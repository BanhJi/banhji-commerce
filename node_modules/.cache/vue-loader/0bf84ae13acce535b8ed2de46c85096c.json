{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/payroll/employee/TimesheetAddListRecord.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/payroll/employee/TimesheetAddListRecord.vue","mtime":1640595536836},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBUaW1lc2hlZXQgZnJvbSAiQC9zY3JpcHRzL21vZGVsL1RpbWVzaGVldCI7CmltcG9ydCBUaW1lc2hlZXRMaW5lIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9UaW1lc2hlZXRMaW5lIjsKaW1wb3J0IGtlbmRvIGZyb20gIkBwcm9ncmVzcy9rZW5kby11aSI7CmNvbnN0IHRpbWVzaGVldE1vZGVsID0gbmV3IFRpbWVzaGVldCh7fSkKY29uc3QgdGltZXNoZWV0TGluZU1vZGVsID0gbmV3IFRpbWVzaGVldExpbmUoe30pCmNvbnN0IGVtcGxveWVlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9lbXBsb3llZUhhbmRsZXIiKQpjb25zdCBsb2NhdGlvbkhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvbG9jYXRpb25IYW5kbGVyIikKY29uc3QgcGF5cm9sbEhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvcGF5cm9sbEhhbmRsZXIiKQpjb25zdCBwcm9qZWN0SGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9wcm9qZWN0SGFuZGxlciIpCmNvbnN0ICQgPSByZXF1aXJlKCJqcXVlcnkiKQpjb25zdCBjb29raWVKUyA9IHJlcXVpcmUoIkAvY29va2llLmpzIik7CmNvbnN0IGNvb2tpZSA9IGNvb2tpZUpTLmdldENvb2tpZSgpOwpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiQWRkVGltZXNoZWV0IiwKICAgIHByb3BzOiBbJ2lkJ10sCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgTG9hZGluZ01lOiAoKSA9PiBpbXBvcnQoYEAvY29tcG9uZW50cy9Mb2FkaW5nYCksCiAgICAgICAgJ21vbnRoLXBpY2tlcicgOiAoKT0+IGltcG9ydCgnQC9jb21wb25lbnRzL2N1c3RvbV90ZW1wbGF0ZXMvTW9udGhQaWNrZXInKQogICAgfSwKICAgIGRhdGE6ICgpID0+ICh7CiAgICAgICAgc2hvd0xvYWRpbmc6IGZhbHNlLAogICAgICAgIGxvY2F0aW9uU2VsZWN0ZWQ6ICcnLAogICAgICAgIGxvY2F0aW9uOltdLAogICAgICAgIG5hbWU6JycsCiAgICAgICAgbW9udGhPZjogJycsCiAgICAgICAgdGltZXNoZWV0OiB0aW1lc2hlZXRNb2RlbCwKICAgICAgICB0aW1lc2hlZXRMaW5lOiB0aW1lc2hlZXRMaW5lTW9kZWwsCiAgICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCA3KSwKICAgICAgICBtZW51OiBmYWxzZSwKICAgICAgICBtb2RhbDogZmFsc2UsCiAgICAgICAgaXNfbW9udGg6IGZhbHNlLAogICAgICAgIHNwZWNpZmljV29yazogewogICAgICAgICAgICAnbmFtZSc6ICcnCiAgICAgICAgfSwKICAgICAgICB0aW1lc2hlZXRMaXN0OiBbCiAgICAgICAgXSwKICAgICAgICBlbmdhZ2VtZW50X3Byb2plY3Q6ewogICAgICAgICAgICBuYW1lOiAnJwogICAgICAgIH0sCiAgICAgICAgbVR5cGVPRldvcms6IHt9LAogICAgICAgIG1TcGVzaWZpY1dvcms6IHt9LAogICAgICAgIG1Qcm9qZWN0OiB7CiAgICAgICAgICAgIG5hbWU6ICcnCiAgICAgICAgfSwKICAgICAgICBwZXJpb2Q6IHsKICAgICAgICAgICAgaWQ6ICAgICAgICAgICAgICAgICAgICAgICAgICcnLAogICAgICAgICAgICBwYXltZW50UGVyaW9kOiAgICAgICAgICAgICAge30sCiAgICAgICAgICAgIGhvdXJQZXJEYXk6ICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICBvdmVydGltZUZvcldlZWtlbmQ6ICAgICAgICAgMCwKICAgICAgICAgICAgb3ZlcnRpbWVGb3JOYXRpb25hbEhvbGlkYXk6IDAsCiAgICAgICAgICAgIGRheVRvUGF5cm9sbDogICAgICAgICAgICAgICAwLAogICAgICAgICAgICB3b3JraW5nRGF5OiAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgb3ZlcnRpbWVOaWdodDogICAgICAgICAgICAgIDAsCiAgICAgICAgICAgIG5pZ2h0VGltZTogICAgICAgICAgICAgICAgICAwLAogICAgICAgIH0sCiAgICAgICAgbGVhdmVzOiBbXSwKICAgICAgICBvdmVyVGltZVR5cGU6WwogICAgICAgICAgICB7IGlkOiAibm9uZSIsIG5hbWU6ICJOL0EifSwKICAgICAgICAgICAgeyBpZDogIndlZWtlbmQiLCBuYW1lOiAiV2Vla2VuZCJ9LAogICAgICAgICAgICB7IGlkOiAibmF0aW9uYWxfaG9saWRheSIsIG5hbWU6ICJOYXRpb25hbCBIb2xpZGF5In0sCiAgICAgICAgICAgIHsgaWQ6ICJuaWdodCIsIG5hbWU6ICJOaWdodCJ9CiAgICAgICAgXSwKICAgICAgICBvdmVyVGltZTogewogICAgICAgICAgICBvdmVyVGltZVdlZWtlbmQ6ICAgICAgICAgICAwLAogICAgICAgICAgICBvdmVyVGltZU5hdGlvbmFsSG9saWRheTogICAwLAogICAgICAgICAgICBvdmVyVGltZU5pZ2h0OiAgICAgICAgICAgICAwLAogICAgICAgICAgICB0b3RhbE92ZXJUaW1lOiAgICAgICAgICAwLAogICAgICAgICAgICB3b3JraW5nSG91cnM6ICAgICAgICAgICAwLAogICAgICAgICAgICB3b3JraW5nVGltZTogICAgICAgICAgICAwLAogICAgICAgICAgICB0b3RhbFVucGFpZDogICAgICAgICAgICAwLAogICAgICAgIH0sCiAgICAgICAgbG9nZ2VkVXNlcjogewogICAgICAgICAgICBpZDogY29va2llLmNyZWF0b3IsCiAgICAgICAgICAgIG5hbWU6IGNvb2tpZS5lbWFpbAogICAgICAgIH0sCiAgICAgICAgcHJvamVjdDogW10KICAgIH0pLAogICAgbWV0aG9kczogewogICAgICAgIFRpbWVzaGVldERhdGVFZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgICAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IHJlcXVpcmVkIG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAgICAgLmtlbmRvRGF0ZVBpY2tlcigpCiAgICAgICAgfSwKICAgICAgICBUaW1lc2hlZXRDaGVja0luRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucyl7CiAgICAgICAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IGlkPSJ0aW1lSW4iIHJlcXVpcmVkIG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAgICAgLmtlbmRvVGltZVBpY2tlcigpCiAgICAgICAgfSwKICAgICAgICBUaW1lc2hlZXRjaGVja091dEVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCByZXF1aXJlZCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb1RpbWVQaWNrZXIoKQogICAgICAgIH0sCiAgICAgICAgb25DaGFuZ2VzKGUpewogICAgICAgICAgICBsZXQgZGF0YVJvdyA9IGUuaXRlbXNbMF0KICAgICAgICAgICAgaWYgKGUuZmllbGQgPT09ICJ0eXBlT0ZXb3JrIikgewogICAgICAgICAgICAgICAgdGhpcy50eXBlb2Z3b3JrY2xpY2sgPSBlLml0ZW1zWzBdLnR5cGVPRldvcmsKICAgICAgICAgICAgICAgIHRoaXMubG9hZFNwZWNpZmljQnlUeXBlKHRoaXMudHlwZW9md29ya2NsaWNrLmlkKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGUuZmllbGQgPT09ICJjaGVja0luIil7CiAgICAgICAgICAgICAgICBsZXQgY2luID0gZGF0YVJvdy5jaGVja0luCiAgICAgICAgICAgICAgICBsZXQgY2luTSA9IGNpbi5nZXRUaW1lKCkKICAgICAgICAgICAgICAgIHRoaXMuQ0lOID0gY2luTQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGUuZmllbGQgPT09ICJjaGVja091dCIpewogICAgICAgICAgICAgICAgbGV0IGNPdXQgPSBkYXRhUm93LmNoZWNrT3V0CiAgICAgICAgICAgICAgICBsZXQgY091dE0gPSBjT3V0LmdldFRpbWUoKQogICAgICAgICAgICAgICAgdGhpcy5DT1VUID0gY091dE0KICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmhvdXJzID0gcGFyc2VGbG9hdCgodGhpcy5DT1VUIC0gdGhpcy5DSU4pIC8gKDEwMDAgKiA2MCAqIDYwKSk7CiAgICAgICAgICAgIGlmKHRoaXMuaG91cnMpewogICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoJ2hvdXJzJyx0aGlzLmhvdXJzKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuYXV0b0NhbGN1bGF0ZSgpCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkU3BlY2lmaWNCeVR5cGUoaWQpewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0U3BlY2lmaWNCeVR5cGUoaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3Blc2lmaWNXb3JrID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5zcGVzaWZpY1dvcmsubGVuZ3RoID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tU3Blc2lmaWNXb3JrID0gdGhpcy5zcGVzaWZpY1dvcmtbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZExvY2F0aW9uKCkgewogICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSGFuZGxlci5saXN0KCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbiA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMubG9jYXRpb24ubGVuZ3RoID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkID0gdGhpcy5sb2NhdGlvblswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkUHJvamVjdCgpIHsKICAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICBwcm9qZWN0SGFuZGxlci5saXN0KCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9qZWN0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5wcm9qZWN0Lmxlbmd0aCA+IDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubVByb2plY3QgID0gdGhpcy5wcm9qZWN0WzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIHJvd051bWJlclRtcGwoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgdmFyIGRzID0gdGhpcy4kcmVmcy5kYXRhU291cmNlLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgICAgICAgICBpbmRleCA9IGRzLmluZGV4T2YoZGF0YUl0ZW0pOwogICAgICAgICAgICByZXR1cm4gaW5kZXggKyAxOwogICAgICAgIH0sCiAgICAgICAgYWRkUm93KCkgewogICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmRhdGFTb3VyY2Uua2VuZG9XaWRnZXQoKSwKICAgICAgICAgICAgICAgIHRvdGFsID0gZHMudG90YWwoKTsKICAgICAgICAgICAgZHMuaW5zZXJ0KHRvdGFsLCB7CiAgICAgICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLAogICAgICAgICAgICAgICAgaG91cnM6IDAsCiAgICAgICAgICAgICAgICBvdmVyVGltZVR5cGU6IHsKICAgICAgICAgICAgICAgICAgICBpZDogJ25vbmUnLCAKICAgICAgICAgICAgICAgICAgICBuYW1lOiAnTm9uZScKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjaGVja0luOiBuZXcgRGF0ZSgpLAogICAgICAgICAgICAgICAgY2hlY2tPdXQ6IG5ldyBEYXRlKCksCiAgICAgICAgICAgICAgICB0eXBlT0ZXb3JrOiB0aGlzLm1UeXBlT0ZXb3JrLAogICAgICAgICAgICAgICAgc3BlY2lmaWNXb3JrOiB0aGlzLm1TcGVzaWZpY1dvcmssCiAgICAgICAgICAgICAgICBlbmdhZ2VtZW50X3Byb2plY3Q6IHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiAnJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmVSb3coZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGNvbnN0IGdyaWQgPSBrZW5kby5qUXVlcnkoIiNncmlkVGltZXNoZWV0TGlzdCIpLmRhdGEoImtlbmRvR3JpZCIpLAogICAgICAgICAgICAgICAgZGF0YVNvdXJjZSA9IGdyaWQuZGF0YVNvdXJjZSwKICAgICAgICAgICAgICAgIGRhdGFJdGVtID0gZ3JpZC5kYXRhSXRlbSgkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdCgidHIiKSk7CiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLnRvdGFsKCkgPiAxKSB7CiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnJlbW92ZShkYXRhSXRlbSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRUeXBlT2ZXb3JrKCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0VHlwZU9mV29yaygpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzLnN0YXR1c0NvZGUgPT09IDIwMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR5cGVPRldvcmsgPSByZXMuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy50eXBlT0ZXb3JrLmxlbmd0aCA+IDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRUeXBlID0gdGhpcy50eXBlT0ZXb3JrLmZpbHRlcih3b3JkID0+IHdvcmQubmFtZSA9PSJBZG1pbmlzdHJhdGlvbiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tVHlwZU9GV29yayA9IHJlc3VsdFR5cGVbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2codGhpcy5tVHlwZU9GV29yaykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRTcGVjaWZpY0J5VHlwZSh0aGlzLm1UeXBlT0ZXb3JrLmlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdERhdGEoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBvdmVyVGltZURyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucyl7CiAgICAgICAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICAgICAgICBhdXRvQmluZDogZmFsc2UsCiAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJuYW1lIiwKICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICAgICAgICAgZGF0YTogdGhpcy5vdmVyVGltZVR5cGUsCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgdHlwZU9mV29yZERyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgICAgICAgYXV0b0JpbmQ6IGZhbHNlLAogICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAibmFtZSIsCiAgICAgICAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1uYW1lIzwvc3Bhbj4iLAogICAgICAgICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLnR5cGVPRldvcmssCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgc3Blc2lmaWNEcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAgICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgICAgICAgIGF1dG9CaW5kOiBmYWxzZSwKICAgICAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLnNwZXNpZmljV29yaywKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBwcm9qZWN0RHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKXsKICAgICAgICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAibmFtZSIsCiAgICAgICAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogIm5hbWUiLAogICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICAgICAgICAgZGF0YTogdGhpcy5wcm9qZWN0LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGNhbGN1bGF0ZU92ZXJ0aW1lKCl7CiAgICAgICAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuZGF0YVNvdXJjZS5rZW5kb1dpZGdldCgpCiAgICAgICAgICAgIGxldCB0aW1lc2hlZXREYXRhID0gZHMuZGF0YSgpCiAgICAgICAgICAgIGxldCBsZWF2ZSA9IHtpZDogJyd9CiAgICAgICAgICAgIGxldCB0aW1lc2hlZXRfbGlzdCA9IHRpbWVzaGVldERhdGEubWFwKGl0ZW0gPT4gewogICAgICAgICAgICAgICAgbGVhdmUgICAgICA9IGl0ZW0uc3BlY2lmaWNXb3JrLmxlYXZlID8gaXRlbS5zcGVjaWZpY1dvcmsubGVhdmU6IHtpZDogJyd9CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGRhdGU6ICAgICAgICAgICAgICAgICBpdGVtLmRhdGUgPyBpdGVtLmRhdGU6IGBgLAogICAgICAgICAgICAgICAgICAgIGRhdGVGb3JtYXRlOiAgICAgICAgICBrZW5kby50b1N0cmluZyhuZXcgRGF0ZShpdGVtLmRhdGUpLCd5eXl5LU1NLWRkJyksCiAgICAgICAgICAgICAgICAgICAgaG91cnM6ICAgICAgICAgICAgICAgIGl0ZW0uaG91cnMgPyBpdGVtLmhvdXJzOiAwLAogICAgICAgICAgICAgICAgICAgIGNoZWNrSW46ICAgICAgICAgICAgICBpdGVtLmNoZWNrSW4gPyBpdGVtLmNoZWNrSW46IGBgLAogICAgICAgICAgICAgICAgICAgIGNoZWNrT3V0OiAgICAgICAgICAgICBpdGVtLmNoZWNrT3V0ID8gaXRlbS5jaGVja091dDogJycsCiAgICAgICAgICAgICAgICAgICAgbGVhdmVJZDogICAgICAgICAgICAgIGxlYXZlLmlkID8gbGVhdmUuaWQ6ICcnLAogICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lVHlwZTogICAgICAgICBpdGVtLm92ZXJUaW1lVHlwZSA/IGl0ZW0ub3ZlclRpbWVUeXBlOiB7aWQ6ICdub25lJywgbmFtZTogJ04vQSd9LAogICAgICAgICAgICAgICAgICAgIG5hdHVyZTogICAgICAgICAgICAgICBpdGVtLnNwZWNpZmljV29yay5uYXR1cmUgPyBpdGVtLnNwZWNpZmljV29yay5uYXR1cmU6IHt9LAogICAgICAgICAgICAgICAgICAgIHR5cGVPRldvcms6ICAgICAgICAgICBpdGVtLnR5cGVPRldvcmsgPyBpdGVtLnR5cGVPRldvcms6IHtuYW1lOiAnJ30sCiAgICAgICAgICAgICAgICAgICAgc3BlY2lmaWNXb3JrOiAgICAgICAgIGl0ZW0uc3BlY2lmaWNXb3JrID9pdGVtLnNwZWNpZmljV29yazoge25hbWU6ICcnfSwKICAgICAgICAgICAgICAgICAgICBlbmdhZ2VtZW50X3Byb2plY3Q6ICAgaXRlbS5lbmdhZ2VtZW50X3Byb2plY3QgPyBpdGVtLmVuZ2FnZW1lbnRfcHJvamVjdDoge25hbWU6ICcnfSwKICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogICAgICAgICAgaXRlbS5kZXNjcmlwdGlvbiA/IGl0ZW0uZGVzY3JpcHRpb246IGBgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IG92ZXJUaW1lX3dlZWtlbmQgICAgICAgICAgICA9IDAKICAgICAgICAgICAgbGV0IG92ZXJUaW1lX25hdGlvbmFsX2hvbGlkYXkgICA9IDAKICAgICAgICAgICAgbGV0IG92ZXJUaW1lX25pZ2h0ICAgICAgICAgICAgICA9IDAKICAgICAgICAgICAgbGV0IHdvcmtpbmdfaG91cnMgICAgICAgICAgICAgICA9IDAKICAgICAgICAgICAgbGV0IHRvdGFsX3VucGFpZCAgICAgICAgICAgICAgICA9IDAKICAgICAgICAgICAgdGltZXNoZWV0X2xpc3QuZm9yRWFjaChrID0+ewogICAgICAgICAgICAgICAgaWYoay5vdmVyVGltZVR5cGUuaWQgPT0gJ3dlZWtlbmQnKXsKICAgICAgICAgICAgICAgICAgICBvdmVyVGltZV93ZWVrZW5kICs9IGsuaG91cnMKICAgICAgICAgICAgICAgIH1lbHNlIGlmKGsub3ZlclRpbWVUeXBlLmlkID09ICduYXRpb25hbF9ob2xpZGF5Jyl7CiAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVfbmF0aW9uYWxfaG9saWRheSArPSBrLmhvdXJzCiAgICAgICAgICAgICAgICB9ZWxzZSBpZihrLm92ZXJUaW1lVHlwZS5pZCA9PSAnbmlnaHQnKXsKICAgICAgICAgICAgICAgICAgICBvdmVyVGltZV9uaWdodCArPSBrLmhvdXJzCiAgICAgICAgICAgICAgICB9ZWxzZSBpZihrLm92ZXJUaW1lVHlwZS5pZCA9PSAnbm9uZScgJiZrLnR5cGVPRldvcmsubmFtZSAhPSdHZW5lcmFsJyAmJiBrLnR5cGVPRldvcmsubmFtZSAhPSAnTmF0aW9uYWwgSG9saWRheS8gV2Vla2VuZCcpewogICAgICAgICAgICAgICAgICAgIHdvcmtpbmdfaG91cnMgKz0gay5ob3VycwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoay5uYXR1cmUuaWQgPT0gJ3VucGFpZF9ob3VycycpewogICAgICAgICAgICAgICAgICAgIHRvdGFsX3VucGFpZCAgICArPSBrLmhvdXJzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGxldCB0b3RhbE92ZXJUaW1lID0gICAgICAgICAgICBwYXJzZUZsb2F0KG92ZXJUaW1lX3dlZWtlbmQpICsgcGFyc2VGbG9hdChvdmVyVGltZV9uYXRpb25hbF9ob2xpZGF5KSArIHBhcnNlRmxvYXQob3ZlclRpbWVfbmlnaHQpOwogICAgICAgICAgICB0aGlzLm92ZXJUaW1lID0gewogICAgICAgICAgICAgICAgb3ZlclRpbWVXZWVrZW5kOiAgICAgICAgICAgIHBhcnNlRmxvYXQob3ZlclRpbWVfd2Vla2VuZCksCiAgICAgICAgICAgICAgICBvdmVyVGltZU5hdGlvbmFsSG9saWRheTogICAgcGFyc2VGbG9hdChvdmVyVGltZV9uYXRpb25hbF9ob2xpZGF5KSwKICAgICAgICAgICAgICAgIG92ZXJUaW1lTmlnaHQ6ICAgICAgICAgICAgICBwYXJzZUZsb2F0KG92ZXJUaW1lX25pZ2h0KSwKICAgICAgICAgICAgICAgIHRvdGFsT3ZlclRpbWU6ICAgICAgICAgICAgICB0b3RhbE92ZXJUaW1lLAogICAgICAgICAgICAgICAgdG90YWxVbnBhaWQ6ICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQodG90YWxfdW5wYWlkKSwKICAgICAgICAgICAgICAgIHdvcmtpbmdIb3VyczogICAgICAgICAgICAgICBwYXJzZUZsb2F0KHdvcmtpbmdfaG91cnMpLAogICAgICAgICAgICAgICAgdG90YWxXb3JraW5naG91cnM6ICAgICAgICAgIHBhcnNlRmxvYXQod29ya2luZ19ob3VycykgKyBwYXJzZUZsb2F0KHRvdGFsT3ZlclRpbWUpLAogICAgICAgICAgICAgICAgZGVmYXVsdFdvcmtpbmdIb3VyczogICAgICAgIHBhcnNlRmxvYXQodGhpcy5wZXJpb2QuaG91clBlckRheSkgKiBwYXJzZUZsb2F0KHRoaXMucGVyaW9kLndvcmtpbmdEYXkpLAogICAgICAgICAgICB9CiAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygnb3ZlclRpbWUnLHRoaXMub3ZlclRpbWUpCiAgICAgICAgfSwKICAgICAgICBvblNhdmVDbG9zZSgpewogICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU92ZXJ0aW1lKCkKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWUKICAgICAgICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5kYXRhU291cmNlLmtlbmRvV2lkZ2V0KCkKICAgICAgICAgICAgbGV0IHRpbWVzaGVldERhdGEgPSBkcy5kYXRhKCkKICAgICAgICAgICAgbGV0IGxlYXZlID0ge2lkOiAnJ30KICAgICAgICAgICAgbGV0IHRpbWVzaGVldF9saXN0ID0gdGltZXNoZWV0RGF0YS5tYXAoaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBsZWF2ZSAgICAgID0gaXRlbS5zcGVjaWZpY1dvcmsubGVhdmUgPyBpdGVtLnNwZWNpZmljV29yay5sZWF2ZToge2lkOiAnJ30KICAgICAgICAgICAgICAgIHJldHVybiB7ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBkYXRlOiAgICAgICAgICAgICAgICAgaXRlbS5kYXRlID8gaXRlbS5kYXRlOiBgYCwKICAgICAgICAgICAgICAgICAgICBkYXRlRm9ybWF0ZTogICAgICAgICAga2VuZG8udG9TdHJpbmcobmV3IERhdGUoaXRlbS5kYXRlKSwneXl5eS1NTS1kZCcpLAogICAgICAgICAgICAgICAgICAgIGhvdXJzOiAgICAgICAgICAgICAgICBpdGVtLmhvdXJzID8gaXRlbS5ob3VyczogMCwKICAgICAgICAgICAgICAgICAgICBjaGVja0luOiAgICAgICAgICAgICAgaXRlbS5jaGVja0luID8gaXRlbS5jaGVja0luOiBgYCwKICAgICAgICAgICAgICAgICAgICBjaGVja091dDogICAgICAgICAgICAgaXRlbS5jaGVja091dCA/IGl0ZW0uY2hlY2tPdXQ6ICcnLAogICAgICAgICAgICAgICAgICAgIGxlYXZlSWQ6ICAgICAgICAgICAgICBsZWF2ZS5pZCA/IGxlYXZlLmlkOiAnJywKICAgICAgICAgICAgICAgICAgICB0eXBlT0ZXb3JrOiAgICAgICAgICAgaXRlbS50eXBlT0ZXb3JrID8gaXRlbS50eXBlT0ZXb3JrOiB7bmFtZTogJyd9LAogICAgICAgICAgICAgICAgICAgIHNwZWNpZmljV29yazogICAgICAgICBpdGVtLnNwZWNpZmljV29yayA/aXRlbS5zcGVjaWZpY1dvcms6IHtuYW1lOiAnJ30sCiAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVUeXBlOiAgICAgICAgIGl0ZW0ub3ZlclRpbWVUeXBlID8gaXRlbS5vdmVyVGltZVR5cGU6IHtpZDogJ25vbmUnLCBuYW1lOiAnTi9BJ30sCiAgICAgICAgICAgICAgICAgICAgZW5nYWdlbWVudF9wcm9qZWN0OiAgIGl0ZW0uZW5nYWdlbWVudF9wcm9qZWN0ID8gaXRlbS5lbmdhZ2VtZW50X3Byb2plY3Q6IHtuYW1lOiAnJ30sCiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICAgICAgICAgIGl0ZW0uZGVzY3JpcHRpb24gPyBpdGVtLmRlc2NyaXB0aW9uOiBgYAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbGV0IGhlbHBlciA9IHt9OwogICAgICAgICAgICBsZXQgcmVzdWx0cyA9IHRpbWVzaGVldF9saXN0LnJlZHVjZShmdW5jdGlvbihyLCBvKSB7CiAgICAgICAgICAgIGxldCBrZXkgPSBvLmRhdGVGb3JtYXRlICsgby5sZWF2ZUlkOyAKICAgICAgICAgICAgaWYoIWhlbHBlcltrZXldKSB7CiAgICAgICAgICAgICAgICBoZWxwZXJba2V5XSA9IE9iamVjdC5hc3NpZ24oe30sIG8pOyAvLyBjcmVhdGUgYSBjb3B5IG9mIG8KICAgICAgICAgICAgICAgIHIucHVzaChoZWxwZXJba2V5XSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBoZWxwZXJba2V5XS5ob3VycyAgICAgICAgICAgICArPSBvLmhvdXJzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByOwogICAgICAgICAgICB9LCBbXSk7CiAgICAgICAgICAgIGxldCByZXN1bHRzX3RpbWVzaGVldCA9IFtdCiAgICAgICAgICAgIGxldCBsZWF2ZXMgPSB0aGlzLmxlYXZlcwogICAgICAgICAgICByZXN1bHRzLmZvckVhY2goaW5kZXg9PnsKICAgICAgICAgICAgICAgIGxldCBsZWF2ZSAgPSBsZWF2ZXMuZmlsdGVyKGk9PmkuaWQgPT09IGluZGV4LmxlYXZlSWQpCiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coMSxpbmRleCkKICAgICAgICAgICAgICAgIHJlc3VsdHNfdGltZXNoZWV0LnB1c2goewogICAgICAgICAgICAgICAgICAgIHNwZWNpZmljV29yazogICAgICAgaW5kZXguc3BlY2lmaWNXb3JrLAogICAgICAgICAgICAgICAgICAgIGhvdXJzOiAgICAgICAgICAgICAgaW5kZXguaG91cnMsCiAgICAgICAgICAgICAgICAgICAgdHlwZU9GV29yazogICAgICAgICBpbmRleC50eXBlT0ZXb3JrLAogICAgICAgICAgICAgICAgICAgIGRhdGVGb3JtYXRlOiAgICAgICAgaW5kZXguZGF0ZUZvcm1hdGUsCiAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVVdWlkOiAgICAgICBpbmRleC5lbXBsb3llZVV1aWQsCiAgICAgICAgICAgICAgICAgICAgbGVhdmVJZDogICAgICAgICAgICBpbmRleC5sZWF2ZUlkLAogICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAgICAgICAgaW5kZXguZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgbGVhdmU6ICAgICAgICAgICAgICBsZWF2ZVswXSB8fCB7fSwKICAgICAgICAgICAgICAgICAgICBlbmdhZ2VtZW50X3Byb2plY3Q6IGluZGV4LmVuZ2FnZW1lbnRfcHJvamVjdCB8fCB7fSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAgICAgICAgICAgICAgIGluZGV4LnR5cGUKCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KQoKICAgICAgICAgICAgaWYodGltZXNoZWV0X2xpc3QubGVuZ3RoID4gMCl7CiAgICAgICAgICAgICAgICBsZXQgdG90YWxITiAgICAgICAgICAgICAgICAgID0gdGhpcy50b3RhbGVIb3Vyc0J5TmF0dXJlOwogICAgICAgICAgICAgICAgdGhpcy5wYWlkX2hvdXJzICAgICAgICAgICAgICA9IHRvdGFsSE4ucGFpZF9ob3Vycz8gdG90YWxITi5wYWlkX2hvdXJzOiAwOwogICAgICAgICAgICAgICAgdGhpcy51bnBhaWRfaG91cnMgICAgICAgICAgICA9IHRvdGFsSE4udW5wYWlkX2hvdXJzPyB0b3RhbEhOLnVucGFpZF9ob3VyczogMDsKICAgICAgICAgICAgICAgIHRoaXMub3ZlcnRpbWVfaG91cnNfd2Vla2VuZCAgPSB0b3RhbEhOLm92ZXJ0aW1lX2hvdXJzX3dlZWtlbmQ/IHRvdGFsSE4ub3ZlcnRpbWVfaG91cnNfd2Vla2VuZDowOwogICAgICAgICAgICAgICAgdGhpcy5vdmVydGltZV9ob3Vyc19ob2xpZGF5ICA9IHRvdGFsSE4ub3ZlcnRpbWVfaG91cnNfaG9saWRheT8gdG90YWxITi5vdmVydGltZV9ob3Vyc19ob2xpZGF5OiAwOwogICAgICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVzaGVldC5pZCB8fCAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcGxveWVlOiAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbXBsb3llZS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUlkOiAgICAgICAgICAgICB0aGlzLmVtcGxveWVlLmVtcGxveWVlSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdE5hbWU6ICAgICAgICAgICAgICAgdGhpcy5lbXBsb3llZS5sYXN0TmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdE5hbWU6ICAgICAgICAgICAgICB0aGlzLmVtcGxveWVlLmZpcnN0TmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZW5kZXI6ICAgICAgICAgICAgICAgICB0aGlzLmVtcGxveWVlLmdlbmRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYW5rOiAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAgICAgICAgICAgICAgICAgdGhpcy5lbXBsb3llZS5iYW5rLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYW5rTmFtZTogICAgICAgICAgIHRoaXMuZW1wbG95ZWUuYmFuay5iYW5rTmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogICAgICAgICAgICAgICB0aGlzLmVtcGxveWVlLmJhbmsudXVpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwb3VzZUdlbmRlcjogICAgICAgICAgIHRoaXMuZW1wbG95ZWUuc3BvdXNlR2VuZGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdHVyZUVtcGxveWVlOiAgICAgICAgIHRoaXMuZW1wbG95ZWUubmF0dXJlRW1wbG95ZWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9PZkNoaWxkcmVuOiAgICAgICAgICAgdGhpcy5lbXBsb3llZS5ub09mQ2hpbGRyZW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFua0FjY291bnQ6ICAgICAgICAgICAgdGhpcy5lbXBsb3llZS5iYW5rQWNjb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiAgICAgICAgICB0aGlzLmVtcGxveWVlLnBheW1lbnRNZXRob2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BvdXNlTmF0dXJlRW1wbG95ZWU6ICAgdGhpcy5lbXBsb3llZS5zcG91c2VOYXR1cmVFbXBsb3llZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsTGlhYmlsaXRpZTogICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQ6ICAgICAgICAgICAgICAgdGhpcy5lbXBsb3llZS5wYXlyb2xsTGlhYmlsaXRpZS51dWlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbF9uYW1lOiAgICAgICAgIHRoaXMuZW1wbG95ZWUucGF5cm9sbExpYWJpbGl0aWUubG9jYWxfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZV9jb2RlOiAgICAgICAgICB0aGlzLmVtcGxveWVlLnBheXJvbGxMaWFiaWxpdGllLnR5cGVfY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogICAgICAgICAgICAgICB0aGlzLmVtcGxveWVlLnBheXJvbGxMaWFiaWxpdGllLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogICAgICAgICAgICAgdGhpcy5lbXBsb3llZS5wYXlyb2xsTGlhYmlsaXRpZS5udW1iZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbGFyeUFjYzogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogICAgICAgICAgICAgICB0aGlzLmVtcGxveWVlLnBheXJvbGxMaWFiaWxpdGllLnV1aWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsX25hbWU6ICAgICAgICAgdGhpcy5lbXBsb3llZS5wYXlyb2xsTGlhYmlsaXRpZS5sb2NhbF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlX2NvZGU6ICAgICAgICAgIHRoaXMuZW1wbG95ZWUucGF5cm9sbExpYWJpbGl0aWUudHlwZV9jb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAgICAgICAgICAgICAgIHRoaXMuZW1wbG95ZWUucGF5cm9sbExpYWJpbGl0aWUubmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiAgICAgICAgICAgICB0aGlzLmVtcGxveWVlLnBheXJvbGxMaWFiaWxpdGllLm51bWJlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb250aE9mOiAgICAgICAgICAgICAgICAgIGtlbmRvLnRvU3RyaW5nKG5ldyBEYXRlKHRoaXMubW9udGhPZiksJ3l5eXktTU0tZGQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZVNoZWV0UmVjb3JkOiAgICAgICAgICB0aW1lc2hlZXRfbGlzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHNfdGltZXNoZWV0OiAgICAgICAgcmVzdWx0c190aW1lc2hlZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEhvdXJzOiAgICAgICAgICAgICAgIHRoaXMudG90YWxIb3VycywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsSG91cnNCeXR5cGU6ICAgICAgICAgdGhpcy50b3RhbGVIb3Vyc0J5TmF0dXJlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFpZEhvdXJzOiAgICAgICAgICAgICAgICB0aGlzLnBhaWRfaG91cnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnBhaWRIb3VyczogICAgICAgICAgICAgIHRoaXMudW5wYWlkX2hvdXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyaW9kOiAgICAgICAgICAgICAgICAgICB0aGlzLnBlcmlvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lOiAgICAgICAgICAgICAgICAgdGhpcy5vdmVyVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJ0aW1lSG91cnNXZWVrZW5kOiAgICAgdGhpcy5vdmVyVGltZS5vdmVyVGltZVdlZWtlbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVydGltZUhvdXJzSG9saWRheTogICAgIHRoaXMub3ZlclRpbWUub3ZlclRpbWVOYXRpb25hbEhvbGlkYXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyVGltZU5pZ2h0OiAgICAgICAgICAgIHRoaXMub3ZlclRpbWUub3ZlclRpbWVOaWdodCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsT3ZlclRpbWU6ICAgICAgICAgICAgdGhpcy5vdmVyVGltZS50b3RhbE92ZXJUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxVbnBhaWQ6ICAgICAgICAgICAgICB0aGlzLm92ZXJUaW1lLnRvdGFsVW5wYWlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxXb3JraW5naG91cnM6ICAgICAgICB0aGlzLm92ZXJUaW1lLnRvdGFsV29ya2luZ2hvdXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFdvcmtpbmdIb3VyczogICAgICB0aGlzLm92ZXJUaW1lLmRlZmF1bHRXb3JraW5nSG91cnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZWRVc2VyOiAgICAgICAgICAgICAgIHRoaXMubG9nZ2VkVXNlcgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygxLGRhdGEpCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVtcGxveWVlSGFuZGxlci5jcmVhdGVUaW1lc2hlZXQoZGF0YSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc25vdGlmeS5zdWNjZXNzKCdTdWNjZXNzJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc25vdGlmeS5lcnJvcignU29tZXRoaW5nIHdlbnQgd3JvbmcnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChlKQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLiRzbm90aWZ5LmVycm9yKCdEYXRhIG5vdCBmb3VuZCcpCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGNhbmNlbCgpewogICAgICAgICAgICB0aGlzLnRpbWVzaGVldExpc3QgPSAnJwogICAgICAgICAgICB0aGlzLm1vbnRoT2YgPSBrZW5kby50b1N0cmluZyhuZXcgRGF0ZSgpLCd5eXl5LU1NLWRkJykKICAgICAgICAgICAgdGhpcy5jbG9zZSgpCiAgICAgICAgfSwKICAgICAgICBjbG9zZSgpewogICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5nbygtMSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGluaXREYXRhKCkgewogICAgICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLnRpbWVzaGVldF9pZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvYWRUaW1lc2hlZXRTaW5nbGUoKQogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmRhdGFTb3VyY2Uua2VuZG9XaWRnZXQoKQogICAgICAgICAgICAgICAgZHMuZGF0YShbXSkKICAgICAgICAgICAgICAgIHRoaXMuYWRkUm93KCkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZFNpbmdsZUVtcGxveWVlKCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUhhbmRsZXIuZ2V0KHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtcGxveWVlID0gcmVzLmRhdGEuZGF0YVswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5lbXBsb3llZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5lbXBsb3llZS5lbXBsb3llZUlkICsnLScrdGhpcy5lbXBsb3llZS5maXJzdE5hbWUgKyAnICcgKyB0aGlzLmVtcGxveWVlLmxhc3ROYW1lIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtb250aF9vZiA9IHRoaXMubW9udGhPZiA/IHRoaXMubW9udGhPZjogbmV3IERhdGUoKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vbnRoT2YgPSBrZW5kby50b1N0cmluZyhuZXcgRGF0ZShtb250aF9vZiksJ3l5eXktTU0nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZSAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkVHlwZU9mV29yaygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGxvYWRUaW1lc2hlZXRTaW5nbGUoKXsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVIYW5kbGVyLmdldFRpbWVzaGVldFNpbmdsZSh0aGlzLiRyb3V0ZS5wYXJhbXMudGltZXNoZWV0X2lkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZXNoZWV0RFMgPSByZXMuZGF0YVswXQogICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnRpbWVzaGVldERTKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZXNoZWV0ICAgICAgID0gdGhpcy50aW1lc2hlZXREUwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkICAgID0gdGhpcy50aW1lc2hlZXREUy5sb2NhdGlvbiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW9udGhPZiA9IHRoaXMudGltZXNoZWV0RFMubW9udGhPZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lc2hlZXRMaXN0ID0gdGhpcy50aW1lc2hlZXREUy50aW1lU2hlZXRSZWNvcmQKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vbnRoX29mID0gdGhpcy5tb250aE9mID8gdGhpcy5tb250aE9mOiBuZXcgRGF0ZSgpIAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vbnRoT2YgPSBrZW5kby50b1N0cmluZyhuZXcgRGF0ZShtb250aF9vZiksJ3l5eXktTU0nKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhdXRvQ2FsY3VsYXRlKCkgewogICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmRhdGFTb3VyY2Uua2VuZG9XaWRnZXQoKSwKICAgICAgICAgICAgICAgIHNwZWNpZmljV29ya3MgPSBbXSwKICAgICAgICAgICAgICAgIHRvdGFsSG91cnMgPSAwOwogICAgICAgICAgICAgICAgZHMuZGF0YSgpLmZvckVhY2godmFsdWUgPT4gewogICAgICAgICAgICAgICAgICAgIHRvdGFsSG91cnMgKz0ga2VuZG8ucGFyc2VGbG9hdCh2YWx1ZS5ob3VycykKICAgICAgICAgICAgICAgICAgICBpZih2YWx1ZS5zcGVjaWZpY1dvcmspewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuc3BlY2lmaWNXb3JrLmhhc093blByb3BlcnR5KCdpZCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY1dvcmtzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHZhbHVlLnNwZWNpZmljV29yay5uYXR1cmUuaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG91cjogdmFsdWUuaG91cnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHZhbHVlLnR5cGVPRldvcmsuaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIHRoaXMudG90YWxIb3VycyAgPSB0b3RhbEhvdXJzCiAgICAgICAgICAgICAgICB0aGlzLmF1dG9DYWxjdWxhdGVTcGljaWZpY1dvcmsoc3BlY2lmaWNXb3JrcykKICAgICAgICB9LAogICAgICAgIGF1dG9DYWxjdWxhdGVTcGljaWZpY1dvcmsod29ya3MpIHsKICAgICAgICAvLyByZXR1cm4gYnkgYSBrZXkKICAgICAgICAgICAgY29uc3QgZ3JvdXBBbGwgPSBsaXN0ID0+IGxpc3QucmVkdWNlKCh3b3JrcywgaXRlbSkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgdG90YWxIb3VycyA9IHdvcmtzW2l0ZW0ubmFtZV0gfHwgMAogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHdvcmtzLCB7W2l0ZW0ubmFtZV06IHRvdGFsSG91cnMgKyBwYXJzZUZsb2F0KGl0ZW0uaG91cil9KQogICAgICAgICAgICB9LCB7fSkKICAgICAgICAgICAgdGhpcy50b3RhbGVIb3Vyc0J5TmF0dXJlID0gZ3JvdXBBbGwod29ya3MpCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkUGVyaW9kKCl7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICBwYXlyb2xsSGFuZGxlci5nZXRQZXJpaW9kKCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcmlvZCA9IHJlc1swXQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZExlYXZlKCl7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICBwYXlyb2xsSGFuZGxlci5nZXRMZWF2ZSgpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzLnN0YXR1c0NvZGUgPT09IDIwMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxlYXZlcyA9IHJlcy5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgfSwKICAgIG1vdW50ZWQ6IGFzeW5jIGZ1bmN0aW9uICgpIHsKICAgICAgICBhd2FpdCB0aGlzLmxvYWRMb2NhdGlvbigpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2luZ2xlRW1wbG95ZWUoKQogICAgICAgIGF3YWl0IHRoaXMubG9hZFByb2plY3QoKQogICAgICAgIGF3YWl0IHRoaXMubG9hZFBlcmlvZCgpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkTGVhdmUoKQogICAgfSwKICAgIHdhdGNoOiB7CiAgICAgICAgJyRyb3V0ZSc6ICdsb2FkU2luZ2xlRW1wbG95ZWUnCiAgICB9Cn0KCg=="},{"version":3,"sources":["TimesheetAddListRecord.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TimesheetAddListRecord.vue","sourceRoot":"src/views/payroll/employee","sourcesContent":["<template>\n    <v-app>\n        <v-container>\n            <v-row>\n                <v-col cols=\"12\" sm=\"12\">\n                    <v-card outlined dense class=\"pa-4 no_border rounded-sm\" color=\"white\">\n                        <v-form ref=\"form\" lazy-validation>\n                            <v-card outlined dense class=\"no_border\">\n                                <h2 class=\"mb-0\">{{ $t('timesheet') }}</h2>\n                                <v-icon\n                                        onclick=\"window.history.go(-1); return false;\"\n                                        style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                                        class=\"float-right\"\n                                >close\n                                </v-icon>\n                            </v-card>\n                            <v-card outlined dense class=\"px-3 no_border\" color=\"grayBg\" height=\"92px\">\n                                <v-row>\n                                    <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                                        <label class=\"label\">{{ $t('employee_name') }}</label>\n                                        <v-text-field class=\"mt-1\"\n                                            outlined\n                                            v-model=\"name\"\n                                            tage=\"Employee Name\"\n                                            readonly/>\n                                    </v-col>\n                                    <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                                        <label class=\"label\">{{ $t('business_unit_branch') }}</label>\n                                        <v-select class=\"mt-1\"\n                                            outlined\n                                            :items=\"location\"\n                                            item-text=\"name\"\n                                            item-value=\"id\"\n                                            v-model=\"locationSelected\"\n                                            tage=\"Business Unit/Branch\"\n                                            return-object/>\n                                    </v-col>\n                                    <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                                        <label class=\"label\">{{$t('for_the_month_of')}}</label>\n                                        <month-picker :initialMonth=\"monthOf\" @emitMonth=\"monthOf = $event\"/>\n                                    </v-col>\n                                </v-row>\n                            </v-card>\n                            <v-card outlined dense class=\"no_border\" color=\"white\">\n                                <v-row>\n                                    <v-col sm=\"12\" cols=\"12\" class=\"pt-3\">\n                                        <kendo-datasource ref=\"dataSource\"\n                                            :data=\"timesheetList\"\n                                            :change=\"onChanges\"/>\n                                        <kendo-grid id=\"gridTimesheetList\" class=\"grid-function\"\n                                            :data-source-ref=\"'dataSource'\"\n                                            :editable=\"true\"\n                                            :scrollable-virtual=\"true\">\n                                            <kendo-grid-column\n                                                :field=\"'no'\"\n                                                :title=\"$t('no')\"\n                                                :template=\"rowNumberTmpl\"\n                                                :width=\"60\"\n                                                :editable=\"() => {return false;}\"\n                                                :column-menu=\"false\"\n                                                :headerAttributes=\"{ style: 'background-color: #EDF1F5;', class: 'text-center'\t}\"\n                                                :attributes=\"{style: 'text-align: center'}\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'date'\"\n                                                    :title=\"$t('date')\"\n                                                    :width=\"120\"\n                                                    :template=\"'<span>#= kendo.toString(new Date(date), `yyyy-MM-dd`)#</span>'\"\n                                                    :editor=\"TimesheetDateEditor\"\n                                                    :headerAttributes=\"{\n                                                        style: 'background-color: #EDF1F5'\n                                                    }\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'checkIn'\"\n                                                    :title=\"$t('check_in')\"\n                                                    :width=\"120\"\n                                                    :template=\"'<span>#= kendo.toString(new Date(checkIn), `HH:mm tt`)#</span>'\"\n                                                    :editor=\"TimesheetCheckInEditor\"\n                                                    :headerAttributes=\"{\n                                                        style: 'background-color: #EDF1F5'\n                                                    }\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'checkOut'\"\n                                                    :title=\"$t('check_out')\"\n                                                    :width=\"120\"\n                                                    :template=\"'<span>#= kendo.toString(new Date(checkOut), `HH:mm tt`)#</span>'\"\n                                                    :editor=\"TimesheetcheckOutEditor\"\n                                                    :headerAttributes=\"{\n                                                        style: 'background-color: #EDF1F5'\n                                                    }\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'hours'\"\n                                                    :title=\"$t('hours')\"\n                                                    :width=\"100\"\n                                                    :editable=\"() => {return false;}\"\n                                                    :headerAttributes=\"{style: 'text-align: right; background-color: #EDF1F5'}\"/>\n                                             <kendo-grid-column\n                                                    :field=\"'overTimeType'\"\n                                                    :title=\"$t('over_time')\"\n                                                    :width=\"120\"\n                                                    :template=\"'<span>#=overTimeType.name#</span>'\"\n                                                    :editor=\"overTimeDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'typeOFWork'\"\n                                                    :title=\"$t('type_of_work')\"\n                                                    :width=\"200\"\n                                                    :template=\"'<span>#=typeOFWork.name#</span>'\"\n                                                    :editor=\"typeOfWordDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'specificWork'\"\n                                                    :title=\"$t('specific_work')\"\n                                                    :width=\"150\"\n                                                    :template=\"'<span>#=specificWork.name ? specificWork.name: ``#</span>'\"\n                                                    :editor=\"spesificDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'engagement_project'\"\n                                                    :title=\"$t('engagement_project')\"\n                                                    :width=\"240\"\n                                                    :template=\"'<span>#=engagement_project.name || ``#</span>'\"\n                                                    :editor=\"projectDropDownEditor\"\n                                                    :headerAttributes=\"{style: 'text-align: right; background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                    :field=\"'description'\"\n                                                    :title=\"$t('description')\"\n                                                    :width=\"250\"\n                                                    :headerAttributes=\"{style: 'text-align: right; background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                    :width=\"60\"\n                                                    :command=\"{ iconClass: 'k-icon k-i-trash', text: ' ', click: removeRow, class: 'btn-plus' }\"\n                                                    :title=\"$t('action')\"\n                                                    :headerAttributes=\"{style: 'text-align: center; background-color: #EDF1F5'}\"\n                                                    :attributes=\"{style: 'text-align: center'}\"/>\n                                        </kendo-grid>\n                                        <v-btn color=\"primary\"\n                                               class=\"float-left rounded-0 white--text mt-3\"\n                                               @click=\"addRow\">\n                                            <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                                        </v-btn>\n                                    </v-col>\n                                </v-row>\n                            </v-card>\n                            <v-divider/>\n                            <v-card outlined dense class=\"no_border function_footer\">\n                                <v-btn color=\"primary\" class=\"float-right white--text text-capitalize \" @click=\"onSaveClose\">\n                                    {{$t('save')}}\n                                </v-btn>\n                                <v-btn color=\"black\"  class=\"text-capitalize  white--text float-left\" @click=\"cancel\">{{$t('cancel')}}</v-btn>\n                            </v-card>\n                        </v-form>\n                    </v-card>\n                </v-col>\n            </v-row>\n            <LoadingMe\n                :isLoading=\"showLoading\"\n                :fullPage=\"true\"\n                :myLoading=\"true\"/>\n        </v-container>\n    </v-app>\n</template>\n\n<script>\n    import Timesheet from \"@/scripts/model/Timesheet\";\n    import TimesheetLine from \"@/scripts/model/TimesheetLine\";\n    import kendo from \"@progress/kendo-ui\";\n    const timesheetModel = new Timesheet({})\n    const timesheetLineModel = new TimesheetLine({})\n    const employeeHandler = require(\"@/scripts/employeeHandler\")\n    const locationHandler = require(\"@/scripts/locationHandler\")\n    const payrollHandler = require(\"@/scripts/payrollHandler\")\n    const projectHandler = require(\"@/scripts/projectHandler\")\n    const $ = require(\"jquery\")\n    const cookieJS = require(\"@/cookie.js\");\n    const cookie = cookieJS.getCookie();\n    export default {\n        name: \"AddTimesheet\",\n        props: ['id'],\n        components: {\n            LoadingMe: () => import(`@/components/Loading`),\n            'month-picker' : ()=> import('@/components/custom_templates/MonthPicker')\n        },\n        data: () => ({\n            showLoading: false,\n            locationSelected: '',\n            location:[],\n            name:'',\n            monthOf: '',\n            timesheet: timesheetModel,\n            timesheetLine: timesheetLineModel,\n            date: new Date().toISOString().substr(0, 7),\n            menu: false,\n            modal: false,\n            is_month: false,\n            specificWork: {\n                'name': ''\n            },\n            timesheetList: [\n            ],\n            engagement_project:{\n                name: ''\n            },\n            mTypeOFWork: {},\n            mSpesificWork: {},\n            mProject: {\n                name: ''\n            },\n            period: {\n                id:                         '',\n                paymentPeriod:              {},\n                hourPerDay:                 0,\n                overtimeForWeekend:         0,\n                overtimeForNationalHoliday: 0,\n                dayToPayroll:               0,\n                workingDay:                 0,\n                overtimeNight:              0,\n                nightTime:                  0,\n            },\n            leaves: [],\n            overTimeType:[\n                { id: \"none\", name: \"N/A\"},\n                { id: \"weekend\", name: \"Weekend\"},\n                { id: \"national_holiday\", name: \"National Holiday\"},\n                { id: \"night\", name: \"Night\"}\n            ],\n            overTime: {\n                overTimeWeekend:           0,\n                overTimeNationalHoliday:   0,\n                overTimeNight:             0,\n                totalOverTime:          0,\n                workingHours:           0,\n                workingTime:            0,\n                totalUnpaid:            0,\n            },\n            loggedUser: {\n                id: cookie.creator,\n                name: cookie.email\n            },\n            project: []\n        }),\n        methods: {\n            TimesheetDateEditor(container, options) {\n                kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                    .appendTo(container)\n                    .kendoDatePicker()\n            },\n            TimesheetCheckInEditor(container, options){\n                kendo.jQuery('<input id=\"timeIn\" required name=\"' + options.field + '\"/>')\n                    .appendTo(container)\n                    .kendoTimePicker()\n            },\n            TimesheetcheckOutEditor(container, options){\n                kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                    .appendTo(container)\n                    .kendoTimePicker()\n            },\n            onChanges(e){\n                let dataRow = e.items[0]\n                if (e.field === \"typeOFWork\") {\n                    this.typeofworkclick = e.items[0].typeOFWork\n                    this.loadSpecificByType(this.typeofworkclick.id)\n                }\n                if(e.field === \"checkIn\"){\n                    let cin = dataRow.checkIn\n                    let cinM = cin.getTime()\n                    this.CIN = cinM\n                }\n                if(e.field === \"checkOut\"){\n                    let cOut = dataRow.checkOut\n                    let cOutM = cOut.getTime()\n                    this.COUT = cOutM\n                }\n                this.hours = parseFloat((this.COUT - this.CIN) / (1000 * 60 * 60));\n                if(this.hours){\n                    dataRow.set('hours',this.hours)\n                }\n                this.autoCalculate()\n            },\n            async loadSpecificByType(id){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        payrollHandler.getSpecificByType(id).then(res => {\n                            if(res.data.statusCode === 200){\n                                this.spesificWork = res.data.data\n                                if(this.spesificWork.length > 0){\n                                    this.mSpesificWork = this.spesificWork[0]\n                                }\n                            }\n                        })\n                    }, 300);\n                })\n            },\n            async loadLocation() {\n                 new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        locationHandler.list().then(res => {\n                            if(res.data.statusCode === 200){\n                                this.location = res.data.data\n                                if(this.location.length > 0){\n                                    this.locationSelected = this.location[0]\n                                }\n                            }\n                        })\n                    }, 300);\n                })\n            },\n            async loadProject() {\n                 new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        projectHandler.list().then(res => {\n                            if(res.data.statusCode === 200){\n                                this.project = res.data.data\n                                if(this.project.length > 0){\n                                    this.mProject  = this.project[0]\n                                }\n                            }\n                        })\n                    }, 300);\n                })\n            },\n            rowNumberTmpl(dataItem) {\n                var ds = this.$refs.dataSource.kendoWidget(),\n                    index = ds.indexOf(dataItem);\n                return index + 1;\n            },\n            addRow() {\n                let ds = this.$refs.dataSource.kendoWidget(),\n                    total = ds.total();\n                ds.insert(total, {\n                    date: new Date(),\n                    hours: 0,\n                    overTimeType: {\n                        id: 'none', \n                        name: 'None'\n                    },\n                    checkIn: new Date(),\n                    checkOut: new Date(),\n                    typeOFWork: this.mTypeOFWork,\n                    specificWork: this.mSpesificWork,\n                    engagement_project: {\n                        name: ''\n                    },\n                    description: '',\n                });\n            },\n            removeRow(e) {\n                e.preventDefault();\n                const grid = kendo.jQuery(\"#gridTimesheetList\").data(\"kendoGrid\"),\n                    dataSource = grid.dataSource,\n                    dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n                if (dataSource.total() > 1) {\n                    dataSource.remove(dataItem);\n                }\n            },\n            async loadTypeOfWork() {\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        payrollHandler.getTypeOfWork().then(res => {\n                            if(res.statusCode === 200){\n                                this.typeOFWork = res.data\n                                if(this.typeOFWork.length > 0){\n                                    let resultType = this.typeOFWork.filter(word => word.name ==\"Administration\")\n                                    this.mTypeOFWork = resultType[0]\n                                    window.console.log(this.mTypeOFWork)\n                                    this.loadSpecificByType(this.mTypeOFWork.id)\n                                    this.initData()\n                                }\n                            }\n                        })\n                    }, 300);\n                })\n            },\n            overTimeDropDownEditor(container, options){\n                kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 400,\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                       data: this.overTimeType,\n                    })\n                })\n            },\n            typeOfWordDropDownEditor(container, options) {\n                kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 400,\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.typeOFWork,\n                    })\n                })\n            },\n            spesificDropDownEditor(container, options) {\n                kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 400,\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                       data: this.spesificWork,\n                    })\n                })\n            },\n            projectDropDownEditor(container, options){\n                kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    dataTextField: \"name\",\n                    dataValueField: \"name\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                       data: this.project,\n                    })\n                })\n            },\n            calculateOvertime(){\n                let ds = this.$refs.dataSource.kendoWidget()\n                let timesheetData = ds.data()\n                let leave = {id: ''}\n                let timesheet_list = timesheetData.map(item => {\n                    leave      = item.specificWork.leave ? item.specificWork.leave: {id: ''}\n                    return {\n                        date:                 item.date ? item.date: ``,\n                        dateFormate:          kendo.toString(new Date(item.date),'yyyy-MM-dd'),\n                        hours:                item.hours ? item.hours: 0,\n                        checkIn:              item.checkIn ? item.checkIn: ``,\n                        checkOut:             item.checkOut ? item.checkOut: '',\n                        leaveId:              leave.id ? leave.id: '',\n                        overTimeType:         item.overTimeType ? item.overTimeType: {id: 'none', name: 'N/A'},\n                        nature:               item.specificWork.nature ? item.specificWork.nature: {},\n                        typeOFWork:           item.typeOFWork ? item.typeOFWork: {name: ''},\n                        specificWork:         item.specificWork ?item.specificWork: {name: ''},\n                        engagement_project:   item.engagement_project ? item.engagement_project: {name: ''},\n                        description:          item.description ? item.description: ``\n                    }\n                });\n                \n                let overTime_weekend            = 0\n                let overTime_national_holiday   = 0\n                let overTime_night              = 0\n                let working_hours               = 0\n                let total_unpaid                = 0\n                timesheet_list.forEach(k =>{\n                    if(k.overTimeType.id == 'weekend'){\n                        overTime_weekend += k.hours\n                    }else if(k.overTimeType.id == 'national_holiday'){\n                        overTime_national_holiday += k.hours\n                    }else if(k.overTimeType.id == 'night'){\n                        overTime_night += k.hours\n                    }else if(k.overTimeType.id == 'none' &&k.typeOFWork.name !='General' && k.typeOFWork.name != 'National Holiday/ Weekend'){\n                        working_hours += k.hours\n                    }\n                    if(k.nature.id == 'unpaid_hours'){\n                        total_unpaid    += k.hours\n                    }\n                })\n                let totalOverTime =            parseFloat(overTime_weekend) + parseFloat(overTime_national_holiday) + parseFloat(overTime_night);\n                this.overTime = {\n                    overTimeWeekend:            parseFloat(overTime_weekend),\n                    overTimeNationalHoliday:    parseFloat(overTime_national_holiday),\n                    overTimeNight:              parseFloat(overTime_night),\n                    totalOverTime:              totalOverTime,\n                    totalUnpaid:                parseFloat(total_unpaid),\n                    workingHours:               parseFloat(working_hours),\n                    totalWorkinghours:          parseFloat(working_hours) + parseFloat(totalOverTime),\n                    defaultWorkingHours:        parseFloat(this.period.hourPerDay) * parseFloat(this.period.workingDay),\n                }\n                window.console.log('overTime',this.overTime)\n            },\n            onSaveClose(){\n                this.calculateOvertime()\n                this.showLoading = true\n                let ds = this.$refs.dataSource.kendoWidget()\n                let timesheetData = ds.data()\n                let leave = {id: ''}\n                let timesheet_list = timesheetData.map(item => {\n                    leave      = item.specificWork.leave ? item.specificWork.leave: {id: ''}\n                    return {                 \n                        date:                 item.date ? item.date: ``,\n                        dateFormate:          kendo.toString(new Date(item.date),'yyyy-MM-dd'),\n                        hours:                item.hours ? item.hours: 0,\n                        checkIn:              item.checkIn ? item.checkIn: ``,\n                        checkOut:             item.checkOut ? item.checkOut: '',\n                        leaveId:              leave.id ? leave.id: '',\n                        typeOFWork:           item.typeOFWork ? item.typeOFWork: {name: ''},\n                        specificWork:         item.specificWork ?item.specificWork: {name: ''},\n                        overTimeType:         item.overTimeType ? item.overTimeType: {id: 'none', name: 'N/A'},\n                        engagement_project:   item.engagement_project ? item.engagement_project: {name: ''},\n                        description:          item.description ? item.description: ``\n                    }\n                });\n                let helper = {};\n                let results = timesheet_list.reduce(function(r, o) {\n                let key = o.dateFormate + o.leaveId; \n                if(!helper[key]) {\n                    helper[key] = Object.assign({}, o); // create a copy of o\n                    r.push(helper[key]);\n                } else {\n                    helper[key].hours             += o.hours;\n                }\n                return r;\n                }, []);\n                let results_timesheet = []\n                let leaves = this.leaves\n                results.forEach(index=>{\n                    let leave  = leaves.filter(i=>i.id === index.leaveId)\n                    window.console.log(1,index)\n                    results_timesheet.push({\n                        specificWork:       index.specificWork,\n                        hours:              index.hours,\n                        typeOFWork:         index.typeOFWork,\n                        dateFormate:        index.dateFormate,\n                        employeeUuid:       index.employeeUuid,\n                        leaveId:            index.leaveId,\n                        description:        index.description,\n                        leave:              leave[0] || {},\n                        engagement_project: index.engagement_project || {},\n                        type:               index.type\n\n                    })\n                })\n\n                if(timesheet_list.length > 0){\n                    let totalHN                  = this.totaleHoursByNature;\n                    this.paid_hours              = totalHN.paid_hours? totalHN.paid_hours: 0;\n                    this.unpaid_hours            = totalHN.unpaid_hours? totalHN.unpaid_hours: 0;\n                    this.overtime_hours_weekend  = totalHN.overtime_hours_weekend? totalHN.overtime_hours_weekend:0;\n                    this.overtime_hours_holiday  = totalHN.overtime_hours_holiday? totalHN.overtime_hours_holiday: 0;\n                    new Promise(resolve => {\n                        setTimeout(() => {\n                            resolve('resolved');\n                            let data = {\n                                id:                       this.timesheet.id || '',\n                                employee:                   {\n                                    id:                     this.employee.id,\n                                    employeeId:             this.employee.employeeId,\n                                    lastName:               this.employee.lastName,\n                                    firstName:              this.employee.firstName,\n                                    gender:                 this.employee.gender,\n                                    bank:                   {\n                                        id:                 this.employee.bank.id,\n                                        bankName:           this.employee.bank.bankName,\n                                        uuid:               this.employee.bank.uuid,\n                                    },\n                                    spouseGender:           this.employee.spouseGender,\n                                    natureEmployee:         this.employee.natureEmployee,\n                                    noOfChildren:           this.employee.noOfChildren,\n                                    bankAccount:            this.employee.bankAccount,\n                                    paymentMethod:          this.employee.paymentMethod,\n                                    spouseNatureEmployee:   this.employee.spouseNatureEmployee,\n                                    payrollLiabilitie:      {\n                                        uuid:               this.employee.payrollLiabilitie.uuid,\n                                        local_name:         this.employee.payrollLiabilitie.local_name,\n                                        type_code:          this.employee.payrollLiabilitie.type_code,\n                                        name:               this.employee.payrollLiabilitie.name,\n                                        number:             this.employee.payrollLiabilitie.number\n                                    },\n                                    salaryAcc:              {\n                                        uuid:               this.employee.payrollLiabilitie.uuid,\n                                        local_name:         this.employee.payrollLiabilitie.local_name,\n                                        type_code:          this.employee.payrollLiabilitie.type_code,\n                                        name:               this.employee.payrollLiabilitie.name,\n                                        number:             this.employee.payrollLiabilitie.number\n                                    }\n                                },\n                                monthOf:                  kendo.toString(new Date(this.monthOf),'yyyy-MM-dd'),\n                                location:                 this.locationSelected,\n                                timeSheetRecord:          timesheet_list,\n                                results_timesheet:        results_timesheet,\n                                totalHours:               this.totalHours,\n                                totalHoursBytype:         this.totaleHoursByNature,\n                                paidHours:                this.paid_hours,\n                                unpaidHours:              this.unpaid_hours,\n                                period:                   this.period,\n                                overTime:                 this.overTime,\n                                overtimeHoursWeekend:     this.overTime.overTimeWeekend,\n                                overtimeHoursHoliday:     this.overTime.overTimeNationalHoliday,\n                                overTimeNight:            this.overTime.overTimeNight,\n                                totalOverTime:            this.overTime.totalOverTime,\n                                totalUnpaid:              this.overTime.totalUnpaid,\n                                totalWorkinghours:        this.overTime.totalWorkinghours,\n                                defaultWorkingHours:      this.overTime.defaultWorkingHours,\n                                loggedUser:               this.loggedUser\n                            }\n                            window.console.log(1,data)\n                            this.showLoading = true\n                            employeeHandler.createTimesheet(data).then(response => {\n                                this.showLoading = true\n                                if (response.data.statusCode === 201) {\n                                    this.$snotify.success('Success')\n                                    this.cancel()\n                                    this.showLoading = false\n                                }\n                            }).catch(e => {\n                                this.$snotify.error('Something went wrong')\n                                this.errors.push(e)\n                            })\n                        }, 300);\n                    })\n                }else {\n                    this.$snotify.error('Data not found')\n                }\n            },\n            cancel(){\n                this.timesheetList = ''\n                this.monthOf = kendo.toString(new Date(),'yyyy-MM-dd')\n                this.close()\n            },\n            close(){\n                window.history.go(-1)\n            },\n            async initData() {\n                if (this.$route.params.timesheet_id !== undefined) {\n                    await this.loadTimesheetSingle()\n                }else {\n                    let ds = this.$refs.dataSource.kendoWidget()\n                    ds.data([])\n                    this.addRow()\n                }\n            },\n            async loadSingleEmployee() {\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        this.showLoading = true\n                        employeeHandler.get(this.$route.params.id).then(res => {\n                            this.showLoading = true\n                            if (res.data.statusCode === 200) {\n                                this.employee = res.data.data[0]\n                                if(this.employee){\n                                    this.showLoading = false\n                                    this.name = this.employee.employeeId +'-'+this.employee.firstName + ' ' + this.employee.lastName \n                                    let month_of = this.monthOf ? this.monthOf: new Date() \n                                    this.monthOf = kendo.toString(new Date(month_of),'yyyy-MM')\n                                    this.showLoading = false   \n                                }\n                                this.loadTypeOfWork()\n                            }\n                        })\n                    }, 300);\n                })\n            },\n            loadTimesheetSingle(){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        this.showLoading = true\n                        employeeHandler.getTimesheetSingle(this.$route.params.timesheet_id).then(res => {\n                            this.showLoading = true\n                            this.timesheetDS = res.data[0]\n                            if(this.timesheetDS){\n                                this.timesheet       = this.timesheetDS\n                                this.locationSelected    = this.timesheetDS.location \n                                this.monthOf = this.timesheetDS.monthOf\n                                this.timesheetList = this.timesheetDS.timeSheetRecord\n                            } \n                            let month_of = this.monthOf ? this.monthOf: new Date() \n                            this.monthOf = kendo.toString(new Date(month_of),'yyyy-MM')\n                            this.showLoading = false             \n                        })\n                    }, 300);\n                })\n            },\n            autoCalculate() {\n                let ds = this.$refs.dataSource.kendoWidget(),\n                    specificWorks = [],\n                    totalHours = 0;\n                    ds.data().forEach(value => {\n                        totalHours += kendo.parseFloat(value.hours)\n                        if(value.specificWork){\n                            if (value.specificWork.hasOwnProperty('id')) {\n                                specificWorks.push({\n                                    name: value.specificWork.nature.id,\n                                    hour: value.hours,\n                                    id: value.typeOFWork.id\n                                })\n\n                            }\n                        }\n                    })\n                    this.totalHours  = totalHours\n                    this.autoCalculateSpicificWork(specificWorks)\n            },\n            autoCalculateSpicificWork(works) {\n            // return by a key\n                const groupAll = list => list.reduce((works, item) => {\n                    const totalHours = works[item.name] || 0\n                    return Object.assign({}, works, {[item.name]: totalHours + parseFloat(item.hour)})\n                }, {})\n                this.totaleHoursByNature = groupAll(works)\n            },\n            async loadPeriod(){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        payrollHandler.getPeriiod().then(res => {\n                            this.period = res[0]\n                        })\n                    }, 300);\n                })\n            },\n            async loadLeave(){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        payrollHandler.getLeave().then(res => {\n                            if(res.statusCode === 200){\n                                this.leaves = res.data\n                            }\n                        })\n                    }, 300);\n                })\n            },\n        },\n        mounted: async function () {\n            await this.loadLocation()\n            await this.loadSingleEmployee()\n            await this.loadProject()\n            await this.loadPeriod()\n            await this.loadLeave()\n        },\n        watch: {\n            '$route': 'loadSingleEmployee'\n        }\n    }\n\n</script>\n<style scoped>\n    .small_sidebar {\n        height: 97%;\n        position: relative;\n        padding: 12px;\n    }\n    .hide_small_bar_class {\n        max-width: 0;\n        transition: .5s ease-in;\n        flex: 0 0 0;\n        padding: 0;\n    }\n\n    .hide_big_bar_class {\n        max-width: 100%;\n        transition: .5s ease-in;\n        flex: 0 0 100%;\n    }\n    .iconArrow {\n        right: -35px;\n        position: absolute;\n        bottom: -10px;\n    }\n    .iconArrowHide {\n        position: absolute;\n        right: -7px;\n        bottom: -10px;\n    }\n    .theme--light.v-data-table > .v-data-table__wrapper > table > tbody > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper){\n        background-color: transparent !important;\n    }\n    .detial_smallside_p{\n        position: absolute;\n        bottom: 10px;\n    }   \n    .k-scrollbar .k-scrollbar-vertical .k-grid-header{\n        width: 0px!important;\n        padding-right: 16px!important;\n        \n    }\n</style>"]}]}