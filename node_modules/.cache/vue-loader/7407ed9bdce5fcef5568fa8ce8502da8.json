{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/customers/sales/sale_channels/app_connetion/app_connect/Settings.vue?vue&type=style&index=0&id=4d87ca38&scoped=true&lang=css&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/customers/sales/sale_channels/app_connetion/app_connect/Settings.vue","mtime":1642390528860},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5ncmF5QmcgewogIGJhY2tncm91bmQtY29sb3I6ICNmOGY4Zjk7Cn0KCi5teV90YWJsZV9kYXJrdgogIC50aGVtZS0tbGlnaHQudi1kYXRhLXRhYmxlCiAgPiAudi1kYXRhLXRhYmxlX193cmFwcGVyCiAgPiB0YWJsZQogID4gdGhlYWQKICA+IHRyCiAgPiB0aCB7CiAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC42KTsKICBiYWNrZ3JvdW5kOiAjMjIyYTM1OwogIGNvbG9yOiAjZmZmICFpbXBvcnRhbnQ7Cn0KCi5wcml2YWN5IHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgYm90dG9tOiAyMHB4OwogIGxlZnQ6IDclOwogIHdpZHRoOiAxMDAlOwp9Cgoudi1zbGlkZS1ncm91cF9fd3JhcHBlciB7CiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYigxODIsIDE4MSwgMTgxKSAhaW1wb3J0YW50Owp9CgoudGhlbWUtLWxpZ2h0LnYtdGFicyA+IC52LXRhYnMtYmFyIHsKICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2RkZCAhaW1wb3J0YW50Owp9Cgoudi10YWItLWFjdGl2ZSB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2U1ZWZmYTsKICBjb2xvcjogIzAwMDsKfQoKLnRoZW1lLS1saWdodC52LXRhYnMgPj4+IC52LXRhYnMtYmFyIHsKICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2RkZCAhaW1wb3J0YW50Owp9Cg=="},{"version":3,"sources":["Settings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAo2BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Settings.vue","sourceRoot":"src/views/customers/sales/sale_channels/app_connetion/app_connect","sourcesContent":["<template>\n  <v-row>\n    <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n      <h1 class=\"primary--text niradie_heavy\">{{ $t(types) }}</h1>\n    </v-col>\n    <v-col cols=\"12\" class=\"mt-1\">\n      <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\n        <v-row style=\"background-color: #fff\">\n          <v-col sm=\"4\" cols=\"12\" class=\"pt-4 pb-0 px-4\">\n            <label>{{ $t(\"customer_type\") }}</label>\n            <v-select\n              :items=\"customerTypes\"\n              item-value=\"id\"\n              item-text=\"name\"\n              class=\"mt-1\"\n              v-model=\"mCustomerType\"\n              @change=\"changeCustomerTyep\"\n              return-object\n              :placeholder=\"$t('type')\"\n              :rules=\"[(v) => !!v || $t('is_required')]\"\n              clearable\n              outlined\n            />\n          </v-col>\n          <v-col sm=\"4\" cols=\"12\" class=\"pt-4 pb-0 px-4\">\n            <label>{{ $t(\"segment\") }}</label>\n            <app-segment-dropdownlist\n              :initSegment=\"segment\"\n              @emitSegment=\"segment = $event\"\n            />\n          </v-col>\n          <v-col sm=\"4\" cols=\"12\" class=\"pt-4 pb-0 px-4\">\n            <label class=\"label mb-0\">{{ $t(\"term\") }}</label>\n            <v-select\n              class=\"mt-1\"\n              v-model=\"paymentTerm\"\n              :items=\"paymentTerms\"\n              placeholder=\"Term\"\n              :rules=\"[(v) => !!v['id'] || $t('is required!')]\"\n              item-text=\"name\"\n              item-value=\"id\"\n              return-object\n              outlined\n            />\n          </v-col>\n          <v-col sm=\"4\" cols=\"12\" class=\"pt-0 pb-0 px-4\">\n            <label class=\"label font_14\">{{ $t(\"sale_channel\") }}</label>\n            <v-select\n              class=\"mt-1\"\n              v-model=\"saleChannel\"\n              :items=\"saleChannelList\"\n              item-value=\"id\"\n              item-text=\"name\"\n              return-object\n              :rules=\"[(v) => !!v || $t('is_required')]\"\n              tage=\"Sale Channel\"\n              placeholder=\"Channel\"\n              outlined\n            />\n          </v-col>\n          <!-- <v-col sm=\"4\" cols=\"12\" class=\"pt-0 pb-0 px-4\">\n\n                              </v-col> -->\n          <v-col sm=\"12\" cols=\"12\" class=\"pt-0 pb-0 px-4\">\n            <h2 class=\"font_18\">{{ $t(\"items\") }}</h2>\n            <kendo-datasource\n              ref=\"itemLineDSAppConnect\"\n              :data=\"itemLines\"\n              @change=\"dataSourceChangedApp\"\n            />\n            <kendo-grid\n              id=\"itemLineDSAppConnect\"\n              class=\"grid-function\"\n              :data-source-ref=\"'itemLineDSAppConnect'\"\n              :sortable=\"false\"\n              :column-menu=\"false\"\n              :editable=\"true\"\n              :scrollable-virtual=\"true\"\n            >\n              <kendo-grid-column\n                :command=\"{\n                  iconClass: 'k-icon k-i-trash',\n                  text: ' ',\n                  click: removeRow,\n                  className: 'btn-plus isEditable',\n                }\"\n                :title=\"''\"\n                :width=\"36\"\n                :headerAttributes=\"{\n                  style: 'text-align: left; background-color: #EDF1F5',\n                }\"\n              />\n              <kendo-grid-column\n                :title=\"$t('no.')\"\n                :width=\"40\"\n                :column-menu=\"false\"\n                :template=\"rowNumberTmpl\"\n                :headerAttributes=\"{\n                  style: 'background-color: #EDF1F5;',\n                  class: 'text-products',\n                }\"\n                :attributes=\"{ style: 'text-align: products' }\"\n              />\n\n              <kendo-grid-column\n                :field=\"'item'\"\n                :title=\"$t('banhji_item')\"\n                :template=\"itemTemplate\"\n                :editor=\"ItemDropDownEditor\"\n                :attributes=\"{ class: 'tb_name_td isEditable' }\"\n                :editable=\"isDisableUpdate\"\n                :width=\"200\"\n                :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n              />\n              <kendo-grid-column\n                :field=\"'uom'\"\n                :title=\"$t('uom')\"\n                :width=\"120\"\n                :template=\"UOMTemplate\"\n                :editor=\"UOMDropDownEditor\"\n                :headerAttributes=\"{\n                  style: 'text-align: left; background-color: #EDF1F5',\n                }\"\n                :attributes=\"{ style: 'text-align: left' }\"\n              />\n              <kendo-grid-column\n                :field=\"'itemPartner'\"\n                :title=\"$t('partner_item')\"\n                :template=\"itemTemplatePartner\"\n                :editor=\"ItemDropDownEditorConnector\"\n                :editable=\"isDisableUpdate\"\n                :attributes=\"{ class: 'tb_name_td isEditable' }\"\n                :width=\"200\"\n                :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n              />\n            </kendo-grid>\n            <v-btn color=\"primary\" class=\"btn_plus my-2 mr-2\" @click=\"addRow\">\n              <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n            </v-btn>\n            <div>\n              <h2 class=\"font_18 mt-3\">{{ $t(\"location\") }}</h2>\n            </div>\n            <kendo-datasource\n              ref=\"itemLineDSAppConnectLocation\"\n              :data=\"itemLinesLocation\"\n              @change=\"dataSourceChangedApp\"\n            />\n            <kendo-grid\n              id=\"itemLineDSAppConnectLocation\"\n              class=\"grid-function\"\n              :data-source-ref=\"'itemLineDSAppConnectLocation'\"\n              :sortable=\"false\"\n              :column-menu=\"false\"\n              :editable=\"true\"\n              :scrollable-virtual=\"true\"\n            >\n              <kendo-grid-column\n                :command=\"{\n                  iconClass: 'k-icon k-i-trash',\n                  text: ' ',\n                  click: removeRowLocation,\n                  className: 'btn-plus isEditable',\n                }\"\n                :title=\"''\"\n                :width=\"35\"\n                :headerAttributes=\"{\n                  style: 'text-align: left; background-color: #EDF1F5',\n                }\"\n              />\n              <kendo-grid-column\n                :title=\"$t('no.')\"\n                :width=\"40\"\n                :column-menu=\"false\"\n                :template=\"rowNumberTmplLocation\"\n                :headerAttributes=\"{\n                  style: 'background-color: #EDF1F5;',\n                  class: 'text-products',\n                }\"\n                :attributes=\"{ style: 'text-align: products' }\"\n              />\n\n              <kendo-grid-column\n                :field=\"'location'\"\n                :title=\"$t('banhji_business_unit')\"\n                :editable=\"isEditableLocation\"\n                :template=\"itemTemplateLocation\"\n                :editor=\"ItemDropDownEditorLocation\"\n                :attributes=\"{ class: 'tb_name_td isEditable' }\"\n                :width=\"200\"\n                :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n              />\n              <kendo-grid-column\n                :field=\"'locationPartner'\"\n                :title=\"$t('partner_business_unit')\"\n                :template=\"LocationTemplatePartner\"\n                :editor=\"ItemDropDownEditorDepartment\"\n                :editable=\"isEditableLocation\"\n                :attributes=\"{ class: 'tb_name_td isEditable' }\"\n                :width=\"200\"\n                :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n              />\n            </kendo-grid>\n            <v-btn\n              color=\"primary\"\n              class=\"float-left btn_plus my-2 mr-2\"\n              @click=\"addRow2\"\n            >\n              <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n            </v-btn>\n          </v-col>\n\n          <v-col sm=\"12\" cols=\"12\" class=\"pt-2\">\n            <v-btn\n              color=\"primary\"\n              class=\"float-right ml-0 mr-2\"\n              @click=\"saveClose\"\n            >\n              {{ $t(\"save_close\") }}\n            </v-btn>\n          </v-col>\n        </v-row>\n      </v-form>\n      <p class=\"text-center privacy mb-0 mt-10\">\n        <v-icon size=\"13\" class=\"third--text mr-2 black--text\">mdi-key</v-icon>\n        {{ $t(\"at_banhJi_the_privacy\") }}\n      </p>\n    </v-col>\n    <LoadingMe\n      :isLoading=\"showLoading\"\n      :fullPage=\"false\"\n      :myLoading=\"true\"\n      type=\"loading\"\n    />\n  </v-row>\n</template>\n<script>\nimport uomPriceHandler from \"@/scripts/uomPriceHandler\";\n\nconst appConnectionHandle = require(\"@/scripts/app-connection/handler/appConnectionHandle\");\n// const axios = require(\"axios\");\nconst productVariantHandler = require(\"@/scripts/productVariantHandler\");\nimport ItemLine from \"@/scripts/app-connection/model/ItemLine\";\nimport ItemLineLocation from \"@/scripts/app-connection/model/ItemLineLocation\";\n\nconst itemLineModel = new ItemLine({});\nconst ItemLineLocationModel = new ItemLineLocation({});\n// import {uuid} from \"vue-uuid\";\nimport kendo from \"@progress/kendo-ui\";\nimport { SegmentModel } from \"@/scripts/model/AppModels\";\n\n// const priceLevelHandler = require(\"@/scripts/priceLevelHandler\");\nconst customerTypeHandler = require(\"@/scripts/customerTypeHandler\");\nconst saleChannelHandler = require(\"@/scripts/saleChannelHandler\");\nconst paymentTermHandler = require(\"@/scripts/settingsHandler\");\nconst locationHandler = require(\"@/scripts/locationHandler\");\nimport { i18n } from \"@/i18n\";\n// import {mapState} from \"vuex\";\n\nconst $ = kendo.jQuery;\n\nexport default {\n  props: [\"authorize\", \"types\"],\n  data: () => ({\n    showLoading: false,\n    itemLine: itemLineModel,\n    itemLines: [],\n    itemLineLocation: ItemLineLocationModel,\n    itemLinesLocation: [],\n    priceLevel: {},\n    partnerItem: [],\n    customerTypes: [],\n    mCustomerType: \"\",\n    locations: [],\n    segment: new SegmentModel(),\n    saleChannel: \"\",\n    saleChannelList: [],\n    valid: true,\n    isSuccess: false,\n    paymentTerm: {},\n    paymentTerms: [],\n    departments: [],\n    transactionDate: new Date().toJSON(),\n    id: \"\",\n  }),\n  components: {\n    LoadingMe: () => import(`@/components/Loading`),\n    \"app-segment-dropdownlist\": () =>\n      import(\"@/components/dropdownlist/Segment\"),\n  },\n  methods: {\n    changeCustomerTyep() {\n      this.priceLevel = this.mCustomerType.priceLevel;\n    },\n    findDuplicates(values) {\n      var valueArr = values.map(function (item) {\n        return item.item.name;\n      });\n      var isDuplicate = valueArr.some(function (item, idx) {\n        return valueArr.indexOf(item) != idx;\n      });\n      return isDuplicate;\n    },\n    findDuplicatesParter(values) {\n      var valueArr = values.map(function (item) {\n        return item.itemPartner.name_en;\n      });\n      var isDuplicate = valueArr.some(function (item, idx) {\n        return valueArr.indexOf(item) != idx;\n      });\n      return isDuplicate;\n    },\n    findDuplicatesLocation(values) {\n      var valueArr = values.map(function (item) {\n        return item.location.name;\n      });\n      var isDuplicate = valueArr.some(function (item, idx) {\n        return valueArr.indexOf(item) != idx;\n      });\n      return isDuplicate;\n    },\n    findDuplicatesLocationPartner(values) {\n      var valueArr = values.map(function (item) {\n        return item.locationPartner.name_en;\n      });\n      var isDuplicate = valueArr.some(function (item, idx) {\n        return valueArr.indexOf(item) != idx;\n      });\n      return isDuplicate;\n    },\n    saveClose() {\n      if (!this.$refs.form.validate()) {\n        this.$refs.form.validate();\n        return;\n      }\n      let data = {};\n      let ds = this.$refs.itemLineDSAppConnect.kendoWidget();\n      let dsLocation = this.$refs.itemLineDSAppConnectLocation.kendoWidget();\n      let itemLines = [];\n      ds.data().forEach((i) => {\n        if (i.isAddNew) {\n          itemLines.push({\n            item: i.item || {},\n            uom: i.uom || {},\n            itemPartner: i.itemPartner || {},\n          });\n        }\n      });\n      data.itemLines = itemLines;\n      data.type = this.types;\n      data.authorize = this.authorize;\n      data.priceLevel = this.priceLevel;\n      data.mCustomerType = this.mCustomerType;\n      data.location = this.location;\n      data.segment = this.segment;\n      data.saleChannel = this.saleChannel;\n      data.paymentTerm = this.paymentTerm;\n      let locationItemLine = [];\n      dsLocation.data().forEach((i) => {\n        if (i.isAddNew) {\n          locationItemLine.push({\n            location: i.location,\n            locationPartner: i.locationPartner,\n          });\n        }\n      });\n\n      data.itemLinesLocation = locationItemLine;\n      let findDup = this.findDuplicates(itemLines);\n      let findDupPartern = this.findDuplicatesParter(itemLines);\n      let findDupLocation = this.findDuplicatesLocation(locationItemLine);\n      let findDupLocationPartner =\n        this.findDuplicatesLocationPartner(locationItemLine);\n      if (\n        findDup ||\n        findDupPartern ||\n        findDupLocation ||\n        findDupLocationPartner\n      ) {\n        this.$swal({\n          title: i18n.t(\"failed\"),\n          text: i18n.t(\"duplicates_item\"),\n          icon: \"warning\",\n          showCancelButton: false,\n          confirmButtonColor: \"#4d4848\",\n          cancelButtonColor: \"#ED1A3A\",\n          confirmButtonText: i18n.t(\"ok\"),\n        });\n        return;\n      }\n      window.console.log(\"data\",data);\n      appConnectionHandle.add(data).then((res) => {\n        if (res.msg === \"successful\") {\n          this.$swal({\n            title: i18n.t(\"successful\"),\n            text: i18n.t(\"data_record\"),\n            icon: \"success\",\n            showCancelButton: true,\n            confirmButtonColor: \"#4d4848\",\n            cancelButtonColor: \"#ED1A3A\",\n            confirmButtonText: i18n.t(\"ok\"),\n          }).then((result) => {\n            if (result.value) {\n              this.$router.go(-1);\n            }\n          });\n          this.$emit(\"finish\");\n        } else {\n          this.$swal({\n            title: i18n.t(\"failed\"),\n            text: i18n.t(\"sth_went_wrong_check_your\"),\n            icon: \"warning\",\n            showCancelButton: false,\n            confirmButtonColor: \"#4d4848\",\n            cancelButtonColor: \"#ED1A3A\",\n            confirmButtonText: i18n.t(\"ok\"),\n          });\n          this.isSuccess = false;\n        }\n      });\n    },\n    async dataSourceChangedApp() {},\n    rowNumberTmpl(dataItem) {\n      let ds = this.$refs.itemLineDSAppConnect.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    rowNumberTmplLocation(dataItem) {\n      let ds = this.$refs.itemLineDSAppConnectLocation.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    addRow() {\n      let ds = this.$refs.itemLineDSAppConnect.kendoWidget();\n      let total = ds.total();\n      this.itemLine.isAddNew = true;\n      if (total < 36) {\n        ds.insert(total, this.itemLine);\n      }\n    },\n    addRow2() {\n      let dsL = this.$refs.itemLineDSAppConnectLocation.kendoWidget();\n      let totaldsL = dsL.total();\n      this.itemLineLocation.isAddNew = true;\n      if (totaldsL < 36) {\n        dsL.insert(totaldsL, this.itemLineLocation);\n      }\n    },\n    removeRow(e) {\n      e.preventDefault();\n      const grid = kendo.jQuery(\"#itemLineDSAppConnect\").data(\"kendoGrid\");\n      const dataSource = grid.dataSource;\n      const dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n      if (!dataItem.isAddNew) {\n        this.$swal({\n          title: i18n.t(\"warning\"),\n          text: i18n.t(\"do_you_delete\"),\n          icon: \"warning\",\n          showCancelButton: true,\n          confirmButtonColor: \"#4d4848\",\n          cancelButtonColor: \"#ED1A3A\",\n          confirmButtonText: i18n.t(\"ok\"),\n        }).then((result) => {\n          if (result.value) {\n            let data_delete = {\n              id: dataItem.itemPartner.id,\n            };\n            appConnectionHandle.deletItem(data_delete).then((res) => {\n              if (res.status === 200) {\n                this.$snotify.success(i18n.t(\"successful\"));\n              } else {\n                this.$snotify.error(i18n.t(\"error_something_wrong\"));\n              }\n            });\n            dataSource.remove(dataItem);\n          }\n        });\n      } else {\n        if (dataSource.total() > 1) {\n          dataSource.remove(dataItem);\n        }\n      }\n    },\n    removeRowLocation(e) {\n      e.preventDefault();\n      const grid = kendo\n        .jQuery(\"#itemLineDSAppConnectLocation\")\n        .data(\"kendoGrid\");\n      let dataSource = grid.dataSource;\n      let dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n      window.console.log(dataItem);\n      if (!dataItem.isAddNew) {\n        this.$swal({\n          title: i18n.t(\"warning\"),\n          text: i18n.t(\"do_you_delete\"),\n          icon: \"warning\",\n          showCancelButton: true,\n          confirmButtonColor: \"#4d4848\",\n          cancelButtonColor: \"#ED1A3A\",\n          confirmButtonText: i18n.t(\"ok\"),\n        }).then((result) => {\n          if (result.value) {\n            let data_delete = {\n              id: dataItem.locationPartner.id,\n            };\n            appConnectionHandle.deletLocation(data_delete).then((res) => {\n              if (res.status === 200) {\n                this.$snotify.success(i18n.t(\"successful\"));\n              } else {\n                this.$snotify.error(i18n.t(\"error_something_wrong\"));\n              }\n            });\n            dataSource.remove(dataItem);\n          }\n        });\n      } else {\n        if (dataSource.total() > 1) {\n          dataSource.remove(dataItem);\n        }\n      }\n    },\n    itemTemplate(dataItem) {\n      const item = dataItem.item;\n      if (item) {\n        return `<span>${item.name ? item.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    isDisableUpdate(dataItem) {\n      if (dataItem.isAddNew) {\n        return true;\n      }\n      return false;\n    },\n    isEditableLocation(dataItem) {\n      if (dataItem.isAddNew) {\n        return true;\n      }\n      return false;\n    },\n    itemTemplateLocation(dataItem) {\n      const item = dataItem.location;\n      if (item) {\n        return `<span>${item.name ? item.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    itemTemplatePartner(dataItem) {\n      const item = dataItem.itemPartner;\n      if (item) {\n        return `<span>${item.name_en ? item.name_en : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    LocationTemplatePartner(dataItem) {\n      const item = dataItem.locationPartner;\n      if (item) {\n        return `<span>${\n          item.name_en ? item.name + \"-\" + item.name_en : ``\n        }</span>`;\n      } else {\n        return ``;\n      }\n    },\n    async loadPaymentTerm() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          const strFilter = \"?type=pmt-customer\";\n          paymentTermHandler.getPaymentTerm(strFilter).then((res) => {\n            if (res.data.statusCode === 200) {\n              this.paymentTerms = res.data.data;\n            }\n          });\n        }, 10);\n      });\n    },\n    async loadCustomerType() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          customerTypeHandler.get().then((res) => {\n            this.customerTypes = res;\n          });\n        }, 100);\n      });\n    },\n    ItemDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"contains\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          headerTemplate:\n            '<div class=\"dropdown-header k-widget k-header\">' +\n            \"<span>Items </span>\" +\n            \"<span></span>\" +\n            \"</div>\",\n          template: \"<span>#=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: productVariantHandler.itemSearchURL(\n                  \"?plId=\" + this.priceLevel.id\n                ),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  name: { type: \"string\" },\n                  sku: { type: \"string\" },\n                },\n              },\n              data: function (response) {\n                return response.data;\n              },\n              total: function (response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    ItemDropDownEditorConnector(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: false,\n          autoWidth: true,\n          height: 300,\n          filter: \"contains\",\n          dataTextField: \"name_en\",\n          dataValueField: \"id\",\n          optionLabel: \"--- Select ---\",\n          dataSource: this.partnerItem,\n        });\n    },\n    ItemDropDownEditorDepartment(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: false,\n          autoWidth: true,\n          height: 300,\n          filter: \"contains\",\n          dataTextField: \"name_en\",\n          template: \"<span>#= name#-#= name_en#</span>\",\n          dataValueField: \"id\",\n          optionLabel: \"--- Select ---\",\n          dataSource: this.departments,\n        });\n    },\n    ItemDropDownEditorLocation(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: false,\n          autoWidth: true,\n          height: 300,\n          filter: \"contains\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          optionLabel: \"--- Select ---\",\n          dataSource: this.locations,\n        });\n    },\n    async loadLocation() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.locations = [];\n          locationHandler\n            .list()\n            .then((res) => {\n              if (res.data.statusCode === 200) {\n                this.locations = res.data.data;\n              }\n            })\n            .catch();\n        }, 300);\n      });\n    },\n    async loadDepartment() {\n      appConnectionHandle.getDepartment().then((res) => {\n        let department = [];\n        if (res.length > 0) {\n          res.map((i) => {\n            // return {\n            //     id: i.id || '',\n            //     code: i.code || '',\n            //     name: i.name || '',\n            //     name_en: i.name_en || ''\n            // }\n            i.department_structure.map((dp) => {\n              department.push(dp);\n            });\n          });\n          this.departments = department;\n        }\n      });\n    },\n    async getFreeCategory() {\n      appConnectionHandle.get().then((res) => {\n        this.partnerItem = res;\n      });\n    },\n    async setDefaultData() {\n      // Brand New Mode\n      let segments = await this.$store.dispatch(\"segments/getList\");\n      this.segment = new SegmentModel(segments.find((i) => i.isSystem === 1));\n    },\n    async loadSaleChannel() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          saleChannelHandler.get().then((res) => {\n            if (res.data.statusCode === 200) {\n              this.saleChannelList = res.data.data;\n            }\n          });\n        }, 10);\n      });\n    },\n    UOMDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"code\",\n          dataValueField: \"uomConvertId\",\n          cascadeFrom: \"item\",\n          template: \"<span>#= code || `No Price Level`#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: uomPriceHandler.uomPriceByPriceLevelURL(\n                  \"id=\" +\n                    options.model.item.id +\n                    \"&plId=\" +\n                    this.priceLevel.id +\n                    \"&date=\" +\n                    this.transactionDate +\n                    \"&nature=purchase\"\n                ),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  // name: {type: \"string\"},\n                  // sku: {type: \"string\"},\n                },\n              },\n              data: function (response) {\n                return response.data;\n              },\n              total: function (response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    UOMTemplate(dataItem) {\n      const uom = dataItem.uom;\n      const code = uom.code || \"\";\n      if (uom) {\n        return `<span>${uom.uom ? code : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    loadData() {\n      appConnectionHandle.getMatch().then((res) => {\n        window.console.log(\"res data\", res);\n        if (res.data) {\n          let filerLocation = res.data.itemLinesLocation.filter((i) => {\n            i.isAddNew = false;\n            return i;\n          });\n          this.priceLevel = res.data.priceLevel;\n          this.mCustomerType = res.data.mCustomerType;\n          // this.location = res.data.location;\n          this.segment = res.data.segment;\n          this.saleChannel = res.data.saleChannel;\n          this.paymentTerm = res.data.paymentTerm;\n          this.itemLinesLocation = filerLocation;\n          this.itemLines = res.data.itemLines;\n        }\n      });\n    },\n    clear() {\n      this.itemLine = itemLineModel;\n      this.itemLineLocation = ItemLineLocationModel;\n      this.priceLevel = {};\n      this.mCustomerType = \"\";\n      this.segment = new SegmentModel();\n      this.saleChannel = \"\";\n      this.paymentTerm = {};\n      this.itemLinesLocation = [];\n      this.itemLines = [];\n    },\n    laodDefualtData() {\n      this.getFreeCategory();\n      // this.loadPriceLevel();\n      this.loadCustomerType();\n      this.setDefaultData();\n      this.loadSaleChannel();\n      this.loadPaymentTerm();\n      this.loadLocation();\n      this.loadDepartment();\n    },\n  },\n  computed: {\n    realType() {\n      return this.$route.query.type;\n    },\n  },\n  watch: {\n    realType() {\n      if (this.$route.query.type === undefined) {\n        this.clear();\n        this.loadData();\n      } else {\n        this.loadData();\n      }\n    },\n  },\n  mounted() {\n    this.laodDefualtData();\n    if (this.$route.query.type !== undefined) {\n      // this.loadData();\n    } else {\n      this.addRow2();\n      this.addRow();\n    }\n    this.loadData();\n  },\n};\n</script>\n<style scoped>\n.grayBg {\n  background-color: #f8f8f9;\n}\n\n.my_table_darkv\n  .theme--light.v-data-table\n  > .v-data-table__wrapper\n  > table\n  > thead\n  > tr\n  > th {\n  color: rgba(0, 0, 0, 0.6);\n  background: #222a35;\n  color: #fff !important;\n}\n\n.privacy {\n  position: absolute;\n  bottom: 20px;\n  left: 7%;\n  width: 100%;\n}\n\n.v-slide-group__wrapper {\n  border-bottom: 1px solid rgb(182, 181, 181) !important;\n}\n\n.theme--light.v-tabs > .v-tabs-bar {\n  border-bottom: 1px solid #ddd !important;\n}\n\n.v-tab--active {\n  background-color: #e5effa;\n  color: #000;\n}\n\n.theme--light.v-tabs >>> .v-tabs-bar {\n  border-bottom: 1px solid #ddd !important;\n}\n</style>\n\n\n\n\n\n"]}]}