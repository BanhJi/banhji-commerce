{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/payroll/payroll_run/Input.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/payroll/payroll_run/Input.vue","mtime":1638499443262},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBVcGxvYWRFeGNlbENvbXBvbmVudCBmcm9tICdAL2NvbXBvbmVudHMvdXBsb2FkX2V4Y2VsL1RpbWVDYXJkLnZ1ZSc7CmltcG9ydCBrZW5kbyBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdWkiOwppbXBvcnQgVGltZUNhcmRMaW5lIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9UaW1lQ2FyZExpbmUiOwppbXBvcnQgRW1wbG95ZWVNb2RlbCBmcm9tICdAL3NjcmlwdHMvbW9kZWwvRW1wbG95ZWUnCmltcG9ydCBUaW1lQ2FyZCBmcm9tICJAL3NjcmlwdHMvbW9kZWwvVGltZUNhcmQiOwppbXBvcnQgUGF5cm9sbFJ1biBmcm9tICJAL3NjcmlwdHMvbW9kZWwvUGF5cm9sbFJ1biI7CmltcG9ydCBQYXlyb2xsTGlzdCBmcm9tICJAL3NjcmlwdHMvbW9kZWwvUGF5cm9sbExpc3QiCgpjb25zdCBpbnN0aXR1dGVIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2luc3RpdHV0ZUhhbmRsZXIiKQpjb25zdCBjdXJyZW5jeUhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvY3VycmVuY3kvaGFuZGxlci9jdXJyZW5jeUhhbmRsZXIiKQpjb25zdCBheGlvcyAJPSByZXF1aXJlKCdheGlvcycpOwpjb25zdCB0aW1lQ2FyZExpbmVNb2RlbCA9IG5ldyBUaW1lQ2FyZExpbmUoe30pCmNvbnN0IGVtcGxveWVlTW9kZWwgPSBuZXcgRW1wbG95ZWVNb2RlbCh7fSkKY29uc3QgdGltZUNhcmRNb2RlbCA9IG5ldyBUaW1lQ2FyZCh7fSkKY29uc3QgcGF5cm9sbFJ1bk1vZGVsID0gbmV3IFBheXJvbGxSdW4oe30pCmNvbnN0IGVtcGxveWVlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9lbXBsb3llZUhhbmRsZXIiKQpjb25zdCBwYXlyb2xsSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9wYXlyb2xsSGFuZGxlciIpCmNvbnN0IGxvY2F0aW9uSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9sb2NhdGlvbkhhbmRsZXIiKQpjb25zdCBzZXR0aW5nc0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvc2V0dGluZ3NIYW5kbGVyIikKY29uc3QgY3VycmVuY3lUeXBlID0gewogICAgRlVOQ1RJT05BTF9DVVJSRU5DWTogJ2Z1bi1jJywKICAgIFRSQU5TQUNUSU9OX0NVUlJFTkNZOiAndHhuLWMnLAogICAgUkVQT1JUSU5HX0NVUlJFTkNZOiAncnB0LWMnLAogICAgVEFYX0VYQ0hBTkdFX0NVUlJFTkNZOiAndGF4LWMnLAp9CgovKiBDb29raWUgKi8KY29uc3QgY29va2llSlMgPSByZXF1aXJlKCJAL2Nvb2tpZS5qcyIpOwpjb25zdCBjb29raWUgPSBjb29raWVKUy5nZXRDb29raWUoKTsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIHByb3BzOlsncHJvcElucHV0J10sCiAgICBkYXRhOiAoKSA9Pih7CiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgZGlzYWJsZWQ6IHRydWUsCiAgICAgICAgZGlzYWJsZWRMOiBmYWxzZSwKICAgICAgICBkaXNhYmxlZEc6IGZhbHNlLAogICAgICAgIHNob3dMb2FkaW5nOiB0cnVlLAogICAgICAgIGpvdXJuYWxfZGF0ZTogIiIsCiAgICAgICAgZGlhbG9nbTogZmFsc2UsCiAgICAgICAgdGFibGVEYXRhOiBbXSwKICAgICAgICB0YWJsZUhlYWRlcjogW10sCiAgICAgICAgZGF0ZUZvcm1hdDogdGltZUNhcmRMaW5lTW9kZWwuZGF0ZUZvcm1hdCwKICAgICAgICB0aW1lRm9ybWF0OiB0aW1lQ2FyZExpbmVNb2RlbC50aW1lRm9ybWF0LAogICAgICAgIGVtcGxveWVlRGF0YTogW10sCiAgICAgICAgbW9udGhPZjogJycsCiAgICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCksCiAgICAgICAgbG9jYXRpb246IFtdLAogICAgICAgIHNlZ21lbnQ6IFtdLAogICAgICAgIGVtcGxveWVlOiBlbXBsb3llZU1vZGVsLAogICAgICAgIHRpbWVDYXJkOiB0aW1lQ2FyZE1vZGVsLAogICAgICAgIHBheXJvbGxSdW46IHBheXJvbGxSdW5Nb2RlbCwKICAgICAgICBsb2NhdGlvblNlbGVjdGVkOiAnJywKICAgICAgICBzZWdtZW50U2VsZWN0ZWQ6ICcnLAogICAgICAgIHNldENhcmRIZWlnaHQ6IGZhbHNlLAogICAgICAgIG5hdHVyZUlucHV0OlsKICAgICAgICAgICAge25hbWU6ICdUaW1lc2hlZXQnfSwKICAgICAgICAgICAge25hbWU6ICdUaW1lY2FyZCd9LAogICAgICAgICAgICB7bmFtZTogJ0ZpeGVkJ30KICAgICAgICBdLAogICAgICAgIHRpbWVDYXJkTGluZTogW10sCiAgICAgICAgcmVjb3JkTGlzdDogW10sCiAgICAgICAgbmF0dXJlSW5wdXRTZWxlY3RlZDonRml4ZWQnLAogICAgICAgIG51bWJlcjogJycsCiAgICAgICAgcHJlZml4OiAnJywKICAgICAgICBwYXlOdW1iZXI6IHt9LAogICAgICAgIHJlc3VsdDoge30sCiAgICAgICAgZXhjaGFuZ2VSYXRlOiB7fSwKICAgICAgICBidG5FbmFibGVkOiB0cnVlLAogICAgICAgIHNvcnQ6WwogICAgICAgICAgICB7IGZpZWxkOiAnZW1wbG95ZWVJZCcsIGRpcjogJ2FzYycgfQogICAgICAgIF0sCiAgICAgICAgcGVyaW9kOiB7fSwKICAgICAgICBsb2dnZWRVc2VyOiB7CiAgICAgICAgICAgIGlkOiBjb29raWUuY3JlYXRvciwKICAgICAgICAgICAgbmFtZTogY29va2llLmVtYWlsCiAgICAgICAgfSwKICAgICAgICBiYXNlQ3VycmVuY3k6IHt9LAogICAgICAgIGRlcGFydG1lbnRzOiBbXSwKICAgICAgICBkZXBhcnRtZW50OiAiIiwKICAgICAgICBuYXR1cmVDb250cmFjdHM6WwogICAgICAgICAgICB7aWQ6ICJmaXhlZF9kdXJhdGlvbl9jb250cmFjdCIsIG5hbWU6ICJGaXhlZCBEdXJhdGlvbiBDb250cmFjdCJ9LAogICAgICAgICAgICB7aWQ6ICJ1bmRldGVybWluZWRfZHVyYXRpb25fY29udHJhY3QiLCBuYW1lOiAiVW5kZXRlcm1pbmVkIER1cmF0aW9uIENvbnRyYWN0In0sCiAgICAgICAgICAgIHtpZDogImNvbnRyYWN0ZCIsIG5hbWU6ICJDb250cmFjdGVkIn0KICAgICAgICBdLAogICAgICAgIG5hdHVyZUNvbnRyYWN0OiAiIiwKICAgICAgICBlbXBsb3llZUdyb3VwczogW10sCiAgICAgICAgZW1wbG95ZWVHcm91cDogIiIKICAgIH0pLAogICAgY29tcG9uZW50czogewogICAgICAgIExvYWRpbmdNZTogKCkgPT4gaW1wb3J0KGBAL2NvbXBvbmVudHMvTG9hZGluZ2ApLAogICAgICAgICd1cGxvYWQtZXhjZWwtY29tcG9uZW50JzpVcGxvYWRFeGNlbENvbXBvbmVudCwKICAgICAgICAnbW9udGgtcGlja2VyJyA6ICgpPT4gaW1wb3J0KCdAL2NvbXBvbmVudHMvY3VzdG9tX3RlbXBsYXRlcy9Nb250aFBpY2tlcicpLAogICAgICAgICdkYXRlLXBpY2tlcicgOiAoKT0+IGltcG9ydCgnQC9jb21wb25lbnRzL2N1c3RvbV90ZW1wbGF0ZXMvRGF0ZVBpY2tlckNvbXBvbmVudCcpCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIG51bWJlckZvcm1hdCh2YWx1ZSl7CiAgICAgICAgICAgIGxldCByYXRlID0gdmFsdWUucmF0ZQogICAgICAgICAgICByZXR1cm4ga2VuZG8udG9TdHJpbmcoIGtlbmRvLnBhcnNlRmxvYXQoMS9yYXRlKSxgbjBgKQogICAgICAgIH0sCiAgICAgICAgcmV0dXJuRGF0YShkYXRhKXsKICAgICAgICAgICAgdGhpcy4kZW1pdCgncmV0dXJuRGF0YScsIGRhdGEpCiAgICAgICAgfSwKICAgICAgICBDaGFuZ2VOYXR1cmUoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLm5hdHVyZUlucHV0U2VsZWN0ZWQgPT09ICdUaW1lY2FyZCcpIHsKICAgICAgICAgICAgICAgIHRoaXMuYnRuRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuYnRuRW5hYmxlZCA9IHRydWUKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgbW9udGhPZkNoYW5nZSgpewogICAgICAgICAgICB0aGlzLmdlbmVyYXRlTnVtYmVyKCkKICAgICAgICB9LAogICAgICAgIGJlZm9yZVVwbG9hZChmaWxlKSB7CiAgICAgICAgICAgIGNvbnN0IGlzTHQxTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMQogICAgICAgICAgICBpZiAoaXNMdDFNKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogJ1BsZWFzZSBkbyBub3QgdXBsb2FkIGZpbGVzIGxhcmdlciB0aGFuIDFtIGluIHNpemUuJywKICAgICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICAgICAgICB9KQogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9LAogICAgICAgIGhhbmRsZVN1Y2Nlc3MoeyByZXN1bHRzLCBoZWFkZXIgfSkgewogICAgICAgICAgICByZXN1bHRzLmZvckVhY2goZWxlbWVudCA9PiB7CiAgICAgICAgICAgICAgICB2YXIgdXRjX2RheXMgID0gTWF0aC5mbG9vcihlbGVtZW50LmRhdGUgLSAyNTU2OSk7CiAgICAgICAgICAgICAgICB2YXIgdXRjX3ZhbHVlID0gdXRjX2RheXMgKiA4NjQwMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgZGF0ZV9pbmZvID0gbmV3IERhdGUodXRjX3ZhbHVlICogMTAwMCk7CiAgICAgICAgICAgICAgICB2YXIgZnJhY3Rpb25hbF9kYXkgPSBlbGVtZW50LmRhdGUgLSBNYXRoLmZsb29yKGVsZW1lbnQuZGF0ZSkgKyAwLjAwMDAwMDE7CiAgICAgICAgICAgICAgICB2YXIgdG90YWxfc2Vjb25kcyA9IE1hdGguZmxvb3IoODY0MDAgKiBmcmFjdGlvbmFsX2RheSk7CiAgICAgICAgICAgICAgICB2YXIgc2Vjb25kcyA9IHRvdGFsX3NlY29uZHMgJSA2MDsKICAgICAgICAgICAgICAgIHRvdGFsX3NlY29uZHMgLT0gc2Vjb25kczsKICAgICAgICAgICAgICAgIHZhciBob3VycyA9IE1hdGguZmxvb3IodG90YWxfc2Vjb25kcyAvICg2MCAqIDYwKSk7CiAgICAgICAgICAgICAgICB2YXIgbWludXRlcyA9IE1hdGguZmxvb3IodG90YWxfc2Vjb25kcyAvIDYwKSAlIDYwOwogICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRfZGF0ZXRpbWUgPSAgbmV3IERhdGUoZGF0ZV9pbmZvLmdldEZ1bGxZZWFyKCksIGRhdGVfaW5mby5nZXRNb250aCgpLCBkYXRlX2luZm8uZ2V0RGF0ZSgpLCBob3VycywgbWludXRlcywgc2Vjb25kcyk7CiAgICAgICAgICAgICAgICBlbGVtZW50LmRhdGUgICAgPSBjdXJyZW50X2RhdGV0aW1lCiAgICAgICAgICAgICAgICBlbGVtZW50LmRhdGVGb3JtYXQgPSB0aGlzLmRhdGVGb3JtYXQKICAgICAgICAgICAgICAgIHZhciB1dGNfZGF5c190aW1lX2luICA9IE1hdGguZmxvb3IoZWxlbWVudC5jbG9ja2VkSW4gLSAyNTU2OSk7CiAgICAgICAgICAgICAgICB2YXIgdXRjX3ZhbHVlX3RpbWVfaW4gPSB1dGNfZGF5c190aW1lX2luICogODY0MDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGRhdGVfaW5mb190aW1lX2luID0gbmV3IERhdGUodXRjX3ZhbHVlX3RpbWVfaW4gKiAxMDAwKTsKICAgICAgICAgICAgICAgIHZhciBmcmFjdGlvbmFsX3RpbWVfaW4gPSBlbGVtZW50LmNsb2NrZWRJbiAtIE1hdGguZmxvb3IoZWxlbWVudC5jbG9ja2VkSW4pICsgMC4wMDAwMDAxOwogICAgICAgICAgICAgICAgdmFyIHRvdGFsX3NlY29uZHNfdGltZV9pbiA9IE1hdGguZmxvb3IoODY0MDAgKiBmcmFjdGlvbmFsX3RpbWVfaW4pOwogICAgICAgICAgICAgICAgdmFyIHNlY29uZHNfdGltZV9pbiA9IHRvdGFsX3NlY29uZHNfdGltZV9pbiAlIDYwOwogICAgICAgICAgICAgICAgdG90YWxfc2Vjb25kc190aW1lX2luIC09IHNlY29uZHNfdGltZV9pbjsKICAgICAgICAgICAgICAgIHZhciBob3Vyc190aW1lX2luID0gTWF0aC5mbG9vcih0b3RhbF9zZWNvbmRzX3RpbWVfaW4gLyAoNjAgKiA2MCkpOwogICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXNfdGltZV9pbiA9IE1hdGguZmxvb3IodG90YWxfc2Vjb25kc190aW1lX2luIC8gNjApICUgNjA7CiAgICAgICAgICAgICAgICB2YXIgY3VycmVudF90aW1lX2luID0gIG5ldyBEYXRlKGRhdGVfaW5mb190aW1lX2luLmdldEZ1bGxZZWFyKCksIGRhdGVfaW5mb190aW1lX2luLmdldE1vbnRoKCksIGRhdGVfaW5mb190aW1lX2luLmdldERhdGUoKSwgaG91cnNfdGltZV9pbiwgbWludXRlc190aW1lX2luLCBzZWNvbmRzX3RpbWVfaW4pOwogICAgICAgICAgICAgICAgZWxlbWVudC5jbG9ja2VkSW4gICAgPSBjdXJyZW50X3RpbWVfaW4KCiAgICAgICAgICAgICAgICB2YXIgdXRjX2RheXNfdGltZV9vdXQgID0gTWF0aC5mbG9vcihlbGVtZW50LmNsb2NrZWRPdXQgLSAyNTU2OSk7CiAgICAgICAgICAgICAgICB2YXIgdXRjX3ZhbHVlX3RpbWVfb3V0ID0gdXRjX2RheXNfdGltZV9vdXQgKiA4NjQwMDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgZGF0ZV9pbmZvX3RpbWVfb3V0ID0gbmV3IERhdGUodXRjX3ZhbHVlX3RpbWVfb3V0ICogMTAwMCk7CiAgICAgICAgICAgICAgICB2YXIgZnJhY3Rpb25hbF90aW1lX291dCA9IGVsZW1lbnQuY2xvY2tlZE91dCAtIE1hdGguZmxvb3IoZWxlbWVudC5jbG9ja2VkT3V0KSArIDAuMDAwMDAwMTsKICAgICAgICAgICAgICAgIHZhciB0b3RhbF9zZWNvbmRzX3RpbWVfb3V0ID0gTWF0aC5mbG9vcig4NjQwMCAqIGZyYWN0aW9uYWxfdGltZV9vdXQpOwogICAgICAgICAgICAgICAgdmFyIHNlY29uZHNfdGltZV9vdXQgPSB0b3RhbF9zZWNvbmRzX3RpbWVfb3V0ICUgNjA7CiAgICAgICAgICAgICAgICB0b3RhbF9zZWNvbmRzX3RpbWVfb3V0IC09IHNlY29uZHNfdGltZV9vdXQ7CiAgICAgICAgICAgICAgICB2YXIgaG91cnNfdGltZV9vdXQgPSBNYXRoLmZsb29yKHRvdGFsX3NlY29uZHNfdGltZV9vdXQgLyAoNjAgKiA2MCkpOwogICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXNfdGltZV9vdXQgPSBNYXRoLmZsb29yKHRvdGFsX3NlY29uZHNfdGltZV9vdXQgLyA2MCkgJSA2MDsKICAgICAgICAgICAgICAgIHZhciBjdXJyZW50X3RpbWVfb3V0ID0gIG5ldyBEYXRlKGRhdGVfaW5mb190aW1lX291dC5nZXRGdWxsWWVhcigpLCBkYXRlX2luZm9fdGltZV9vdXQuZ2V0TW9udGgoKSwgZGF0ZV9pbmZvX3RpbWVfb3V0LmdldERhdGUoKSwgaG91cnNfdGltZV9vdXQsIG1pbnV0ZXNfdGltZV9vdXQsIHNlY29uZHNfdGltZV9vdXQpOwogICAgICAgICAgICAgICAgZWxlbWVudC5jbG9ja2VkT3V0ICAgID0gY3VycmVudF90aW1lX291dAogICAgICAgICAgICAgICAgZWxlbWVudC50aW1lRm9ybWF0ICA9IHRoaXMudGltZUZvcm1hdAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXN1bHRzCiAgICAgICAgICAgIHRoaXMudGFibGVIZWFkZXIgPSBoZWFkZXIKICAgICAgICB9LAogICAgICAgIG9uU2F2ZUNsb3NlKCl7CiAgICAgICAgICAgIHRoaXMuYXV0b0NhbGN1bGF0ZSgpCiAgICAgICAgICAgIHRoaXMuZ3JvdXBCeSgpCiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YVRpbWVDYXJkID0gewogICAgICAgICAgICAgICAgICAgICAgICBpZDogICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZUNhcmQuaWQgPyB0aGlzLnRpbWVDYXJkLmlkIDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoT2Y6ICAgICAgICAgICAgICAgICAga2VuZG8udG9TdHJpbmcobmV3IERhdGUodGhpcy5tb250aE9mKSwneXl5eS1NTS1kZCcpLAogICAgICAgICAgICAgICAgICAgICAgICB0aW1lQ2FyZExpbmU6ICAgICAgICAgICAgIHRoaXMudGltZUNhcmRMaW5lLAogICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFdvcms6ICAgICAgICAgICAgICAgIHRoaXMudG90YWxXb3JrLAogICAgICAgICAgICAgICAgICAgICAgICB0b3RhbE92ZXJUaW1lV2Vla2VuZDogICAgIHRoaXMudG90YWxPdmVyVGltZVdlZWtlbmQsCiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsT3ZlclRpbWVIb2xpZGF5OiAgICAgdGhpcy50b3RhbE92ZXJUaW1lSG9saWRheSwKICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxPdmVyVGltZU5pZ2h0OiAgICAgICB0aGlzLnRvdGFsT3ZlclRpbWVOaWdodCwKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb246ICAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uU2VsZWN0ZWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSWQ6ICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkLmlkLAogICAgICAgICAgICAgICAgICAgICAgICBzZWdtZW50OiAgICAgICAgICAgICAgICAgIHRoaXMuc2VnbWVudFNlbGVjdGVkLAogICAgICAgICAgICAgICAgICAgICAgICBzZWdtZW50SWQ6ICAgICAgICAgICAgICAgIHRoaXMuc2VnbWVudFNlbGVjdGVkLmlkLAogICAgICAgICAgICAgICAgICAgICAgICBwZXJpb2Q6ICAgICAgICAgICAgICAgICAgIHRoaXMucGVyaW9kLAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuY3JlYXRlVGltZUNhcmQoZGF0YVRpbWVDYXJkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzbm90aWZ5LnN1Y2Nlc3MoJ1N1Y2Nlc3MnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc25vdGlmeS5lcnJvcignU29tZXRoaW5nIHdlbnQgd3JvbmcnKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9ycy5wdXNoKGUpCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhdXRvQ2FsY3VsYXRlKCkgewogICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmRhdGFTb3VyY2VJbnB1dC5rZW5kb1dpZGdldCgpLAogICAgICAgICAgICAvLyBzcGVjaWZpY1dvcmtzID0gW10sCiAgICAgICAgICAgIHRvdGFsV29yayA9IDAsCiAgICAgICAgICAgIHRvdGFsT3ZlclRpbWVXZWVrZW5kID0gMCwKICAgICAgICAgICAgdG90YWxPdmVyVGltZUhvbGlkYXkgPSAwLAogICAgICAgICAgICB0b3RhbE92ZXJUaW1lTmlnaHQgICA9IDA7CiAgICAgICAgICAgIGRzLmRhdGEoKS5mb3JFYWNoKHZhbHVlID0+IHsKICAgICAgICAgICAgICAgIHRvdGFsV29yayArPSBrZW5kby5wYXJzZUZsb2F0KHZhbHVlLndvcmtUaW1lKQogICAgICAgICAgICAgICAgdG90YWxPdmVyVGltZVdlZWtlbmQgKz0ga2VuZG8ucGFyc2VGbG9hdCh2YWx1ZS5vdmVyVGltZVdlZWtlbmQpCiAgICAgICAgICAgICAgICB0b3RhbE92ZXJUaW1lSG9saWRheSArPSBrZW5kby5wYXJzZUZsb2F0KHZhbHVlLm92ZXJUaW1lSG9saWRheSkKICAgICAgICAgICAgICAgIHRvdGFsT3ZlclRpbWVOaWdodCAgICs9IGtlbmRvLnBhcnNlRmxvYXQodmFsdWUub3ZlclRpbWVOaWdodCkKICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGhpcy50b3RhbFdvcmsgICAgICAgICAgICAgID0gdG90YWxXb3JrCiAgICAgICAgICAgIHRoaXMudG90YWxPdmVyVGltZVdlZWtlbmQgICA9IHRvdGFsT3ZlclRpbWVXZWVrZW5kCiAgICAgICAgICAgIHRoaXMudG90YWxPdmVyVGltZUhvbGlkYXkgICA9IHRvdGFsT3ZlclRpbWVIb2xpZGF5CiAgICAgICAgICAgIHRoaXMudG90YWxPdmVyVGltZU5pZ2h0ICAgICA9IHRvdGFsT3ZlclRpbWVOaWdodAogICAgICAgIH0sCiAgICAgICAgZ3JvdXBCeSgpIHsKICAgICAgICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5kYXRhU291cmNlSW5wdXQua2VuZG9XaWRnZXQoKTsKICAgICAgICAgICAgbGV0IGhlbHBlciA9IHt9OwogICAgICAgICAgICBsZXQgcmVzdWx0ID0gZHMuZGF0YSgpLnJlZHVjZShmdW5jdGlvbihyLCBvKSB7CiAgICAgICAgICAgICAgICBsZXQga2V5ID0gby5kYXRlICsgJy0nICsgby5lbXBsb3llZUlkOwogICAgICAgICAgICAgICAgaWYoIWhlbHBlcltrZXldKSB7CiAgICAgICAgICAgICAgICAgICAgaGVscGVyW2tleV0gPSBPYmplY3QuYXNzaWduKHt9LCBvKTsgLy8gY3JlYXRlIGEgY29weSBvZiBvCiAgICAgICAgICAgICAgICAgICAgci5wdXNoKGhlbHBlcltrZXldKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaGVscGVyW2tleV0ud29ya1RpbWUgKz0gby53b3JrVGltZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiByOwogICAgICAgICAgICB9LCBbXSk7CiAgICAgICAgICAgIGxldCBsYXN0UmVzdWx0ID0ge30KICAgICAgICAgICAgbGV0IGVtcGxveWVlcyA9IHRoaXMuZW1wbG95ZWVzCiAgICAgICAgICAgIGxldCBsYXN0X3Jlc3VsdCA9IHJlc3VsdC5yZWR1Y2UoZnVuY3Rpb24obSwgbikgewogICAgICAgICAgICAgICAgbGV0IGtleSA9IG4uZW1wbG95ZWVJZAogICAgICAgICAgICAgICAgaWYoIWxhc3RSZXN1bHRba2V5XSkgewogICAgICAgICAgICAgICAgICAgIGxhc3RSZXN1bHRba2V5XSA9IE9iamVjdC5hc3NpZ24oe30sIG4pOyAvLyBjcmVhdGUgYSBjb3B5IG9mIG8KICAgICAgICAgICAgICAgICAgICBtLnB1c2gobGFzdFJlc3VsdFtrZXldKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVzLmZvckVhY2goZnVuY3Rpb24oZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoa2V5ID09IGVtLmVtcGxveWVlSWQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFJlc3VsdFtrZXldLndvcmtUaW1lICs9IG4ud29ya1RpbWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UmVzdWx0W2tleV0uZW1wbG95ZWVVdWlkICA9IGVtLmlkOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbTsKICAgICAgICAgICAgfSwgW10pOwogICAgICAgICAgICBsZXQgdGltZUNhcmRMaW5lID0gIGxhc3RfcmVzdWx0Lm1hcChuPT57CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVDYXJkTGluZShuKQogICAgICAgICAgICB9KQogICAgICAgICAgICB0aGlzLnRpbWVDYXJkTGluZSA9IHRpbWVDYXJkTGluZQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZEVtcGxveWVlKCl7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgIHRoaXMuZW1wbG95ZWVzID0gW10KICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUhhbmRsZXIuY2VudGVyKCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1wbG95ZWVzID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgY2xvc2UoKSB7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nbSA9IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkTG9jYXRpb24oKSB7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkhhbmRsZXIubGlzdCgpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24gPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkU2VnbWVudCgpIHsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHNldHRpbmdzSGFuZGxlci5nZXRTZWcoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlZ21lbnQgPSByZXMuZGF0YS5kYXRhICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgLy8gc2VhcmNoMSgpewogICAgICAgIC8vICAgICBpZih0aGlzLm5hdHVyZUlucHV0U2VsZWN0ZWQgPT0gIkZpeGVkIil7CiAgICAgICAgLy8gICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5yZWNvcmRMaXN0LmZpbHRlcihuID0+bi5zYWxhcnlUeXBlID09Ik1vbnRobHkiICYmIG4uYXBwbHlPdmVydGltZSA9PSBmYWxzZSAmJiBuLmxvY2F0aW9uSWQgPT0gdGhpcy5sb2NhdGlvblNlbGVjdGVkLmlkKTsKICAgICAgICAvLyAgICAgICAgIGxldCB0aW1lQ2FyZExpc3QgPSByZXN1bHQubWFwKGluZGV4ID0+ewogICAgICAgIC8vICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgIGVtcGxveWVlVXVpZDogICAgICAgICAgICAgICBpbmRleC5lbXBsb3llZS5pZCA/IGluZGV4LmVtcGxveWVlLmlkOiAnJywKICAgICAgICAvLyAgICAgICAgICAgICAgICAgc2FsYXJ5OiAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoaW5kZXguc2FsYXJ5KSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgZW1wbG95ZWVJZDogICAgICAgICAgICAgICAgIGluZGV4LmVtcGxveWVlSWQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIGJhbms6ICAgICAgICAgICAgICAgICAgICAgICBpbmRleC5lbXBsb3llZS5iYW5rICwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgYmFua0FjY291bnQ6ICAgICAgICAgICAgICAgIGluZGV4LmVtcGxveWVlLmJhbmtBY2NvdW50LAogICAgICAgIC8vICAgICAgICAgICAgICAgICBlbXBsb3llZU5hbWU6ICAgICAgICAgICAgICAgaW5kZXguZW1wbG95ZWUuZmlyc3ROYW1lICsnICcrIGluZGV4LmVtcGxveWVlLmxhc3ROYW1lLAogICAgICAgIC8vICAgICAgICAgICAgICAgICBuYXR1cmVFbXBsb3llZTogICAgICAgICAgICAgaW5kZXguZW1wbG95ZWUubmF0dXJlRW1wbG95ZWUsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHBheXJvbGxMaWFiaWxpdGllOiAgICAgICAgICBpbmRleC5lbXBsb3llZS5wYXlyb2xsTGlhYmlsaXRpZSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogICAgICAgICAgICAgIGluZGV4LmVtcGxveWVlLnBheW1lbnRNZXRob2QsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIGVtcGxveWVlOiAgICAgICAgICAgICAgICAgICBpbmRleC5lbXBsb3llZSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgb3ZlclRpbWVIb2xpZGF5OiAgICAgICAgICAgIDAsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIG92ZXJUaW1lV2Vla2VuZDogICAgICAgICAgICAwLAogICAgICAgIC8vICAgICAgICAgICAgICAgICBvdmVyVGltZU5pZ2h0OiAgICAgICAgICAgICAgMCwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgd29ya0RheTogICAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHdvcmtUaW1lOiAgICAgICAgICAgICAgICAgICAwLAogICAgICAgIC8vICAgICAgICAgICAgICAgICBiZW5lZml0OiAgICAgICAgICAgICAgICAgICAgaW5kZXguYmVuZWZpdCwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxCZW5lZml0OiAgICAgICAgICAgICAgIDAgLAogICAgICAgIC8vICAgICAgICAgICAgICAgICBjdXJyZW5jeTogICAgICAgICAgICAgICAgICAgaW5kZXguY3VycmVuY3kgPyBpbmRleC5jdXJyZW5jeToge30sCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAgICAgICAgICAgICAgICAgICBpbmRleC5sb2NhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgc2VnbWVudDogICAgICAgICAgICAgICAgICAgIGluZGV4LnNlZ21lbnQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHNhbGFyeVR5cGU6ICAgICAgICAgICAgICAgICBpbmRleC5zYWxhcnlUeXBlLm5hbWUsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHN0YXJ0aW5nVGltZTogICAgICAgICAgICAgICBpbmRleC5zdGFydGluZ1RpbWUsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAgICAgICAgICAgICAgICAgICBpbmRleC5wb3NpdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgbmF0dXJlQ29udHJhY3Q6ICAgICAgICAgICAgIGluZGV4Lm5hdHVyZUNvbnRyYWN0LAogICAgICAgIC8vICAgICAgICAgICAgICAgICBlYXJuaW5nOiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChpbmRleC5zYWxhcnkpLAogICAgICAgIC8vICAgICAgICAgICAgICAgICBwYWlkSG91cnM6ICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgZGVkdWN0aW9uOiAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgIG5ldFBheTogICAgICAgICAgICAgICAgICAgICAwLAogICAgICAgIC8vICAgICAgICAgICAgIH0KICAgICAgICAvLyAgICAgICAgIH0pCiAgICAgICAgLy8gICAgICAgICB0aGlzLnRpbWVDYXJkTGluZSA9IHRpbWVDYXJkTGlzdAogICAgICAgIC8vICAgICB9ZWxzZXsKICAgICAgICAvLyAgICAgICAgIGxldCBwYXJhbSA9ICB7CiAgICAgICAgLy8gICAgICAgICAgICAgJ21vbnRoT2YnOiAgICAgIGtlbmRvLnRvU3RyaW5nKCBuZXcgRGF0ZSh0aGlzLm1vbnRoT2YpLCd5eXl5LU1NLWRkJyksCiAgICAgICAgLy8gICAgICAgICAgICAgJ3NlbGVjdFRpbWUnOiAgIHRoaXMubmF0dXJlSW5wdXRTZWxlY3RlZAogICAgICAgIC8vICAgICAgICAgfQogICAgICAgIC8vICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgLy8gICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHBheXJvbGxIYW5kbGVyLmdldFRpbWVDYXJkKHBhcmFtKS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBpZihyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApewogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXMuZGF0YS5kYXRhOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdC5sZW5ndGggPiAwKXsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0WzBdLnRpbWVDYXJkTGluZS5sZW5ndGggPiAwKXsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRfdGltZWNhcmQgPSByZXN1bHRbMF0udGltZUNhcmRMaW5lOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdF9yZWNvcmQgPSB0aGlzLnJlY29yZExpc3QuZmlsdGVyKG4gPT5uLmFwcGx5T3ZlcnRpbWUgPT0gdHJ1ZSk7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGltZUNhcmRMaXN0ID0gW107CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRfdGltZWNhcmQuZm9yRWFjaChmdW5jdGlvbih0YykgewogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0aW1lX2VtcGxveWVlSWQgPSB0Yy5lbXBsb3llZUlkOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b3RhbEJlbmVmaXQgPSAwOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWR1Y3Rpb24gPSAwOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXRQYXkgPSAwOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlID0gIHJlc3VsdF9yZWNvcmQuZmlsdGVyKG0gPT4gbS5lbXBsb3llZUlkID09PSAgdGltZV9lbXBsb3llZUlkKS5tYXAoaXRlbSA9PnsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5iZW5lZml0LmZvckVhY2goZnVuY3Rpb24oYil7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihiLmFtb3VudCl7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxCZW5lZml0ICs9IHBhcnNlRmxvYXQoYi5hbW91bnQpCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGF5cm9sbExpYWJpbGl0aWUgICAgICAgPSAgaXRlbS5lbXBsb3llZS5wYXlyb2xsTGlhYmlsaXRpZQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcGVyaW9kID0gcmVzdWx0WzBdLnBlcmlvZAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3ZlclRpbWVOaWdodCA9IHRjLm92ZXJUaW1lTmlnaHQgKiBwYXJzZUZsb2F0KHBlcmlvZC5vdmVydGltZU5pZ2h0KQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3ZlclRpbWVXZWVrZW5kID0gdGMub3ZlclRpbWVXZWVrZW5kICogcGFyc2VGbG9hdChwZXJpb2Qub3ZlcnRpbWVGb3JXZWVrZW5kKQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3ZlclRpbWVIb2xpZGF5ID0gdGMub3ZlclRpbWVIb2xpZGF5ICogcGFyc2VGbG9hdChwZXJpb2Qub3ZlcnRpbWVGb3JOYXRpb25hbEhvbGlkYXkpCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b3RhbEhvdXJzID0gdGMud29ya1RpbWUgKyBvdmVyVGltZU5pZ2h0ICsgb3ZlclRpbWVXZWVrZW5kICsgb3ZlclRpbWVIb2xpZGF5CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b3RhbG92ZXJUaW1lID0gb3ZlclRpbWVOaWdodCArIG92ZXJUaW1lV2Vla2VuZCArIG92ZXJUaW1lSG9saWRheQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd29ya0RheSA9IHRjLndvcmtUaW1lIC8gcGFyc2VGbG9hdChwZXJpb2QuaG91clBlckRheSkKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNhbGFyeUFtb3VudCA9IDAKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNhbGFyeSA9IHBhcnNlRmxvYXQoaXRlbS5zYWxhcnkpCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0uc2FsYXJ5VHlwZSA9PSAiTW9udGhseSIpewogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNhbGFyeUhvdXJzID0gc2FsYXJ5IC8gKHBhcnNlRmxvYXQocGVyaW9kLmhvdXJQZXJEYXkpICogcGFyc2VGbG9hdChwZXJpb2Qud29ya2luZ0RheSkpIAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5QW1vdW50ID0gc2FsYXJ5ICsgKHNhbGFyeUhvdXJzICogdG90YWxvdmVyVGltZSkKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWxhcnlBbW91bnQgPSBzYWxhcnkgKiB0b3RhbEhvdXJzCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcGxveWVlVXVpZDogICAgICAgICAgICAgICBpdGVtLmVtcGxveWVlLmlkID8gaXRlbS5lbXBsb3llZS5pZDogJycsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWxhcnk6ICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5QW1vdW50LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVJZDogICAgICAgICAgICAgICAgIHRjLmVtcGxveWVlSWQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYW5rOiAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5lbXBsb3llZS5iYW5rICwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbmtBY2NvdW50OiAgICAgICAgICAgICAgICBpdGVtLmVtcGxveWVlLmJhbmtBY2NvdW50LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVOYW1lOiAgICAgICAgICAgICAgIGl0ZW0uZW1wbG95ZWUuZmlyc3ROYW1lICsnICcrICAgaXRlbS5lbXBsb3llZS5sYXN0TmFtZSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdHVyZUVtcGxveWVlOiAgICAgICAgICAgICBpdGVtLmVtcGxveWVlLm5hdHVyZUVtcGxveWVlLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5cm9sbExpYWJpbGl0aWU6ICAgICAgICAgIHBheXJvbGxMaWFiaWxpdGllLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudE1ldGhvZDogICAgICAgICAgICAgIGl0ZW0uZW1wbG95ZWUucGF5bWVudE1ldGhvZCwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcGxveWVlOiAgICAgICAgICAgICAgICAgICBpdGVtLmVtcGxveWVlLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVIb2xpZGF5OiAgICAgICAgICAgIHRjLm92ZXJUaW1lSG9saWRheSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lV2Vla2VuZDogICAgICAgICAgICB0Yy5vdmVyVGltZVdlZWtlbmQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyVGltZU5pZ2h0OiAgICAgICAgICAgICAgdGMub3ZlclRpbWVOaWdodCwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtEYXk6ICAgICAgICAgICAgICAgICAgICB3b3JrRGF5IHx8IDAsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWlkSG91cnM6ICAgICAgICAgICAgICAgICAgdGMud29ya1RpbWUsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFdvcmtpbmdob3VyczogICAgICAgICAgdGMud29ya1RpbWUsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZW5lZml0OiAgICAgICAgICAgICAgICAgICAgaXRlbS5iZW5lZml0LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVuY3k6ICAgICAgICAgICAgICAgICAgIHRjLmN1cnJlbmN5ID8gdGMuY3VycmVuY3k6IHt9LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxCZW5lZml0OiAgICAgICAgICAgICAgIHBhcnNlRmxvYXQodG90YWxCZW5lZml0KSAsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogICAgICAgICAgICAgICAgICAgaXRlbS5sb2NhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnQ6ICAgICAgICAgICAgICAgICAgICBpdGVtLnNlZ21lbnQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWxhcnlUeXBlOiAgICAgICAgICAgICAgICAgaXRlbS5zYWxhcnlUeXBlLm5hbWUsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydGluZ1RpbWU6ICAgICAgICAgICAgICAgaXRlbS5zdGFydGluZ1RpbWUsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogICAgICAgICAgICAgICAgICAgaXRlbS5wb3NpdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdHVyZUNvbnRyYWN0OiAgICAgICAgICAgICBpdGVtLm5hdHVyZUNvbnRyYWN0LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFybmluZzogICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoaXRlbS5zYWxhcnkpICsgcGFyc2VGbG9hdCh0b3RhbEJlbmVmaXQpLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVkdWN0aW9uOiAgICAgICAgICAgICAgICAgIGRlZHVjdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldFBheTogICAgICAgICAgICAgICAgICAgICBuZXRQYXksCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlLmxlbmd0aCA+MCl7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVDYXJkTGlzdC5wdXNoKHJlWzBdKQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lQ2FyZExpbmUgPSB0aW1lQ2FyZExpc3QKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0X3JlY29yZCA9IHRoaXMucmVjb3JkTGlzdC5maWx0ZXIobiA9Pm4uYXBwbHlPdmVydGltZSA9PSB0cnVlKTsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0aW1lc2hlZXQgPSBbXQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24odGMpIHsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGltZV9lbXBsb3llZV9pZCA9IHRjLmVtcGxveWVlLmlkOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b3RhbEJlbmVmaXQgPSAwOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWR1Y3Rpb24gPSAwOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXRQYXkgPSAwOwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwZXJpb2QgPSB0Yy5wZXJpb2QKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsZXQgdG90YWxIb3VycyA9IDAKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZSA9ICByZXN1bHRfcmVjb3JkLmZpbHRlcihtID0+IG0uZW1wbG95ZWVfaWQgPT09ICB0aW1lX2VtcGxveWVlX2lkKS5tYXAoaXRlbSA9PnsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5iZW5lZml0LmZvckVhY2goZnVuY3Rpb24oYil7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihiLmFtb3VudCl7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxCZW5lZml0ICs9IHBhcnNlRmxvYXQoYi5hbW91bnQpCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvdmVyVGltZU5pZ2h0ID0gdGMub3ZlclRpbWVOaWdodCAqIHBhcnNlRmxvYXQocGVyaW9kLm92ZXJ0aW1lTmlnaHQpCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvdmVydGltZUhvdXJzV2Vla2VuZCA9IHRjLm92ZXJ0aW1lSG91cnNXZWVrZW5kICogcGFyc2VGbG9hdChwZXJpb2Qub3ZlcnRpbWVGb3JXZWVrZW5kKQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3ZlcnRpbWVIb3Vyc0hvbGlkYXkgPSB0Yy5vdmVydGltZUhvdXJzSG9saWRheSAqIHBhcnNlRmxvYXQocGVyaW9kLm92ZXJ0aW1lRm9yTmF0aW9uYWxIb2xpZGF5KQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxIb3VycyA9IHRjLndvcmtpbmdIb3VycyArIG92ZXJUaW1lTmlnaHQgKyBvdmVydGltZUhvdXJzV2Vla2VuZCArIG92ZXJ0aW1lSG91cnNIb2xpZGF5CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB3b3JrRGF5ID0gdGMud29ya2luZ0hvdXJzIC9wYXJzZUZsb2F0KHRjLnBlcmlvZC5ob3VyUGVyRGF5KQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxvdmVyVGltZSA9IG92ZXJUaW1lTmlnaHQgKyBvdmVydGltZUhvdXJzV2Vla2VuZCArIG92ZXJ0aW1lSG91cnNIb2xpZGF5CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYWxhcnkgPSBwYXJzZUZsb2F0KGl0ZW0uc2FsYXJ5KQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2FsYXJ5QW1vdW50ID0gMAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLnNhbGFyeVR5cGUgPT0gIk1vbnRobHkiKXsKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYWxhcnlIb3VycyA9IHNhbGFyeSAvIChwYXJzZUZsb2F0KHRjLnBlcmlvZC5ob3VyUGVyRGF5KSAqIHBhcnNlRmxvYXQodGMucGVyaW9kLndvcmtpbmdEYXkpKSAKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbGFyeUFtb3VudCA9IHNhbGFyeSArIChzYWxhcnlIb3VycyAqIHRvdGFsb3ZlclRpbWUpCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5QW1vdW50ID0gc2FsYXJ5ICogdG90YWxIb3VycwogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZVV1aWQ6ICAgICAgIHRjLmVtcGxveWVlLmlkLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5OiAgICAgICAgICAgICBzYWxhcnlBbW91bnQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUlkOiAgICAgICAgIHRjLmVtcGxveWVlLmVtcGxveWVlSWQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZTogICAgICAgICAgIHRjLmVtcGxveWVlLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5cm9sbExpYWJpbGl0aWU6ICB0Yy5lbXBsb3llZS5wYXlyb2xsTGlhYmlsaXRpZSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbms6ICAgICAgICAgICAgICAgdGMuZW1wbG95ZWUuYmFuaywKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbmtBY2NvdW50OiAgICAgICAgdGMuZW1wbG95ZWUuYmFua0FjY291bnQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiAgICAgIHRjLmVtcGxveWVlLnBheW1lbnRNZXRob2QsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXR1cmVFbXBsb3llZTogICAgIHRjLmVtcGxveWVlLm5hdHVyZUVtcGxveWVlLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVOYW1lOiAgICAgICB0Yy5lbXBsb3llZS5maXJzdE5hbWUgKycgJysgICB0Yy5lbXBsb3llZS5sYXN0TmFtZSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lSG9saWRheTogICAgdGMub3ZlcnRpbWVIb3Vyc0hvbGlkYXksCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyVGltZVdlZWtlbmQ6ICAgIHRjLm92ZXJ0aW1lSG91cnNXZWVrZW5kLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVOaWdodDogICAgICB0Yy5vdmVyVGltZU5pZ2h0LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFpZEhvdXJzOiAgICAgICAgICB0Yy53b3JraW5nSG91cnMsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JraW5nSG91cnM6ICAgICAgIHRjLndvcmtpbmdIb3VycywKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcmlvZDogICAgICAgICAgICAgdGMucGVyaW9kLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya0RheTogICAgICAgICAgICB3b3JrRGF5IHx8IDAsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZW5lZml0OiAgICAgICAgICAgIGl0ZW0uYmVuZWZpdCwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQmVuZWZpdDogICAgICAgcGFyc2VGbG9hdCh0b3RhbEJlbmVmaXQpLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxXb3JraW5naG91cnM6ICBwYXJzZUZsb2F0KHRvdGFsSG91cnMpLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudDogICAgICAgICAgICBpdGVtLnNlZ21lbnQsCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogICAgICAgICAgIGl0ZW0ubG9jYXRpb24sCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWxhcnlUeXBlOiAgICAgICAgIGl0ZW0uc2FsYXJ5VHlwZS5uYW1lLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRpbmdUaW1lOiAgICAgICBpdGVtLnN0YXJ0aW5nVGltZSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAgICAgICAgICAgaXRlbS5wb3NpdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAgICAgICAgICAgaXRlbS5jdXJyZW5jeSA/IGl0ZW0uY3VycmVuY3k6IHt9LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF0dXJlQ29udHJhY3Q6ICAgICBpdGVtLm5hdHVyZUNvbnRyYWN0LAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFybmluZzogICAgICAgICAgICBwYXJzZUZsb2F0KGl0ZW0uc2FsYXJ5KSArIHBhcnNlRmxvYXQodG90YWxCZW5lZml0KSwKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZHVjdGlvbjogICAgICAgICAgZGVkdWN0aW9uLAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0UGF5OiAgICAgICAgICAgICBuZXRQYXksCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlLmxlbmd0aCA+IDApewogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lc2hlZXQucHVzaChyZVswXSkKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lQ2FyZExpbmUgPSB0aW1lc2hlZXQKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVDYXJkTGluZSA9IFtdCiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgIC8vICAgICAgICAgICAgICAgICB9KQogICAgICAgIC8vICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgLy8gICAgICAgICB9KQogICAgICAgIC8vICAgICB9CiAgICAgICAgLy8gfSwKICAgICAgICBmaWx0ZXJFbXBsb3llZSgpewogICAgICAgICAgICBpZih0aGlzLm5hdHVyZUlucHV0U2VsZWN0ZWQgPT0gIkZpeGVkIil7CiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5yZWNvcmRMaXN0LmZpbHRlcihuID0+bi5zYWxhcnlUeXBlID09Ik1vbnRobHkiICYmIG4uYXBwbHlPdmVydGltZSA9PSBmYWxzZSk7CiAgICAgICAgICAgICAgICBsZXQgdGltZUNhcmRMaXN0ID0gcmVzdWx0Lm1hcChpbmRleCA9PnsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZVV1aWQ6ICAgICAgICAgICAgICAgaW5kZXguZW1wbG95ZWUuaWQgPyBpbmRleC5lbXBsb3llZS5pZDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgIHNhbGFyeTogICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KGluZGV4LnNhbGFyeSksCiAgICAgICAgICAgICAgICAgICAgICAgIGVtcGxveWVlSWQ6ICAgICAgICAgICAgICAgICBpbmRleC5lbXBsb3llZUlkLAogICAgICAgICAgICAgICAgICAgICAgICBiYW5rOiAgICAgICAgICAgICAgICAgICAgICAgaW5kZXguZW1wbG95ZWUuYmFuayAsCiAgICAgICAgICAgICAgICAgICAgICAgIGJhbmtBY2NvdW50OiAgICAgICAgICAgICAgICBpbmRleC5lbXBsb3llZS5iYW5rQWNjb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVOYW1lOiAgICAgICAgICAgICAgIGluZGV4LmVtcGxveWVlLmZpcnN0TmFtZSArJyAnKyBpbmRleC5lbXBsb3llZS5sYXN0TmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgbmF0dXJlRW1wbG95ZWU6ICAgICAgICAgICAgIGluZGV4LmVtcGxveWVlLm5hdHVyZUVtcGxveWVlLAogICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsTGlhYmlsaXRpZTogICAgICAgICAgaW5kZXguZW1wbG95ZWUucGF5cm9sbExpYWJpbGl0aWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6ICAgICAgICAgICAgICBpbmRleC5lbXBsb3llZS5wYXltZW50TWV0aG9kLAogICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZTogICAgICAgICAgICAgICAgICAgaW5kZXguZW1wbG95ZWUsCiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lSG9saWRheTogICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICAgICAgICBvdmVyVGltZVdlZWtlbmQ6ICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVOaWdodDogICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtEYXk6ICAgICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICAgICAgICB3b3JrVGltZTogICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICAgICAgYmVuZWZpdDogICAgICAgICAgICAgICAgICAgIGluZGV4LmJlbmVmaXQsCiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQmVuZWZpdDogICAgICAgICAgICAgICAwICwKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVuY3k6ICAgICAgICAgICAgICAgICAgIGluZGV4LmN1cnJlbmN5ID8gaW5kZXguY3VycmVuY3k6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogICAgICAgICAgICAgICAgICAgaW5kZXgubG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnQ6ICAgICAgICAgICAgICAgICAgICBpbmRleC5zZWdtZW50LAogICAgICAgICAgICAgICAgICAgICAgICBzYWxhcnlUeXBlOiAgICAgICAgICAgICAgICAgaW5kZXguc2FsYXJ5VHlwZS5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBzdGFydGluZ1RpbWU6ICAgICAgICAgICAgICAgaW5kZXguc3RhcnRpbmdUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogICAgICAgICAgICAgICAgICAgaW5kZXgucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIG5hdHVyZUNvbnRyYWN0OiAgICAgICAgICAgICBpbmRleC5uYXR1cmVDb250cmFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgZWFybmluZzogICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoaW5kZXguc2FsYXJ5KSwKICAgICAgICAgICAgICAgICAgICAgICAgcGFpZEhvdXJzOiAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZHVjdGlvbjogICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICAgICAgICBuZXRQYXk6ICAgICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgdGhpcy50aW1lQ2FyZExpbmUgPSB0aW1lQ2FyZExpc3QKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICBsZXQgcGFyYW0gPSAgewogICAgICAgICAgICAgICAgICAgICdtb250aE9mJzogICAgICBrZW5kby50b1N0cmluZyggbmV3IERhdGUodGhpcy5tb250aE9mKSwneXl5eS1NTS1kZCcpLAogICAgICAgICAgICAgICAgICAgICdzZWxlY3RUaW1lJzogICB0aGlzLm5hdHVyZUlucHV0U2VsZWN0ZWQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsSGFuZGxlci5nZXRUaW1lQ2FyZChwYXJhbSkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQubGVuZ3RoID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdFswXS50aW1lQ2FyZExpbmUubGVuZ3RoID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0X3RpbWVjYXJkID0gcmVzdWx0WzBdLnRpbWVDYXJkTGluZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHRfcmVjb3JkID0gdGhpcy5yZWNvcmRMaXN0LmZpbHRlcihuID0+bi5hcHBseU92ZXJ0aW1lID09IHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRpbWVDYXJkTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0X3RpbWVjYXJkLmZvckVhY2goZnVuY3Rpb24odGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGltZV9lbXBsb3llZUlkID0gdGMuZW1wbG95ZWVJZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxCZW5lZml0ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVkdWN0aW9uID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV0UGF5ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZSA9ICByZXN1bHRfcmVjb3JkLmZpbHRlcihtID0+IG0uZW1wbG95ZWVJZCA9PT0gIHRpbWVfZW1wbG95ZWVJZCkubWFwKGl0ZW0gPT57CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uYmVuZWZpdC5mb3JFYWNoKGZ1bmN0aW9uKGIpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYi5hbW91bnQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQmVuZWZpdCArPSBwYXJzZUZsb2F0KGIuYW1vdW50KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBheXJvbGxMaWFiaWxpdGllICAgICAgID0gIGl0ZW0uZW1wbG95ZWUucGF5cm9sbExpYWJpbGl0aWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBlcmlvZCA9IHJlc3VsdFswXS5wZXJpb2QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG92ZXJUaW1lTmlnaHQgPSB0Yy5vdmVyVGltZU5pZ2h0ICogcGFyc2VGbG9hdChwZXJpb2Qub3ZlcnRpbWVOaWdodCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG92ZXJUaW1lV2Vla2VuZCA9IHRjLm92ZXJUaW1lV2Vla2VuZCAqIHBhcnNlRmxvYXQocGVyaW9kLm92ZXJ0aW1lRm9yV2Vla2VuZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG92ZXJUaW1lSG9saWRheSA9IHRjLm92ZXJUaW1lSG9saWRheSAqIHBhcnNlRmxvYXQocGVyaW9kLm92ZXJ0aW1lRm9yTmF0aW9uYWxIb2xpZGF5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxIb3VycyA9IHRjLndvcmtUaW1lICsgb3ZlclRpbWVOaWdodCArIG92ZXJUaW1lV2Vla2VuZCArIG92ZXJUaW1lSG9saWRheQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxvdmVyVGltZSA9IG92ZXJUaW1lTmlnaHQgKyBvdmVyVGltZVdlZWtlbmQgKyBvdmVyVGltZUhvbGlkYXkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdvcmtEYXkgPSB0Yy53b3JrVGltZSAvIHBhcnNlRmxvYXQocGVyaW9kLmhvdXJQZXJEYXkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYWxhcnlBbW91bnQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYWxhcnkgPSBwYXJzZUZsb2F0KGl0ZW0uc2FsYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLnNhbGFyeVR5cGUgPT0gIk1vbnRobHkiKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYWxhcnlIb3VycyA9IHNhbGFyeSAvIChwYXJzZUZsb2F0KHBlcmlvZC5ob3VyUGVyRGF5KSAqIHBhcnNlRmxvYXQocGVyaW9kLndvcmtpbmdEYXkpKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbGFyeUFtb3VudCA9IHNhbGFyeSArIChzYWxhcnlIb3VycyAqIHRvdGFsb3ZlclRpbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5QW1vdW50ID0gc2FsYXJ5ICogdG90YWxIb3VycwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZVV1aWQ6ICAgICAgICAgICAgICAgaXRlbS5lbXBsb3llZS5pZCA/IGl0ZW0uZW1wbG95ZWUuaWQ6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5OiAgICAgICAgICAgICAgICAgICAgIHNhbGFyeUFtb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcGxveWVlSWQ6ICAgICAgICAgICAgICAgICB0Yy5lbXBsb3llZUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFuazogICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZW1wbG95ZWUuYmFuayAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYW5rQWNjb3VudDogICAgICAgICAgICAgICAgaXRlbS5lbXBsb3llZS5iYW5rQWNjb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtcGxveWVlTmFtZTogICAgICAgICAgICAgICBpdGVtLmVtcGxveWVlLmZpcnN0TmFtZSArJyAnKyAgIGl0ZW0uZW1wbG95ZWUubGFzdE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXR1cmVFbXBsb3llZTogICAgICAgICAgICAgaXRlbS5lbXBsb3llZS5uYXR1cmVFbXBsb3llZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheXJvbGxMaWFiaWxpdGllOiAgICAgICAgICBwYXlyb2xsTGlhYmlsaXRpZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6ICAgICAgICAgICAgICBpdGVtLmVtcGxveWVlLnBheW1lbnRNZXRob2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZTogICAgICAgICAgICAgICAgICAgaXRlbS5lbXBsb3llZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lSG9saWRheTogICAgICAgICAgICB0Yy5vdmVyVGltZUhvbGlkYXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyVGltZVdlZWtlbmQ6ICAgICAgICAgICAgdGMub3ZlclRpbWVXZWVrZW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVOaWdodDogICAgICAgICAgICAgIHRjLm92ZXJUaW1lTmlnaHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrRGF5OiAgICAgICAgICAgICAgICAgICAgd29ya0RheSB8fCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFpZEhvdXJzOiAgICAgICAgICAgICAgICAgIHRjLndvcmtUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxXb3JraW5naG91cnM6ICAgICAgICAgIHRjLndvcmtUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVuZWZpdDogICAgICAgICAgICAgICAgICAgIGl0ZW0uYmVuZWZpdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICB0Yy5jdXJyZW5jeSA/IHRjLmN1cnJlbmN5OiB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQmVuZWZpdDogICAgICAgICAgICAgICBwYXJzZUZsb2F0KHRvdGFsQmVuZWZpdCkgLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb246ICAgICAgICAgICAgICAgICAgIGl0ZW0ubG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWdtZW50OiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZWdtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5VHlwZTogICAgICAgICAgICAgICAgIGl0ZW0uc2FsYXJ5VHlwZS5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRpbmdUaW1lOiAgICAgICAgICAgICAgIGl0ZW0uc3RhcnRpbmdUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICAgICAgICAgICAgICAgICAgIGl0ZW0ucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXR1cmVDb250cmFjdDogICAgICAgICAgICAgaXRlbS5uYXR1cmVDb250cmFjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVhcm5pbmc6ICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KGl0ZW0uc2FsYXJ5KSArIHBhcnNlRmxvYXQodG90YWxCZW5lZml0KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZHVjdGlvbjogICAgICAgICAgICAgICAgICBkZWR1Y3Rpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXRQYXk6ICAgICAgICAgICAgICAgICAgICAgbmV0UGF5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZS5sZW5ndGggPjApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lQ2FyZExpc3QucHVzaChyZVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZUNhcmRMaW5lID0gdGltZUNhcmRMaXN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0X3JlY29yZCA9IHRoaXMucmVjb3JkTGlzdC5maWx0ZXIobiA9Pm4uYXBwbHlPdmVydGltZSA9PSB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0aW1lc2hlZXQgPSBbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24odGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGltZV9lbXBsb3llZV9pZCA9IHRjLmVtcGxveWVlLmlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0b3RhbEJlbmVmaXQgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWR1Y3Rpb24gPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXRQYXkgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwZXJpb2QgPSB0Yy5wZXJpb2QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsZXQgdG90YWxIb3VycyA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZSA9ICByZXN1bHRfcmVjb3JkLmZpbHRlcihtID0+IG0uZW1wbG95ZWVfaWQgPT09ICB0aW1lX2VtcGxveWVlX2lkKS5tYXAoaXRlbSA9PnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5iZW5lZml0LmZvckVhY2goZnVuY3Rpb24oYil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihiLmFtb3VudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxCZW5lZml0ICs9IHBhcnNlRmxvYXQoYi5hbW91bnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvdmVyVGltZU5pZ2h0ID0gdGMub3ZlclRpbWVOaWdodCAqIHBhcnNlRmxvYXQocGVyaW9kLm92ZXJ0aW1lTmlnaHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvdmVydGltZUhvdXJzV2Vla2VuZCA9IHRjLm92ZXJ0aW1lSG91cnNXZWVrZW5kICogcGFyc2VGbG9hdChwZXJpb2Qub3ZlcnRpbWVGb3JXZWVrZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3ZlcnRpbWVIb3Vyc0hvbGlkYXkgPSB0Yy5vdmVydGltZUhvdXJzSG9saWRheSAqIHBhcnNlRmxvYXQocGVyaW9kLm92ZXJ0aW1lRm9yTmF0aW9uYWxIb2xpZGF5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxIb3VycyA9IHRjLndvcmtpbmdIb3VycyArIG92ZXJUaW1lTmlnaHQgKyBvdmVydGltZUhvdXJzV2Vla2VuZCArIG92ZXJ0aW1lSG91cnNIb2xpZGF5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB3b3JrRGF5ID0gdGMud29ya2luZ0hvdXJzIC9wYXJzZUZsb2F0KHRjLnBlcmlvZC5ob3VyUGVyRGF5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxvdmVyVGltZSA9IG92ZXJUaW1lTmlnaHQgKyBvdmVydGltZUhvdXJzV2Vla2VuZCArIG92ZXJ0aW1lSG91cnNIb2xpZGF5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYWxhcnkgPSBwYXJzZUZsb2F0KGl0ZW0uc2FsYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2FsYXJ5QW1vdW50ID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLnNhbGFyeVR5cGUgPT0gIk1vbnRobHkiKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYWxhcnlIb3VycyA9IHNhbGFyeSAvIChwYXJzZUZsb2F0KHRjLnBlcmlvZC5ob3VyUGVyRGF5KSAqIHBhcnNlRmxvYXQodGMucGVyaW9kLndvcmtpbmdEYXkpKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbGFyeUFtb3VudCA9IHNhbGFyeSArIChzYWxhcnlIb3VycyAqIHRvdGFsb3ZlclRpbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5QW1vdW50ID0gc2FsYXJ5ICogdG90YWxIb3VycwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZVV1aWQ6ICAgICAgIHRjLmVtcGxveWVlLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FsYXJ5OiAgICAgICAgICAgICBzYWxhcnlBbW91bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUlkOiAgICAgICAgIHRjLmVtcGxveWVlLmVtcGxveWVlSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZTogICAgICAgICAgIHRjLmVtcGxveWVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5cm9sbExpYWJpbGl0aWU6ICB0Yy5lbXBsb3llZS5wYXlyb2xsTGlhYmlsaXRpZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbms6ICAgICAgICAgICAgICAgdGMuZW1wbG95ZWUuYmFuaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbmtBY2NvdW50OiAgICAgICAgdGMuZW1wbG95ZWUuYmFua0FjY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiAgICAgIHRjLmVtcGxveWVlLnBheW1lbnRNZXRob2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYXR1cmVFbXBsb3llZTogICAgIHRjLmVtcGxveWVlLm5hdHVyZUVtcGxveWVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVOYW1lOiAgICAgICB0Yy5lbXBsb3llZS5maXJzdE5hbWUgKycgJysgICB0Yy5lbXBsb3llZS5sYXN0TmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lSG9saWRheTogICAgdGMub3ZlcnRpbWVIb3Vyc0hvbGlkYXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyVGltZVdlZWtlbmQ6ICAgIHRjLm92ZXJ0aW1lSG91cnNXZWVrZW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVOaWdodDogICAgICB0Yy5vdmVyVGltZU5pZ2h0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFpZEhvdXJzOiAgICAgICAgICB0Yy53b3JraW5nSG91cnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JraW5nSG91cnM6ICAgICAgIHRjLndvcmtpbmdIb3VycywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcmlvZDogICAgICAgICAgICAgdGMucGVyaW9kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya0RheTogICAgICAgICAgICB3b3JrRGF5IHx8IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZW5lZml0OiAgICAgICAgICAgIGl0ZW0uYmVuZWZpdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQmVuZWZpdDogICAgICAgcGFyc2VGbG9hdCh0b3RhbEJlbmVmaXQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxXb3JraW5naG91cnM6ICBwYXJzZUZsb2F0KHRvdGFsSG91cnMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudDogICAgICAgICAgICBpdGVtLnNlZ21lbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogICAgICAgICAgIGl0ZW0ubG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYWxhcnlUeXBlOiAgICAgICAgIGl0ZW0uc2FsYXJ5VHlwZS5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRpbmdUaW1lOiAgICAgICBpdGVtLnN0YXJ0aW5nVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAgICAgICAgICAgaXRlbS5wb3NpdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAgICAgICAgICAgaXRlbS5jdXJyZW5jeSA/IGl0ZW0uY3VycmVuY3k6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF0dXJlQ29udHJhY3Q6ICAgICBpdGVtLm5hdHVyZUNvbnRyYWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWFybmluZzogICAgICAgICAgICBwYXJzZUZsb2F0KGl0ZW0uc2FsYXJ5KSArIHBhcnNlRmxvYXQodG90YWxCZW5lZml0KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZHVjdGlvbjogICAgICAgICAgZGVkdWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0UGF5OiAgICAgICAgICAgICBuZXRQYXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlLmxlbmd0aCA+IDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lc2hlZXQucHVzaChyZVswXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lQ2FyZExpbmUgPSB0aW1lc2hlZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVDYXJkTGluZSA9IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIHNlYXJjaCgpewogICAgICAgICAgICBsZXQgcGFyYW0gPXsKICAgICAgICAgICAgICAgIHN0YXR1czogICAgICAgICAgICAgMSwKICAgICAgICAgICAgICAgIGxvY2F0aW9uX2lkOiAgICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkLmlkIHx8ICIiLAogICAgICAgICAgICAgICAgZGVwYXJ0bWVudF9pZDogICAgICB0aGlzLmRlcGFydG1lbnQsCiAgICAgICAgICAgICAgICBuYXR1cmVDb250cmFjdF9pZDogIHRoaXMubmF0dXJlQ29udHJhY3QsCiAgICAgICAgICAgICAgICBlbXBsb3llZUdyb3VwX2lkOiAgIHRoaXMuZW1wbG95ZWVHcm91cCB8fCAnJwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUhhbmRsZXIuZ2V0UmVjb3JkKHBhcmFtKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvcmRMaXN0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckVtcGxveWVlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgc2F2ZU5leHQoKXsKICAgICAgICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5kYXRhU291cmNlVGltZUNhcmQua2VuZG9XaWRnZXQoKQogICAgICAgICAgICBsZXQgdG90YWxFbXBsb3llZSA9IDA7CiAgICAgICAgICAgIGRzLmRhdGEoKS5mb3JFYWNoKHZhbHVlID0+IHsKICAgICAgICAgICAgICAgIGlmKHZhbHVlKXsKICAgICAgICAgICAgICAgICAgICB0b3RhbEVtcGxveWVlICs9IDEKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGhpcy50b3RhbEVtcGxveWVlID0gdG90YWxFbXBsb3llZQogICAgICAgICAgICBsZXQgZGF0YVNvdXJjZSA9IGRzLmRhdGEoKQogICAgICAgICAgICB0aGlzLnBheXJvbGxMaXN0ID0gZGF0YVNvdXJjZS5tYXAoaW5kZXg9PnsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUGF5cm9sbExpc3QoewogICAgICAgICAgICAgICAgICAgIGFwcGx5T3ZlcnRpbWU6ICAgICAgaW5kZXguYXBwbHlPdmVydGltZSwKICAgICAgICAgICAgICAgICAgICBkYXRlOiAgICAgICAgICAgICAgIHRoaXMuZGF0ZSwKICAgICAgICAgICAgICAgICAgICBiZW5lZml0OiAgICAgICAgICAgIGluZGV4LmJlbmVmaXQgPyBpbmRleC5iZW5lZml0OiBbXSwKICAgICAgICAgICAgICAgICAgICBlbXBsb3llZTogICAgICAgICAgIGluZGV4LmVtcGxveWVlLAogICAgICAgICAgICAgICAgICAgIGVtcGxveWVlSWQ6ICAgICAgICAgaW5kZXguZW1wbG95ZWVJZCwKICAgICAgICAgICAgICAgICAgICBlbXBsb3llZV9pZDogICAgICAgIGluZGV4LmVtcGxveWVlX2lkLAogICAgICAgICAgICAgICAgICAgIGVtcGxveWVlVXVpZDogICAgICAgaW5kZXguZW1wbG95ZWVVdWlkLAogICAgICAgICAgICAgICAgICAgIGVtcGxveWVlTmFtZTogICAgICAgaW5kZXguZW1wbG95ZWVOYW1lLAogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAgICAgICAgICAgaW5kZXgubG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgbmF0dXJlUmVjb3JkOiAgICAgICBpbmRleC5uYXR1cmVSZWNvcmQsCiAgICAgICAgICAgICAgICAgICAgbmF0dXJlU2FsYXJ5OiAgICAgICBpbmRleC5uYXR1cmVTYWxhcnksCiAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWU6ICAgICAgICAgICBpbmRleC5vdmVyVGltZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogICAgICAgICAgIGluZGV4LnBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgIHNhbGFyeTogICAgICAgICAgICAgaW5kZXguc2FsYXJ5LAogICAgICAgICAgICAgICAgICAgIHNhbGFyeTE6ICAgICAgICAgICAgaW5kZXguc2FsYXJ5LAogICAgICAgICAgICAgICAgICAgIHNhbGFyeVR5cGU6ICAgICAgICAgaW5kZXguc2FsYXJ5VHlwZSwKICAgICAgICAgICAgICAgICAgICB0b3RhbEJlbmVmaXQ6ICAgICAgIGluZGV4LnRvdGFsQmVuZWZpdCwKICAgICAgICAgICAgICAgICAgICBzZWdtZW50OiAgICAgICAgICAgIGluZGV4LnNlZ21lbnQgPyBpbmRleC5zZWdtZW50OiBbXSwKICAgICAgICAgICAgICAgICAgICBzdGFydGluZ1RpbWU6ICAgICAgIGluZGV4LnN0YXJ0aW5nVGltZSwKICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICAgICAgICAgICAgIGluZGV4LnN0YXR1cywKICAgICAgICAgICAgICAgICAgICB3b3JrRGF5OiAgICAgICAgICAgIGluZGV4LndvcmtEYXksCiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3k6ICAgICAgICAgICBpbmRleC5jdXJyZW5jeSwKICAgICAgICAgICAgICAgICAgICBwZXJpb2Q6ICAgICAgICAgICAgIGluZGV4LnBlcmlvZCwKICAgICAgICAgICAgICAgICAgICBvdmVyVGltZUhvbGlkYXk6ICAgIGluZGV4Lm92ZXJUaW1lSG9saWRheSwKICAgICAgICAgICAgICAgICAgICBvdmVyVGltZVdlZWtlbmQ6ICAgIGluZGV4Lm92ZXJUaW1lV2Vla2VuZCwKICAgICAgICAgICAgICAgICAgICBvdmVyVGltZU5pZ2h0OiAgICAgIGluZGV4Lm92ZXJUaW1lTmlnaHQsCiAgICAgICAgICAgICAgICAgICAgd29ya2luZ0hvdXJzOiAgICAgICBpbmRleC53b3JraW5nSG91cnMsCiAgICAgICAgICAgICAgICAgICAgdG90YWxXb3JraW5naG91cnM6ICBpbmRleC50b3RhbFdvcmtpbmdob3VycywKICAgICAgICAgICAgICAgICAgICBwYWlkSG91cnM6ICAgICAgICAgIGluZGV4LnBhaWRIb3VycywKICAgICAgICAgICAgICAgICAgICBwYXltZW50TWV0aG9kOiAgICAgIGluZGV4LnBheW1lbnRNZXRob2QsCiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbExpYWJpbGl0aWU6ICBpbmRleC5wYXlyb2xsTGlhYmlsaXRpZSwKICAgICAgICAgICAgICAgICAgICBuYXR1cmVDb250cmFjdDogICAgIGluZGV4Lm5hdHVyZUNvbnRyYWN0ICAgICAgICAKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGlmKHRoaXMucGF5cm9sbExpc3QubGVuZ3RoID4gMCAmJiB0aGlzLmJhc2VDdXJyZW5jeSAmJiB0aGlzLmV4Y2hhbmdlUmF0ZS5yYXRlKXsKICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IG5ldyBQYXlyb2xsUnVuKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogICAgICAgICAgICAgdGhpcy5sb2NhdGlvblNlbGVjdGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9udGhPZjogICAgICAgICAgICAgIGtlbmRvLnRvU3RyaW5nKG5ldyBEYXRlKHRoaXMubW9udGhPZiksJ3l5eXktTU0tZGQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcXVjZW5jaW5nOiAgICAgICAgICBwYXJzZUludChrZW5kby50b1N0cmluZyhuZXcgRGF0ZSh0aGlzLm1vbnRoT2YpLCd5eXl5JykpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxFbXBsb3llZTogICAgICAgIHRoaXMudG90YWxFbXBsb3llZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAgICAgICAgICAgICB0aGlzLmJhc2VDdXJyZW5jeSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2hhbmdlUmF0ZTogICAgICAgICB0aGlzLmV4Y2hhbmdlUmF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6ICAgICAgICAgICAgICAgICBrZW5kby50b1N0cmluZyhuZXcgRGF0ZSh0aGlzLmRhdGUpLCd5eXl5LU1NLWRkJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXlOdW1iZXI6ICAgICAgICAgICAgdGhpcy5wYXlOdW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXI6ICAgICAgICAgICAgICAgdGhpcy5udW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkOiAgICAgICAgICAgICAga2VuZG8udG9TdHJpbmcobmV3IERhdGUoKSwneXl5eS1NTS1kZCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdE51bWJlcjogICAgICAgICAgIHRoaXMubGFzdE51bWJlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFiYnI6ICAgICAgICAgICAgICAgICB0aGlzLnBheU51bWJlci5hYmJyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogICAgICAgICAgICAgICAgICdwYXlyb2xsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdHVyZUlucHV0OiAgICAgICAgICB0aGlzLm5hdHVyZUlucHV0U2VsZWN0ZWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOdW1iZXI6ICAgICAgdGhpcy5wYXlOdW1iZXIuYWJicit0aGlzLnBheU51bWJlci5udW1iZXJTZXBhcmF0b3IgKyB0aGlzLm51bWJlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheXJvbGxMaXN0OiAgICAgICAgICB0aGlzLnBheXJvbGxMaXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDogICAgICAgICAgICAgICAgIDIsICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBhcnRtZW50OiAgICAgICAgICAgdGhpcy5kZXBhcnRtZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmF0dXJlQ29udHJhY3Q6ICAgICAgIHRoaXMubmF0dXJlQ29udHJhY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUdyb3VwOiAgICAgICAgdGhpcy5lbXBsb3llZUdyb3VwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VkVXNlcjogICAgICAgICAgIHRoaXMubG9nZ2VkVXNlciwgCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsSGFuZGxlci5jcmVhdGVQYXlyb2xsKGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHNub3RpZnkuc3VjY2VzcygnU3VjY2VzcycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkU3VjY2VzcyhyZXNwb25zZS5kYXRhLnN0YXR1c0NvZGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc25vdGlmeS5lcnJvcignU29tZXRoaW5nIHdlbnQgd3JvbmcnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChlKQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIGlmKCF0aGlzLmV4Y2hhbmdlUmF0ZS5yYXRlKXsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRzbm90aWZ5LmVycm9yKCdFeGNoYW5nZSByYXRlIG5vdCBmb3VuZCEgcGxlYXNlIGNoZWNrIGFnYWluJykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHRoaXMucGF5cm9sbExpc3QubGVuZ3RoID09IDApewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHNub3RpZnkuZXJyb3IoJ0RhdGEgbm90IGZvdW5kIHBsZWFzZSBjaGVjayBhZ2FpbicpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGxvYWRTdWNjZXNzKGRhdGEpewogICAgICAgICAgICB0aGlzLiRlbWl0KCdoZWFkbGluZScsZGF0YSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRQYXlyb2xsTGlzdCgpewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0UGF5cm9sbCh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coJ1Jhbm5ubm4nLCByZXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRQYXkgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHRQYXkubGVuZ3RoID4gMCl7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0UGF5WzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkUGF5cm9sbEl0ZW0odGhpcy5yZXN1bHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5kYXRlID0gcmVzdWx0UGF5LmRhdGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnJlc3VsdC5tb250aE9mICE9PSAnJyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW9udGhPZiA9IGtlbmRvLnRvU3RyaW5nKG5ldyBEYXRlKHRoaXMucmVzdWx0Lm1vbnRoT2YpLCAieXl5eS1NTSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVOdW1iZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uU2VsZWN0ZWQgPSB0aGlzLnJlc3VsdC5sb2NhdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1wbG95ZWVHcm91cCA9IHRoaXMucmVzdWx0LmVtcGxveWVlR3JvdXAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmVtcGxveWVlR3JvdXAgIT09ICIiKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZEwgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBsb2FkUGF5cm9sbEl0ZW0ocmVzdWx0KXsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbXBsb3llZSA9IFtdCiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0UGF5cm9sbEl0ZW0ocmVzdWx0LmlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1dGxfaXRlbSA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZUNhcmRMaW5lID0gcmVzdXRsX2l0ZW0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgbG9hZFByZWZpeGVzKCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NIYW5kbGVyLmdldFByZWZpeGVzKCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVmaXhMaXN0ID0gcmVzdWx0LmZpbHRlcihwID0+IHAudHlwZSA9PSdwYXlyb2xsJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJlZml4ID0gdGhpcy5wcmVmaXhMaXN0WzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBheU51bWJlciA9IHRoaXMucHJlZml4CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgZ2VuZXJhdGVOdW1iZXIoKSB7CiAgICAgICAgICAgIGxldCByZXN1bHROdW1iZXIgPSB0aGlzLnJlc3VsdAogICAgICAgICAgICBpZihyZXN1bHROdW1iZXIubnVtYmVyKXsKICAgICAgICAgICAgICAgIHRoaXMubnVtYmVyICAgICA9IHJlc3VsdE51bWJlci5udW1iZXIKICAgICAgICAgICAgICAgIHRoaXMubGFzdE51bWJlciA9IHJlc3VsdE51bWJlci5sYXN0TnVtYmVyCiAgICAgICAgICAgICAgICB0aGlzLnBheU51bWJlciAgPSByZXN1bHROdW1iZXIucGF5TnVtYmVyCiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgbGV0IG1vbnRPZl9mb3JtYXQgPSBrZW5kby50b1N0cmluZyhuZXcgRGF0ZSh0aGlzLm1vbnRoT2YpLCd5eXl5LU1NLWRkJyk7CiAgICAgICAgICAgICAgICBpZihtb250T2ZfZm9ybWF0ID09ICIiKXsKICAgICAgICAgICAgICAgICAgICBsZXQgbW9udGhfeWVhciA9IGtlbmRvLnRvU3RyaW5nKG5ldyBEYXRlKCksJ3l5eXktTU0tZGQnKQogICAgICAgICAgICAgICAgICAgIG1vbnRPZl9mb3JtYXQgPSBtb250aF95ZWFyLnNldERhdGUoMSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBzZXF1Y2VuY2luZyA9ICcnCiAgICAgICAgICAgICAgICBpZih0aGlzLnBheU51bWJlci5zZXF1Y2VuY2luZyA9PSJZZWFyIil7CiAgICAgICAgICAgICAgICAgICAgc2VxdWNlbmNpbmcgPSBuZXcgRGF0ZShtb250T2ZfZm9ybWF0KS50b0lTT1N0cmluZygpLnN1YnN0cigwLCA0KQogICAgICAgICAgICAgICAgfWVsc2UgaWYodGhpcy5wYXlOdW1iZXIuc2VxdWNlbmNpbmcgPT0iTW9udGgiKXsKICAgICAgICAgICAgICAgICAgICBzZXF1Y2VuY2luZyA9IG5ldyBEYXRlKG1vbnRPZl9mb3JtYXQpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDcpCiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBzZXF1Y2VuY2luZyA9ICcnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhYmJyOiAgICAgICAgICAgdGhpcy5wYXlOdW1iZXIuYWJiciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZTogICAgICB0aGlzLnBheU51bWJlci5zdHJ1Y3R1cmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiAgICAgICAgICAgbW9udE9mX2Zvcm1hdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICAgICAgICAgICAncGF5cm9sbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwa0lkOiAgICAgICAgICAgJ3Bhci0nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxdWNlbmNpbmc6ICAgIHNlcXVjZW5jaW5nCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93CiAgICAgICAgICAgICAgICAgICAgICAgIHBheXJvbGxIYW5kbGVyLmdldFByZWZpeE51bWJlcihkYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxhc3ROdW1iZXIgPSB0aGlzLnplcm9QYWQocGFyc2VJbnQocmVzdWx0Lmxhc3ROdW1iZXIpLCB0aGlzLnBheU51bWJlci5mb3JtYXQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtYmVyID0gcmVzdWx0LnN1ZmZpeCArIHRoaXMucGF5TnVtYmVyLm51bWJlclNlcGFyYXRvciArIGxhc3ROdW1iZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm51bWJlciA9IG51bWJlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdE51bWJlciA9IGxhc3ROdW1iZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHplcm9QYWQobnVtLCBwbGFjZXMpIHsKICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhudW0pLnBhZFN0YXJ0KHBsYWNlcywgJzAnKQogICAgICAgIH0sCiAgICAgICAgZG93bmxvYWRUaW1lQ2FyZCgpewogICAgICAgICAgICBheGlvcy5nZXQoJ2h0dHBzOi8vczMuYXAtc291dGhlYXN0LTEuYW1hem9uYXdzLmNvbS9pbWFnZXMuYmFuaGppL2ZpbGVzL1RpbWVjYXJkLnhsc3gnLCB7CiAgICAgICAgICAgIC8vIElmIHlvdSBmb3JnZXQgdGhpcywgeW91ciBkb3dubG9hZCB3aWxsIGJlIGNvcnJ1cHQuCiAgICAgICAgICAgICAgICByZXNwb25zZVR5cGU6ICdibG9iJwogICAgICAgICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKAogICAgICAgICAgICAgICAgICAgIG5ldyBCbG9iKFtyZXNwb25zZS5kYXRhXSkKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCAnVGltZWNhcmQueGxzeCcpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTsKICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTsKICAgICAgICAgICAgfSk7IAogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZEJhc2VDdXJyZW5jeSgpIHsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBpbnN0aXR1dGVIYW5kbGVyLmdldE9uZUNvbXBhbnkoY29va2llLmluc3RpdHV0ZUlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmFzZUN1cnJlbmN5ID0gcmVzLmJhc2VDdXJyZW5jeQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgIH0sIDIwMCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZExhc3RFeGNoYW5nZVJhdGUoKXsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpCiAgICAgICAgICAgICAgICAgICAgbGV0IGdldERhdGUgPSBuZXcgRGF0ZSgpCiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGVfdGF4X3BheXJvbGwgPSBuZXcgRGF0ZShnZXREYXRlLmdldEZ1bGxZZWFyKCksIGdldERhdGUuZ2V0TW9udGgoKSwgMTUpOwogICAgICAgICAgICAgICAgICAgIGxldCBkYXRlID0ga2VuZG8udG9TdHJpbmcobmV3IERhdGUoZGF0ZV90YXhfcGF5cm9sbCksJ3l5eXktTU0tZGQnKQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRlKQogICAgICAgICAgICAgICAgICAgIGxldCBjb2RlID0gJ0tIUicKICAgICAgICAgICAgICAgICAgICBpZiAoY29kZSAhPT0gdW5kZWZpbmVkIHx8IGNvZGUgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5SGFuZGxlci5nZXRMYXN0RXhjaGFuZ2VSYXRlVGF4QnlEYXRlKGRhdGUsIGNvZGUpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coMSxyZXMuZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4Y2hhbmdlUmF0ZSA9IHJlcy5kYXRhLmRhdGFbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZEN1cnJlbmN5RGF0YSh0eXBlKSB7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3lIYW5kbGVyLmxpc3QodHlwZSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09IGN1cnJlbmN5VHlwZS5GVU5DVElPTkFMX0NVUlJFTkNZKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jQ3VycmVuY3lMaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IGN1cnJlbmN5VHlwZS5UUkFOU0FDVElPTl9DVVJSRU5DWSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY3lMaXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDMwMCkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGdvQmFjaygpewogICAgICAgICAgICBsZXQgcGF5cm9sbF9pZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZAogICAgICAgICAgICBpZihwYXlyb2xsX2lkICYmIHRoaXMucmVzdWx0LnN0ZXAgPT0gMSl7CiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsSGFuZGxlci5kZWxldGVUcmFuc2FjdGlvbnMocGF5cm9sbF9pZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkUGF5cm9sbExpc3QoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmdvKC0xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0sMzAwKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5nbygtMSkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZFBlcmlvZCgpewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0UGVyaWlvZCgpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJpb2QgPSByZXNbMF0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGxvY2F0aW9uQ2hhbmdlKCl7CiAgICAgICAgICAgIGxldCBsb2NhdGlvbiA9IHRoaXMubG9jYXRpb25TZWxlY3RlZAogICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coJ2xvY2F0aW9uJyxsb2NhdGlvbikKICAgICAgICAgICAgaWYobG9jYXRpb24gIT09IG51bGwpewogICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZEcgPSB0cnVlCiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2UKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygxLCBsb2NhdGlvbikKICAgICAgICAgICAgICAgIHRoaXMubG9hZERlcGFydG1lbnQobG9jYXRpb24uaWQpCiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgdGhpcy5kZXBhcnRtZW50ID0gIiIKICAgICAgICAgICAgICAgIHRoaXMubmF0dXJlQ29udHJhY3QgPSAiIgogICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZEcgPSBmYWxzZQogICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IHRydWUKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlIAogICAgICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKDIsIGxvY2F0aW9uKQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkRGVwYXJ0bWVudChsb2NhdGlvbl9pZCl7CiAgICAgICAgICAgIGxldCBwYXJhbSA9IHsKICAgICAgICAgICAgICAgIGxvY2F0aW9uX2lkOiBsb2NhdGlvbl9pZAogICAgICAgICAgICB9CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICBwYXlyb2xsSGFuZGxlci5nZXREZXBhcnRtZW50KHBhcmFtKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVwYXJ0bWVudHMgPSByZXMKICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5kZXBhcnRtZW50cy5sZW5ndGggPiAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRHcm91cCgpewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0R3JvdXAoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1wbG95ZWVHcm91cHMgPSByZXMuZGF0YQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgZW1wbG95ZWVHcm91cENoYW5nZSAoKXsKICAgICAgICAgICAgaWYodGhpcy5lbXBsb3llZUdyb3VwKXsKICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZWRMID0gdHJ1ZQogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZWRMID0gZmFsc2UKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBhc3luYyBtb3VudGVkKCkgewogICAgICAgIGF3YWl0IHRoaXMubG9hZFBlcmlvZCgpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkUGF5cm9sbExpc3QoKQogICAgICAgIGF3YWl0IHRoaXMubG9hZEVtcGxveWVlKCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRMb2NhdGlvbigpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2VnbWVudCgpCiAgICAgICAgLy8gYXdhaXQgdGhpcy5sb2FkUmVjb3JkKCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRQcmVmaXhlcygpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkQmFzZUN1cnJlbmN5KCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRMYXN0RXhjaGFuZ2VSYXRlKCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRHcm91cCgpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkQ3VycmVuY3lEYXRhKGN1cnJlbmN5VHlwZS5UUkFOU0FDVElPTl9DVVJSRU5DWSkKICAgIH0sCiAgICB3YXRjaDogewogICAgICAgIHByb3BJbnB1dCgpewogICAgICAgICAgICBpZiAodGhpcy5wcm9wSW5wdXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgdGhpcy5sb2FkUGF5cm9sbExpc3QoKQogICAgICAgICAgICAgICAgdGhpcy5sb2FkTGFzdEV4Y2hhbmdlUmF0ZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAp9Cg=="},{"version":3,"sources":["Input.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsWA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Input.vue","sourceRoot":"src/views/payroll/payroll_run","sourcesContent":["<template>\n    <v-row>\n        <v-col cols=\"12\" class=\"pt-0\">\n            <v-row style=\"margin-bottom: -40px;\">\n                <v-col sm=\"3\">\n                    <label class=\"label\">{{$t('for_the_month_of')}}</label>\n                    <month-picker :initialMonth=\"monthOf\" @emitMonth=\"monthOf = $event\" @onChanged=\"monthOfChange\"/>\n                </v-col>\n                <v-col sm=\"3\">\n                    <v-row class=\"my-3 mr-0\" style=\"padding-top: 12px;\">\n                        <v-col sm=\"3\" cols=\"3\" class=\"pt-0 pr-0\">\n                            <div class=\"code_text text-bold\">{{prefix.abbr}}</div>\n                        </v-col>\n                        <v-col sm=\"7\" cols=\"7\" class=\"pt-0 pl-0 pr-1\">\n                            <v-text-field class=\" custom-border \"\n                                v-model=\"number\"\n                                outlined\n                                :rules=\"[v => !!v || 'Number is required']\"\n                                required\n                                readonly/>\n                        </v-col>\n                        <v-col sm=\"2\" cols=\"2\" class=\"pt-0 px-0\">\n                            <v-icon color=\"black\" size=\"30\" class=\"border_qrcode\"\n                                @click=\"generateNumber\">mdi-qrcode\n                            </v-icon>\n                        </v-col>\n                    </v-row>\n                </v-col>\n                <v-col sm=\"3\">\n                    <label class=\"label\">{{$t('Date')}}</label>\n                    <date-picker :initialDate=\"date\" @emitDate=\"date = $event\"/>\n                </v-col>\n                <v-col sm=\"3\" style=\"text-align: center;\">\n                    <p>{{$t('approved_exch_rate_month')}}</p>\n                    <h2 class=\"primary--text\">{{numberFormat(exchangeRate)}}</h2>\n                </v-col>\n            </v-row>\n            <v-row>\n                <v-col sm=\"3\">\n                    <label>{{$t('employee_group')}}</label>\n                    <v-select class=\"mt-1\"\n                        outlined\n                        :items=\"employeeGroups\"\n                        :item-text=\"item =>`${item.groupCode} - ${item.groupName}`\"\n                        item-value=\"id\"\n                        :disabled=\"disabledG\"\n                        v-model=\"employeeGroup\"\n                        @change=\"employeeGroupChange\"\n                        clearable\n                        tage=\"Business Unit/Branch\"/>\n                </v-col>\n                <v-col sm=\"3\">\n                    <label>{{$t('business_unit_branch')}}</label>\n                    <v-select class=\"mt-1\"\n                        outlined\n                        :disabled=\"disabledL\"\n                        :items=\"location\"\n                        item-text=\"name\"\n                        item-value=\"id\"\n                        v-model=\"locationSelected\"\n                        @change=\"locationChange\"\n                        tage=\"Business Unit/Branch\"\n                        return-object\n                        clearable/>\n                </v-col>\n                <v-col sm=\"3\">\n                    <label>{{$t('department')}}</label>\n                    <v-select class=\"mt-1\"\n                        outlined\n                        :disabled=\"disabled\"\n                        :loading=\"loading\"\n                        :items=\"departments\"\n                        item-text=\"name\"\n                        item-value=\"id\"\n                        v-model=\"department\"\n                        tage=\"Business Unit/Branch\"/>\n                </v-col>\n                <v-col sm=\"3\">\n                    <label>{{$t('nature_of_the_contract')}}</label>\n                    <v-select class=\"mt-1\"\n                        outlined\n                        :disabled=\"disabled\"\n                        :items=\"natureContracts\"\n                        item-text=\"name\"\n                        item-value=\"id\"\n                        v-model=\"natureContract\"\n                        tage=\"Business Unit/Branch\"/>\n                </v-col>\n            </v-row>\n            <v-row>\n                <v-col sm=\"3\" cols=\"12\">\n                    <v-select class=\"mt-1\"\n                        id=\"acc_type_selector\"\n                        :items=\"natureInput\"\n                        item-text=\"name\"\n                        item-value=\"id\"\n                        v-model=\"natureInputSelected\"\n                        @change=\"ChangeNature\"\n                        outlined\n                        clearable/>\n                </v-col>\n                <v-col sm=\"3\" cols=\"12\">\n                    <v-dialog v-model=\"dialogm\" max-width=\"1080px\">\n                        <template v-slot:activator=\"{ on }\">\n                            <!-- <v-card-text :class=\"{'setCardHeight': setCardHeight,'setCardHeightOther': !setCardHeight}\"> -->\n                                <!-- <div v-if=\"natureInputSelected === 'Timecard'\" > -->\n                                    <v-btn :disabled=\"btnEnabled\"  color=\"primary\" style=\"width: 100%;\" class=\"float-right text-capitalize\" v-on=\"on\">\n                                        {{$t('import_timecard')}}\n                                    </v-btn>\n                                <!-- </div> -->\n                            <!-- </v-card-text> -->\n                        </template>\n                        <v-card>\n                            <div class=\"modal_header\">\n                                <v-card-title>{{$t('import_data')}}</v-card-title>\n                                <v-icon  @click=\"dialogm = false\">close</v-icon>\n                            </div>\n                            <v-card-text class=\"modal_text_content\">\n                                <v-row>\n                                    <v-col sm=\"2\" class=\"pr-2 pt-2\">\n                                        <label class=\"label mt-2\">{{$t('location')}}</label>\n                                    </v-col>\n                                    <v-col sm=\"2\" class=\"pl-0\">\n                                    <v-select class=\"mt-1\"\n                                        outlined\n                                        :items=\"location\"\n                                        item-text=\"name\"\n                                        item-value=\"id\"\n                                        v-model=\"locationSelected\"\n                                        tage=\"Business Unit/Branch\"\n                                        return-object/>\n                                    </v-col>\n                                    <v-col sm=\"2\" class=\"pr-2 pt-2\">\n                                        <label class=\"label mt-2\">{{$t('segment')}}</label>\n                                    </v-col>\n                                    <v-col sm=\"2\" class=\"pl-0\">\n                                        <v-select class=\"mt-1\"\n                                        id=\"acc_type_selector\"\n                                        :items=\"segment\"\n                                        item-text=\"name\"\n                                        item-value=\"id\"\n                                        v-model=\"segmentSelected\"\n                                        outlined\n                                        return-object/>\n                                    </v-col>\n                                    <v-col sm=\"2\" class=\"pr-2 pt-2\">\n                                        <label class=\"label mt-3\">{{$t('month_of')}}</label>\n                                    </v-col>\n                                    <v-col sm=\"2\" class=\"pl-0\">\n                                        <month-picker :initialMonth=\"monthOf\" @emitMonth=\"monthOf = $event\"/>\n                                    </v-col>\n                                </v-row>\n                                <v-row>\n                                    <v-col sm=\"3\" cols=\"12\">\n                                        <p>Download file format for import</p>\n                                    </v-col>\n                                    <v-col sm=\"3\" cols=\"12\">\n                                        <v-btn color=\"secondary\" class=\" white--text float-right text-capitalize mr-5\" @click=\"downloadTimeCard\">\n                                            {{$t('file_format')}}\n                                        </v-btn>\n                                    </v-col>\n                                    <v-col sm=\"3\" cols=\"12\">\n                                        <p>Or start importing if you are ready</p>\n                                    </v-col>\n                                    <v-col sm=\"3\" cols=\"12\">\n                                        <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                                            <upload-excel-component :on-success=\"handleSuccess\" :before-upload=\"beforeUpload\" />\n                                        </v-col>\n                                    </v-col>\n                                </v-row>\n                                <v-row>\n                                    <v-col cols=\"12\">\n                                        <kendo-datasource ref=\"dataSourceInput\"\n                                            :data=\"tableData\"/>\n                                        <kendo-grid id=\"gridTimecard\" class=\"grid-function\"\n                                            :data-source-ref=\"'dataSourceInput'\"\n                                            :editable=\"false\"\n                                            :scrollable-virtual=\"true\">\n                                            <kendo-grid-column\n                                                :field=\"'date'\"\n                                                :title=\"$t('date')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= kendo.toString(new Date(date),`yyyy-MM-dd`)#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'employeeId'\"\n                                                :title=\"$t('employee_id')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= employeeId#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'employeeName'\"\n                                                :title=\"$t('employee_name')\"\n                                                :width=\"120\"\n                                                :template=\"'<span>#= employeeName#</span>'\"\n                                                readonly\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'timeTable'\"\n                                                :title=\"$t('time_table')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= timeTable#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'clockedIn'\"\n                                                :title=\"$t('clocked_in')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= kendo.toString(new Date(clockedIn), timeFormat)#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'clockedOut'\"\n                                                :title=\"$t('clocked_out')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= kendo.toString(new Date(clockedOut), timeFormat)#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'overTimeWeekend'\"\n                                                :title=\"$t('over_time_weekend')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= overTimeWeekend#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'overTimeHoliday'\"\n                                                :title=\"$t('over_time_holiday')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= overTimeHoliday#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'overTimeNight'\"\n                                                :title=\"$t('over_time_night')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= overTimeNight#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                            <kendo-grid-column\n                                                :field=\"'work_time'\"\n                                                :title=\"$t('work_time')\"\n                                                :width=\"120\"\n                                                readonly\n                                                :template=\"'<span>#= workTime ? workTime: 0#</span>'\"\n                                                :headerAttributes=\"{style: 'background-color: #EDF1F5'}\"/>\n                                        </kendo-grid>\n                                    </v-col>\n                                </v-row>\n                            </v-card-text>\n                            <v-card-actions class=\"modal_footer\">\n                                <v-btn class=\"btn_cancel\" @click=\"dialogm = false\">{{$t('cancel')}}</v-btn>\n                                <v-btn color=\"primary\" class=\"white--text capitalize\" @click=\"onSaveClose\">\n                                    {{$t('confirm_report')}}\n                                </v-btn>\n                            </v-card-actions>\n                        </v-card>\n                    </v-dialog>\n                </v-col>\n                <v-col sm=\"3\" cols=\"12\">\n                    <v-btn style=\"width: 100%;\" color=\"primary\" @click=\"search()\" class=\" white--text float-right text-capitalize\">\n                        {{$t('search')}}\n                    </v-btn>\n                </v-col>\n            </v-row>\n        </v-col>\n        <v-col cols=\"12\">\n            <kendo-datasource ref=\"dataSourceTimeCard\"\n                :data=\"timeCardLine\"\n                :sort=\"sort\"/>\n            <kendo-grid id=\"gridInput\" class=\"grid-function\"\n                :data-source-ref=\"'dataSourceTimeCard'\"\n                :editable=\"false\"\n                :scrollable-virtual=\"true\"\n                :column-menu=\"false\">\n                <kendo-grid-column\n                    :field=\"'employeeId'\"\n                    :title=\"$t('employee_id')\"\n                    :template=\"'<span>#= employeeId#</span>'\"\n                    readonly\n                    :width=\"150\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"/>\n                <kendo-grid-column\n                    :field=\"'employeeName'\"\n                    :title=\"$t('employee_name')\"\n                    readonly\n                    :width=\"200\"\n                    :template=\"'<span>#= employeeName#</span>'\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"/>\n                <kendo-grid-column\n                    :field=\"'workDay'\"\n                    :title=\"$t('workDay')\"\n                    readonly\n                    :width=\"120\"\n                    :template=\"'<span>#= workDay#</span>'\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"\n                    :attributes=\"{\n                        style: 'text-align: center;'\n                    }\"/>\n                <kendo-grid-column\n                    :field=\"'paidHours'\"\n                    :title=\"$t('work_hours')\"\n                    readonly\n                    :width=\"120\"\n                    :template=\"'<span>#= paidHours#</span>'\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"\n                    :attributes=\"{\n                        style: 'text-align: center;'\n                    }\"/>\n                <kendo-grid-column\n                    :field=\"'overTimeWeekend'\"\n                    :title=\"$t('over_time_weekend')\"\n                    readonly\n                    :template=\"'<span>#= overTimeWeekend#</span>'\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"\n                    :attributes=\"{\n                        style: 'text-align: center;'\n                    }\"/>\n                <kendo-grid-column\n                    :field=\"'overTimeNight'\"\n                    :title=\"$t('over_time_night')\"\n                    readonly\n                    :template=\"'<span>#= overTimeNight || 0#</span>'\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"\n                    :attributes=\"{\n                        style: 'text-align: center;'\n                    }\"/>\n                <kendo-grid-column\n                    :field=\"'overTimeHoliday'\"\n                    :title=\"$t('over_time_holiday')\"\n                    readonly\n                    :template=\"'<span>#= overTimeHoliday#</span>'\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"\n                    :attributes=\"{\n                        style: 'text-align: center;'\n                    }\"/>\n            </kendo-grid>\n        </v-col>\n        <LoadingMe :isLoading=\"showLoading\" :fullPage=\"true\" :myLoading=\"true\"  type=\"loading\"/>\n    </v-row>\n</template>\n<script>\nimport UploadExcelComponent from '@/components/upload_excel/TimeCard.vue';\nimport kendo from \"@progress/kendo-ui\";\nimport TimeCardLine from \"@/scripts/model/TimeCardLine\";\nimport EmployeeModel from '@/scripts/model/Employee'\nimport TimeCard from \"@/scripts/model/TimeCard\";\nimport PayrollRun from \"@/scripts/model/PayrollRun\";\nimport PayrollList from \"@/scripts/model/PayrollList\"\n\nconst instituteHandler = require(\"@/scripts/instituteHandler\")\nconst currencyHandler = require(\"@/scripts/currency/handler/currencyHandler\")\nconst axios \t= require('axios');\nconst timeCardLineModel = new TimeCardLine({})\nconst employeeModel = new EmployeeModel({})\nconst timeCardModel = new TimeCard({})\nconst payrollRunModel = new PayrollRun({})\nconst employeeHandler = require(\"@/scripts/employeeHandler\")\nconst payrollHandler = require(\"@/scripts/payrollHandler\")\nconst locationHandler = require(\"@/scripts/locationHandler\")\nconst settingsHandler = require(\"@/scripts/settingsHandler\")\nconst currencyType = {\n    FUNCTIONAL_CURRENCY: 'fun-c',\n    TRANSACTION_CURRENCY: 'txn-c',\n    REPORTING_CURRENCY: 'rpt-c',\n    TAX_EXCHANGE_CURRENCY: 'tax-c',\n}\n\n/* Cookie */\nconst cookieJS = require(\"@/cookie.js\");\nconst cookie = cookieJS.getCookie();\n\nexport default {\n    props:['propInput'],\n    data: () =>({\n        loading: false,\n        disabled: true,\n        disabledL: false,\n        disabledG: false,\n        showLoading: true,\n        journal_date: \"\",\n        dialogm: false,\n        tableData: [],\n        tableHeader: [],\n        dateFormat: timeCardLineModel.dateFormat,\n        timeFormat: timeCardLineModel.timeFormat,\n        employeeData: [],\n        monthOf: '',\n        date: new Date().toISOString().substr(0, 10),\n        location: [],\n        segment: [],\n        employee: employeeModel,\n        timeCard: timeCardModel,\n        payrollRun: payrollRunModel,\n        locationSelected: '',\n        segmentSelected: '',\n        setCardHeight: false,\n        natureInput:[\n            {name: 'Timesheet'},\n            {name: 'Timecard'},\n            {name: 'Fixed'}\n        ],\n        timeCardLine: [],\n        recordList: [],\n        natureInputSelected:'Fixed',\n        number: '',\n        prefix: '',\n        payNumber: {},\n        result: {},\n        exchangeRate: {},\n        btnEnabled: true,\n        sort:[\n            { field: 'employeeId', dir: 'asc' }\n        ],\n        period: {},\n        loggedUser: {\n            id: cookie.creator,\n            name: cookie.email\n        },\n        baseCurrency: {},\n        departments: [],\n        department: \"\",\n        natureContracts:[\n            {id: \"fixed_duration_contract\", name: \"Fixed Duration Contract\"},\n            {id: \"undetermined_duration_contract\", name: \"Undetermined Duration Contract\"},\n            {id: \"contractd\", name: \"Contracted\"}\n        ],\n        natureContract: \"\",\n        employeeGroups: [],\n        employeeGroup: \"\"\n    }),\n    components: {\n        LoadingMe: () => import(`@/components/Loading`),\n        'upload-excel-component':UploadExcelComponent,\n        'month-picker' : ()=> import('@/components/custom_templates/MonthPicker'),\n        'date-picker' : ()=> import('@/components/custom_templates/DatePickerComponent')\n    },\n    methods: {\n        numberFormat(value){\n            let rate = value.rate\n            return kendo.toString( kendo.parseFloat(1/rate),`n0`)\n        },\n        returnData(data){\n            this.$emit('returnData', data)\n        },\n        ChangeNature() {\n            if (this.natureInputSelected === 'Timecard') {\n                this.btnEnabled = false\n            }else {\n                this.btnEnabled = true\n            }\n        },\n        monthOfChange(){\n            this.generateNumber()\n        },\n        beforeUpload(file) {\n            const isLt1M = file.size / 1024 / 1024 < 1\n            if (isLt1M) {\n                return true\n            }\n            this.$message({\n                message: 'Please do not upload files larger than 1m in size.',\n                type: 'warning'\n            })\n            return false\n        },\n        handleSuccess({ results, header }) {\n            results.forEach(element => {\n                var utc_days  = Math.floor(element.date - 25569);\n                var utc_value = utc_days * 86400;                                        \n                var date_info = new Date(utc_value * 1000);\n                var fractional_day = element.date - Math.floor(element.date) + 0.0000001;\n                var total_seconds = Math.floor(86400 * fractional_day);\n                var seconds = total_seconds % 60;\n                total_seconds -= seconds;\n                var hours = Math.floor(total_seconds / (60 * 60));\n                var minutes = Math.floor(total_seconds / 60) % 60;\n                var current_datetime =  new Date(date_info.getFullYear(), date_info.getMonth(), date_info.getDate(), hours, minutes, seconds);\n                element.date    = current_datetime\n                element.dateFormat = this.dateFormat\n                var utc_days_time_in  = Math.floor(element.clockedIn - 25569);\n                var utc_value_time_in = utc_days_time_in * 86400;                                        \n                var date_info_time_in = new Date(utc_value_time_in * 1000);\n                var fractional_time_in = element.clockedIn - Math.floor(element.clockedIn) + 0.0000001;\n                var total_seconds_time_in = Math.floor(86400 * fractional_time_in);\n                var seconds_time_in = total_seconds_time_in % 60;\n                total_seconds_time_in -= seconds_time_in;\n                var hours_time_in = Math.floor(total_seconds_time_in / (60 * 60));\n                var minutes_time_in = Math.floor(total_seconds_time_in / 60) % 60;\n                var current_time_in =  new Date(date_info_time_in.getFullYear(), date_info_time_in.getMonth(), date_info_time_in.getDate(), hours_time_in, minutes_time_in, seconds_time_in);\n                element.clockedIn    = current_time_in\n\n                var utc_days_time_out  = Math.floor(element.clockedOut - 25569);\n                var utc_value_time_out = utc_days_time_out * 86400;                                        \n                var date_info_time_out = new Date(utc_value_time_out * 1000);\n                var fractional_time_out = element.clockedOut - Math.floor(element.clockedOut) + 0.0000001;\n                var total_seconds_time_out = Math.floor(86400 * fractional_time_out);\n                var seconds_time_out = total_seconds_time_out % 60;\n                total_seconds_time_out -= seconds_time_out;\n                var hours_time_out = Math.floor(total_seconds_time_out / (60 * 60));\n                var minutes_time_out = Math.floor(total_seconds_time_out / 60) % 60;\n                var current_time_out =  new Date(date_info_time_out.getFullYear(), date_info_time_out.getMonth(), date_info_time_out.getDate(), hours_time_out, minutes_time_out, seconds_time_out);\n                element.clockedOut    = current_time_out\n                element.timeFormat  = this.timeFormat\n            });\n            this.tableData = results\n            this.tableHeader = header\n        },\n        onSaveClose(){\n            this.autoCalculate()\n            this.groupBy()\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    let dataTimeCard = {\n                        id:                       this.timeCard.id ? this.timeCard.id : '',\n                        monthOf:                  kendo.toString(new Date(this.monthOf),'yyyy-MM-dd'),\n                        timeCardLine:             this.timeCardLine,\n                        totalWork:                this.totalWork,\n                        totalOverTimeWeekend:     this.totalOverTimeWeekend,\n                        totalOverTimeHoliday:     this.totalOverTimeHoliday,\n                        totalOverTimeNight:       this.totalOverTimeNight,\n                        location:                 this.locationSelected,\n                        locationId:               this.locationSelected.id,\n                        segment:                  this.segmentSelected,\n                        segmentId:                this.segmentSelected.id,\n                        period:                   this.period,\n                    };\n                    payrollHandler.createTimeCard(dataTimeCard).then(response => {\n                        if (response.data.statusCode === 201) {\n                            this.$snotify.success('Success')\n                            this.close()\n                        }\n                    }).catch(e => {\n                        this.$snotify.error('Something went wrong')\n                        this.errors.push(e)\n                    })\n                }, 300);\n            })\n        },\n        autoCalculate() {\n            let ds = this.$refs.dataSourceInput.kendoWidget(),\n            // specificWorks = [],\n            totalWork = 0,\n            totalOverTimeWeekend = 0,\n            totalOverTimeHoliday = 0,\n            totalOverTimeNight   = 0;\n            ds.data().forEach(value => {\n                totalWork += kendo.parseFloat(value.workTime)\n                totalOverTimeWeekend += kendo.parseFloat(value.overTimeWeekend)\n                totalOverTimeHoliday += kendo.parseFloat(value.overTimeHoliday)\n                totalOverTimeNight   += kendo.parseFloat(value.overTimeNight)\n            })\n            this.totalWork              = totalWork\n            this.totalOverTimeWeekend   = totalOverTimeWeekend\n            this.totalOverTimeHoliday   = totalOverTimeHoliday\n            this.totalOverTimeNight     = totalOverTimeNight\n        },\n        groupBy() {\n            let ds = this.$refs.dataSourceInput.kendoWidget();\n            let helper = {};\n            let result = ds.data().reduce(function(r, o) {\n                let key = o.date + '-' + o.employeeId;\n                if(!helper[key]) {\n                    helper[key] = Object.assign({}, o); // create a copy of o\n                    r.push(helper[key]);\n                } else {\n                    helper[key].workTime += o.workTime;\n                }\n                return r;\n            }, []);\n            let lastResult = {}\n            let employees = this.employees\n            let last_result = result.reduce(function(m, n) {\n                let key = n.employeeId\n                if(!lastResult[key]) {\n                    lastResult[key] = Object.assign({}, n); // create a copy of o\n                    m.push(lastResult[key]);\n                } else {\n                    employees.forEach(function(em) {\n                        if(key == em.employeeId){\n                            lastResult[key].workTime += n.workTime;\n                            lastResult[key].employeeUuid  = em.id;\n                        }\n                    });\n                }\n                return m;\n            }, []);\n            let timeCardLine =  last_result.map(n=>{\n                return new TimeCardLine(n)\n            })\n            this.timeCardLine = timeCardLine\n        },\n        async loadEmployee(){\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    this.employees = []\n                    employeeHandler.center().then(res => {\n                        this.showLoading = true\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false\n                            this.employees = res.data.data\n                        }\n                    }).catch()\n                    {\n                        this.showLoading = false\n                    }\n                }, 300)\n            })\n        },\n        close() {\n            this.dialogm = false\n        },\n        async loadLocation() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    locationHandler.list().then(res => {\n                        if(res.data.statusCode === 200){\n                            this.location = res.data.data\n                        }\n                        \n                    })\n                }, 300);\n            })\n        },\n        async loadSegment() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    settingsHandler.getSeg().then(res => {\n                        if(res.data.statusCode === 200){\n                            this.segment = res.data.data        \n                        }\n                    })\n                }, 300);\n            })\n        },\n        // search1(){\n        //     if(this.natureInputSelected == \"Fixed\"){\n        //         let result = this.recordList.filter(n =>n.salaryType ==\"Monthly\" && n.applyOvertime == false && n.locationId == this.locationSelected.id);\n        //         let timeCardList = result.map(index =>{\n        //             return {\n        //                 employeeUuid:               index.employee.id ? index.employee.id: '',\n        //                 salary:                     parseFloat(index.salary),\n        //                 employeeId:                 index.employeeId,\n        //                 bank:                       index.employee.bank ,\n        //                 bankAccount:                index.employee.bankAccount,\n        //                 employeeName:               index.employee.firstName +' '+ index.employee.lastName,\n        //                 natureEmployee:             index.employee.natureEmployee,\n        //                 payrollLiabilitie:          index.employee.payrollLiabilitie,\n        //                 paymentMethod:              index.employee.paymentMethod,\n        //                 employee:                   index.employee,\n        //                 overTimeHoliday:            0,\n        //                 overTimeWeekend:            0,\n        //                 overTimeNight:              0,\n        //                 workDay:                    0,\n        //                 workTime:                   0,\n        //                 benefit:                    index.benefit,\n        //                 totalBenefit:               0 ,\n        //                 currency:                   index.currency ? index.currency: {},\n        //                 location:                   index.location,\n        //                 segment:                    index.segment,\n        //                 salaryType:                 index.salaryType.name,\n        //                 startingTime:               index.startingTime,\n        //                 position:                   index.position,\n        //                 natureContract:             index.natureContract,\n        //                 earning:                    parseFloat(index.salary),\n        //                 paidHours:                  0,\n        //                 deduction:                  0,\n        //                 netPay:                     0,\n        //             }\n        //         })\n        //         this.timeCardLine = timeCardList\n        //     }else{\n        //         let param =  {\n        //             'monthOf':      kendo.toString( new Date(this.monthOf),'yyyy-MM-dd'),\n        //             'selectTime':   this.natureInputSelected\n        //         }\n        //         new Promise(resolve => {\n        //             setTimeout(() => {\n        //                 resolve('resolved');\n        //                 payrollHandler.getTimeCard(param).then(res => {\n        //                     if(res.data.statusCode === 200){\n        //                         let result = res.data.data;\n        //                         if(result.length > 0){\n        //                             if(result[0].timeCardLine.length > 0){\n        //                                 let result_timecard = result[0].timeCardLine;\n        //                                 let result_record = this.recordList.filter(n =>n.applyOvertime == true);\n        //                                 let timeCardList = [];\n        //                                 result_timecard.forEach(function(tc) {\n        //                                     let time_employeeId = tc.employeeId;\n        //                                     let totalBenefit = 0;\n        //                                     let deduction = 0;\n        //                                     let netPay = 0;\n        //                                     const re =  result_record.filter(m => m.employeeId ===  time_employeeId).map(item =>{\n        //                                         item.benefit.forEach(function(b){\n        //                                             if(b.amount){\n        //                                                 totalBenefit += parseFloat(b.amount)\n        //                                             }\n        //                                         }) \n        //                                         let payrollLiabilitie       =  item.employee.payrollLiabilitie\n        //                                         let period = result[0].period\n        //                                         let overTimeNight = tc.overTimeNight * parseFloat(period.overtimeNight)\n        //                                         let overTimeWeekend = tc.overTimeWeekend * parseFloat(period.overtimeForWeekend)\n        //                                         let overTimeHoliday = tc.overTimeHoliday * parseFloat(period.overtimeForNationalHoliday)\n        //                                         let totalHours = tc.workTime + overTimeNight + overTimeWeekend + overTimeHoliday\n        //                                         let totaloverTime = overTimeNight + overTimeWeekend + overTimeHoliday\n        //                                         let workDay = tc.workTime / parseFloat(period.hourPerDay)\n        //                                         let salaryAmount = 0\n        //                                         let salary = parseFloat(item.salary)\n        //                                         if(item.salaryType == \"Monthly\"){\n        //                                             let salaryHours = salary / (parseFloat(period.hourPerDay) * parseFloat(period.workingDay)) \n        //                                             salaryAmount = salary + (salaryHours * totaloverTime)\n        //                                         }else{\n        //                                             salaryAmount = salary * totalHours\n        //                                         }\n        //                                         return {\n        //                                             employeeUuid:               item.employee.id ? item.employee.id: '',\n        //                                             salary:                     salaryAmount,\n        //                                             employeeId:                 tc.employeeId,\n        //                                             bank:                       item.employee.bank ,\n        //                                             bankAccount:                item.employee.bankAccount,\n        //                                             employeeName:               item.employee.firstName +' '+   item.employee.lastName,\n        //                                             natureEmployee:             item.employee.natureEmployee,\n        //                                             payrollLiabilitie:          payrollLiabilitie,\n        //                                             paymentMethod:              item.employee.paymentMethod,\n        //                                             employee:                   item.employee,\n        //                                             overTimeHoliday:            tc.overTimeHoliday,\n        //                                             overTimeWeekend:            tc.overTimeWeekend,\n        //                                             overTimeNight:              tc.overTimeNight,\n        //                                             workDay:                    workDay || 0,\n        //                                             paidHours:                  tc.workTime,\n        //                                             totalWorkinghours:          tc.workTime,\n        //                                             benefit:                    item.benefit,\n        //                                             currency:                   tc.currency ? tc.currency: {},\n        //                                             totalBenefit:               parseFloat(totalBenefit) ,\n        //                                             location:                   item.location,\n        //                                             segment:                    item.segment,\n        //                                             salaryType:                 item.salaryType.name,\n        //                                             startingTime:               item.startingTime,\n        //                                             position:                   item.position,\n        //                                             natureContract:             item.natureContract,\n        //                                             earning:                    parseFloat(item.salary) + parseFloat(totalBenefit),\n        //                                             deduction:                  deduction,\n        //                                             netPay:                     netPay,\n        //                                         }\n        //                                     })\n        //                                     if(re.length >0){\n        //                                         timeCardList.push(re[0])\n        //                                     }\n        //                                 });\n        //                                 this.timeCardLine = timeCardList\n        //                             }else{\n        //                                 let result_record = this.recordList.filter(n =>n.applyOvertime == true);\n        //                                 let timesheet = []\n        //                                 result.forEach(function(tc) {\n        //                                     let time_employee_id = tc.employee.id;\n        //                                     let totalBenefit = 0;\n        //                                     let deduction = 0;\n        //                                     let netPay = 0;\n        //                                     let period = tc.period\n        //                                     // let totalHours = 0\n        //                                     const re =  result_record.filter(m => m.employee_id ===  time_employee_id).map(item =>{\n        //                                         item.benefit.forEach(function(b){\n        //                                             if(b.amount){\n        //                                                 totalBenefit += parseFloat(b.amount)\n        //                                             }\n        //                                         })\n        //                                         let overTimeNight = tc.overTimeNight * parseFloat(period.overtimeNight)\n        //                                         let overtimeHoursWeekend = tc.overtimeHoursWeekend * parseFloat(period.overtimeForWeekend)\n        //                                         let overtimeHoursHoliday = tc.overtimeHoursHoliday * parseFloat(period.overtimeForNationalHoliday)\n        //                                         let totalHours = tc.workingHours + overTimeNight + overtimeHoursWeekend + overtimeHoursHoliday\n        //                                         let workDay = tc.workingHours /parseFloat(tc.period.hourPerDay)\n        //                                         let totaloverTime = overTimeNight + overtimeHoursWeekend + overtimeHoursHoliday\n        //                                         let salary = parseFloat(item.salary)\n        //                                         let salaryAmount = 0\n        //                                         if(item.salaryType == \"Monthly\"){\n        //                                             let salaryHours = salary / (parseFloat(tc.period.hourPerDay) * parseFloat(tc.period.workingDay)) \n        //                                             salaryAmount = salary + (salaryHours * totaloverTime)\n        //                                         }else{\n        //                                             salaryAmount = salary * totalHours\n        //                                         }\n        //                                         return {\n        //                                             employeeUuid:       tc.employee.id,\n        //                                             salary:             salaryAmount,\n        //                                             employeeId:         tc.employee.employeeId,\n        //                                             employee:           tc.employee,\n        //                                             payrollLiabilitie:  tc.employee.payrollLiabilitie,\n        //                                             bank:               tc.employee.bank,\n        //                                             bankAccount:        tc.employee.bankAccount,\n        //                                             paymentMethod:      tc.employee.paymentMethod,\n        //                                             natureEmployee:     tc.employee.natureEmployee,\n        //                                             employeeName:       tc.employee.firstName +' '+   tc.employee.lastName,\n        //                                             overTimeHoliday:    tc.overtimeHoursHoliday,\n        //                                             overTimeWeekend:    tc.overtimeHoursWeekend,\n        //                                             overTimeNight:      tc.overTimeNight,\n        //                                             paidHours:          tc.workingHours,\n        //                                             workingHours:       tc.workingHours,\n        //                                             period:             tc.period,\n        //                                             workDay:            workDay || 0,\n        //                                             benefit:            item.benefit,\n        //                                             totalBenefit:       parseFloat(totalBenefit),\n        //                                             totalWorkinghours:  parseFloat(totalHours),\n        //                                             segment:            item.segment,\n        //                                             location:           item.location,\n        //                                             salaryType:         item.salaryType.name,\n        //                                             startingTime:       item.startingTime,\n        //                                             position:           item.position,\n        //                                             currency:           item.currency ? item.currency: {},\n        //                                             natureContract:     item.natureContract,\n        //                                             earning:            parseFloat(item.salary) + parseFloat(totalBenefit),\n        //                                             deduction:          deduction,\n        //                                             netPay:             netPay,\n        //                                         }\n        //                                     })\n        //                                     if(re.length > 0){\n        //                                         timesheet.push(re[0])\n        //                                     }\n        //                                 })\n        //                                 this.timeCardLine = timesheet\n        //                             }\n        //                         }else{\n        //                             this.timeCardLine = []\n        //                         }\n        //                     }\n        //                 })\n        //             }, 300);\n        //         })\n        //     }\n        // },\n        filterEmployee(){\n            if(this.natureInputSelected == \"Fixed\"){\n                let result = this.recordList.filter(n =>n.salaryType ==\"Monthly\" && n.applyOvertime == false);\n                let timeCardList = result.map(index =>{\n                    return {\n                        employeeUuid:               index.employee.id ? index.employee.id: '',\n                        salary:                     parseFloat(index.salary),\n                        employeeId:                 index.employeeId,\n                        bank:                       index.employee.bank ,\n                        bankAccount:                index.employee.bankAccount,\n                        employeeName:               index.employee.firstName +' '+ index.employee.lastName,\n                        natureEmployee:             index.employee.natureEmployee,\n                        payrollLiabilitie:          index.employee.payrollLiabilitie,\n                        paymentMethod:              index.employee.paymentMethod,\n                        employee:                   index.employee,\n                        overTimeHoliday:            0,\n                        overTimeWeekend:            0,\n                        overTimeNight:              0,\n                        workDay:                    0,\n                        workTime:                   0,\n                        benefit:                    index.benefit,\n                        totalBenefit:               0 ,\n                        currency:                   index.currency ? index.currency: {},\n                        location:                   index.location,\n                        segment:                    index.segment,\n                        salaryType:                 index.salaryType.name,\n                        startingTime:               index.startingTime,\n                        position:                   index.position,\n                        natureContract:             index.natureContract,\n                        earning:                    parseFloat(index.salary),\n                        paidHours:                  0,\n                        deduction:                  0,\n                        netPay:                     0,\n                    }\n                })\n                this.timeCardLine = timeCardList\n                this.showLoading = false;\n            }else{\n                let param =  {\n                    'monthOf':      kendo.toString( new Date(this.monthOf),'yyyy-MM-dd'),\n                    'selectTime':   this.natureInputSelected\n                }\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        payrollHandler.getTimeCard(param).then(res => {\n                            if(res.data.statusCode === 200){\n                                let result = res.data.data;\n                                if(result.length > 0){\n                                    if(result[0].timeCardLine.length > 0){\n                                        let result_timecard = result[0].timeCardLine;\n                                        let result_record = this.recordList.filter(n =>n.applyOvertime == true);\n                                        let timeCardList = [];\n                                        result_timecard.forEach(function(tc) {\n                                            let time_employeeId = tc.employeeId;\n                                            let totalBenefit = 0;\n                                            let deduction = 0;\n                                            let netPay = 0;\n                                            const re =  result_record.filter(m => m.employeeId ===  time_employeeId).map(item =>{\n                                                item.benefit.forEach(function(b){\n                                                    if(b.amount){\n                                                        totalBenefit += parseFloat(b.amount)\n                                                    }\n                                                }) \n                                                let payrollLiabilitie       =  item.employee.payrollLiabilitie\n                                                let period = result[0].period\n                                                let overTimeNight = tc.overTimeNight * parseFloat(period.overtimeNight)\n                                                let overTimeWeekend = tc.overTimeWeekend * parseFloat(period.overtimeForWeekend)\n                                                let overTimeHoliday = tc.overTimeHoliday * parseFloat(period.overtimeForNationalHoliday)\n                                                let totalHours = tc.workTime + overTimeNight + overTimeWeekend + overTimeHoliday\n                                                let totaloverTime = overTimeNight + overTimeWeekend + overTimeHoliday\n                                                let workDay = tc.workTime / parseFloat(period.hourPerDay)\n                                                let salaryAmount = 0\n                                                let salary = parseFloat(item.salary)\n                                                if(item.salaryType == \"Monthly\"){\n                                                    let salaryHours = salary / (parseFloat(period.hourPerDay) * parseFloat(period.workingDay)) \n                                                    salaryAmount = salary + (salaryHours * totaloverTime)\n                                                }else{\n                                                    salaryAmount = salary * totalHours\n                                                }\n                                                return {\n                                                    employeeUuid:               item.employee.id ? item.employee.id: '',\n                                                    salary:                     salaryAmount,\n                                                    employeeId:                 tc.employeeId,\n                                                    bank:                       item.employee.bank ,\n                                                    bankAccount:                item.employee.bankAccount,\n                                                    employeeName:               item.employee.firstName +' '+   item.employee.lastName,\n                                                    natureEmployee:             item.employee.natureEmployee,\n                                                    payrollLiabilitie:          payrollLiabilitie,\n                                                    paymentMethod:              item.employee.paymentMethod,\n                                                    employee:                   item.employee,\n                                                    overTimeHoliday:            tc.overTimeHoliday,\n                                                    overTimeWeekend:            tc.overTimeWeekend,\n                                                    overTimeNight:              tc.overTimeNight,\n                                                    workDay:                    workDay || 0,\n                                                    paidHours:                  tc.workTime,\n                                                    totalWorkinghours:          tc.workTime,\n                                                    benefit:                    item.benefit,\n                                                    currency:                   tc.currency ? tc.currency: {},\n                                                    totalBenefit:               parseFloat(totalBenefit) ,\n                                                    location:                   item.location,\n                                                    segment:                    item.segment,\n                                                    salaryType:                 item.salaryType.name,\n                                                    startingTime:               item.startingTime,\n                                                    position:                   item.position,\n                                                    natureContract:             item.natureContract,\n                                                    earning:                    parseFloat(item.salary) + parseFloat(totalBenefit),\n                                                    deduction:                  deduction,\n                                                    netPay:                     netPay,\n                                                }\n                                            })\n                                            if(re.length >0){\n                                                timeCardList.push(re[0])\n                                            }\n                                        });\n                                        this.timeCardLine = timeCardList\n                                        this.showLoading = false\n                                    }else{\n                                        let result_record = this.recordList.filter(n =>n.applyOvertime == true);\n                                        let timesheet = []\n                                        result.forEach(function(tc) {\n                                            let time_employee_id = tc.employee.id;\n                                            let totalBenefit = 0;\n                                            let deduction = 0;\n                                            let netPay = 0;\n                                            let period = tc.period\n                                            // let totalHours = 0\n                                            const re =  result_record.filter(m => m.employee_id ===  time_employee_id).map(item =>{\n                                                item.benefit.forEach(function(b){\n                                                    if(b.amount){\n                                                        totalBenefit += parseFloat(b.amount)\n                                                    }\n                                                })\n                                                let overTimeNight = tc.overTimeNight * parseFloat(period.overtimeNight)\n                                                let overtimeHoursWeekend = tc.overtimeHoursWeekend * parseFloat(period.overtimeForWeekend)\n                                                let overtimeHoursHoliday = tc.overtimeHoursHoliday * parseFloat(period.overtimeForNationalHoliday)\n                                                let totalHours = tc.workingHours + overTimeNight + overtimeHoursWeekend + overtimeHoursHoliday\n                                                let workDay = tc.workingHours /parseFloat(tc.period.hourPerDay)\n                                                let totaloverTime = overTimeNight + overtimeHoursWeekend + overtimeHoursHoliday\n                                                let salary = parseFloat(item.salary)\n                                                let salaryAmount = 0\n                                                if(item.salaryType == \"Monthly\"){\n                                                    let salaryHours = salary / (parseFloat(tc.period.hourPerDay) * parseFloat(tc.period.workingDay)) \n                                                    salaryAmount = salary + (salaryHours * totaloverTime)\n                                                }else{\n                                                    salaryAmount = salary * totalHours\n                                                }\n                                                return {\n                                                    employeeUuid:       tc.employee.id,\n                                                    salary:             salaryAmount,\n                                                    employeeId:         tc.employee.employeeId,\n                                                    employee:           tc.employee,\n                                                    payrollLiabilitie:  tc.employee.payrollLiabilitie,\n                                                    bank:               tc.employee.bank,\n                                                    bankAccount:        tc.employee.bankAccount,\n                                                    paymentMethod:      tc.employee.paymentMethod,\n                                                    natureEmployee:     tc.employee.natureEmployee,\n                                                    employeeName:       tc.employee.firstName +' '+   tc.employee.lastName,\n                                                    overTimeHoliday:    tc.overtimeHoursHoliday,\n                                                    overTimeWeekend:    tc.overtimeHoursWeekend,\n                                                    overTimeNight:      tc.overTimeNight,\n                                                    paidHours:          tc.workingHours,\n                                                    workingHours:       tc.workingHours,\n                                                    period:             tc.period,\n                                                    workDay:            workDay || 0,\n                                                    benefit:            item.benefit,\n                                                    totalBenefit:       parseFloat(totalBenefit),\n                                                    totalWorkinghours:  parseFloat(totalHours),\n                                                    segment:            item.segment,\n                                                    location:           item.location,\n                                                    salaryType:         item.salaryType.name,\n                                                    startingTime:       item.startingTime,\n                                                    position:           item.position,\n                                                    currency:           item.currency ? item.currency: {},\n                                                    natureContract:     item.natureContract,\n                                                    earning:            parseFloat(item.salary) + parseFloat(totalBenefit),\n                                                    deduction:          deduction,\n                                                    netPay:             netPay,\n                                                }\n                                            })\n                                            if(re.length > 0){\n                                                timesheet.push(re[0])\n                                            }\n                                        })\n                                        this.timeCardLine = timesheet\n                                        this.showLoading = false;\n                                    }\n                                }else{\n                                    this.timeCardLine = []\n                                    this.showLoading = false;\n                                }\n                            }\n                        })\n                    }, 300);\n                })\n            }\n        },\n        async search(){\n            let param ={\n                status:             1,\n                location_id:        this.locationSelected.id || \"\",\n                department_id:      this.department,\n                natureContract_id:  this.natureContract,\n                employeeGroup_id:   this.employeeGroup || ''\n            }\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    this.showLoading = true;\n                    employeeHandler.getRecord(param).then(res => {\n                        this.showLoading = true;\n                        if(res.data.statusCode === 200){\n                            this.recordList = res.data.data\n                            this.showLoading = true;\n                            this.filterEmployee()\n                        }\n                    })\n                }, 300);\n            })\n        },\n        saveNext(){\n            let ds = this.$refs.dataSourceTimeCard.kendoWidget()\n            let totalEmployee = 0;\n            ds.data().forEach(value => {\n                if(value){\n                    totalEmployee += 1\n                }\n            })\n            this.totalEmployee = totalEmployee\n            let dataSource = ds.data()\n            this.payrollList = dataSource.map(index=>{\n                return new PayrollList({\n                    applyOvertime:      index.applyOvertime,\n                    date:               this.date,\n                    benefit:            index.benefit ? index.benefit: [],\n                    employee:           index.employee,\n                    employeeId:         index.employeeId,\n                    employee_id:        index.employee_id,\n                    employeeUuid:       index.employeeUuid,\n                    employeeName:       index.employeeName,\n                    location:           index.location,\n                    natureRecord:       index.natureRecord,\n                    natureSalary:       index.natureSalary,\n                    overTime:           index.overTime,\n                    position:           index.position,\n                    salary:             index.salary,\n                    salary1:            index.salary,\n                    salaryType:         index.salaryType,\n                    totalBenefit:       index.totalBenefit,\n                    segment:            index.segment ? index.segment: [],\n                    startingTime:       index.startingTime,\n                    status:             index.status,\n                    workDay:            index.workDay,\n                    currency:           index.currency,\n                    period:             index.period,\n                    overTimeHoliday:    index.overTimeHoliday,\n                    overTimeWeekend:    index.overTimeWeekend,\n                    overTimeNight:      index.overTimeNight,\n                    workingHours:       index.workingHours,\n                    totalWorkinghours:  index.totalWorkinghours,\n                    paidHours:          index.paidHours,\n                    paymentMethod:      index.paymentMethod,\n                    payrollLiabilitie:  index.payrollLiabilitie,\n                    natureContract:     index.natureContract        \n                })\n            })\n            if(this.payrollList.length > 0 && this.baseCurrency && this.exchangeRate.rate){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        let data = new PayrollRun({\n                            id:                   this.$route.params.id,\n                            location:             this.locationSelected,\n                            monthOf:              kendo.toString(new Date(this.monthOf),'yyyy-MM-dd'),\n                            sequcencing:          parseInt(kendo.toString(new Date(this.monthOf),'yyyy')),\n                            totalEmployee:        this.totalEmployee,\n                            currency:             this.baseCurrency,\n                            exchangeRate:         this.exchangeRate,\n                            date:                 kendo.toString(new Date(this.date),'yyyy-MM-dd'),\n                            payNumber:            this.payNumber,\n                            number:               this.number,\n                            created:              kendo.toString(new Date(),'yyyy-MM-dd'),\n                            lastNumber:           this.lastNumber,\n                            abbr:                 this.payNumber.abbr,\n                            type:                 'payroll',\n                            natureInput:          this.natureInputSelected,\n                            referenceNumber:      this.payNumber.abbr+this.payNumber.numberSeparator + this.number,\n                            payrollList:          this.payrollList,\n                            step:                 2,      \n                            department:           this.department,\n                            natureContract:       this.natureContract,\n                            employeeGroup:        this.employeeGroup,\n                            loggedUser:           this.loggedUser, \n                        });\n                        this.showLoading = true\n                        payrollHandler.createPayroll(data).then(response => {\n                            this.showLoading = true\n                            if (response.data.statusCode === 201) {\n                                this.$snotify.success('Success')\n                                this.loadSuccess(response.data.statusCode)\n                                this.close()\n                            }\n                        }).catch(e => {\n                            this.$snotify.error('Something went wrong')\n                            this.errors.push(e)\n                        })\n                    }, 300);\n                })\n            }else{\n                if(!this.exchangeRate.rate){\n                    this.$snotify.error('Exchange rate not found! please check again')\n                }\n                if(this.payrollList.length == 0){\n                    this.$snotify.error('Data not found please check again')\n                }\n            }\n        },\n        loadSuccess(data){\n            this.$emit('headline',data)\n        },\n        async loadPayrollList(){\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    this.showLoading = true;\n                    payrollHandler.getPayroll(this.$route.params.id).then(res => {\n                        this.showLoading = true;\n                        if(res.data.statusCode === 200){\n                            window.console.log('Rannnnn', res)\n                            const resultPay = res.data.data\n                            if(resultPay.length > 0){                            \n                                this.result = resultPay[0]\n                                this.loadPayrollItem(this.result)\n                                // this.date = resultPay.date\n                                if(this.result.monthOf !== ''){\n                                    this.monthOf = kendo.toString(new Date(this.result.monthOf), \"yyyy-MM\")\n                                    this.generateNumber()\n                                }\n                                this.locationSelected = this.result.location\n                                this.employeeGroup = this.result.employeeGroup\n                                if(this.employeeGroup !== \"\"){\n                                    this.disabledL = true\n                                }\n                            }\n                            this.showLoading = false;\n                        }\n                    })\n                }, 300);\n            })\n        },\n        loadPayrollItem(result){\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    this.employee = []\n                    payrollHandler.getPayrollItem(result.id).then(res => {\n                        this.showLoading = true\n                        if (res.data.statusCode === 200) {\n                            let resutl_item = res.data.data\n                            this.timeCardLine = resutl_item\n                            this.showLoading = false\n                        }\n                    }).catch()\n                    {\n                        this.showLoading = false\n                    }\n                }, 300)\n            })\n        },\n        loadPrefixes() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    settingsHandler.getPrefixes().then(res => {\n                        if (res.data.statusCode === 200) {\n                            let result = res.data.data\n                            this.prefixList = result.filter(p => p.type =='payroll')\n                            this.prefix = this.prefixList[0]\n                            this.payNumber = this.prefix\n                        }\n                    })\n                }, 300)\n            })\n        },\n        generateNumber() {\n            let resultNumber = this.result\n            if(resultNumber.number){\n                this.number     = resultNumber.number\n                this.lastNumber = resultNumber.lastNumber\n                this.payNumber  = resultNumber.payNumber\n            }else{\n                let montOf_format = kendo.toString(new Date(this.monthOf),'yyyy-MM-dd');\n                if(montOf_format == \"\"){\n                    let month_year = kendo.toString(new Date(),'yyyy-MM-dd')\n                    montOf_format = month_year.setDate(1)\n                }\n                let sequcencing = ''\n                if(this.payNumber.sequcencing ==\"Year\"){\n                    sequcencing = new Date(montOf_format).toISOString().substr(0, 4)\n                }else if(this.payNumber.sequcencing ==\"Month\"){\n                    sequcencing = new Date(montOf_format).toISOString().substr(0, 7)\n                }else{\n                    sequcencing = ''\n                }\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        let data = {\n                            abbr:           this.payNumber.abbr,\n                            structure:      this.payNumber.structure,\n                            date:           montOf_format,\n                            type:           'payroll',\n                            pkId:           'par-',\n                            sequcencing:    sequcencing\n                        }\n                        window\n                        payrollHandler.getPrefixNumber(data).then(res => {\n                            this.showLoading = true;\n                            if(res.data.statusCode === 200){\n                                const result = res.data.data\n                                const lastNumber = this.zeroPad(parseInt(result.lastNumber), this.payNumber.format)\n                                const number = result.suffix + this.payNumber.numberSeparator + lastNumber\n                                this.number = number\n                                this.lastNumber = lastNumber\n                                this.showLoading = false;\n                            }\n                        })\n                    }, 300);\n                })\n            }\n        },\n        zeroPad(num, places) {\n            return String(num).padStart(places, '0')\n        },\n        downloadTimeCard(){\n            axios.get('https://s3.ap-southeast-1.amazonaws.com/images.banhji/files/Timecard.xlsx', {\n            // If you forget this, your download will be corrupt.\n                responseType: 'blob'\n            }).then((response) => {\n                const link = document.createElement('a');\n                link.href = window.URL.createObjectURL(\n                    new Blob([response.data])\n                );\n                link.setAttribute('download', 'Timecard.xlsx');\n                document.body.appendChild(link);\n                link.click();\n            }); \n        },\n        async loadBaseCurrency() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    instituteHandler.getOneCompany(cookie.instituteId).then(res => {\n                        this.baseCurrency = res.baseCurrency\n                    })\n                    resolve('resolved');\n                }, 200);\n            });\n        },\n        async loadLastExchangeRate(){\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    let getDate = new Date()\n                    let date_tax_payroll = new Date(getDate.getFullYear(), getDate.getMonth(), 15);\n                    let date = kendo.toString(new Date(date_tax_payroll),'yyyy-MM-dd')\n                    window.console.log(date)\n                    let code = 'KHR'\n                    if (code !== undefined || code !== '') {\n                        this.showLoading = true\n                        currencyHandler.getLastExchangeRateTaxByDate(date, code).then(res => {\n                            if (res.data.statusCode === 200) {\n                                window.console.log(1,res.data)\n                                this.showLoading = false\n                                this.exchangeRate = res.data.data[0]\n                            }\n                        })\n                    }\n\n                }, 300)\n            })\n        },\n        async loadCurrencyData(type) {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    this.showLoading = true\n                    currencyHandler.list(type).then(response => {\n                        if (response.data.statusCode === 200) {\n                            if (type === currencyType.FUNCTIONAL_CURRENCY) {\n                                this.funcCurrencyList = response.data.data\n                            } else if (type === currencyType.TRANSACTION_CURRENCY) {\n                                this.currencyList = response.data.data\n                            }\n                            this.showLoading = false\n                        }\n                    }).catch()\n                    {\n                        this.showLoading = false\n                    }\n                }, 300)\n            })\n        },\n        goBack(){\n            let payroll_id = this.$route.params.id\n            if(payroll_id && this.result.step == 1){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved')\n                        this.showLoading = true\n                        payrollHandler.deleteTransactions(payroll_id).then(response => {\n                            if (response.statusCode === 200) {\n                                this.loadPayrollList()\n                                this.showLoading = false\n                                window.history.go(-1)\n                            }\n                        })\n                    },300)\n                })\n            }else{\n                window.history.go(-1)\n            }\n        },\n        async loadPeriod(){\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    payrollHandler.getPeriiod().then(res => {\n                        this.period = res[0]\n                    })\n                }, 300);\n            })\n        },\n        locationChange(){\n            let location = this.locationSelected\n            window.console.log('location',location)\n            if(location !== null){\n                this.disabledG = true\n                this.loading = true\n                this.disabled = false\n                window.console.log(1, location)\n                this.loadDepartment(location.id)\n            }else{\n                this.department = \"\"\n                this.natureContract = \"\"\n                this.disabledG = false\n                this.disabled = true\n                this.loading = false \n                \n\n                window.console.log(2, location)\n            }\n        },\n        async loadDepartment(location_id){\n            let param = {\n                location_id: location_id\n            }\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    payrollHandler.getDepartment(param).then(res => {\n                        this.departments = res\n                        if(this.departments.length > 0){\n                            this.loading = false\n                        }\n                    })\n                }, 300);\n            })\n        },\n        async loadGroup(){\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    payrollHandler.getGroup().then(res => {\n                        this.employeeGroups = res.data\n                    })\n                }, 300);\n            })\n        },\n        employeeGroupChange (){\n            if(this.employeeGroup){\n                this.disabledL = true\n            }else{\n                this.disabledL = false\n            }\n        }\n    },\n    async mounted() {\n        await this.loadPeriod()\n        await this.loadPayrollList()\n        await this.loadEmployee()\n        await this.loadLocation()\n        await this.loadSegment()\n        // await this.loadRecord()\n        await this.loadPrefixes()\n        await this.loadBaseCurrency()\n        await this.loadLastExchangeRate()\n        await this.loadGroup()\n        await this.loadCurrencyData(currencyType.TRANSACTION_CURRENCY)\n    },\n    watch: {\n        propInput(){\n            if (this.propInput !== undefined) {\n                this.loadPayrollList()\n                this.loadLastExchangeRate()\n            }\n        }\n    },\n}\n</script>\n<style scoped>\n    .grayBg{\n        background-color: #F8F8F9;\n    }\n    .my_table_darkv .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr > th {\n        color: rgba(0, 0, 0, 0.6);\n        background: #222a35;\n        color: #fff !important;\n    }"]}]}