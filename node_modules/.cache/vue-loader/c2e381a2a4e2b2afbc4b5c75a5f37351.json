{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/budgeting/insight/ForecastCashFlow.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/budgeting/insight/ForecastCashFlow.vue","mtime":1638499443145},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGltcG9ydCB7aTE4bn0gZnJvbSAiQC9pMThuIjsKaW1wb3J0IGtlbmRvIGZyb20gIkBwcm9ncmVzcy9rZW5kby11aSI7CmltcG9ydCBIZWxwZXIgZnJvbSAiQC9oZWxwZXIuanMiOwppbXBvcnQgQWNjb3VudE1vZGVsIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9BY2NvdW50LmpzIjsKCmNvbnN0IFRyaWFsQmFsYW5jZUhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvaGFuZGxlci9hY2NvdW50aW5nL3RyaWFsQmFsYW5jZUhhbmRsZXIiKTsKY29uc3QgQnVkZ2V0SGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9oYW5kbGVyL3dvcmtpbmdjYXBpdGFsL2J1ZGdldEhhbmRsZXIiKTsKY29uc3QgQWNjb3VudFR5cGVDb2RlID0gcmVxdWlyZSgiQC9zY3JpcHRzL2RlZmF1bHRfc2V0dXAvQWNjb3VudFR5cGVDb2RlLmpzIik7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkJ1ZGdldFZhcmlhbmNlcyIsCiAgY29tcG9uZW50czogewogICAgTG9hZGluZ01lOiAoKSA9PiBpbXBvcnQoIkAvY29tcG9uZW50cy9Mb2FkaW5nIiksCiAgfSwKICBkYXRhOiAoKSA9PiAoewogICAgY2FzaEJhbGFuY2U6IDAsCiAgICBleHBlY3RlZER1ZTogMCwKICAgIHBheWFibGVUb1BheTogMCwKICAgIGJ1ZGdldGVkRXhwZW5zZTogMCwKICAgIGZvcmVjYXN0ZWRCYWxhbmNlOiAwLAogICAgLy8gTG9hZGluZ01lCiAgICBzaG93TG9hZGluZzogZmFsc2UsCiAgfSksCiAgbWV0aG9kczogewogICAgYXN5bmMgbG9hZERhdGEoKSB7CiAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwoKICAgICAgLy8gTG9hZCBBY2NvdW50IExpc3QKICAgICAgbGV0IGFjY291bnRzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImFjY291bnRpbmcvZ2V0QWNjb3VudHMiKTsKCiAgICAgIGxldCBjYXNoQmFsYW5jZSA9IDAsCiAgICAgICAgZXhwZWN0ZWREdWVBbW91bnQgPSAwLAogICAgICAgIHBheWFibGVUb1BheUFtb3VudCA9IDAsCiAgICAgICAgYnVkZ2V0ZWRFeHBlbnNlQW1vdW50ID0gMDsKCiAgICAgIC8qIFNldCBDdXJyZW50IEZpc2NhbCBEYXRlICovCiAgICAgIGxldCBjdXJyZW5jeUZpc2NhbERhdGUgPSBIZWxwZXIuZ2V0RmlzY2FsRGF0ZUJ5RGF0ZShuZXcgRGF0ZSgpKTsKCiAgICAgIC8qIFRyaWFsIEJhbGFuY2UgKi8KICAgICAgbGV0IHRyaWFsQmFsYW5jZXMgPSBhd2FpdCBUcmlhbEJhbGFuY2VIYW5kbGVyCiAgICAgICAgICAuZ2V0VHJpYWxCYWxhbmNlKHsKICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgYXNfb2ZfZGF0ZToKICAgICAgICAgICAgICAgIGtlbmRvLnRvU3RyaW5nKG5ldyBEYXRlKCksICJ5eXl5LU1NLWRkIikgKyAiVDIzOjU5OjU5Ljk5OVoiLAogICAgICAgICAgICB9LAogICAgICAgICAgfSkKCiAgICAgIHRyaWFsQmFsYW5jZXMuZGF0YS50YmRldGFpbHMuZm9yRWFjaCgodmFsdWUpID0+IHsKICAgICAgICBsZXQgYW10ID0gdmFsdWUuYmFsYW5jZTsKICAgICAgICBpZiAodmFsdWUuYWNjb3VudC5hY2NvdW50X3R5cGUubmF0dXJlLnRvTG93ZXJDYXNlKCkgPT09ICJjciIpIHsKICAgICAgICAgIGFtdCA9IHZhbHVlLmJhbGFuY2UgKiAtMTsKICAgICAgICB9CgogICAgICAgIC8qIENhc2ggQmFsYW5jZSAqLwogICAgICAgIGlmKH5BY2NvdW50VHlwZUNvZGUuQ0FTSF9BQ0NPVU5UUy5pbmRleE9mKHZhbHVlLmFjY291bnQuYWNjb3VudF90eXBlLm51bWJlcikpewogICAgICAgICAgY2FzaEJhbGFuY2UgKz0ga2VuZG8ucGFyc2VGbG9hdChhbXQpOwogICAgICAgIH0KCiAgICAgICAgLyogRXhwZWN0ZWQgRHVlICovCiAgICAgICAgaWYodmFsdWUuYWNjb3VudC5hY2NvdW50X3R5cGUubnVtYmVyID09PSBBY2NvdW50VHlwZUNvZGUuQUNDT1VOVF9SRUNFSVZBQkxFKXsKICAgICAgICAgIGV4cGVjdGVkRHVlQW1vdW50ICs9IGtlbmRvLnBhcnNlRmxvYXQoYW10KTsKICAgICAgICB9CgogICAgICAgIC8qIFBheWFibGUgVG8gUGF5ICovCiAgICAgICAgaWYodmFsdWUuYWNjb3VudC5hY2NvdW50X3R5cGUubnVtYmVyID09PSBBY2NvdW50VHlwZUNvZGUuQUNDT1VOVF9QQVlBQkxFKXsKICAgICAgICAgIHBheWFibGVUb1BheUFtb3VudCArPSBrZW5kby5wYXJzZUZsb2F0KGFtdCk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8qIEdlbmVyYXRlIE1vbnRocyAqLwogICAgICB0aGlzLmZpc2NhbE1vbnRocyA9IEhlbHBlci5nZW5lcmF0ZUZpc2NhbE1vbnRocygKICAgICAgICBjdXJyZW5jeUZpc2NhbERhdGUuc3RhcnRfZGF0ZSwKICAgICAgICBjdXJyZW5jeUZpc2NhbERhdGUuZW5kX2RhdGUsCiAgICAgICAgIjEyIgogICAgICApOwoKICAgICAgLyogRmluZCBpbmRleCBvZiBzZWxlY3RlZCBtb250aCAqLwoJCQlsZXQgbW9udGhPZkZvcm1hdGVkID0ga2VuZG8udG9TdHJpbmcobmV3IERhdGUoKSwgIk1NTSB5eXl5IiksCiAgICAgICAgICBtb250aE9mSW5kZXggPSB0aGlzLmZpc2NhbE1vbnRocy5pbmRleE9mKG1vbnRoT2ZGb3JtYXRlZCk7CgogICAgICAvKiBCdWRnZXQgKi8KICAgICAgbGV0IGJ1ZGdldHMgPSBhd2FpdCBCdWRnZXRIYW5kbGVyLmdldEJ1ZGdldEZvckNvbnNvbGlkYXRlKHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGZpc2NhbF95ZWFyX3V1aWQ6IGN1cnJlbmN5RmlzY2FsRGF0ZS51dWlkLAogICAgICAgIH0sCiAgICAgIH0pOwoKICAgICAgYnVkZ2V0cy5kYXRhLmxpbmVzLmZvckVhY2goKHZhbHVlKSA9PiB7CiAgICAgICAgLyogU2V0IEFjY291bnQgSW5mb3JtYXRpb24gKi8KICAgICAgICBsZXQgYWNjb3VudCA9IG5ldyBBY2NvdW50TW9kZWwoCiAgICAgICAgICBhY2NvdW50cy5maW5kKChpdGVtKSA9PiBpdGVtLnV1aWQgPT09IHZhbHVlLmFjY291bnRfdXVpZCkKICAgICAgICApOwoKICAgICAgICAvKiBSZXZlcnNlIE5hdHVyZSAqLwogICAgICAgIGxldCBuYXR1cmUgPSAxOwogICAgICAgIGlmIChhY2NvdW50LmFjY291bnRfdHlwZS5uYXR1cmUudG9Mb3dlckNhc2UoKSA9PT0gImNyIikgewogICAgICAgICAgbmF0dXJlID0gLTE7CiAgICAgICAgfQoKICAgICAgICAvKiBCdWRnZXQgRXhwZW5zZXMgKi8KICAgICAgICBpZiAofkFjY291bnRUeXBlQ29kZS5QTF9FWFBFTlNFUy5pbmRleE9mKGFjY291bnQuYWNjb3VudF90eXBlLm51bWJlcikpIHsKICAgICAgICAgIGxldCBjdXJyZW50TW9udGggPSB2YWx1ZS5tb250aGx5X2Ftb3VudFttb250aE9mSW5kZXhdOwogICAgICAgICAgYnVkZ2V0ZWRFeHBlbnNlQW1vdW50ICs9IGtlbmRvLnBhcnNlRmxvYXQoY3VycmVudE1vbnRoLmFtb3VudCAqIG5hdHVyZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgLyogRW5kIEJ1ZGdldCAqLwoKICAgICAgLyogQmluZCBEYXRhICovCiAgICAgIHRoaXMuY2FzaEJhbGFuY2UgPSBrZW5kby50b1N0cmluZyhjYXNoQmFsYW5jZSwgIm4iKTsKICAgICAgdGhpcy5leHBlY3RlZER1ZSA9IGtlbmRvLnRvU3RyaW5nKGV4cGVjdGVkRHVlQW1vdW50LCAibiIpOwogICAgICB0aGlzLnBheWFibGVUb1BheSA9IGtlbmRvLnRvU3RyaW5nKHBheWFibGVUb1BheUFtb3VudCwgIm4iKTsKICAgICAgdGhpcy5idWRnZXRlZEV4cGVuc2UgPSBrZW5kby50b1N0cmluZyhidWRnZXRlZEV4cGVuc2VBbW91bnQsICJuIik7CgogICAgICB0aGlzLmZvcmVjYXN0ZWRCYWxhbmNlID0ga2VuZG8udG9TdHJpbmcoKGNhc2hCYWxhbmNlICsgZXhwZWN0ZWREdWVBbW91bnQpIC0gKHBheWFibGVUb1BheUFtb3VudCArIGJ1ZGdldGVkRXhwZW5zZUFtb3VudCksICJuIik7CgogICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICB9LAogICAgLyogRmluZCBWYXJpYW5jZSBQZXJjZW50YWdlICovCiAgICBmaW5kVmFyaWFuY2VQZXJjZW50YWdlKG51bTEsIG51bTIpIHsKICAgICAgbGV0IGFtdCA9IDA7CiAgICAgIGlmIChudW0yICE9PSAwKSB7CiAgICAgICAgYW10ID0gbnVtMSAvIG51bTI7CiAgICAgIH0KCiAgICAgIHJldHVybiBrZW5kby50b1N0cmluZyhhbXQsICJwIik7CiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMubG9hZERhdGEoKTsKICB9LAp9Owo="},{"version":3,"sources":["ForecastCashFlow.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ForecastCashFlow.vue","sourceRoot":"src/views/budgeting/insight","sourcesContent":["<template>\n  <div>\n    <LoadingMe\n        type=\"loading\"\n        :isLoading=\"showLoading\"\n        :myLoading=\"true\"\n        :fullPage=\"false\"\n      />\n    <v-simple-table>\n      <template>\n        <tbody>\n          <tr>\n            <td class=\"text-left\">\n              <span class=\"niradei_medium font_14 grey--text\">\n                {{ $t(\"cash_balance\") }}\n              </span>\n            </td>\n            <td class=\"text-right\">\n              <span class=\"niradei_heavy font_18 dark_grey\">\n                {{ cashBalance }}\n              </span>\n            </td>\n          </tr>\n          <tr>\n            <td class=\"text-left\">\n              <span class=\"niradei_medium font_14 grey--text\">\n                {{ $t(\"expected_due\") }}\n              </span>\n            </td>\n            <td class=\"text-right\">\n              <span class=\"niradei_heavy font_18 dark_grey\">\n                {{ expectedDue }}\n              </span>\n            </td>\n          </tr>\n          <tr>\n            <td class=\"text-left\">\n              <span class=\"niradei_medium font_14 grey--text\">\n                {{ $t(\"payable_to_pay\") }}\n              </span>\n            </td>\n            <td class=\"text-right\">\n              <span class=\"niradei_heavy font_18 dark_grey\">\n                {{ payableToPay }}\n              </span>\n            </td>\n          </tr>\n          <tr>\n            <td class=\"text-left\">\n              <span class=\"niradei_medium font_14 grey--text\">\n                {{ $t(\"budgeted_expense\") }}\n              </span>\n            </td>\n            <td class=\"text-right\">\n              <span class=\"niradei_heavy font_18 dark_grey\">\n                {{ budgetedExpense }}\n              </span>\n            </td>\n          </tr>\n          <tr class=\"light-green--text\">\n            <td class=\"text-left\">\n              <span class=\"niradei_medium font_14 grey--text\">\n                {{ $t(\"forecasted_balance\") }}\n              </span>\n            </td>\n            <td class=\"text-right\">\n              <span class=\"niradei_heavy font_18 dark_grey\">\n                {{ forecastedBalance }}\n              </span>\n            </td>\n          </tr>\n        </tbody>\n      </template>\n    </v-simple-table>\n  </div>\n</template>\n\n<script>\n// import {i18n} from \"@/i18n\";\nimport kendo from \"@progress/kendo-ui\";\nimport Helper from \"@/helper.js\";\nimport AccountModel from \"@/scripts/model/Account.js\";\n\nconst TrialBalanceHandler = require(\"@/scripts/handler/accounting/trialBalanceHandler\");\nconst BudgetHandler = require(\"@/scripts/handler/workingcapital/budgetHandler\");\nconst AccountTypeCode = require(\"@/scripts/default_setup/AccountTypeCode.js\");\n\nexport default {\n  name: \"BudgetVariances\",\n  components: {\n    LoadingMe: () => import(\"@/components/Loading\"),\n  },\n  data: () => ({\n    cashBalance: 0,\n    expectedDue: 0,\n    payableToPay: 0,\n    budgetedExpense: 0,\n    forecastedBalance: 0,\n    // LoadingMe\n    showLoading: false,\n  }),\n  methods: {\n    async loadData() {\n      this.showLoading = true;\n\n      // Load Account List\n      let accounts = await this.$store.dispatch(\"accounting/getAccounts\");\n\n      let cashBalance = 0,\n        expectedDueAmount = 0,\n        payableToPayAmount = 0,\n        budgetedExpenseAmount = 0;\n\n      /* Set Current Fiscal Date */\n      let currencyFiscalDate = Helper.getFiscalDateByDate(new Date());\n\n      /* Trial Balance */\n      let trialBalances = await TrialBalanceHandler\n          .getTrialBalance({\n            params: {\n              as_of_date:\n                kendo.toString(new Date(), \"yyyy-MM-dd\") + \"T23:59:59.999Z\",\n            },\n          })\n\n      trialBalances.data.tbdetails.forEach((value) => {\n        let amt = value.balance;\n        if (value.account.account_type.nature.toLowerCase() === \"cr\") {\n          amt = value.balance * -1;\n        }\n\n        /* Cash Balance */\n        if(~AccountTypeCode.CASH_ACCOUNTS.indexOf(value.account.account_type.number)){\n          cashBalance += kendo.parseFloat(amt);\n        }\n\n        /* Expected Due */\n        if(value.account.account_type.number === AccountTypeCode.ACCOUNT_RECEIVABLE){\n          expectedDueAmount += kendo.parseFloat(amt);\n        }\n\n        /* Payable To Pay */\n        if(value.account.account_type.number === AccountTypeCode.ACCOUNT_PAYABLE){\n          payableToPayAmount += kendo.parseFloat(amt);\n        }\n      });\n\n      /* Generate Months */\n      this.fiscalMonths = Helper.generateFiscalMonths(\n        currencyFiscalDate.start_date,\n        currencyFiscalDate.end_date,\n        \"12\"\n      );\n\n      /* Find index of selected month */\n\t\t\tlet monthOfFormated = kendo.toString(new Date(), \"MMM yyyy\"),\n          monthOfIndex = this.fiscalMonths.indexOf(monthOfFormated);\n\n      /* Budget */\n      let budgets = await BudgetHandler.getBudgetForConsolidate({\n        params: {\n          fiscal_year_uuid: currencyFiscalDate.uuid,\n        },\n      });\n\n      budgets.data.lines.forEach((value) => {\n        /* Set Account Information */\n        let account = new AccountModel(\n          accounts.find((item) => item.uuid === value.account_uuid)\n        );\n\n        /* Reverse Nature */\n        let nature = 1;\n        if (account.account_type.nature.toLowerCase() === \"cr\") {\n          nature = -1;\n        }\n\n        /* Budget Expenses */\n        if (~AccountTypeCode.PL_EXPENSES.indexOf(account.account_type.number)) {\n          let currentMonth = value.monthly_amount[monthOfIndex];\n          budgetedExpenseAmount += kendo.parseFloat(currentMonth.amount * nature);\n        }\n      });\n      /* End Budget */\n\n      /* Bind Data */\n      this.cashBalance = kendo.toString(cashBalance, \"n\");\n      this.expectedDue = kendo.toString(expectedDueAmount, \"n\");\n      this.payableToPay = kendo.toString(payableToPayAmount, \"n\");\n      this.budgetedExpense = kendo.toString(budgetedExpenseAmount, \"n\");\n\n      this.forecastedBalance = kendo.toString((cashBalance + expectedDueAmount) - (payableToPayAmount + budgetedExpenseAmount), \"n\");\n\n      this.showLoading = false;\n    },\n    /* Find Variance Percentage */\n    findVariancePercentage(num1, num2) {\n      let amt = 0;\n      if (num2 !== 0) {\n        amt = num1 / num2;\n      }\n\n      return kendo.toString(amt, \"p\");\n    },\n  },\n  mounted() {\n    this.loadData();\n  },\n};\n</script>\n\n<style scoped>\n.theme--light.v-data-table {\n  background-color: transparent !important;\n}\n\n.v-data-table > .v-data-table__wrapper > table > tbody > tr > td {\n  height: 32px !important;\n  border-bottom: thin solid rgba(0, 0, 0, 0.12);\n}\n\n.v-data-table.average_sale > .v-data-table__wrapper > table > tbody > tr > td {\n  height: 50px !important;\n}\n\n.v-data-table.collection_day\n  > .v-data-table__wrapper\n  > table\n  > tbody\n  > tr\n  > td {\n  height: 42px !important;\n}\n\n.theme--light.v-data-table\n  > .v-data-table__wrapper\n  > table\n  > tbody\n  > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {\n  background-color: transparent !important;\n}\n\n.theme--light.v-data-table\n  > .v-data-table__wrapper\n  > table\n  > tbody\n  > tr.third:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {\n  background-color: #898c8f !important;\n}\n</style>\n"]}]}