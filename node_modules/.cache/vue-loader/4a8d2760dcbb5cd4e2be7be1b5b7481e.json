{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/products/production/production_orders/ProductionOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/products/production/production_orders/ProductionOrder.vue","mtime":1642155812700},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEYXRlUGlja2VyQ29tcG9uZW50IGZyb20gIkAvY29tcG9uZW50cy9jdXN0b21fdGVtcGxhdGVzL0RhdGVQaWNrZXJDb21wb25lbnQiOwppbXBvcnQgeyBEcm9wRG93bkxpc3QgfSBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdnVlLWRyb3Bkb3ducyI7CmltcG9ydCBQcm9kdWN0aW9uT3JkZXIgZnJvbSAiQC9zY3JpcHRzL21vZGVsL1Byb2R1Y3Rpb25PcmRlciI7CmltcG9ydCBrZW5kbyBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdWkiOwppbXBvcnQge1Nob3dSZXNvdXJjZX0gZnJvbSAiQC9vYnNlcnZhYmxlL3N0b3JlIjsKaW1wb3J0IEJvbU1vZGVsIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9Cb20iOwppbXBvcnQgdW9tUHJpY2VIYW5kbGVyIGZyb20gIkAvc2NyaXB0cy91b21QcmljZUhhbmRsZXIiOwppbXBvcnQgJCBmcm9tICJqcXVlcnkiOwovLyBpbXBvcnQge3V1aWR9IGZyb20gInZ1ZS11dWlkIjsKCmNvbnN0IHByb2R1Y3RWYXJpYW50SGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9wcm9kdWN0VmFyaWFudEhhbmRsZXIiKTsKY29uc3Qgd2FyZWhvdXNlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy93YXJlaG91c2VIYW5kbGVyIik7CmNvbnN0IGJvbUhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvYm9tSGFuZGxlciIpOwpjb25zdCBzZXR0aW5nc0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvc2V0dGluZ3NIYW5kbGVyIik7CmNvbnN0IHNhbGVDaGFubmVsSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9zYWxlQ2hhbm5lbEhhbmRsZXIiKTsKY29uc3QgbG9jYXRpb25IYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2xvY2F0aW9uSGFuZGxlciIpOwpjb25zdCBwcm9qZWN0SGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9wcm9qZWN0SGFuZGxlciIpOwpjb25zdCBwcmVmaXhIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3ByZWZpeEhhbmRsZXIiKTsKY29uc3QgYmlsbGluZ0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvaW52b2ljZS9oYW5kbGVyL2JpbGxpbmdIYW5kbGVyIik7CmNvbnN0IHByb2R1Y3Rpb25PcmRlckhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvcHJvZHVjdGlvbk9yZGVySGFuZGxlciIpOwpjb25zdCBrZXlGaWVsZCA9ICJpZCI7CmNvbnN0IHRleHRGaWVsZCA9ICJuYW1lIjsKY29uc3QgZW1wdHlJdGVtID0ge1t0ZXh0RmllbGRdOiAibG9hZGluZyAuLi4ifTsKY29uc3QgYm9tTW9kZWwgPSBuZXcgQm9tTW9kZWwoe30pOwovLyBjb25zdCAkID0gcmVxdWlyZSgianF1ZXJ5IikKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIlByb2R1Y3Rpb25PcmRlciIsCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgTG9hZGluZ01lOiAoKSA9PiBpbXBvcnQoYEAvY29tcG9uZW50cy9Mb2FkaW5nYCksCiAgICAgICAgImFwcC1kYXRlcGlja2VyIjogRGF0ZVBpY2tlckNvbXBvbmVudCwKICAgICAgICBkcm9wZG93bmxpc3Q6IERyb3BEb3duTGlzdCwKICAgIH0sCiAgICBkYXRhOiAoKSA9PiAoewogICAgICAgIGlzRWRpdDogZmFsc2UsCiAgICAgICAgc2hvd0xvYWRpbmc6IGZhbHNlLAogICAgICAgIGxvYWRpbmdBbGVydDogZmFsc2UsCiAgICAgICAgYWxlcnQ6IGZhbHNlLAogICAgICAgIHZhbGlkOiB0cnVlLAogICAgICAgIHRlbXBsYXRlczogWwogICAgICAgICAgICB7dGl0bGU6ICJEcmFmdCJ9LAogICAgICAgICAgICB7dGl0bGU6ICJPcGVuIn0sCiAgICAgICAgICAgIHt0aXRsZTogIlBhaWQifSwKICAgICAgICAgICAge3RpdGxlOiAiUGFydGlhbGx5IFBhaWQifSwKICAgICAgICBdLAogICAgICAgIGlzSGlkZUJhcjogZmFsc2UsCiAgICAgICAgcHJvZHVjdEJhc2VVcmw6IHByb2R1Y3RWYXJpYW50SGFuZGxlci5pdGVtU2VhcmNoVVJMKCksCiAgICAgICAgcHJvZHVjdExpc3Q6IFtdLAogICAgICAgIGRhdGFJdGVtS2V5OiAiaWQiLAogICAgICAgIHRleHRGaWVsZDogIm5hbWUiLAogICAgICAgIGRlZmF1bHRJdGVtOiB7W3RleHRGaWVsZF06ICJTZWxlY3QgcHJvZHVjdC4uLiIsIFtrZXlGaWVsZF06IG51bGx9LAogICAgICAgIHJlcXVlc3RTdGFydGVkOiBmYWxzZSwKICAgICAgICBwcm9kdWN0aW9uT3JkZXI6IG5ldyBQcm9kdWN0aW9uT3JkZXIoe30pLAogICAgICAgIGJvbTogYm9tTW9kZWwsCiAgICAgICAgcHJvamVjdHM6IFtdLAogICAgICAgIGJvbXM6IFtdLAogICAgICAgIGJvbVNlbGV0ZWQ6IHt9LAogICAgICAgIHlpZWxkVW9tczogW10sCiAgICAgICAgd2FyZWhvdXNlczogW10sCiAgICAgICAgd2FyZWhvdXNlOiB7fSwKICAgICAgICBzZWdtZW50czogW10sCiAgICAgICAgc2FsZUNoYW5uZWxMaXN0OiBbXSwKICAgICAgICBsb2NhdGlvbnM6IFtdLAogICAgICAgIHRyYW5zYWN0aW9uVHlwZXM6IFtdLAogICAgICAgIHVvbTogIiIsCiAgICAgICAgdHJhbnNhY3Rpb25Ob3RlOiAiIiwKICAgICAgICBjb21wb25lbnRVc2VkRGF0YTogW10sCiAgICAgICAgb3RoZXJGaW5pc2hQcm9kdWN0RGF0YTogW10sCiAgICAgICAgdG90YWxDb3N0OiAwLAogICAgICAgIHZhcmlhbmNlOiAwLAogICAgICAgIGRlY2ltYWxGb3JtYXQ6IDIsCiAgICB9KSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBudW1iZXJGb3JtYXQodmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIGtlbmRvLnRvU3RyaW5nKHZhbHVlLCBgbiR7dGhpcy5kZWNpbWFsRm9ybWF0fWApOwogICAgICAgIH0sCiAgICAgICAgaXRlbVRlbXBsYXRlKGRhdGFJdGVtKSB7CiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkYXRhSXRlbS5pdGVtOwogICAgICAgICAgICBpZiAoaXRlbSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke2l0ZW0ubmFtZSA/IGl0ZW0ubmFtZSA6IGBgfTwvc3Bhbj5gOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGBgOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBVT01UZW1wbGF0ZShkYXRhSXRlbSkgewogICAgICAgICAgICBjb25zdCB1b20gPSBkYXRhSXRlbS5idW9tOwogICAgICAgICAgICBpZiAodW9tKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYDxzcGFuPiR7dW9tLm5hbWUgPyB1b20ubmFtZSA6IGBgfTwvc3Bhbj5gOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGBgOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBIZWxwKGtleV9zZWFyY2gpIHsKICAgICAgICAgICAgU2hvd1Jlc291cmNlKGtleV9zZWFyY2gpOwogICAgICAgIH0sCiAgICAgICAgb25DaGFuZ2VRdHkoKSB7CiAgICAgICAgICAgIGNvbnN0IHByb2R1Y2VRdHkgPSB0aGlzLnByb2R1Y3Rpb25PcmRlci5xdHk7CiAgICAgICAgICAgIGxldCBmcEFtb3VudCA9IDA7CiAgICAgICAgICAgIGNvbnN0IGZpbmlzaFByb2R1Y3QgPSB0aGlzLmJvbVNlbGV0ZWQuZmluaXNoUHJvZHVjdCB8fCBbXTsKICAgICAgICAgICAgZmluaXNoUHJvZHVjdC5tYXAoKG4pID0+IHsKICAgICAgICAgICAgICAgIGlmICghbi5oYXNPd25Qcm9wZXJ0eSgiZGVjaW1hbEZvcm1hdCIpKSB7CiAgICAgICAgICAgICAgICAgICAgblsiZGVjaW1hbEZvcm1hdCJdID0gIm4yIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHlRdHkgPSBuLnlpZWxkUXR5ICoga2VuZG8ucGFyc2VGbG9hdChwcm9kdWNlUXR5KTsKICAgICAgICAgICAgICAgIGNvbnN0IGlDb3N0ID0gbi5jb3N0OwogICAgICAgICAgICAgICAgY29uc3QgYW1vdW50ID0gaUNvc3QgKiB5UXR5OwogICAgICAgICAgICAgICAgblsieWllbGRRdHkiXSA9IHlRdHk7CiAgICAgICAgICAgICAgICBuWyJhbW91bnQiXSA9IGFtb3VudDsKICAgICAgICAgICAgICAgIGZwQW1vdW50ICs9IGFtb3VudDsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgLi4ubiwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5maW5pc2hQcm9kdWN0ID0gZmluaXNoUHJvZHVjdDsKICAgICAgICAgICAgY29uc3QgY29tcG9uZW50VXNlQW10ID0gdGhpcy5hZGRHcmlkQ29tcG9uZW50VXNlZCgKICAgICAgICAgICAgICAgIHRoaXMuYm9tU2VsZXRlZC5jb21wb25lbnRVc2VkLAogICAgICAgICAgICAgICAgcHJvZHVjZVF0eQogICAgICAgICAgICApOwogICAgICAgICAgICBjb25zdCBvdGhlckZpbmlzaFByb2R1Y3RVc2VBbXQgPSB0aGlzLmFkZEdyaWRPdGhlclByb2R1Y3QoCiAgICAgICAgICAgICAgICB0aGlzLmJvbVNlbGV0ZWQub3RoZXJGaW5pc2hQcm9kdWN0LAogICAgICAgICAgICAgICAgcHJvZHVjZVF0eQogICAgICAgICAgICApOwoKICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIuYW1vdW50ID0gY29tcG9uZW50VXNlQW10OwogICAgICAgICAgICB0aGlzLnRvdGFsQ29zdCA9IGNvbXBvbmVudFVzZUFtdDsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIuZXhjaGFuZ2VBbW91bnQgPSBjb21wb25lbnRVc2VBbXQ7CiAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLnZhcmlhbmNlID0KICAgICAgICAgICAgICAgIGZwQW1vdW50ICsgb3RoZXJGaW5pc2hQcm9kdWN0VXNlQW10IC0gY29tcG9uZW50VXNlQW10OwogICAgICAgICAgICB0aGlzLnZhcmluY2UgPSBmcEFtb3VudCArIG90aGVyRmluaXNoUHJvZHVjdFVzZUFtdCAtIGNvbXBvbmVudFVzZUFtdDsKICAgICAgICAgICAgLy8gdGhpcy5jYWxjdWxhdGVWYXJpYW5jZShmcEFtb3VudCkKICAgICAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKHByb2R1Y2VRdHksICdjaGFuZ2UgcXR5JykKICAgICAgICB9LAogICAgICAgIGFzeW5jIG9uQ2hhbmdlQm9tKGUpIHsKICAgICAgICAgICAgdGhpcy5ib21TZWxldGVkID0gZTsKICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKGUsICdib21TZWxldGVkJykKICAgICAgICAgICAgLy8gdGhpcy5wcm9kdWN0aW9uT3JkZXIgPSBlCiAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb25Ob3RlID0gdGhpcy5ib21TZWxldGVkLnRyYW5zYWN0aW9uTm90ZTsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIud2FyZWhvdXNlID0gdGhpcy5ib21TZWxldGVkLndhcmVob3VzZTsKICAgICAgICAgICAgY29uc3Qgb3RoZXJGaW5pc2hQcm9kdWN0ID0gdGhpcy5ib21TZWxldGVkLm90aGVyRmluaXNoUHJvZHVjdCB8fCBbXTsKICAgICAgICAgICAgb3RoZXJGaW5pc2hQcm9kdWN0Lm1hcCgobikgPT4gewogICAgICAgICAgICAgICAgaWYgKCFuLmhhc093blByb3BlcnR5KCJkZWNpbWFsRm9ybWF0IikpIHsKICAgICAgICAgICAgICAgICAgICBuWyJkZWNpbWFsRm9ybWF0Il0gPSAibjIiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAuLi5uLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMub3RoZXJGaW5pc2hQcm9kdWN0RGF0YSA9IG90aGVyRmluaXNoUHJvZHVjdDsKICAgICAgICAgICAgY29uc3QgY29tcG9uZW50VXNlZCA9IHRoaXMuYm9tU2VsZXRlZC5jb21wb25lbnRVc2VkIHx8IFtdOwogICAgICAgICAgICBjb21wb25lbnRVc2VkLm1hcCgobikgPT4gewogICAgICAgICAgICAgICAgaWYgKCFuLmhhc093blByb3BlcnR5KCJkZWNpbWFsRm9ybWF0IikpIHsKICAgICAgICAgICAgICAgICAgICBuWyJkZWNpbWFsRm9ybWF0Il0gPSAibjIiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAuLi5uLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50VXNlZERhdGEgPSBjb21wb25lbnRVc2VkOwogICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5xdHkgPSAxOwogICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci55aWVsZFVPTSA9IGUuZmluaXNoUHJvZHVjdFswXS5idW9tIHx8IHt9OwogICAgICAgICAgICBjb25zdCB5aWVsZFVPTSA9IHRoaXMucHJvZHVjdGlvbk9yZGVyLnlpZWxkVU9NOwogICAgICAgICAgICBpZiAoeWllbGRVT00uaGFzT3duUHJvcGVydHkoIm5hbWUiKSkgewogICAgICAgICAgICAgICAgdGhpcy51b20gPSB0aGlzLnByb2R1Y3Rpb25PcmRlci55aWVsZFVPTS5uYW1lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMudG90YWxDb3N0ID0gdGhpcy5ib21TZWxldGVkLmFtb3VudDsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIuYW1vdW50ID0gdGhpcy5ib21TZWxldGVkLmFtb3VudDsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIuZXhjaGFuZ2VBbW91bnQgPSB0aGlzLmJvbVNlbGV0ZWQuYW1vdW50OwogICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci52YXJpYW5jZSA9IHRoaXMuYm9tU2VsZXRlZC52YXJpYW5jZTsKICAgICAgICAgICAgdGhpcy52YXJpYW5jZSA9IHRoaXMuYm9tU2VsZXRlZC52YXJpYW5jZTsKICAgICAgICB9LAogICAgICAgIGFkZEdyaWRDb21wb25lbnRVc2VkKGRhdGEsIHByb2R1Y2VRdHkpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCB0b3RhbENvc3RfID0gMDsKICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50VXNlZERhdGEgPSBkYXRhIHx8IFtdOwogICAgICAgICAgICAgICAga2VuZG8KICAgICAgICAgICAgICAgICAgICAualF1ZXJ5KCIjY29tcG9uZW50VXNlIikKICAgICAgICAgICAgICAgICAgICAuZGF0YSgia2VuZG9HcmlkIikKICAgICAgICAgICAgICAgICAgICAuZGF0YVNvdXJjZS5kYXRhKFtdKTsKICAgICAgICAgICAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuY29tcG9uZW50VXNlRFMua2VuZG9XaWRnZXQoKTsKICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50VXNlZERhdGEuZm9yRWFjaCgoaXRtLCBpbmRleCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHlRdHkgPSBpdG0ucXR5ICoga2VuZG8ucGFyc2VGbG9hdChwcm9kdWNlUXR5KTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpQ29zdCA9IGl0bS5jb3N0OwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IGlDb3N0ICogeVF0eTsKICAgICAgICAgICAgICAgICAgICB0b3RhbENvc3RfICs9IGFtb3VudDsKICAgICAgICAgICAgICAgICAgICBkcy5pbnNlcnQoaW5kZXggKyAxLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpdG0uaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0bS5pdGVtLAogICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaXRtLmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICBidW9tOiBpdG0uYnVvbSB8fCB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgdW9tOiBpdG0udW9tLAogICAgICAgICAgICAgICAgICAgICAgICBxdHk6IHlRdHksCiAgICAgICAgICAgICAgICAgICAgICAgIGNvc3Q6IGlDb3N0LAogICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGFtb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiBpdG0uc2t1LAogICAgICAgICAgICAgICAgICAgICAgICBkZWNpbWFsRm9ybWF0OiBpdG0uZGVjaW1hbEZvcm1hdCwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy50b3RhbENvc3QgPSB0b3RhbENvc3RfOwogICAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIuYW1vdW50ID0gdG90YWxDb3N0XzsKICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLmV4Y2hhbmdlQW1vdW50ID0gdG90YWxDb3N0XzsKICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLmNvbXBvbmVudFVzZWQgPSBkcy5kYXRhKCkubWFwKChpdG0pID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBpZDogaXRtLmlkLAogICAgICAgICAgICAgICAgICAgICAgICBpdGVtOiBpdG0uaXRlbSwKICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGl0bS5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgYnVvbTogaXRtLmJ1b20gfHwge30sCiAgICAgICAgICAgICAgICAgICAgICAgIHVvbTogaXRtLnVvbSwKICAgICAgICAgICAgICAgICAgICAgICAgcXR5OiBpdG0ucXR5LAogICAgICAgICAgICAgICAgICAgICAgICBjb3N0OiBpdG0uY29zdCwKICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBpdG0uYW1vdW50LAogICAgICAgICAgICAgICAgICAgICAgICBza3U6IGl0bS5za3UsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxGb3JtYXQ6IGl0bS5kZWNpbWFsRm9ybWF0LAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiB0b3RhbENvc3RfOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coImVycm9yIiwgZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYWRkR3JpZE90aGVyUHJvZHVjdChkYXRhLCBwcm9kdWNlUXR5KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgb0ZwQW1vdW50ID0gMDsKICAgICAgICAgICAgICAgIHRoaXMub3RoZXJGaW5pc2hQcm9kdWN0RGF0YSA9IGRhdGEgfHwgW107CiAgICAgICAgICAgICAgICBrZW5kbwogICAgICAgICAgICAgICAgICAgIC5qUXVlcnkoIiNncmlkT3RoZXJQcm9kdWN0IikKICAgICAgICAgICAgICAgICAgICAuZGF0YSgia2VuZG9HcmlkIikKICAgICAgICAgICAgICAgICAgICAuZGF0YVNvdXJjZS5kYXRhKFtdKTsKICAgICAgICAgICAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMub3RoZXJQcm9kdWN0RFMua2VuZG9XaWRnZXQoKTsKICAgICAgICAgICAgICAgIHRoaXMub3RoZXJGaW5pc2hQcm9kdWN0RGF0YS5mb3JFYWNoKChpdG0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeVF0eSA9IGl0bS55aWVsZFF0eSAqIGtlbmRvLnBhcnNlRmxvYXQocHJvZHVjZVF0eSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaUNvc3QgPSBpdG0uY29zdDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBhbW91bnQgPSBpQ29zdCAqIHlRdHk7CiAgICAgICAgICAgICAgICAgICAgb0ZwQW1vdW50ICs9IGFtb3VudDsKICAgICAgICAgICAgICAgICAgICBkcy5pbnNlcnQoaW5kZXggKyAxLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpdG0uaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0bS5pdGVtLAogICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaXRtLmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICBidW9tOiBpdG0uYnVvbSB8fCB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgdW9tOiBpdG0udW9tLAogICAgICAgICAgICAgICAgICAgICAgICB5aWVsZFF0eTogeVF0eSwKICAgICAgICAgICAgICAgICAgICAgICAgY29zdDogaUNvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogYW1vdW50LAogICAgICAgICAgICAgICAgICAgICAgICBza3U6IGl0bS5za3UsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxGb3JtYXQ6IGl0bS5kZWNpbWFsRm9ybWF0LAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5vdGhlckZpbmlzaFByb2R1Y3QgPSBkcy5kYXRhKCkubWFwKChpdG0pID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBpZDogaXRtLmlkLAogICAgICAgICAgICAgICAgICAgICAgICBpdGVtOiBpdG0uaXRlbSwKICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGl0bS5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgYnVvbTogaXRtLmJ1b20gfHwge30sCiAgICAgICAgICAgICAgICAgICAgICAgIHVvbTogaXRtLnVvbSwKICAgICAgICAgICAgICAgICAgICAgICAgeWllbGRRdHk6IGl0bS55aWVsZFF0eSwKICAgICAgICAgICAgICAgICAgICAgICAgY29zdDogaXRtLmNvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogaXRtLmFtb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiBpdG0uc2t1LAogICAgICAgICAgICAgICAgICAgICAgICBkZWNpbWFsRm9ybWF0OiBpdG0uZGVjaW1hbEZvcm1hdCwKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gb0ZwQW1vdW50OwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coImVycm9yIiwgZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY2FsY3VsYXRlVmFyaWFuY2UoKSB7CiAgICAgICAgICAgIGNvbnN0IGNEUyA9IHRoaXMuJHJlZnMuY29tcG9uZW50VXNlRFMua2VuZG9XaWRnZXQoKTsKICAgICAgICAgICAgY29uc3Qgb1BEUyA9IHRoaXMuJHJlZnMub3RoZXJQcm9kdWN0RFMua2VuZG9XaWRnZXQoKTsKICAgICAgICAgICAgbGV0IGFtb3VudCA9IDA7CiAgICAgICAgICAgIGNEUy5kYXRhKCkuZm9yRWFjaCgobikgPT4gewogICAgICAgICAgICAgICAgYW1vdW50ICs9IHBhcnNlRmxvYXQobi5hbW91bnQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgb1BEUy5kYXRhKCkuZm9yRWFjaCgobikgPT4gewogICAgICAgICAgICAgICAgYW1vdW50ICs9IHBhcnNlRmxvYXQobi5hbW91bnQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIuYW1vdW50ID0gYW1vdW50OwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGxvYWRQcmVmaXgoKSB7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCJyZXNvbHZlZCIpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IHByZWZpeEhhbmRsZXIuZ2V0KCJwcm9kdWN0aW9uIG9yZGVyIikudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb25UeXBlcyA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50cmFuc2FjdGlvblR5cGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci50cmFuc2FjdGlvblR5cGUgPSB0aGlzLnRyYW5zYWN0aW9uVHlwZXNbMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2VuZXJhdGVOdW1iZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0sIDEwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBhc3luYyBnZW5lcmF0ZU51bWJlcigpIHsKICAgICAgICAgICAgaWYgKHRoaXMucHJvZHVjdGlvbk9yZGVyLmR1ZURhdGUgIT09ICIiKSB7CiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICBhYmJyOiB0aGlzLnByb2R1Y3Rpb25PcmRlci50cmFuc2FjdGlvblR5cGUuYWJiciwKICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmU6IHRoaXMucHJvZHVjdGlvbk9yZGVyLnRyYW5zYWN0aW9uVHlwZS5zdHJ1Y3R1cmUsCiAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25EYXRlOiB0aGlzLnByb2R1Y3Rpb25PcmRlci5kdWVEYXRlLAogICAgICAgICAgICAgICAgICAgIHNlcXVjZW5jaW5nOiB0aGlzLnByb2R1Y3Rpb25PcmRlci50cmFuc2FjdGlvblR5cGUuc2VxdWNlbmNpbmcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4U2VwYXJhdG9yOiB0aGlzLnByb2R1Y3Rpb25PcmRlci50cmFuc2FjdGlvblR5cGUucHJlZml4U2VwYXJhdG9yIHx8ICcnLAogICAgICAgICAgICAgICAgICAgIG51bWJlclNlcGFyYXRvcjogdGhpcy5wcm9kdWN0aW9uT3JkZXIudHJhbnNhY3Rpb25UeXBlLm51bWJlclNlcGFyYXRvciB8fCAnJywKICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IHRoaXMucHJvZHVjdGlvbk9yZGVyLnRyYW5zYWN0aW9uVHlwZS5mb3JtYXQgfHwgNSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUHJvZHVjdGlvbiBPcmRlciIsCiAgICAgICAgICAgICAgICAgICAgZW50aXR5OiAyLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLmFiYnIgPSBkYXRhLmFiYnI7CiAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5zdHJ1Y3R1cmUgPSBkYXRhLnN0cnVjdHVyZTsKICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLnNlcXVjZW5jaW5nID0gZGF0YS5zZXF1Y2VuY2luZzsKICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLnRyYW5zYWN0aW9uRGF0ZSA9IGRhdGEudHJhbnNhY3Rpb25EYXRlOwogICAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIudHlwZSA9IGRhdGEudHlwZTsKICAgICAgICAgICAgICAgIGF3YWl0IGJpbGxpbmdIYW5kbGVyCiAgICAgICAgICAgICAgICAgICAgLmxhc3ROdW1iZXIoZGF0YSkKICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXN0TnVtYmVyID0gdGhpcy56ZXJvUGFkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHJlcy5sYXN0TnVtYmVyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci50cmFuc2FjdGlvblR5cGUuZm9ybWF0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIubnVtYmVyID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMuc3VmZml4ICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci50cmFuc2FjdGlvblR5cGUubnVtYmVyU2VwYXJhdG9yICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0TnVtYmVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIubGFzdE51bWJlciA9IHJlcy5zdWZmaXggKyBsYXN0TnVtYmVyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKHRoaXMucHJvZHVjdGlvbk9yZGVyLm51bWJlciwgInByb2R1Y3Rpb24iKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JzLnB1c2goZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHplcm9QYWQobnVtLCBwbGFjZXMpIHsKICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhudW0pLnBhZFN0YXJ0KHBsYWNlcywgIjAiKTsKICAgICAgICB9LAogICAgICAgIHN1ZmZpeCh0cmFuc2FjdGlvbkRhdGUpIHsKICAgICAgICAgICAgcmV0dXJuIGtlbmRvLnRvU3RyaW5nKG5ldyBEYXRlKHRyYW5zYWN0aW9uRGF0ZSksIGB5eW1tYCk7CiAgICAgICAgfSwKICAgICAgICBhc3luYyBkYXRhU291cmNlQ2hhbmdlZE9QKGUpIHsKICAgICAgICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICAgICAgICAgIGxldCBkYXRhUm93ID0gZS5pdGVtc1swXSwKICAgICAgICAgICAgICAgICAgICBidW9tID0ge307CiAgICAgICAgICAgICAgICBzd2l0Y2ggKGUuZmllbGQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlICJpdGVtIjoKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoImRlc2NyaXB0aW9uIiwgZGF0YVJvdy5pdGVtLmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoInlpZWxkUXR5IiwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1b20gPSBkYXRhUm93Lml0ZW0udW9tOwogICAgICAgICAgICAgICAgICAgICAgICBkYXRhUm93LnNldCgiYnVvbSIsIGJ1b20pOwogICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmludmVudG9yeUJhbGFuY2VCeUl0ZW0oZGF0YVJvdywgZGF0YVJvdy5pdGVtLmlkLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAieWllbGRRdHkiOgogICAgICAgICAgICAgICAgICAgICAgICBkYXRhUm93LnNldCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhbW91bnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChkYXRhUm93LmNvc3QpICogcGFyc2VGbG9hdChkYXRhUm93LnlpZWxkUXR5KQogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmNvc3RPRlAgPSBkYXRhUm93LmFtb3VudAogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICJjb3N0IjoKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYW1vdW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQoZGF0YVJvdy5jb3N0KSAqIHBhcnNlRmxvYXQoZGF0YVJvdy55aWVsZFF0eSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jb3N0T0ZQID0gZGF0YVJvdy5hbW91bnQKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKGRhdGFSb3cuY29zdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dG9DYWxjdWxhdGVHcmlkMSgpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0b0NhbGN1bGF0ZUdyaWQyKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdXRvQ2FsY3VsYXRlR3JpZDMoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgSXRlbURyb3BEb3duRWRpdG9yRlAoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgICAgICAgIGtlbmRvCiAgICAgICAgICAgICAgICAualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6ICJjb250YWlucyIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgIGhlYWRlclRlbXBsYXRlOgogICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iZHJvcGRvd24taGVhZGVyIGstd2lkZ2V0IGstaGVhZGVyIj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgIjxzcGFuPkl0ZW1zIDwvc3Bhbj4iICsKICAgICAgICAgICAgICAgICAgICAgICAgIjxzcGFuPjwvc3Bhbj4iICsKICAgICAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlckZpbHRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBwcm9kdWN0VmFyaWFudEhhbmRsZXIuaXRlbVZhcmlhbnRTZWFyY2hVUkwoKSwgLy8gdmFyaWFudCBvbmx5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7IHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNrdTogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRhdGE6IHRoaXMudmFyaWFudHMKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgVU9NRHJvcERvd25FZGl0b3JPUChjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAgICAgICAga2VuZG8KICAgICAgICAgICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICAgICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJ1b20udG9VT00ubmFtZSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJ1b20udG9VT00uaWQiLAogICAgICAgICAgICAgICAgICAgIGNhc2NhZGVGcm9tOiAiaXRlbSIsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPXVvbS50b1VPTS5uYW1lIzwvc3Bhbj4iLAogICAgICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICAgICAgICAgICAgICBzZXJ2ZXJGaWx0ZXJpbmc6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zcG9ydDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdW9tUHJpY2VIYW5kbGVyLmdldFVybChvcHRpb25zLm1vZGVsLml0ZW0uaWQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogImlkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmFtZToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2t1OiB7dHlwZTogInN0cmluZyJ9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRhdGE6IHRoaXMudmFyaWFudHMKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlUm93T1AoZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGNvbnN0IGdyaWQgPSBrZW5kby5qUXVlcnkoIiNncmlkT3RoZXJQcm9kdWN0IikuZGF0YSgia2VuZG9HcmlkIiksCiAgICAgICAgICAgICAgICBkYXRhU291cmNlID0gZ3JpZC5kYXRhU291cmNlLAogICAgICAgICAgICAgICAgZGF0YUl0ZW0gPSBncmlkLmRhdGFJdGVtKCQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCJ0ciIpKTsKCiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLnRvdGFsKCkgPiAxKSB7CiAgICAgICAgICAgICAgICBkYXRhU291cmNlLnJlbW92ZShkYXRhSXRlbSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRQcm9qZWN0cygpIHsKICAgICAgICAgICAgYXdhaXQgcHJvamVjdEhhbmRsZXIubGlzdCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgICAgdGhpcy5wcm9qZWN0cyA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9qZWN0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIucHJvamVjdCA9IHRoaXMucHJvamVjdHNbMF07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZFdhcmVob3VzZXMoKSB7CiAgICAgICAgICAgIHdhcmVob3VzZUhhbmRsZXIuZ2V0V2FyZWhvdXNlU2V0dGluZ0FsbCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgICAgdGhpcy53YXJlaG91c2VzID0gcmVzOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGFzeW5jIG9uQ2hhbmdlKGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZXZlbnQudmFsdWU7CiAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZVt0ZXh0RmllbGRdID09PSBlbXB0eUl0ZW1bdGV4dEZpZWxkXSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2codmFsdWUpOwogICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5wcm9kdWN0ID0gdmFsdWU7CiAgICAgICAgICAgIGF3YWl0IHRoaXMub25sb2FkQm9tKHZhbHVlLmlkKTsKICAgICAgICB9LAogICAgICAgIG9uRmlsdGVyQ2hhbmdlKCkgewogICAgICAgICAgICAvLyBjb25zdCBmaWx0ZXIgPSBldmVudC5maWx0ZXIudmFsdWUKICAgICAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSgwLCB0aGlzLnByb2R1Y3RCYXNlVXJsKTsKICAgICAgICB9LAogICAgICAgIHJlcXVlc3REYXRhKHNraXAsIGJhc2VVcmwpIHsKICAgICAgICAgICAgY29uc3QgdXJsID0gYmFzZVVybDsKICAgICAgICAgICAgdGhpcy5yZXF1ZXN0U3RhcnRlZCA9IHRydWU7CiAgICAgICAgICAgIGZldGNoKHVybCkKICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyhyZXNwb25zZS5qc29uKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbih0aGlzLmFmdGVyRmV0Y2gpOwogICAgICAgIH0sCiAgICAgICAgYWZ0ZXJGZXRjaChqc29uKSB7CiAgICAgICAgICAgIHRoaXMucHJvZHVjdExpc3QgPSBqc29uLmRhdGE7CiAgICAgICAgfSwKICAgICAgICBhc3luYyBvbmxvYWRCb20ocHJvZHVjdElkKSB7CiAgICAgICAgICAgIGJvbUhhbmRsZXIuZ2V0QnlQcm9kdWN0KHByb2R1Y3RJZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmJvbXMgPSByZXM7CiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uTm90ZSA9IHJlcy50cmFuc2FjdGlvbk5vdGU7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgdGF4VGVtcGxhdGUoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJ2YXQiLCBkYXRhSXRlbS50YXgpOwogICAgICAgICAgICBjb25zdCB2YXQgPSBkYXRhSXRlbS50YXg7CiAgICAgICAgICAgIGlmICh2YXQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBgPHNwYW4+JHt2YXQuZGVmYXVsdFRheCA/IHZhdC5kZWZhdWx0VGF4IDogYGB9PC9zcGFuPmA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYGA7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFRheERyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAgICAgICBrZW5kbwogICAgICAgICAgICAgICAgLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgICAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiAic3RhcnRzd2l0aCIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogImRlZmF1bHRUYXgiLAogICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1kZWZhdWx0VGF4Izwvc3Bhbj4iLAogICAgICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS1TZWxlY3QtLSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMudmF0VGF4LAogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICByb3dOdW1iZXJDVShkYXRhSXRlbSkgewogICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmNvbXBvbmVudFVzZURTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgICAgICAgICBpbmRleCA9IGRzLmluZGV4T2YoZGF0YUl0ZW0pOwogICAgICAgICAgICByZXR1cm4gaW5kZXggKyAxOwogICAgICAgIH0sCiAgICAgICAgcm93TnVtYmVyT1AoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5vdGhlclByb2R1Y3REUy5rZW5kb1dpZGdldCgpLAogICAgICAgICAgICAgICAgaW5kZXggPSBkcy5pbmRleE9mKGRhdGFJdGVtKTsKICAgICAgICAgICAgcmV0dXJuIGluZGV4ICsgMTsKICAgICAgICB9LAogICAgICAgIFVPTVRlbXBsYXRlT1AoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgY29uc3QgdW9tID0gZGF0YUl0ZW0udW9tOwogICAgICAgICAgICBpZiAodW9tKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYDxzcGFuPiR7dW9tLnVvbSA/IHVvbS51b20ubmFtZSA6IGBgfTwvc3Bhbj5gOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGBgOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBVT01UZW1wbGF0ZUNVKGRhdGFJdGVtKSB7CiAgICAgICAgICAgIGNvbnN0IHVvbSA9IGRhdGFJdGVtLnVvbTsKICAgICAgICAgICAgaWYgKHVvbSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke3VvbS51b20gPyB1b20udW9tLm5hbWUgOiBgYH08L3NwYW4+YDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBgYDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcm93TnVtYmVyT0MoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5vdGhlckNvc3REUy5rZW5kb1dpZGdldCgpLAogICAgICAgICAgICAgICAgaW5kZXggPSBkcy5pbmRleE9mKGRhdGFJdGVtKTsKICAgICAgICAgICAgcmV0dXJuIGluZGV4ICsgMTsKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRTZWdtZW50KCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNlZ21lbnRzID0gW107CiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NIYW5kbGVyCiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRTZWcoKQogICAgICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWdtZW50cyA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VnbWVudHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5zZWdtZW50ID0gdGhpcy5zZWdtZW50c1swXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZWdtZW50TGlzdCA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKCk7CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgMTApOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRMb2NhdGlvbigpIHsKICAgICAgICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbnMgPSBbXTsKICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkhhbmRsZXIKICAgICAgICAgICAgICAgICAgICAgICAgLmxpc3QoKQogICAgICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbnMgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvY2F0aW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLmxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbnNbMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKTsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCAxMCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZFNhbGVDaGFubmVsKCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBzYWxlQ2hhbm5lbEhhbmRsZXIuZ2V0KCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2FsZUNoYW5uZWxMaXN0ID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNhbGVDaGFubmVsTGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIuc2FsZUNoYW5uZWwgPSB0aGlzLnNhbGVDaGFubmVsTGlzdFswXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSwgMTApOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHNhdmVQcmludCgpIHsKICAgICAgICB9LAogICAgICAgIHNhdmVOZXcoKSB7CiAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5ib20gPSBuZXcgQm9tTW9kZWwodGhpcy5ib21TZWxldGVkKTsKICAgICAgICAgICAgdGhpcy5wcm9kdWN0aW9uT3JkZXIudHJhbnNhY3Rpb25Ob3RlID0gdGhpcy50cmFuc2FjdGlvbk5vdGU7CiAgICAgICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLnN0YXR1cyA9IDE7CgogICAgICAgICAgICBwcm9kdWN0aW9uT3JkZXJIYW5kbGVyLmNyZWF0ZSh0aGlzLnByb2R1Y3Rpb25PcmRlcikudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAvLyAgIG5hbWU6ICdQcm9kdWN0cycsCiAgICAgICAgICAgICAgICAvLyAgIHBhdGg6ICdwcm9kdWN0JywKICAgICAgICAgICAgICAgIC8vICAgcGFyYW1zOiB7ZGF0YVBPOiByZXMuZGF0YS5kYXRhfQogICAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGVycm9yTWVzc2FnZSgpIHsKICAgICAgICB9LAogICAgICAgIGFjY291bnREcm9wRG93bkVkaXRvcigpIHsKICAgICAgICB9LAogICAgICAgIGNhbmNlbCgpIHsKICAgICAgICB9LAogICAgICAgIGhpZGVTbWFsbFNpZGViYXIoKSB7CiAgICAgICAgICAgIHRoaXMuaXNIaWRlQmFyID0gIXRoaXMuaXNIaWRlQmFyOwogICAgICAgIH0sCiAgICB9LAogICAgd2F0Y2g6IHsKICAgICAgICAvLyBjYWxsIGFnYWluIHRoZSBtZXRob2QgaWYgdGhlIHJvdXRlIGNoYW5nZXMKICAgIH0sCiAgICBhc3luYyBjcmVhdGVkKCkgewogICAgICAgIC8vIGZldGNoIHRoZSBkYXRhIHdoZW4gdGhlIHZpZXcgaXMgY3JlYXRlZCBhbmQgdGhlIGRhdGEgaXMKICAgICAgICAvLyBhbHJlYWR5IGJlaW5nIG9ic2VydmVkCiAgICAgICAgLy8gdGhpcy5sb2FkT2JqKCkKICAgICAgICAvLyBhd2FpdCB0aGlzLmxvYWRQcmVmaXgoKQogICAgICAgIHRoaXMucHJvZHVjdGlvbk9yZGVyLmR1ZURhdGUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKTsKICAgICAgICB0aGlzLnByb2R1Y3Rpb25PcmRlci5tb250aE9mID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCA3KTsKICAgICAgICBhd2FpdCB0aGlzLmxvYWRQcmVmaXgoKTsKICAgIH0sCiAgICBhc3luYyBtb3VudGVkKCkgewogICAgICAgIC8vIGF3YWl0IHRoaXMubG9hZFByZWZpeCgpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkV2FyZWhvdXNlcygpOwogICAgICAgIGF3YWl0IHRoaXMubG9hZFNhbGVDaGFubmVsKCk7CiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2VnbWVudCgpOwogICAgICAgIGF3YWl0IHRoaXMubG9hZExvY2F0aW9uKCk7CiAgICAgICAgYXdhaXQgdGhpcy5sb2FkUHJvamVjdHMoKTsKICAgICAgICB0aGlzLnJlcXVlc3REYXRhKDAsIHRoaXMucHJvZHVjdEJhc2VVcmwpOwogICAgfSwKfTsK"},{"version":3,"sources":["ProductionOrder.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProductionOrder.vue","sourceRoot":"src/views/products/production/production_orders","sourcesContent":["<template>\n    <v-app>\n        <v-container>\n            <v-row>\n                <v-col sm=\"12\" cols=\"12\">\n                    <v-card\n                        outlined\n                        dense\n                        class=\"pa-4 no_border rounded-sm\"\n                        color=\"white\"\n                    >\n                        <v-row>\n                            <v-col\n                                class=\"bigSide py-0\"\n                                sm=\"12\"\n                                cols=\"12\"\n                                style=\"transition: .3s ease-in;\"\n                                :class=\"{ hide_big_bar_class: isHideBar }\"\n                            >\n                                <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\n                                    <v-card outlined dense class=\"no_border\">\n                                        <h2 class=\"mb-0\">{{ $t(\"production_order\") }}</h2>\n                                        <v-icon\n                                            v-if=\"!isHideBar\"\n                                            onclick=\"window.history.go(-1); return false;\"\n                                            style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                                            class=\"float-right\"\n                                        >close\n                                        </v-icon>\n                                        <!-- <span\n                                          style=\"transition: .3s ease-in; z-index:10;\"\n                                          :class=\"{\n                                            iconArrow: !isHideBar,\n                                            iconArrowHide: isHideBar,\n                                          }\"\n                                        >\n                                          <v-icon\n                                            size=\"22\"\n                                            class=\"arr_icon\"\n                                            @click=\"hideSmallSidebar\"\n                                            v-if=\"isHideBar\"\n                                          >\n                                            fa fa-chevron-circle-left\n                                          </v-icon>\n                                          <v-icon\n                                            size=\"22\"\n                                            class=\"arr_icon\"\n                                            @click=\"hideSmallSidebar\"\n                                            v-if=\"!isHideBar\"\n                                          >\n                                            fa fa-chevron-circle-right\n                                          </v-icon>\n                                        </span> -->\n                                    </v-card>\n                                    <v-card outlined dense class=\"px-3 no_border\" color=\"grayBg\">\n                                        <v-row>\n                                            <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                                                <label class=\"label  mb-0\">{{\n                                                        $t(\"finished_product_variance\")\n                                                    }}</label>\n                                                <v-col sm=\"12\" cols=\"12\"\n                                                       class=\"kendo_dropdown_custom pl-0 pb-3 pt-1 pr-0\">\n                                                    <dropdownlist\n                                                        :data-items=\"productList\"\n                                                        @change=\"onChange\"\n                                                        :value=\"productionOrder.product\"\n                                                        :data-item-key=\"dataItemKey\"\n                                                        :text-field=\"textField\"\n                                                        :default-item=\"defaultItem\"\n                                                        :filterable=\"true\"\n                                                        @filterchange=\"onFilterChange\">\n                                                    </dropdownlist>\n                                                </v-col>\n                                                <label class=\"label mb-0 mt-1\" style=\"\">{{ $t(\"bom\") }}</label>\n                                                <v-select\n                                                    class=\"mt-1\"\n                                                    :items=\"boms\"\n                                                    :disabled=\"boms.length <= 0\"\n                                                    :item-text=\"item => item.abbr + '-' + item.number \"\n                                                    v-model=\"productionOrder.bom\"\n                                                    item-value=\"id\"\n                                                    v-on:change=\"onChangeBom\"\n                                                    :placeholder=\"$t('bom')\"\n                                                    :rules=\"[(v) => !!v || 'BOM is required']\"\n                                                    return-object\n                                                    clearable\n                                                    tage=\"Bom\"\n                                                    outlined\n                                                />\n                                            </v-col>\n                                            <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                                                <v-row>\n                                                    <v-col sm=\"6\" cols=\"12\" class=\"pb-0 mt-2\">\n                                                        <v-text-field\n                                                            :placeholder=\"$t('Produce Qty')\"\n                                                            v-model=\"productionOrder.qty\"\n                                                            type=\"number\"\n                                                            @change=\"onChangeQty\"\n                                                            min=\"1\"\n                                                            class=\"mt-1\"\n                                                            tage=\"Quantity to Produce\"\n                                                            outlined/>\n                                                    </v-col>\n                                                    <v-col sm=\"6\" cols=\"12\" class=\"pt-0 \">\n                                                        <label class=\"label mb-0 mt-2\" style=\"\">{{ $t(\"yield_uom\") }}</label>\n                                                        <h3>{{ uom }}</h3>\n                                                    </v-col>\n                                                </v-row>\n                                            </v-col>\n                                            <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                                                <label class=\"label\">{{ $t(\"due_date\") }}</label>\n                                                <app-datepicker\n                                                    :initialDate=\"productionOrder.dueDate\"\n                                                    @emitDate=\"productionOrder.dueDate = $event\"\n                                                />\n                                                <label class=\"label mb-0 mt-1\">{{\n                                                        $t(\"product_order_num\")\n                                                    }}</label>\n                                                <v-row class=\"mt-1 mr-0\">\n                                                    <v-col sm=\"3\" cols=\"3\" class=\"py-0 pr-0\">\n                                                        <div class=\"code_text text-uppercase\"> {{\n                                                                productionOrder.abbr\n                                                            }}\n                                                        </div>\n                                                    </v-col>\n                                                    <v-col sm=\"7\" cols=\"7\" class=\"pt-0 pl-0 pr-1\">\n                                                        <v-text-field\n                                                            disabled\n                                                            class=\"custom-border\"\n                                                            v-model=\"productionOrder.number\"\n                                                            tage=\"Product Order Number\"\n                                                            outlined\n                                                            :rules=\"[(v) => !!v || 'Number is required']\"\n                                                            required\n                                                        />\n                                                    </v-col>\n                                                    <v-col sm=\"2\" cols=\"2\" class=\"pt-0 px-0\">\n                                                        <v-icon\n                                                            color=\"black\"\n                                                            size=\"30\"\n                                                            class=\"border_qrcode\"\n                                                            @click=\"generateNumber\"\n                                                        >mdi-qrcode\n                                                        </v-icon>\n                                                    </v-col>\n                                                </v-row>\n                                            </v-col>\n                                        </v-row>\n                                    </v-card>\n\n<!--                                    <v-row style=\"background-color: #fff;\">-->\n<!--                                        <v-col cols=\"12\" class=\"pb-1 pb-0\">-->\n<!--                                            <h2 class=\"primary&#45;&#45;text mb-0 font_18 text-uppercase\">-->\n<!--                                                {{ $t(\"finished_product\") }}-->\n<!--                                            </h2>-->\n<!--                                        </v-col>-->\n<!--                                        <v-col sm=\"12\" cols=\"12\" class=\"pt-1\">-->\n<!--                                            <kendo-datasource-->\n<!--                                                ref=\"otherProductDS\"-->\n<!--                                                :data=\"otherFinishProductData\"-->\n<!--                                            />-->\n<!--                                            <kendo-grid-->\n<!--                                                id=\"otherFinishProduct\"-->\n<!--                                                class=\"grid-function\"-->\n<!--                                                :data-source-ref=\"'otherProductDS'\"-->\n<!--                                                :sortable=\"false\"-->\n<!--                                                :filterable=\"false\"-->\n<!--                                                :column-menu=\"true\"-->\n<!--                                                :editable=\"false\"-->\n<!--                                                :scrollable-virtual=\"true\"-->\n<!--                                            >-->\n<!--                                                <kendo-grid-column-->\n<!--                                                    :template=\"rowNumberOP\"-->\n<!--                                                    :title=\"$t('no.')\"-->\n<!--                                                    :width=\"55\"-->\n<!--                                                    :column-menu=\"false\"-->\n<!--                                                    :headerAttributes=\"{-->\n<!--                            style: 'background-color: #EDF1F5;',-->\n<!--                            class: 'text-variants',-->\n<!--                          }\"-->\n<!--                                                    :attributes=\"{-->\n<!--                            style: 'text-align: variants',-->\n<!--                          }\"-->\n<!--                                                />-->\n<!--                                                <kendo-grid-column-->\n<!--                                                    :field=\"'item'\"-->\n<!--                                                    :title=\"$t('item')\"-->\n<!--                                                    :width=\"200\"-->\n<!--                                                    :template=\"itemTemplate\"-->\n<!--                                                    :headerAttributes=\"{-->\n<!--                            style: 'background-color: #EDF1F5',-->\n<!--                          }\"-->\n<!--                                                />-->\n<!--                                                &lt;!&ndash; <kendo-grid-column-->\n<!--                                                  :field=\"'description'\"-->\n<!--                                                  :title=\"$t('description')\"-->\n<!--                                                  :width=\"200\"-->\n<!--                                                  :headerAttributes=\"{-->\n<!--                                                    style: 'background-color: #EDF1F5',-->\n<!--                                                  }\"-->\n<!--                                                /> &ndash;&gt;-->\n<!--                                                <kendo-grid-column-->\n<!--                                                    :field=\"'buom'\"-->\n<!--                                                    :title=\"$t('base_uom')\"-->\n<!--                                                    :width=\"150\"-->\n<!--                                                    :template=\"UOMTemplate\"-->\n<!--                                                    :editable=\"-->\n<!--                            () => {-->\n<!--                              return false;-->\n<!--                            }-->\n<!--                          \"-->\n<!--                                                    :headerAttributes=\"{-->\n<!--                            style:-->\n<!--                              'text-align: right; background-color: #EDF1F5',-->\n<!--                          }\"-->\n<!--                                                    :attributes=\"{ style: 'text-align: right; ' }\"-->\n<!--                                                />-->\n<!--                                                <kendo-grid-column-->\n<!--                                                    :field=\"'yieldQty'\"-->\n<!--                                                    :title=\"$t('yield_qty')\"-->\n<!--                                                    :width=\"150\"-->\n<!--                                                    :template=\"-->\n<!--                            '<span>#=kendo.toString(yieldQty || 0, (decimalFormat || `n2`)) || 0#</span>'-->\n<!--                          \"-->\n<!--                                                    :headerAttributes=\"{-->\n<!--                            style:-->\n<!--                              'text-align: right; background-color: #EDF1F5',-->\n<!--                          }\"-->\n<!--                                                    :attributes=\"{-->\n<!--                            style: 'text-align: right',-->\n<!--                          }\"-->\n<!--                                                />-->\n<!--                                                <kendo-grid-column-->\n<!--                                                    :field=\"'cost'\"-->\n<!--                                                    :title=\"$t('cost')\"-->\n<!--                                                    :width=\"150\"-->\n<!--                                                    :template=\"-->\n<!--                            '<span>#=kendo.toString(cost || 0, (decimalFormat || `n2`)) || 0#</span>'-->\n<!--                          \"-->\n<!--                                                    :headerAttributes=\"{-->\n<!--                            style:-->\n<!--                              'text-align: right; background-color: #EDF1F5',-->\n<!--                          }\"-->\n<!--                                                    :attributes=\"{-->\n<!--                            style: 'text-align: right',-->\n<!--                          }\"-->\n<!--                                                />-->\n<!--                                                <kendo-grid-column-->\n<!--                                                    :field=\"'amount'\"-->\n<!--                                                    :title=\"$t('amount')\"-->\n<!--                                                    :width=\"150\"-->\n<!--                                                    :editable=\"-->\n<!--                            () => {-->\n<!--                              return false;-->\n<!--                            }-->\n<!--                          \"-->\n<!--                                                    :template=\"-->\n<!--                            '<span>#=kendo.toString(amount || 0, (decimalFormat || `n2`)) || 0#</span>'-->\n<!--                          \"-->\n<!--                                                    :headerAttributes=\"{-->\n<!--                            style:-->\n<!--                              'text-align: right; background-color: #EDF1F5',-->\n<!--                          }\"-->\n<!--                                                    :attributes=\"{-->\n<!--                            style: 'text-align: right',-->\n<!--                          }\"-->\n<!--                                                />-->\n<!--                                            </kendo-grid>-->\n<!--                                        </v-col>-->\n<!--                                    </v-row>-->\n                                    <v-row class=\"pt-2\" style=\"background-color: #fff;\">\n                                        <v-col cols=\"12\" class=\"pt-0 pb-0\">\n                                            <h2 class=\"primary--text mb-0 font_18 text-uppercase\">\n                                                {{ $t(\"by_product\") }}\n                                            </h2>\n                                        </v-col>\n                                        <v-col sm=\"12\" cols=\"12\" class=\"pt-1\">\n                                            <kendo-datasource\n                                                ref=\"otherProductDS\"\n                                                :change=\"dataSourceChangedOP\"\n                                                :data=\"otherFinishProductData\"\n                                            />\n                                            <kendo-grid\n                                                id=\"gridOtherProduct\"\n                                                class=\"grid-function\"\n                                                :data-source-ref=\"'otherProductDS'\"\n                                                :sortable=\"false\"\n                                                :filterable=\"false\"\n                                                :column-menu=\"true\"\n                                                :editable=\"true\"\n                                                :scrollable-virtual=\"true\"\n                                            >\n                                                <kendo-grid-column\n                                                    :template=\"rowNumberOP\"\n                                                    :title=\"$t('no.')\"\n                                                    :width=\"55\"\n                                                    :column-menu=\"false\"\n                                                    :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-variants',\n                          }\"\n                                                    :attributes=\"{\n                            style: 'text-align: variants',\n                          }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'item'\"\n                                                    :title=\"$t('item')\"\n                                                    :width=\"200\"\n                                                    :template=\"itemTemplate\"\n                                                    :editor=\"ItemDropDownEditorFP\"\n                                                    :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                                                />\n                                                <!-- <kendo-grid-column\n                                                  :field=\"'description'\"\n                                                  :title=\"$t('description')\"\n                                                  :width=\"200\"\n                                                  :headerAttributes=\"{\n                                                    style: 'background-color: #EDF1F5',\n                                                  }\"\n                                                /> -->\n                                                <kendo-grid-column\n                                                    :field=\"'buom'\"\n                                                    :title=\"$t('base_uom')\"\n                                                    :width=\"150\"\n                                                    :template=\"UOMTemplate\"\n                                                    :editor=\"UOMDropDownEditorOP\"\n                                                    :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                                                    :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                                                    :attributes=\"{ style: 'text-align: right; ' }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'yieldQty'\"\n                                                    :title=\"$t('yield_qty')\"\n                                                    :width=\"150\"\n                                                    :template=\"\n                            '<span>#=kendo.toString(yieldQty || 0, decimalFormat) || 0#</span>'\n                          \"\n                                                    :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                                                    :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'cost'\"\n                                                    :title=\"$t('cost')\"\n                                                    :width=\"150\"\n                                                    :template=\"\n                            '<span>#=kendo.toString(cost || 0, decimalFormat) || 0#</span>'\n                          \"\n                                                    :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                                                    :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'amount'\"\n                                                    :title=\"$t('amount')\"\n                                                    :width=\"150\"\n                                                    :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                                                    :template=\"\n                            '<span>#=kendo.toString(amount || 0, decimalFormat) || 0#</span>'\n                          \"\n                                                    :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                                                    :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                                                />\n                                            </kendo-grid>\n                                        </v-col>\n                                        <!-- <v-col cols=\"12\" class=\"pt-0\">\n                                          <v-btn\n                                            color=\"primary\"\n                                            class=\"float-left btn_plus rounded-4 white--text mr-2\"\n                                            @click=\"addRowOtherProduct\"\n                                          >\n                                            <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                                          </v-btn>\n                                        </v-col> -->\n                                    </v-row>\n                                    <v-row style=\"background-color: #fff;\">\n                                        <v-col cols=\"12\" class=\"py-1 pb-0\">\n                                            <h2 class=\"primary--text mb-0 font_18 text-uppercase\">\n                                                {{ $t(\"components_used\") }}\n                                            </h2>\n                                        </v-col>\n                                        <v-col sm=\"12\" cols=\"12\">\n                                            <kendo-datasource\n                                                ref=\"componentUseDS\"\n                                                :data=\"componentUsedData\"\n                                            />\n                                            <kendo-grid\n                                                id=\"componentUse\"\n                                                class=\"grid-function\"\n                                                :data-source-ref=\"'componentUseDS'\"\n                                                :sortable=\"false\"\n                                                :filterable=\"false\"\n                                                :column-menu=\"true\"\n                                                :editable=\"false\"\n                                                :scrollable-virtual=\"true\"\n                                            >\n                                                <kendo-grid-column\n                                                    :title=\"$t('no.')\"\n                                                    :template=\"rowNumberCU\"\n                                                    :width=\"55\"\n                                                    :column-menu=\"false\"\n                                                    :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-variants',\n                          }\"\n                                                    :attributes=\"{ style: 'text-align: variants' }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'item'\"\n                                                    :title=\"$t('items')\"\n                                                    :width=\"200\"\n                                                    :template=\"'<span>#=item.name#</span>'\"\n                                                    :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                                                />\n                                                <!-- <kendo-grid-column\n                                                  :field=\"'description'\"\n                                                  :title=\"$t('description')\"\n                                                  :width=\"200\"\n                                                  :headerAttributes=\"{\n                                                    style: 'background-color: #EDF1F5',\n                                                  }\"\n                                                /> -->\n                                                <kendo-grid-column\n                                                    :template=\"UOMTemplate\"\n                                                    :field=\"'buom'\"\n                                                    :title=\"$t('base_uom')\"\n                                                    :width=\"160\"\n                                                    :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                                                    :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'qty'\"\n                                                    :title=\"$t('qty')\"\n                                                    :width=\"150\"\n                                                    :template=\"\n                            '<span>#=kendo.toString(qty || 0, (decimalFormat || `n2`)) || 0#</span>'\n                          \"\n                                                    :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                                                    :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'cost'\"\n                                                    :title=\"$t('cost')\"\n                                                    :width=\"150\"\n                                                    :template=\"\n                            '<span>#=kendo.toString(cost || 0, (decimalFormat || `n2`)) || 0#</span>'\n                          \"\n                                                    :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                                                    :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                                                />\n                                                <kendo-grid-column\n                                                    :field=\"'amount'\"\n                                                    :title=\"$t('amount')\"\n                                                    :width=\"150\"\n                                                    :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                                                    :template=\"\n                            '<span>#=kendo.toString(amount || 0, (decimalFormat || `n2`)) || 0#</span>'\n                          \"\n                                                    :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                                                    :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                                                />\n                                            </kendo-grid>\n                                        </v-col>\n                                    </v-row>\n                                    <v-row style=\"background-color: #fff;\">\n                                        <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                                            <v-row>\n                                                <v-col sm=\"6\" cols=\"6\" class=\"py-0\">\n                                                    <v-textarea\n                                                        class=\"mt-1\"\n                                                        outlined\n                                                        clearable\n                                                        no-resize\n                                                        v-model=\"transactionNote\"\n                                                        height=\"90px\"\n                                                        rows=\"3\"\n                                                        placeholder=\"Memo\"\n                                                    />\n                                                </v-col>\n                                                <v-col sm=\"6\" cols=\"6\" class=\"pt-1\">\n                                                    <v-simple-table>\n                                                        <template v-slot:default>\n                                                            <tbody>\n                                                            <tr>\n                                                                <td class=\"text-left text-uppercase\">\n                                                                    {{ $t(\"total_cost\") }}\n                                                                </td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right\">\n                                                                    {{ numberFormat(totalCost) }}\n                                                                </td>\n                                                            </tr>\n                                                            <tr>\n                                                                <td class=\"text-left text-uppercase\">\n                                                                    {{ $t(\"variance\") }}\n                                                                </td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right\">\n                                                                    {{ numberFormat(variance) }}\n                                                                </td>\n                                                            </tr>\n                                                            </tbody>\n                                                        </template>\n                                                    </v-simple-table>\n                                                </v-col>\n                                            </v-row>\n                                        </v-col>\n                                    </v-row>\n\n                                    <v-divider/>\n                                    <v-card outlined dense class=\"no_border function_footer\">\n                                        <v-alert type=\"warning\" v-model=\"alert\" dismissible>\n                                            <span v-html=\"errorMessage\"/>\n                                        </v-alert>\n                                        <v-btn\n                                            color=\"primary\"\n                                            outlined\n                                            class=\"text-capitalize rounded-4 black--text float-left\"\n                                            @click=\"cancel\"\n                                        >{{ $t(\"cancel\") }}\n                                        </v-btn>\n                                        <v-menu>\n                                            <template v-slot:activator=\"{ on }\">\n                                                <v-btn\n                                                    class=\"ml-2 float-right text-capitalize rounded-4 black--text\"\n                                                    v-on=\"on\"\n                                                >\n                                                    {{ $t(\"save_option\") }}\n                                                    <v-icon size=\"\" class=\"ma-1\">expand_more</v-icon>\n                                                </v-btn>\n                                            </template>\n                                            <v-list rounded>\n                                                <v-list-item-group>\n                                                    <v-list-item>\n                                                        <v-list-item-content>\n                                                            <v-list-item-title>\n                                                                {{ $t(\"save_draft\") }}\n                                                            </v-list-item-title>\n                                                        </v-list-item-content>\n                                                    </v-list-item>\n                                                    <v-list-item>\n                                                        <v-list-item-content>\n                                                            <v-list-item-title @click=\"savePrint\"\n                                                            >{{ $t(\"save_print\") }}\n                                                            </v-list-item-title>\n                                                        </v-list-item-content>\n                                                    </v-list-item>\n                                                </v-list-item-group>\n                                            </v-list>\n                                        </v-menu>\n                                        <v-btn\n                                            color=\"primary\"\n                                            v-if=\"!isEdit\"\n                                            @click=\"saveNew\"\n                                            class=\"float-right white--text text-capitalize rounded-pill\"\n                                        >\n                                            {{ $t(\"save_close\") }}\n                                        </v-btn>\n                                    </v-card>\n                                </v-form>\n                            </v-col>\n                            <!-- <v-col\n                              class=\"smallSide\"\n                              sm=\"4\"\n                              style=\"transition: .3s ease-in;\"\n                              :class=\"{ hide_small_bar_class: isHideBar }\"\n                            >\n                              <h3\n                                style=\"color: #b3b5bc; font-size:20px;\"\n                                v-if=\"!isHideBar\"\n                                class=\"text-uppercase float-right mt-n3\"\n                              >\n                                <span class=\"pointer\" @click=\"Help('production order')\">\n                                  {{ $t(\"help\") }}\n                                </span>\n                                <v-icon\n                                  onclick=\"window.history.go(-1); return false;\"\n                                  style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                                  class=\"float-right mt-n1\"\n                                  >close\n                                </v-icon>\n                              </h3>\n\n                              <div v-if=\"!isHideBar\" class=\"small_sidebar mt-9 grayBg\">\n                                <v-row>\n                                  <v-col sm=\"12\" cols=\"12\">\n                                    <h4 class=\"mb-3 text-uppercase\">{{ $t(\"analysis\") }}</h4>\n                                    <label class=\"label mb-0\">{{\n                                      $t(\"default_warehouse\")\n                                    }}</label>\n                                    <v-select\n                                      :items=\"warehouses\"\n                                      class=\"mt-2\"\n                                      v-model=\"productionOrder.warehouse\"\n                                      item-text=\"name\"\n                                      item-value=\"id\"\n                                      :placeholder=\"$t('warehouse')\"\n                                      :rules=\"[(v) => !!v || 'Warehouse is required']\"\n                                      return-object\n                                      tage=\"Warehouse\"\n                                      outlined\n                                    />\n                                    <label class=\"label mb-0\">{{ $t(\"segment\") }}</label>\n                                    <v-select\n                                      class=\"mt-2\"\n                                      v-model=\"productionOrder.segment\"\n                                      :items=\"segments\"\n                                      item-value=\"id\"\n                                      :item-text=\"(item) => `${item.code} - ${item.name}`\"\n                                      return-object\n                                      tage=\"segment\"\n                                      placeholder=\"segment\"\n                                      outlined=\"\"\n                                    />\n\n                                    <label class=\"label\">{{ $t(\"project\") }}</label>\n                                    <v-select\n                                      class=\"mt-1\"\n                                      v-model=\"productionOrder.project\"\n                                      :items=\"projects\"\n                                      :item-text=\"(item) => `${item.code} - ${item.name}`\"\n                                      item-value=\"id\"\n                                      tage=\"Project\"\n                                      outlined\n                                    />\n\n                                  </v-col>\n                                </v-row>\n                                <v-divider class=\"mb-3\" />\n                                <v-row>\n\n                                </v-row>\n\n                                <p class=\"mb-0 detial_smallside_p\">\n                                  {{ $t(\"product_funct_order_desc\") }}\n                                </p>\n                              </div>\n                            </v-col> -->\n                        </v-row>\n                    </v-card>\n                </v-col>\n            </v-row>\n            <LoadingMe\n                :isLoading=\"showLoading\"\n                :fullPage=\"false\"\n                type=\"loading\"\n                :myLoading=\"true\"\n            />\n        </v-container>\n    </v-app>\n</template>\n\n<script>\nimport DatePickerComponent from \"@/components/custom_templates/DatePickerComponent\";\nimport { DropDownList } from \"@progress/kendo-vue-dropdowns\";\nimport ProductionOrder from \"@/scripts/model/ProductionOrder\";\nimport kendo from \"@progress/kendo-ui\";\nimport {ShowResource} from \"@/observable/store\";\nimport BomModel from \"@/scripts/model/Bom\";\nimport uomPriceHandler from \"@/scripts/uomPriceHandler\";\nimport $ from \"jquery\";\n// import {uuid} from \"vue-uuid\";\n\nconst productVariantHandler = require(\"@/scripts/productVariantHandler\");\nconst warehouseHandler = require(\"@/scripts/warehouseHandler\");\nconst bomHandler = require(\"@/scripts/bomHandler\");\nconst settingsHandler = require(\"@/scripts/settingsHandler\");\nconst saleChannelHandler = require(\"@/scripts/saleChannelHandler\");\nconst locationHandler = require(\"@/scripts/locationHandler\");\nconst projectHandler = require(\"@/scripts/projectHandler\");\nconst prefixHandler = require(\"@/scripts/prefixHandler\");\nconst billingHandler = require(\"@/scripts/invoice/handler/billingHandler\");\nconst productionOrderHandler = require(\"@/scripts/productionOrderHandler\");\nconst keyField = \"id\";\nconst textField = \"name\";\nconst emptyItem = {[textField]: \"loading ...\"};\nconst bomModel = new BomModel({});\n// const $ = require(\"jquery\")\nexport default {\n    name: \"ProductionOrder\",\n    components: {\n        LoadingMe: () => import(`@/components/Loading`),\n        \"app-datepicker\": DatePickerComponent,\n        dropdownlist: DropDownList,\n    },\n    data: () => ({\n        isEdit: false,\n        showLoading: false,\n        loadingAlert: false,\n        alert: false,\n        valid: true,\n        templates: [\n            {title: \"Draft\"},\n            {title: \"Open\"},\n            {title: \"Paid\"},\n            {title: \"Partially Paid\"},\n        ],\n        isHideBar: false,\n        productBaseUrl: productVariantHandler.itemSearchURL(),\n        productList: [],\n        dataItemKey: \"id\",\n        textField: \"name\",\n        defaultItem: {[textField]: \"Select product...\", [keyField]: null},\n        requestStarted: false,\n        productionOrder: new ProductionOrder({}),\n        bom: bomModel,\n        projects: [],\n        boms: [],\n        bomSeleted: {},\n        yieldUoms: [],\n        warehouses: [],\n        warehouse: {},\n        segments: [],\n        saleChannelList: [],\n        locations: [],\n        transactionTypes: [],\n        uom: \"\",\n        transactionNote: \"\",\n        componentUsedData: [],\n        otherFinishProductData: [],\n        totalCost: 0,\n        variance: 0,\n        decimalFormat: 2,\n    }),\n    methods: {\n        numberFormat(value) {\n            return kendo.toString(value, `n${this.decimalFormat}`);\n        },\n        itemTemplate(dataItem) {\n            const item = dataItem.item;\n            if (item) {\n                return `<span>${item.name ? item.name : ``}</span>`;\n            } else {\n                return ``;\n            }\n        },\n        UOMTemplate(dataItem) {\n            const uom = dataItem.buom;\n            if (uom) {\n                return `<span>${uom.name ? uom.name : ``}</span>`;\n            } else {\n                return ``;\n            }\n        },\n        Help(key_search) {\n            ShowResource(key_search);\n        },\n        onChangeQty() {\n            const produceQty = this.productionOrder.qty;\n            let fpAmount = 0;\n            const finishProduct = this.bomSeleted.finishProduct || [];\n            finishProduct.map((n) => {\n                if (!n.hasOwnProperty(\"decimalFormat\")) {\n                    n[\"decimalFormat\"] = \"n2\";\n                }\n                const yQty = n.yieldQty * kendo.parseFloat(produceQty);\n                const iCost = n.cost;\n                const amount = iCost * yQty;\n                n[\"yieldQty\"] = yQty;\n                n[\"amount\"] = amount;\n                fpAmount += amount;\n                return {\n                    ...n,\n                };\n            });\n            this.productionOrder.finishProduct = finishProduct;\n            const componentUseAmt = this.addGridComponentUsed(\n                this.bomSeleted.componentUsed,\n                produceQty\n            );\n            const otherFinishProductUseAmt = this.addGridOtherProduct(\n                this.bomSeleted.otherFinishProduct,\n                produceQty\n            );\n\n            this.productionOrder.amount = componentUseAmt;\n            this.totalCost = componentUseAmt;\n            this.productionOrder.exchangeAmount = componentUseAmt;\n            this.productionOrder.variance =\n                fpAmount + otherFinishProductUseAmt - componentUseAmt;\n            this.varince = fpAmount + otherFinishProductUseAmt - componentUseAmt;\n            // this.calculateVariance(fpAmount)\n            // window.console.log(produceQty, 'change qty')\n        },\n        async onChangeBom(e) {\n            this.bomSeleted = e;\n            window.console.log(e, 'bomSeleted')\n            // this.productionOrder = e\n            this.transactionNote = this.bomSeleted.transactionNote;\n            this.productionOrder.warehouse = this.bomSeleted.warehouse;\n            const otherFinishProduct = this.bomSeleted.otherFinishProduct || [];\n            otherFinishProduct.map((n) => {\n                if (!n.hasOwnProperty(\"decimalFormat\")) {\n                    n[\"decimalFormat\"] = \"n2\";\n                }\n                return {\n                    ...n,\n                };\n            });\n            this.otherFinishProductData = otherFinishProduct;\n            const componentUsed = this.bomSeleted.componentUsed || [];\n            componentUsed.map((n) => {\n                if (!n.hasOwnProperty(\"decimalFormat\")) {\n                    n[\"decimalFormat\"] = \"n2\";\n                }\n                return {\n                    ...n,\n                };\n            });\n            this.componentUsedData = componentUsed;\n            this.productionOrder.qty = 1;\n            this.productionOrder.yieldUOM = e.finishProduct[0].buom || {};\n            const yieldUOM = this.productionOrder.yieldUOM;\n            if (yieldUOM.hasOwnProperty(\"name\")) {\n                this.uom = this.productionOrder.yieldUOM.name;\n            }\n            this.totalCost = this.bomSeleted.amount;\n            this.productionOrder.amount = this.bomSeleted.amount;\n            this.productionOrder.exchangeAmount = this.bomSeleted.amount;\n            this.productionOrder.variance = this.bomSeleted.variance;\n            this.variance = this.bomSeleted.variance;\n        },\n        addGridComponentUsed(data, produceQty) {\n            try {\n                let totalCost_ = 0;\n                this.componentUsedData = data || [];\n                kendo\n                    .jQuery(\"#componentUse\")\n                    .data(\"kendoGrid\")\n                    .dataSource.data([]);\n                let ds = this.$refs.componentUseDS.kendoWidget();\n                this.componentUsedData.forEach((itm, index) => {\n                    const yQty = itm.qty * kendo.parseFloat(produceQty);\n                    const iCost = itm.cost;\n                    const amount = iCost * yQty;\n                    totalCost_ += amount;\n                    ds.insert(index + 1, {\n                        id: itm.id,\n                        item: itm.item,\n                        description: itm.description,\n                        buom: itm.buom || {},\n                        uom: itm.uom,\n                        qty: yQty,\n                        cost: iCost,\n                        amount: amount,\n                        sku: itm.sku,\n                        decimalFormat: itm.decimalFormat,\n                    });\n                });\n                this.totalCost = totalCost_;\n                this.productionOrder.amount = totalCost_;\n                this.productionOrder.exchangeAmount = totalCost_;\n                this.productionOrder.componentUsed = ds.data().map((itm) => {\n                    return {\n                        id: itm.id,\n                        item: itm.item,\n                        description: itm.description,\n                        buom: itm.buom || {},\n                        uom: itm.uom,\n                        qty: itm.qty,\n                        cost: itm.cost,\n                        amount: itm.amount,\n                        sku: itm.sku,\n                        decimalFormat: itm.decimalFormat,\n                    };\n                });\n                return totalCost_;\n            } catch (e) {\n                window.console.log(\"error\", e);\n                return 0;\n            }\n        },\n        addGridOtherProduct(data, produceQty) {\n            try {\n                let oFpAmount = 0;\n                this.otherFinishProductData = data || [];\n                kendo\n                    .jQuery(\"#gridOtherProduct\")\n                    .data(\"kendoGrid\")\n                    .dataSource.data([]);\n                let ds = this.$refs.otherProductDS.kendoWidget();\n                this.otherFinishProductData.forEach((itm, index) => {\n                    const yQty = itm.yieldQty * kendo.parseFloat(produceQty);\n                    const iCost = itm.cost;\n                    const amount = iCost * yQty;\n                    oFpAmount += amount;\n                    ds.insert(index + 1, {\n                        id: itm.id,\n                        item: itm.item,\n                        description: itm.description,\n                        buom: itm.buom || {},\n                        uom: itm.uom,\n                        yieldQty: yQty,\n                        cost: iCost,\n                        amount: amount,\n                        sku: itm.sku,\n                        decimalFormat: itm.decimalFormat,\n                    });\n                });\n                this.productionOrder.otherFinishProduct = ds.data().map((itm) => {\n                    return {\n                        id: itm.id,\n                        item: itm.item,\n                        description: itm.description,\n                        buom: itm.buom || {},\n                        uom: itm.uom,\n                        yieldQty: itm.yieldQty,\n                        cost: itm.cost,\n                        amount: itm.amount,\n                        sku: itm.sku,\n                        decimalFormat: itm.decimalFormat,\n                    };\n                });\n                return oFpAmount;\n            } catch (e) {\n                window.console.log(\"error\", e);\n                return 0;\n            }\n        },\n        calculateVariance() {\n            const cDS = this.$refs.componentUseDS.kendoWidget();\n            const oPDS = this.$refs.otherProductDS.kendoWidget();\n            let amount = 0;\n            cDS.data().forEach((n) => {\n                amount += parseFloat(n.amount);\n            });\n            oPDS.data().forEach((n) => {\n                amount += parseFloat(n.amount);\n            });\n            this.productionOrder.amount = amount;\n        },\n\n        async loadPrefix() {\n            new Promise((resolve) => {\n                setTimeout(async () => {\n                    resolve(\"resolved\");\n                    await prefixHandler.get(\"production order\").then(async (res) => {\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false;\n                            this.transactionTypes = res.data.data;\n                            if (this.transactionTypes.length > 0) {\n                                this.productionOrder.transactionType = this.transactionTypes[0];\n                                if (this.$route.params.id === undefined) {\n                                    await this.generateNumber();\n                                }\n                            }\n                        }\n                    });\n                }, 10);\n            });\n        },\n        async generateNumber() {\n            if (this.productionOrder.dueDate !== \"\") {\n                let data = {\n                    abbr: this.productionOrder.transactionType.abbr,\n                    structure: this.productionOrder.transactionType.structure,\n                    transactionDate: this.productionOrder.dueDate,\n                    sequcencing: this.productionOrder.transactionType.sequcencing,\n                    prefixSeparator: this.productionOrder.transactionType.prefixSeparator || '',\n                    numberSeparator: this.productionOrder.transactionType.numberSeparator || '',\n                    format: this.productionOrder.transactionType.format || 5,\n                    type: \"Production Order\",\n                    entity: 2,\n                };\n                this.productionOrder.abbr = data.abbr;\n                this.productionOrder.structure = data.structure;\n                this.productionOrder.sequcencing = data.sequcencing;\n                this.productionOrder.transactionDate = data.transactionDate;\n                this.productionOrder.type = data.type;\n                await billingHandler\n                    .lastNumber(data)\n                    .then((response) => {\n                        if (response.data.statusCode === 200) {\n                            const res = response.data.data;\n                            const lastNumber = this.zeroPad(\n                                parseInt(res.lastNumber),\n                                this.productionOrder.transactionType.format\n                            );\n                            this.productionOrder.number =\n                                res.suffix +\n                                this.productionOrder.transactionType.numberSeparator +\n                                lastNumber;\n                            this.productionOrder.lastNumber = res.suffix + lastNumber;\n                            window.console.log(this.productionOrder.number, \"production\");\n                        }\n                    })\n                    .catch((e) => {\n                        this.errors.push(e);\n                    });\n            }\n        },\n        zeroPad(num, places) {\n            return String(num).padStart(places, \"0\");\n        },\n        suffix(transactionDate) {\n            return kendo.toString(new Date(transactionDate), `yymm`);\n        },\n        async dataSourceChangedOP(e) {\n            if (e.field) {\n                let dataRow = e.items[0],\n                    buom = {};\n                switch (e.field) {\n                    case \"item\":\n                        dataRow.set(\"description\", dataRow.item.description);\n                        dataRow.set(\"yieldQty\", 1);\n                        buom = dataRow.item.uom;\n                        dataRow.set(\"buom\", buom);\n                        await this.inventoryBalanceByItem(dataRow, dataRow.item.id, 1);\n                        break;\n                    case \"yieldQty\":\n                        dataRow.set(\n                            \"amount\",\n                            parseFloat(dataRow.cost) * parseFloat(dataRow.yieldQty)\n                        );\n                        // this.costOFP = dataRow.amount\n                        break;\n                    case \"cost\":\n                        dataRow.set(\n                            \"amount\",\n                            parseFloat(dataRow.cost) * parseFloat(dataRow.yieldQty)\n                        );\n                        // this.costOFP = dataRow.amount\n                        window.console.log(dataRow.cost);\n                        break;\n                    default:\n                        break;\n                }\n                if (e.field) {\n                    this.autoCalculateGrid1();\n                    this.autoCalculateGrid2();\n                    this.autoCalculateGrid3();\n                }\n            }\n        },\n        ItemDropDownEditorFP(container, options) {\n            kendo\n                .jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"contains\",\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    headerTemplate:\n                        '<div class=\"dropdown-header k-widget k-header\">' +\n                        \"<span>Items </span>\" +\n                        \"<span></span>\" +\n                        \"</div>\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        serverFiltering: true,\n                        transport: {\n                            read: {\n                                url: productVariantHandler.itemVariantSearchURL(), // variant only\n                            },\n                            dataType: \"json\",\n                        },\n                        schema: {\n                            model: {\n                                id: \"id\",\n                                fields: {\n                                    id: { type: \"string\" },\n                                    name: { type: \"string\" },\n                                    sku: { type: \"string\" },\n                                },\n                            },\n                            data: function(response) {\n                                return response.data;\n                            },\n                            total: function(response) {\n                                return response.data.count;\n                            },\n                        },\n                        // data: this.variants\n                    }),\n                });\n        },\n        UOMDropDownEditorOP(container, options) {\n            kendo\n                .jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"uom.toUOM.name\",\n                    dataValueField: \"uom.toUOM.id\",\n                    cascadeFrom: \"item\",\n                    template: \"<span>#=uom.toUOM.name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        serverFiltering: true,\n                        transport: {\n                            read: {\n                                url: uomPriceHandler.getUrl(options.model.item.id),\n                            },\n                            dataType: \"json\",\n                        },\n                        schema: {\n                            model: {\n                                id: \"id\",\n                                fields: {\n                                    id: { type: \"string\" },\n                                    // name: {type: \"string\"},\n                                    // sku: {type: \"string\"},\n                                },\n                            },\n                            data: function(response) {\n                                return response.data;\n                            },\n                            total: function(response) {\n                                return response.data.count;\n                            },\n                        },\n                        // data: this.variants\n                    }),\n                });\n        },\n        removeRowOP(e) {\n            e.preventDefault();\n            const grid = kendo.jQuery(\"#gridOtherProduct\").data(\"kendoGrid\"),\n                dataSource = grid.dataSource,\n                dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n            if (dataSource.total() > 1) {\n                dataSource.remove(dataItem);\n            }\n        },\n        async loadProjects() {\n            await projectHandler.list().then((res) => {\n                this.projects = res.data.data;\n                if (this.projects.length > 0) {\n                    this.productionOrder.project = this.projects[0];\n                }\n            });\n        },\n        async loadWarehouses() {\n            warehouseHandler.getWarehouseSettingAll().then((res) => {\n                this.warehouses = res;\n            });\n        },\n        async onChange(event) {\n            const value = event.value;\n            if (value && value[textField] === emptyItem[textField]) {\n                return;\n            }\n            this.showLoading = true;\n            window.console.log(value);\n            this.productionOrder.product = value;\n            await this.onloadBom(value.id);\n        },\n        onFilterChange() {\n            // const filter = event.filter.value\n            this.requestData(0, this.productBaseUrl);\n        },\n        requestData(skip, baseUrl) {\n            const url = baseUrl;\n            this.requestStarted = true;\n            fetch(url)\n                .then((response) => {\n                    // window.console.log(response.json())\n                    return response.json();\n                })\n                .then(this.afterFetch);\n        },\n        afterFetch(json) {\n            this.productList = json.data;\n        },\n        async onloadBom(productId) {\n            bomHandler.getByProduct(productId).then((res) => {\n                this.boms = res;\n                this.transactionNote = res.transactionNote;\n                this.showLoading = false;\n            });\n        },\n        taxTemplate(dataItem) {\n            window.console.log(\"vat\", dataItem.tax);\n            const vat = dataItem.tax;\n            if (vat) {\n                return `<span>${vat.defaultTax ? vat.defaultTax : ``}</span>`;\n            } else {\n                return ``;\n            }\n        },\n        TaxDropDownEditor(container, options) {\n            kendo\n                .jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=defaultTax#</span>\",\n                    optionLabel: \"--Select--\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.vatTax,\n                    }),\n                });\n        },\n        rowNumberCU(dataItem) {\n            let ds = this.$refs.componentUseDS.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        rowNumberOP(dataItem) {\n            let ds = this.$refs.otherProductDS.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        UOMTemplateOP(dataItem) {\n            const uom = dataItem.uom;\n            if (uom) {\n                return `<span>${uom.uom ? uom.uom.name : ``}</span>`;\n            } else {\n                return ``;\n            }\n        },\n        UOMTemplateCU(dataItem) {\n            const uom = dataItem.uom;\n            if (uom) {\n                return `<span>${uom.uom ? uom.uom.name : ``}</span>`;\n            } else {\n                return ``;\n            }\n        },\n        rowNumberOC(dataItem) {\n            let ds = this.$refs.otherCostDS.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        async loadSegment() {\n            new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve(\"resolved\");\n                    this.segments = [];\n                    settingsHandler\n                        .getSeg()\n                        .then((res) => {\n                            this.showLoading = true;\n                            if (res.data.statusCode === 200) {\n                                this.showLoading = false;\n                                this.segments = res.data.data;\n                                if (this.segments.length > 0) {\n                                    this.productionOrder.segment = this.segments[0];\n                                }\n                                // this.segmentList = res.data.data\n                            }\n                        })\n                        .catch();\n                    {\n                        this.showLoading = false;\n                    }\n                }, 10);\n            });\n        },\n        async loadLocation() {\n            new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve(\"resolved\");\n                    this.locations = [];\n                    locationHandler\n                        .list()\n                        .then((res) => {\n                            this.showLoading = true;\n                            if (res.data.statusCode === 200) {\n                                this.showLoading = false;\n                                this.locations = res.data.data;\n                                if (this.locations.length > 0) {\n                                    this.productionOrder.location = this.locations[0];\n                                }\n                            }\n                        })\n                        .catch();\n                    {\n                        this.showLoading = false;\n                    }\n                }, 10);\n            });\n        },\n        async loadSaleChannel() {\n            new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve(\"resolved\");\n                    this.showLoading = true;\n                    saleChannelHandler.get().then((res) => {\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false;\n                            this.saleChannelList = res.data.data;\n                            if (this.saleChannelList.length > 0) {\n                                this.productionOrder.saleChannel = this.saleChannelList[0];\n                            }\n                        } else {\n                            this.showLoading = false;\n                        }\n                    });\n                }, 10);\n            });\n        },\n        savePrint() {\n        },\n        saveNew() {\n            this.showLoading = true;\n            this.productionOrder.bom = new BomModel(this.bomSeleted);\n            this.productionOrder.transactionNote = this.transactionNote;\n            this.productionOrder.status = 1;\n\n            productionOrderHandler.create(this.productionOrder).then((res) => {\n                this.showLoading = false;\n                // this.$router.push({\n                //   name: 'Products',\n                //   path: 'product',\n                //   params: {dataPO: res.data.data}\n                // })\n                window.console.log(res);\n            });\n        },\n        errorMessage() {\n        },\n        accountDropDownEditor() {\n        },\n        cancel() {\n        },\n        hideSmallSidebar() {\n            this.isHideBar = !this.isHideBar;\n        },\n    },\n    watch: {\n        // call again the method if the route changes\n    },\n    async created() {\n        // fetch the data when the view is created and the data is\n        // already being observed\n        // this.loadObj()\n        // await this.loadPrefix()\n        this.productionOrder.dueDate = new Date().toISOString().substr(0, 10);\n        this.productionOrder.monthOf = new Date().toISOString().substr(0, 7);\n        await this.loadPrefix();\n    },\n    async mounted() {\n        // await this.loadPrefix()\n        await this.loadWarehouses();\n        await this.loadSaleChannel();\n        await this.loadSegment();\n        await this.loadLocation();\n        await this.loadProjects();\n        this.requestData(0, this.productBaseUrl);\n    },\n};\n</script>\n\n<style scoped>\n.small_sidebar {\n    height: 97%;\n    position: relative;\n    padding: 12px;\n}\n\n.hide_small_bar_class {\n    max-width: 0;\n    transition: 0.5s ease-in;\n    flex: 0 0 0;\n    padding: 0;\n}\n\n.hide_big_bar_class {\n    max-width: 100%;\n    transition: 0.5s ease-in;\n    flex: 0 0 100%;\n}\n\n.iconArrow {\n    right: -35px;\n    position: absolute;\n    bottom: -10px;\n}\n\n.iconArrowHide {\n    position: absolute;\n    right: -7px;\n    bottom: -10px;\n}\n\n.theme--light.v-data-table\n> .v-data-table__wrapper\n> table\n> tbody\n> tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {\n    background-color: transparent !important;\n}\n\n.detial_smallside_p {\n    position: absolute;\n    bottom: 10px;\n}\n\n@media (min-width: 1264px) {\n    .container {\n        /* max-width: 1185px; */\n        max-width: 1080px !important;\n    }\n}\n</style>\n"]}]}