{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/components/dropdownlist/BudgetListItemGroup.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/components/dropdownlist/BudgetListItemGroup.vue","mtime":1640595536762},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CgppbXBvcnQgU2VnbWVudE1vZGVsIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9TZWdtZW50LmpzIjsKaW1wb3J0IEJ1ZGdldE1vZGVsIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9CdWRnZXQuanMiOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0J1ZGdldExpc3RJdGVtR3JvdXAnLAogICAgcHJvcHM6IHsKICAgICAgICBpbml0QnVkZ2V0czogewogICAgICAgICAgICB0eXBlOiBBcnJheSwKICAgICAgICB9LAogICAgICAgIGluaXRGaXNjYWxZZWFyOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICB9LAogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc2VsZWN0ZWRCdWRnZXRzOiBbXSwKICAgICAgICAgICAgYnVkZ2V0TGlzdDogW10sCiAgICAgICAgICAgIGxvYWRpbmc6IGZhbHNlCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBhc3luYyBpbml0aWFsaXplICgpIHsKICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENhbGwgTGlzdAogICAgICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnYnVkZ2V0cy9nZXRMaXN0Jyk7CiAgICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzZWdtZW50cy9nZXRMaXN0JykKCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgaW5pdGlhbERhdGEoKXsKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEJ1ZGdldHMgPSB0aGlzLmluaXRCdWRnZXRzOwogICAgICAgIH0sCiAgICAgICAgZW1pdEJ1ZGdldHMoKSB7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2VtaXRCdWRnZXRzJywgdGhpcy5zZWxlY3RlZEJ1ZGdldHMpOwogICAgICAgIH0sCiAgICAgICAgZmlsdGVyQnlGaXNjYWxZZWFyKCl7CiAgICAgICAgICAgIGxldCBidWRnZXRMaXN0ID0gW107CgogICAgICAgICAgICB0aGlzLmJ1ZGdldHMuZm9yRWFjaCh2YWx1ZSA9PiB7CiAgICAgICAgICAgICAgICBpZih2YWx1ZS5maXNjYWxfeWVhci51dWlkID09PSB0aGlzLmluaXRGaXNjYWxZZWFyICYmIHZhbHVlLnNlZ21lbnRfdXVpZCAhPT0gIiIgJiYgdmFsdWUucHJvamVjdF91dWlkID09PSAiIil7CiAgICAgICAgICAgICAgICAgICAgbGV0IGJ1ZGdldCA9IG5ldyBCdWRnZXRNb2RlbCh2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgYnVkZ2V0LnNlZ21lbnQgPSBuZXcgU2VnbWVudE1vZGVsKHRoaXMuc2VnbWVudHMuZmluZChpID0+IGkuaWQgPT09IHZhbHVlLnNlZ21lbnRfdXVpZCkpOwoKICAgICAgICAgICAgICAgICAgICBidWRnZXRMaXN0LnB1c2goYnVkZ2V0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICB0aGlzLmJ1ZGdldExpc3QgPSBidWRnZXRMaXN0OwogICAgICAgIH0sCiAgICAgICAgdG9nZ2xlKCkgewogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5saWtlc0FsbEZydWl0KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEJ1ZGdldHMgPSBbXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGlkcyA9IFtdOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYnVkZ2V0TGlzdC5mb3JFYWNoKHZhbHVlID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWRzLnB1c2godmFsdWUudXVpZCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEJ1ZGdldHMgPSBpZHM7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLmVtaXRCdWRnZXRzKCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgIH0sCiAgICB3YXRjaDogewogICAgICAgIGluaXRCdWRnZXRzOiAiaW5pdGlhbERhdGEiLAogICAgICAgIGluaXRGaXNjYWxZZWFyOiAiZmlsdGVyQnlGaXNjYWxZZWFyIiwKICAgIH0sCiAgICBjb21wdXRlZDogewogICAgICAgIC4uLm1hcFN0YXRlKHsKICAgICAgICAgICAgYnVkZ2V0czogc3RhdGUgPT4gc3RhdGUuYnVkZ2V0cy5saXN0LAogICAgICAgICAgICBzZWdtZW50czogc3RhdGUgPT4gc3RhdGUuc2VnbWVudHMubGlzdAogICAgICAgIH0pLAogICAgICAgIGxpa2VzQWxsRnJ1aXQoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkQnVkZ2V0cy5sZW5ndGggPT09IHRoaXMuYnVkZ2V0TGlzdC5sZW5ndGgKICAgICAgICB9LAogICAgICAgIGxpa2VzU29tZUZydWl0KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEJ1ZGdldHMubGVuZ3RoID4gMCAmJiAhdGhpcy5saWtlc0FsbEZydWl0CiAgICAgICAgfSwKICAgICAgICBpY29uKCkgewogICAgICAgICAgICBpZiAodGhpcy5saWtlc0FsbEZydWl0KSByZXR1cm4gJ21kaS1jbG9zZS1ib3gnCiAgICAgICAgICAgIGlmICh0aGlzLmxpa2VzU29tZUZydWl0KSByZXR1cm4gJ21kaS1taW51cy1ib3gnCiAgICAgICAgICAgIHJldHVybiAnbWRpLWNoZWNrYm94LWJsYW5rLW91dGxpbmUnCiAgICAgICAgfSwKICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpOwogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgLyogSW5pdGlhbCBEYXRhICovCiAgICAgICAgdGhpcy5pbml0aWFsRGF0YSgpOwogICAgfQp9Cg=="},{"version":3,"sources":["BudgetListItemGroup.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BudgetListItemGroup.vue","sourceRoot":"src/components/dropdownlist","sourcesContent":["<template>\n    <div>\n        <v-select\n            :loading=\"loading\"\n            v-model=\"selectedBudgets\"\n            :items=\"budgetList\"\n            item-text=\"name\"\n            item-value=\"uuid\"\n            @change=\"emitBudgets\"\n            placeholder=\"Select Budgets\"\n            multiple\n            class=\"mt-1\"\n            outlined\n        >\n            <template v-slot:prepend-item>\n                <v-list-item\n                    ripple\n                    @click=\"toggle\"\n                >\n                    <v-list-item-action>\n                        <v-icon :color=\"selectedBudgets.length > 0 ? 'indigo darken-4' : ''\">\n                            {{ icon }}\n                        </v-icon>\n                    </v-list-item-action>\n                    <v-list-item-content>\n                        <v-list-item-title>\n                            Select All\n                        </v-list-item-title>\n                    </v-list-item-content>\n                </v-list-item>\n                <v-divider class=\"mt-2\"></v-divider>\n            </template>\n\n            <template v-slot:selection=\"{ item, index }\">\n                <v-chip v-if=\"index === 0\">\n                    <span>{{ item.name }}</span>\n                </v-chip>\n                <span v-if=\"index === 1\" class=\"font_14\">\n                    (+{{ selectedBudgets.length - 1 }} others)\n                </span>\n            </template>\n\n        </v-select>\n    </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\n\nimport SegmentModel from \"@/scripts/model/Segment.js\";\nimport BudgetModel from \"@/scripts/model/Budget.js\";\n\nexport default {\n    name: 'BudgetListItemGroup',\n    props: {\n        initBudgets: {\n            type: Array,\n        },\n        initFiscalYear: {\n            type: String,\n        },\n    },\n    data() {\n        return {\n            selectedBudgets: [],\n            budgetList: [],\n            loading: false\n        }\n    },\n    methods: {\n        async initialize () {\n            this.loading = true;\n            \n            // Call List\n            await this.$store.dispatch('budgets/getList');\n            await this.$store.dispatch('segments/getList')\n\n            this.loading = false;\n        },\n        initialData(){\n            this.selectedBudgets = this.initBudgets;\n        },\n        emitBudgets() {\n            this.$emit('emitBudgets', this.selectedBudgets);\n        },\n        filterByFiscalYear(){\n            let budgetList = [];\n\n            this.budgets.forEach(value => {\n                if(value.fiscal_year.uuid === this.initFiscalYear && value.segment_uuid !== \"\" && value.project_uuid === \"\"){\n                    let budget = new BudgetModel(value);\n                    budget.segment = new SegmentModel(this.segments.find(i => i.id === value.segment_uuid));\n\n                    budgetList.push(budget);\n                }\n            });\n\n            this.budgetList = budgetList;\n        },\n        toggle() {\n            this.$nextTick(() => {\n                if (this.likesAllFruit) {\n                    this.selectedBudgets = [];\n                } else {\n                    let ids = [];\n                    this.budgetList.forEach(value => {\n                        ids.push(value.uuid);\n                    });\n                    this.selectedBudgets = ids;\n                }\n                this.emitBudgets();\n            })\n        },\n    },\n    watch: {\n        initBudgets: \"initialData\",\n        initFiscalYear: \"filterByFiscalYear\",\n    },\n    computed: {\n        ...mapState({\n            budgets: state => state.budgets.list,\n            segments: state => state.segments.list\n        }),\n        likesAllFruit() {\n            return this.selectedBudgets.length === this.budgetList.length\n        },\n        likesSomeFruit() {\n            return this.selectedBudgets.length > 0 && !this.likesAllFruit\n        },\n        icon() {\n            if (this.likesAllFruit) return 'mdi-close-box'\n            if (this.likesSomeFruit) return 'mdi-minus-box'\n            return 'mdi-checkbox-blank-outline'\n        },\n    },\n    created() {\n        this.initialize();\n    },\n    mounted() {\n        /* Initial Data */\n        this.initialData();\n    }\n}\n</script>"]}]}