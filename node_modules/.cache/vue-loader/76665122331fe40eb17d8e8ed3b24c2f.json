{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/customers/CashRefund.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/customers/CashRefund.vue","mtime":1638499443182},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEYXRlUGlja2VyQ29tcG9uZW50IGZyb20gIkAvY29tcG9uZW50cy9jdXN0b21fdGVtcGxhdGVzL0RhdGVQaWNrZXJDb21wb25lbnQiOwppbXBvcnQga2VuZG8gZnJvbSAiQHByb2dyZXNzL2tlbmRvLXVpIjsKaW1wb3J0IHsgRHJvcERvd25MaXN0IH0gZnJvbSAiQHByb2dyZXNzL2tlbmRvLXZ1ZS1kcm9wZG93bnMiOwppbXBvcnQgU2FsZUZvcm1Db250ZW50TW9kZWwgZnJvbSAiQC9zY3JpcHRzL21vZGVsL1NhbGVGb3JtQ29udGVudCI7CmltcG9ydCBJdGVtTGluZU1vZGVsIGZyb20gIkAvc2NyaXB0cy9pbnZvaWNlL21vZGVsL0l0ZW1MaW5lIjsKaW1wb3J0IHsgdXVpZCB9IGZyb20gInZ1ZS11dWlkIjsKaW1wb3J0IHRyYW5zYWN0aW9uTW9kZWwgZnJvbSAiQC9zY3JpcHRzL21vZGVsL1RyYW5zYWN0aW9uIjsKCi8qIFN0b3JlICovCmltcG9ydCBzdG9yZSBmcm9tICJAL3N0b3JlIjsKY29uc3QgaW5zdGl0dXRlID0gc3RvcmUuc3RhdGUuaW5zdGl0dXRlLmluc3RpdHV0ZTsKCmltcG9ydCBDYXNoQWNjb3VudExpbmVNb2RlbCBmcm9tICJAL3NjcmlwdHMvc2FsZV9kZXBvc2l0L21vZGVsL0l0ZW1MaW5lIjsKaW1wb3J0IHsgRXhwZW5zZUVudHJ5RXh0ZW5kZWRNb2RlbCB9IGZyb20gIkAvc2NyaXB0cy9tb2RlbC9BcHBNb2RlbHMiOwppbXBvcnQgSGVscGVyIGZyb20gIkAvaGVscGVyLmpzIjsKY29uc3QgY2FzaEFjY291bnRMaW5lTW9kZWwgPSBuZXcgQ2FzaEFjY291bnRMaW5lTW9kZWwoe30pOwovLy8vaGFuZGxlcgpjb25zdCB0cmFuc2FjdGlvbkhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvdHJhbnNhY3Rpb25IYW5kbGVyIik7CmNvbnN0IGJpbGxpbmdIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2ludm9pY2UvaGFuZGxlci9iaWxsaW5nSGFuZGxlciIpOwpjb25zdCBjdXN0b21lckhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvY3VzdG9tZXJIYW5kbGVyIik7CmNvbnN0IHByb2plY3RIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3Byb2plY3RIYW5kbGVyIik7CmNvbnN0IHByZWZpeEhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvcHJlZml4SGFuZGxlciIpOwpjb25zdCBwcmljZUxldmVsSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9wcmljZUxldmVsSGFuZGxlciIpOwpjb25zdCBzYWxlRm9ybUNvbnRlbnRIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3NhbGVGb3JtQ29udGVudEhhbmRsZXIiKTsKY29uc3QgZW1wbG95ZWVIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2VtcGxveWVlSGFuZGxlciIpOwpjb25zdCBpdGVtTW9kaWZpZXJIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2l0ZW1Nb2RpZmllckhhbmRsZXIiKTsKY29uc3QgZGlzY291bnRJdGVtSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9kaXNjb3VudEl0ZW1IYW5kbGVyIik7CmNvbnN0IHVvbVByaWNlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy91b21QcmljZUhhbmRsZXIiKTsKY29uc3QgcHJvZHVjdFZhcmlhbnRIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3Byb2R1Y3RWYXJpYW50SGFuZGxlciIpOwpjb25zdCBsb2NhdGlvbkhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvbG9jYXRpb25IYW5kbGVyIik7CmNvbnN0IHNldHRpbmdzSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9zZXR0aW5nc0hhbmRsZXIiKTsKY29uc3Qgc2FsZUNoYW5uZWxIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3NhbGVDaGFubmVsSGFuZGxlciIpOwpjb25zdCBzYWxlVW5pdEl0ZW1IYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3NhbGVVbml0SXRlbUhhbmRsZXIiKTsKY29uc3Qgc2V0dGluZ0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvc2V0dGluZ0hhbmRsZXIiKTsKY29uc3QgY2F0YWxvZ0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvY2F0YWxvZ0hhbmRsZXIiKTsKY29uc3QgcHJvZHVjdEhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvcHJvZHVjdEhhbmRsZXIiKTsKY29uc3QgY3VycmVuY3lIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2N1cnJlbmN5L2hhbmRsZXIvY3VycmVuY3lIYW5kbGVyIik7CmNvbnN0IGFjY291bnRIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2hhbmRsZXIvYWNjb3VudGluZy9hY2NvdW50Iik7Ci8vCmNvbnN0IHNhbGVGb3JtQ29udGVudE1vZGVsID0gbmV3IFNhbGVGb3JtQ29udGVudE1vZGVsKHt9KTsKY29uc3QgaXRlbUxpbmVNb2RlbCA9IG5ldyBJdGVtTGluZU1vZGVsKHt9KTsKY29uc3QgZXhwZW5zZUxpbmVzID0gbmV3IEV4cGVuc2VFbnRyeUV4dGVuZGVkTW9kZWwoe30pOwovL290aGVyCmNvbnN0ICQgPSByZXF1aXJlKCJqcXVlcnkiKTsKY29uc3QgdGV4dEZpZWxkID0gIm51bWJlck5hbWUiOwpjb25zdCBrZXlGaWVsZCA9ICJpZCI7CmNvbnN0IGRlZmF1bHRJdGVtID0geyBbdGV4dEZpZWxkXTogIlNlbGVjdCBjdXN0b21lci4uLiIsIFtrZXlGaWVsZF06IG51bGwgfTsKY29uc3QgZW1wdHlJdGVtID0geyBbdGV4dEZpZWxkXTogImxvYWRpbmcgLi4uIiB9Owpjb25zdCBpbnZvaWNlUHJlZml4ID0gImxpbi0iOwpjb25zdCB7CiAgVW9tRWRpdG9yLAogIFB1cmNoYXNlRGlzY291bnRJdGVtRWRpdG9yLAogIFB1cmNoYXNlVGF4RWRpdG9yLAp9ID0gcmVxdWlyZSgiQC9zY3JpcHRzL2tlbmRvX2VkaXRvci9Db2xsZWN0aW9ucyIpOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJDYXNoUmVmdW5kIiwKICBwcm9wczogewogICAgaWQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgfSwKICAgIGluaXRUcmFuc2FjdGlvbjogewogICAgICB0eXBlOiB0cmFuc2FjdGlvbk1vZGVsLAogICAgfSwKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmdNZTogKCkgPT4gaW1wb3J0KGBAL2NvbXBvbmVudHMvTG9hZGluZ2ApLAogICAgImFwcC1kYXRlcGlja2VyIjogRGF0ZVBpY2tlckNvbXBvbmVudCwKICAgIGRyb3Bkb3dubGlzdDogRHJvcERvd25MaXN0LAogIH0sCiAgZGF0YTogKCkgPT4gKHsKICAgIHRyYW5zYWN0aW9uOiBuZXcgdHJhbnNhY3Rpb25Nb2RlbCgpLAogICAgaXNFZGl0OiBmYWxzZSwKICAgIG51bVNlbGVjdDogWzFdLAogICAgZGlhbG9nVGF4OiBmYWxzZSwKICAgIHRoZURhdGU6ICIiLAogICAgc3VwcGxpZXJzX2l0ZW06IFtdLAogICAgLy9DYXRhbG9nCiAgICBkaWFsb2dDYXRhbG9nOiBmYWxzZSwKICAgIGdyaWRTY2hlbWE6IHsKICAgICAgbW9kZWw6IHsKICAgICAgICBpZDogImlkIiwKICAgICAgfSwKICAgIH0sCiAgICBpbWdVUkw6ICJodHRwczovL3MzLWFwLXNvdXRoZWFzdC0xLmFtYXpvbmF3cy5jb20vaW1hZ2VzLmJhbmhqaS8iLAogICAgLy8gTG9hZGluZ01lCiAgICBzaG93TG9hZGluZzogZmFsc2UsCiAgICBsb2FkaW5nQWxlcnQ6IGZhbHNlLAogICAgbG9hZGluZ0NvbG9yQWxlcnQ6ICIiLAogICAgbG9hZGluZ1RleHRBbGVydDogIiIsCiAgICBiaWxsX2RhdGU6ICIiLAogICAgYWxlcnQ6IGZhbHNlLAogICAgZmlsZXM6IFtdLAogICAgZXJyb3JzOiBbXSwKICAgIC8vIEZvcm0gdmFsaWRhdGlvbgogICAgdmFsaWQ6IHRydWUsCiAgICBjb2xfZXhwYW5kOiA5LAogICAgY29sX2hpZGU6IDMsCiAgICBpc0hpZGVCYXI6IGZhbHNlLAogICAgZmlsdGVyOiAiIiwKICAgIHRleHRGaWVsZDogIm51bWJlck5hbWUiLAogICAgZGF0YUl0ZW1LZXk6ICJpZCIsCiAgICBkZWZhdWx0SXRlbTogZGVmYXVsdEl0ZW0sCiAgICAvL2l0ZW0KICAgIGl0ZW1MaW5lczogW10sCiAgICBpdGVtTGluZTogaXRlbUxpbmVNb2RlbCwKICAgIGRhdGVGb3JtYXQ6IGl0ZW1MaW5lTW9kZWwuZGF0ZUZvcm1hdCwKICAgIC8vY3VzdG9tZXIKICAgIGN1c0Jhc2VVcmw6IGN1c3RvbWVySGFuZGxlci5zZWFyY2goKSwKICAgIGN1c3RvbWVyOiB7fSwKICAgIGN1c3RvbWVyTGlzdDogW10sCiAgICBlbXBsb3llZXM6IFtdLAogICAgbUVtcGxveWVlOiB7fSwKICAgIHNhbGVDaGFubmVsTGlzdDogW10sCiAgICBsb2NhdGlvbnM6IFtdLAogICAgY3VzdG9tZXJQcm9qZWN0czogW10sCiAgICBzZWdtZW50czogW10sCiAgICB0cmFuc2FjdGlvblR5cGU6IHt9LAogICAgdGF4TGlzdFRvdGFsOiB7fSwKICAgIGN1c3RvbWVyRGlzY291bnRJdGVtOiBbXSwKICAgIGN1c3RvbWVyU2FsZVVuaXQ6IFtdLAogICAgc2FsZUZvcm1Db250ZW50OiBzYWxlRm9ybUNvbnRlbnRNb2RlbCwKICAgIHRyYW5zYWN0aW9uRGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCksCiAgICBzcGVjaWZpY0Rpc2NvdW50SXRlbTogW10sCiAgICBzYWxlVW5pdEl0ZW1MaXN0OiBbXSwKICAgIG90aGVyVGF4OiBbXSwKICAgIHNwZWNpZmljVGF4OiBbXSwKICAgIHB1YmxpY0xpZ2h0aW5nVGF4OiBbXSwKICAgIHByaWNlTGV2ZWw6IFtdLAogICAgdmF0VGF4OiBbXSwKICAgIHRheDogW10sCiAgICBsb2dnZWRVc2VyOiB7CiAgICAgIGlkOiAiY2YzZDEwYWItYmNlNi00N2IzLTg0MDUtYjQ0OGMyM2RhZDg0IiwKICAgICAgbmFtZTogIk1yLiBJbnNwZWN0b3IiLAogICAgfSwKICAgIGNhdGFsb2dzOiBbXSwKICAgIHR4bkxpc3Q6IFtdLAogICAgcXVvdGVzOiBbXSwKICAgIHR4bkxpc3RzOiBbXSwKICAgIGlzU2F2ZU5ldzogZmFsc2UsCiAgICBpc1NhdmVDbG9zZTogZmFsc2UsCiAgICBpc1NhdmVQcmludDogZmFsc2UsCiAgICBpc1NhdmVEcmFmdDogZmFsc2UsCiAgICBleGNoYW5nZVJhdGU6IHt9LAogICAgYmFzZUN1cnJlbmN5Q29kZTogIiIsCiAgICBjdXJyZW5jeUNvZGU6ICIiLAogICAgdHJhbnNhY3Rpb25SYXRlOiAxLAogICAgc2F2ZU9wdGlvbjogIiIsCiAgICBmb3JtQVI6IFsKICAgICAgeyBpZDogMSwgbmFtZTogIkRlZmF1bHQgRm9ybSIgfSwKICAgICAgeyBpZDogMiwgbmFtZTogIkZvcm0gODBtbSIgfSwKICAgIF0sCiAgICAvL2Nhc2ggYWNjb3VudAogICAgY2FzaEFjY291bnQ6IHt9LAogICAgY2FzaEFjY291bnRMaW5lOiBjYXNoQWNjb3VudExpbmVNb2RlbCwKICAgIGFjY0Nhc2g6IFtdLAogICAgLy9leHNwZW5zZQogICAgZXhwZW5zZUxpbmVzOiBleHBlbnNlTGluZXMsCiAgICBQdXJjaGFzZVRheEVkaXRvcjogUHVyY2hhc2VUYXhFZGl0b3IsCiAgICBVb21FZGl0b3I6IFVvbUVkaXRvciwKICAgIFB1cmNoYXNlRGlzY291bnRJdGVtRWRpdG9yOiBQdXJjaGFzZURpc2NvdW50SXRlbUVkaXRvciwKICAgIGV4cGVuc2VBY2NvdW50czogW10sCiAgICBleHBlbnNlQWNjb3VudDoge30sCiAgfSksCiAgbWV0aG9kczogewogICAgaW5pdGlhbERhdGEoKSB7CiAgICAgIGlmICh0aGlzLmluaXRUcmFuc2FjdGlvbikgewogICAgICAgIC8vIEVkaXQgTW9kZQogICAgICAgIHRoaXMudHJhbnNhY3Rpb24gPSB0aGlzLnRyYW5zYWN0aW9uOwogICAgICAgIHRoaXMuYmluZERhdGEoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBCcmFuZCBOZXcgTW9kZQogICAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgdGhpcy5zZXREZWZhdWx0RGF0YSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHNldERlZmF1bHREYXRhKCkgewogICAgICAvLyBCcmFuZCBOZXcgTW9kZQogICAgICB0aGlzLmlzRWRpdCA9IGZhbHNlOwogICAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IHRyYW5zYWN0aW9uTW9kZWwoe30pOwogICAgICB0aGlzLnRyYW5zYWN0aW9uLmZvcm1UZW1wbGF0ZSA9IDE7CiAgICAgIC8vIEdlbmVyYXRlIE51bWJlcgogICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLml0ZW1MaW5lRFMua2VuZG9XaWRnZXQoKTsKICAgICAgZHMuZGF0YShbXSk7CiAgICAgIC8vIEFkZCAyIGRlZmF1bHQgbGluZXMKICAgICAgdGhpcy5hZGRSb3coKTsKICAgICAgdGhpcy5hZGRDYXNoQWNjUm93KCk7CiAgICAgIHRoaXMuZXhwZW5zZUFkZFJvdygpOwogICAgICB0aGlzLmxvYWRQcmVmaXgoKTsKICAgICAgdGhpcy5sb2FkU2VnbWVudCgpOwogICAgICB0aGlzLmxvYWRMb2NhdGlvbigpOwogICAgICB0aGlzLmxvYWRTYWxlQ2hhbm5lbCgpOwogICAgICB0aGlzLmxvYWRQcmljZUxldmVsKCk7CiAgICAgIHRoaXMubUVtcGxveWVlID0ge307CiAgICAgIHRoaXMudGF4TGlzdFRvdGFsID0ge307CiAgICAgIHRoaXMuaXNTYXZlTmV3ID0gZmFsc2U7CiAgICAgIHRoaXMuaXNTYXZlQ2xvc2UgPSBmYWxzZTsKICAgICAgdGhpcy5pc1NhdmVQcmludCA9IGZhbHNlOwogICAgICB0aGlzLmlzU2F2ZURyYWZ0ID0gZmFsc2U7CiAgICB9LAogICAgYmluZERhdGEoKSB7CiAgICAgIC8vIEVkaXQgTW9kZQogICAgICB0aGlzLmlzRWRpdCA9IHRydWU7CiAgICAgIHRoaXMuY3VzdG9tZXIgPSB0aGlzLnRyYW5zYWN0aW9uLmN1c3RvbWVyOwogICAgICB0aGlzLnRheExpc3RUb3RhbCA9IHRoaXMudHJhbnNhY3Rpb24udGF4TGlzdFRvdGFsOwogICAgICB0aGlzLml0ZW1MaW5lcyA9IHRoaXMudHJhbnNhY3Rpb24uaXRlbUxpbmVzOwogICAgICB0aGlzLmxvYWRQcm9qZWN0QnlDdXN0b21lcigpOwogICAgfSwKICAgIGFkZFNlbGVjdCgpIHsKICAgICAgbGV0IGFtb3VudF9udW0gPSB0aGlzLm51bVNlbGVjdC5sZW5ndGg7CiAgICAgIGxldCBudW0gPSB0aGlzLm51bVNlbGVjdFthbW91bnRfbnVtIC0gMV07CiAgICAgIGxldCBuZXdfbnVtID0gbnVtICsgMTsKICAgICAgbGV0IGxlbmdodEl0ZW0gPSB0aGlzLnNwZWNpZmljRGlzY291bnRJdGVtLmxlbmd0aDsKICAgICAgaWYgKG5ld19udW0gPD0gbGVuZ2h0SXRlbSkgewogICAgICAgIHRoaXMubnVtU2VsZWN0LnB1c2gobmV3X251bSk7CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVTZWxlY3QoaW5kZXgpIHsKICAgICAgdGhpcy5udW1TZWxlY3Quc3BsaWNlKGluZGV4LCAxKTsKICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKGluZGV4LCB0aGlzLm51bVNlbGVjdCkKICAgICAgLy8gdGhpcy5zZWxlY3REaXNjb3VudC5zcGxpY2UoaW5kZXgsMSkKICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCJyZW1vdmUiLHRoaXMuc2VsZWN0RGlzY291bnQpCiAgICAgIC8vIHRoaXMuc2VsZWN0RGlzY291bnQgPSB0aGlzLnNlbGVjdERpc2NvdW50LmZpbHRlcihpdGVtID0+ICBpdGVtLmlkICE9IHZhbC5pZCk7CiAgICB9LAogICAgaGlkZV9zbWFsbHNpdGViYXIoKSB7CiAgICAgIGlmICghdGhpcy5pc0hpZGVCYXIpIHsKICAgICAgICAvLyB0aGlzLmNvbF9leHBhbmQgPSAxMgogICAgICAgIC8vIHRoaXMuY29sX2hpZGUgPSAwCiAgICAgICAgdGhpcy5pc0hpZGVCYXIgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIHRoaXMuY29sX2V4cGFuZCA9IDkKICAgICAgICAvLyB0aGlzLmNvbF9oaWRlID0gMwogICAgICAgIHRoaXMuaXNIaWRlQmFyID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBlcnJvck1lc3NhZ2UoKSB7fSwKICAgIC8vbnVtYmVyCiAgICBnZW5lcmF0ZU51bWJlcigpIHsKICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCdnZW5lcmF0ZU51bWJlcicpCiAgICAgIGxldCBkID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCk7CiAgICAgIGlmICh0aGlzLnRyYW5zYWN0aW9uRGF0ZSkgewogICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyh0aGlzLnRyYW5zYWN0aW9uRGF0ZSkKICAgICAgICBkID0gdGhpcy50cmFuc2FjdGlvbkRhdGU7CiAgICAgIH0KICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgYWJicjogdGhpcy50cmFuc2FjdGlvbi50cmFuc2FjdGlvblR5cGUuYWJiciwKICAgICAgICBzdHJ1Y3R1cmU6IHRoaXMudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25UeXBlLnN0cnVjdHVyZSwKICAgICAgICB0cmFuc2FjdGlvbkRhdGU6IGQsCiAgICAgICAgdHlwZTogIkNhc2ggUmVmdW5kIiwKICAgICAgfTsKICAgICAgYmlsbGluZ0hhbmRsZXIKICAgICAgICAubGFzdE51bWJlcihkYXRhKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgY29uc3QgbGFzdE51bWJlciA9IHRoaXMuemVyb1BhZCgKICAgICAgICAgICAgICBwYXJzZUludChyZXMubGFzdE51bWJlciksCiAgICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbi50cmFuc2FjdGlvblR5cGUuZm9ybWF0CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGNvbnN0IG51bWJlciA9CiAgICAgICAgICAgICAgcmVzLnN1ZmZpeCArCiAgICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbi50cmFuc2FjdGlvblR5cGUubnVtYmVyU2VwYXJhdG9yICsKICAgICAgICAgICAgICBsYXN0TnVtYmVyOwogICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLm51bWJlciA9IG51bWJlcjsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChlKTsKICAgICAgICB9KTsKICAgIH0sCiAgICB6ZXJvUGFkKG51bSwgcGxhY2VzKSB7CiAgICAgIHJldHVybiBTdHJpbmcobnVtKS5wYWRTdGFydChwbGFjZXMsICIwIik7CiAgICB9LAogICAgLy9jdXN0b21lcgogICAgb25DaGFuZ2UoZXZlbnQpIHsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKGV2ZW50KTsKICAgICAgY29uc3QgdmFsdWUgPSBldmVudC52YWx1ZTsKICAgICAgaWYgKHZhbHVlICYmIHZhbHVlW3RleHRGaWVsZF0gPT09IGVtcHR5SXRlbVt0ZXh0RmllbGRdKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuY3VzdG9tZXIgPSB2YWx1ZTsKICAgICAgdGhpcy50cmFuc2FjdGlvbi5jdXN0b21lciA9IHZhbHVlOwogICAgICBjb25zdCBiYXNlQ3VycmVuY3kgPSB2YWx1ZS5oYXNPd25Qcm9wZXJ0eSgiYmFzZUN1cnJlbmN5IikKICAgICAgICA/IHZhbHVlLmJhc2VDdXJyZW5jeQogICAgICAgIDoge307CiAgICAgIGlmIChiYXNlQ3VycmVuY3kuaGFzT3duUHJvcGVydHkoImNvZGUiKSkgewogICAgICAgIHRoaXMuYmFzZUN1cnJlbmN5Q29kZSA9IGJhc2VDdXJyZW5jeS5jb2RlOwogICAgICB9CiAgICAgIHRoaXMudHJhbnNhY3Rpb24ucHJpY2VMZXZlbCA9IHZhbHVlLmhhc093blByb3BlcnR5KCJwcmljZUxldmVsIikKICAgICAgICA/IHZhbHVlLnByaWNlTGV2ZWwKICAgICAgICA6IHt9OwogICAgICBjb25zdCBwcmljZUxldmVsID0gdmFsdWUuaGFzT3duUHJvcGVydHkoInByaWNlTGV2ZWwiKQogICAgICAgID8gdmFsdWUucHJpY2VMZXZlbAogICAgICAgIDoge307CiAgICAgIGlmIChwcmljZUxldmVsLmhhc093blByb3BlcnR5KCJjdXJyZW5jeSIpKSB7CiAgICAgICAgaWYgKHByaWNlTGV2ZWwuY3VycmVuY3kuaGFzT3duUHJvcGVydHkoImlkIikpIHsKICAgICAgICAgIHRoaXMubG9hZFRyYW5zYWN0aW9uUmF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLm9uRGF0ZUNoYW5nZWQoKTsKICAgICAgdGhpcy5sb2FkUHJvamVjdEJ5Q3VzdG9tZXIoKTsKICAgIH0sCiAgICBvbkZpbHRlckNoYW5nZShldmVudCkgewogICAgICBjb25zdCBmaWx0ZXIgPSBldmVudC5maWx0ZXIudmFsdWU7CiAgICAgIHRoaXMucmVxdWVzdERhdGEoMCwgZmlsdGVyLCB0aGlzLmN1c0Jhc2VVcmwpOwogICAgICB0aGlzLmZpbHRlciA9IGZpbHRlcjsKICAgIH0sCiAgICByZXF1ZXN0RGF0YShza2lwLCBmaWx0ZXIsIGJhc2VVcmwpIHsKICAgICAgY29uc3QgdXJsID0gYmFzZVVybCArIGA/ZmlsdGVyPSR7ZmlsdGVyfWA7CiAgICAgIHRoaXMucmVxdWVzdFN0YXJ0ZWQgPSB0cnVlOwogICAgICBmZXRjaCh1cmwpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgICAgIH0pCiAgICAgICAgLnRoZW4odGhpcy5hZnRlckZldGNoKTsKICAgIH0sCiAgICBhZnRlckZldGNoKGpzb24pIHsKICAgICAgdGhpcy5jdXN0b21lckxpc3QgPSBqc29uLmRhdGE7CiAgICB9LAogICAgcmVtb3ZlUm93KGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBjb25zdCBncmlkID0ga2VuZG8ualF1ZXJ5KCIjZ3JpZEl0ZW1MaW5lIikuZGF0YSgia2VuZG9HcmlkIiksCiAgICAgICAgZGF0YVNvdXJjZSA9IGdyaWQuZGF0YVNvdXJjZSwKICAgICAgICBkYXRhSXRlbSA9IGdyaWQuZGF0YUl0ZW0oJChlLmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoInRyIikpOwoKICAgICAgaWYgKGRhdGFTb3VyY2UudG90YWwoKSA+IDEpIHsKICAgICAgICBkYXRhU291cmNlLnJlbW92ZShkYXRhSXRlbSk7CiAgICAgIH0KICAgIH0sCiAgICAvL2RhdGUKICAgIG9uRGF0ZUNoYW5nZWQoKSB7CiAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuZ2VuZXJhdGVOdW1iZXIoKTsKICAgICAgfQogICAgfSwKICAgIG9uRW1wbG95ZWVGaWx0ZXJDaGFuZ2VkKCkge30sCiAgICAvL251bWJlcgogICAgbnVtYmVyRm9ybWF0KHZhbHVlKSB7CiAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyh0aGlzLnNhbGVGb3JtQ29udGVudC5kZWNpbWFsLCduaW1vbCcpCiAgICAgIHJldHVybiBrZW5kby50b1N0cmluZyh2YWx1ZSwgYG4ke3RoaXMuc2FsZUZvcm1Db250ZW50LmRlY2ltYWx9YCk7CiAgICAgIC8vIHJldHVybiB2YWx1ZQogICAgfSwKICAgIC8vCiAgICBhc3luYyBsb2FkUHJpY2VMZXZlbCgpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICBwcmljZUxldmVsSGFuZGxlci5nZXQoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgdGhpcy5wcmljZUxldmVsID0gcmVzOwogICAgICAgICAgICBpZiAodGhpcy5wcmljZUxldmVsLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICAgICAgdGhpcy4kcm91dGUucGFyYW1zLmlkICE9ICIiCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLnByaWNlTGV2ZWwgPSB0aGlzLnByaWNlTGV2ZWxbMF07CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRUcmFuc2FjdGlvblJhdGUoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0sIDMwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlbW92ZUR1cGxpY2F0ZShhcnJheSkgewogICAgICBjb25zdCByZXN1bHQgPSBbXTsKICAgICAgY29uc3QgbWFwID0gbmV3IE1hcCgpOwogICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgYXJyYXkpIHsKICAgICAgICBpZiAoIW1hcC5oYXMoaXRlbS5pZCkpIHsKICAgICAgICAgIG1hcC5zZXQoaXRlbS5pZCwgdHJ1ZSk7IC8vIHNldCBhbnkgdmFsdWUgdG8gTWFwCiAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlRGlzY291bnQoZGlzY291bnRJdGVtLCBzdWJUb3RhbCkgewogICAgICAgIGlmIChkaXNjb3VudEl0ZW0pIHsKICAgICAgICAgICAgY29uc3QgbmF0dXJlID0gZGlzY291bnRJdGVtLm5hdHVyZSB8fCAnJwogICAgICAgICAgICBjb25zdCBhbW91bnQgPSBkaXNjb3VudEl0ZW0uYW1vdW50IHx8IDAKICAgICAgICAgICAgaWYgKG5hdHVyZSA9PT0gJ0Ftb3VudCcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGFtb3VudCkKICAgICAgICAgICAgfSBlbHNlIGlmIChuYXR1cmUgPT09ICdQZXJjZW50YWdlJykgewogICAgICAgICAgICAgICAgcmV0dXJuIChzdWJUb3RhbCAqIChwYXJzZUZsb2F0KGFtb3VudCkgLyAxMDApKQogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICB9CiAgICB9LAogICAgYXV0b0NhbGN1bGF0ZVRheCh0YXgsIGFtb3VudCkgewogICAgICBpZiAodGF4KSB7CiAgICAgICAgdmFyIGZvcm11bGEgPSB0YXguZm9ybXVsYTsKICAgICAgICB2YXIgaW5BbXQgPSBrZW5kby5wYXJzZUZsb2F0KGFtb3VudCk7CiAgICAgICAgdmFyIG5BbXQgPSBrZW5kby5wYXJzZUZsb2F0KGFtb3VudCk7CiAgICAgICAgdmFyIHRheEJhc2UgPSBrZW5kby5wYXJzZUZsb2F0KHRheC50YXhCYXNlKSAvIDEwMDsKICAgICAgICB2YXIgcmF0ZSA9IGtlbmRvLnBhcnNlRmxvYXQodGF4LnJhdGUpIC8gMTAwOwogICAgICAgIHZhciB0b3RhbCA9IGV2YWwoZm9ybXVsYSk7CiAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKGluQW10LCBuQW10LCB0YXhCYXNlLCByYXRlLCBmb3JtdWxhLCB0b3RhbCk7CiAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKGFtb3VudCkKICAgICAgICByZXR1cm4gdG90YWw7CiAgICAgIH0KICAgICAgLy8gcmV0dXJuIDAKICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlVGF4QnlUeXBlKHRheCkgewogICAgICAvLyByZXR1cm4gYnkgYSBrZXkKICAgICAgY29uc3QgZ3JvdXBBbGwgPSAobGlzdCkgPT4KICAgICAgICBsaXN0LnJlZHVjZSgodGF4LCBpdGVtKSA9PiB7CiAgICAgICAgICBjb25zdCB0YXhBbW91bnQgPSB0YXhbaXRlbS5uYW1lXSB8fCAwOwogICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRheCwgewogICAgICAgICAgICBbaXRlbS5uYW1lXTogdGF4QW1vdW50ICsgcGFyc2VGbG9hdChpdGVtLmFtb3VudCksCiAgICAgICAgICB9KTsKICAgICAgICB9LCB7fSk7CiAgICAgIHRoaXMudGF4TGlzdFRvdGFsID0gZ3JvdXBBbGwodGF4KTsKICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCduaW1vbCcsIGdyb3VwQWxsKHRheCkpCiAgICAgIC8vIHRoaXMuCiAgICB9LAogICAgZGF0YVNvdXJjZUNoYW5nZWQoZSkgewogICAgICBpZiAoZS5maWVsZCkgewogICAgICAgIGxldCBkYXRhUm93ID0gZS5pdGVtc1swXTsKICAgICAgICBzd2l0Y2ggKGUuZmllbGQpIHsKICAgICAgICAgIGNhc2UgIml0ZW0iOgogICAgICAgICAgICAvLyB0aGlzLmF0dHJpYnV0ZV8gPSB0aGlzLmF0dHJpYnV0ZXMuZmlsdGVyKG0gPT4gbS50eXBlLmlkID09PSBkYXRhUm93LnZhcmlhbnQuaWQpCiAgICAgICAgICAgIGRhdGFSb3cuc2V0KCJkZXNjcmlwdGlvbiIsIGRhdGFSb3cuaXRlbS5kZXNjcmlwdGlvbik7CiAgICAgICAgICAgIC8vIHRoaXMuaXRlbUNoYW5nZShkYXRhUm93KQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgInVvbSI6CiAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhUm93LnVvbSwncm93LXVvbScpCiAgICAgICAgICAgIGRhdGFSb3cuc2V0KCJwcmljZSIsIHBhcnNlRmxvYXQoZGF0YVJvdy51b20ucHJpY2UpKTsKICAgICAgICAgICAgZGF0YVJvdy5zZXQoCiAgICAgICAgICAgICAgImFtb3VudCIsCiAgICAgICAgICAgICAgcGFyc2VGbG9hdChkYXRhUm93LnVvbS5wcmljZSkgKiBwYXJzZUZsb2F0KGRhdGFSb3cucXR5KQogICAgICAgICAgICApOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgInF0eSI6CiAgICAgICAgICAgIGRhdGFSb3cuc2V0KCJwcmljZSIsIHBhcnNlRmxvYXQoZGF0YVJvdy51b20ucHJpY2UpKTsKICAgICAgICAgICAgZGF0YVJvdy5zZXQoCiAgICAgICAgICAgICAgImFtb3VudCIsCiAgICAgICAgICAgICAgcGFyc2VGbG9hdChkYXRhUm93LnVvbS5wcmljZSkgKiBwYXJzZUZsb2F0KGRhdGFSb3cucXR5KQogICAgICAgICAgICApOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIm90aGVyVGF4IjoKICAgICAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCItLSIsIGRhdGFSb3cpCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGlmIChlLmZpZWxkKSB7CiAgICAgICAgICB0aGlzLmF1dG9DYWxjdWxhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlKCkgewogICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLml0ZW1MaW5lRFMua2VuZG9XaWRnZXQoKSwKICAgICAgICBzdWJUb3RhbCA9IDAsCiAgICAgICAgdG90YWxUYXggPSAwLAogICAgICAgIGRpc2NvdW50VG90YWwgPSAwLAogICAgICAgIHNwVGF4ID0gMCwKICAgICAgICBwbHRheCA9IDAsCiAgICAgICAgb3RoZXJUYXggPSAwLAogICAgICAgIHZhdFRheCA9IDAsCiAgICAgICAgZGlzY291bnRJbnZvaWNlID0gMCwKICAgICAgICB0YXhMaXN0ID0gW10sCiAgICAgICAgZGlzY291bnRJdGVtID0gW10sCiAgICAgICAgc2FsZVVuaXQgPSBbXTsKCiAgICAgIGRzLmRhdGEoKS5mb3JFYWNoKCh2YWx1ZSkgPT4gewogICAgICAgIGxldCBtb2RpZmllclByaWNlID0gMDsKICAgICAgICBpZiAodmFsdWUubW9kaWZpZXIpIHsKICAgICAgICAgIG1vZGlmaWVyUHJpY2UgPSBrZW5kby5wYXJzZUZsb2F0KHZhbHVlLm1vZGlmaWVyLnByaWNlKTsKICAgICAgICB9CgogICAgICAgIHN1YlRvdGFsICs9IGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50KSArIG1vZGlmaWVyUHJpY2U7CiAgICAgICAgbGV0IGRpc2NvdW50ID0gMDsKICAgICAgICBpZiAodmFsdWUuZGlzY291bnRJdGVtKSB7CiAgICAgICAgICBsZXQgc3ViVG8gPQogICAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHZhbHVlLnByaWNlKSAqIGtlbmRvLnBhcnNlRmxvYXQodmFsdWUucXR5KTsKICAgICAgICAgIGRpc2NvdW50ID0gdGhpcy5hdXRvQ2FsY3VsYXRlRGlzY291bnQodmFsdWUuZGlzY291bnRJdGVtLCBzdWJUbyk7CiAgICAgICAgICBpZiAodmFsdWUuZGlzY291bnRJdGVtLmhhc093blByb3BlcnR5KCJpZCIpKSB7CiAgICAgICAgICAgIGRpc2NvdW50SXRlbS5wdXNoKHZhbHVlLmRpc2NvdW50SXRlbSk7CiAgICAgICAgICB9CiAgICAgICAgICBkaXNjb3VudFRvdGFsICs9IGRpc2NvdW50OwogICAgICAgIH0KICAgICAgICBpZiAodmFsdWUuc2FsZVVuaXQpIHsKICAgICAgICAgIGlmICh2YWx1ZS5zYWxlVW5pdC5oYXNPd25Qcm9wZXJ0eSgiaWQiKSkgewogICAgICAgICAgICBzYWxlVW5pdC5wdXNoKHZhbHVlLnNhbGVVbml0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHZhbHVlLnNwZWNpZmljVGF4KSB7CiAgICAgICAgICBzcFRheCA9IHRoaXMuYXV0b0NhbGN1bGF0ZVRheCgKICAgICAgICAgICAgdmFsdWUuc3BlY2lmaWNUYXgsCiAgICAgICAgICAgIGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50KSAtIGtlbmRvLnBhcnNlRmxvYXQoZGlzY291bnQpCiAgICAgICAgICApOwogICAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCdzcCAnLCBkaXNjb3VudCkKICAgICAgICAgIHNwVGF4ID0ga2VuZG8ucGFyc2VGbG9hdChzcFRheCkgPyBrZW5kby5wYXJzZUZsb2F0KHNwVGF4KSA6IDA7CiAgICAgICAgICBpZiAodmFsdWUuc3BlY2lmaWNUYXguaGFzT3duUHJvcGVydHkoInRheFR5cGUiKSkgewogICAgICAgICAgICB0YXhMaXN0LnB1c2goewogICAgICAgICAgICAgIG5hbWU6IHZhbHVlLnNwZWNpZmljVGF4LnRheFR5cGUubmFtZSwKICAgICAgICAgICAgICBhbW91bnQ6IHNwVGF4LAogICAgICAgICAgICAgIGlkOiB2YWx1ZS5zcGVjaWZpY1RheC50YXhUeXBlLmlkLAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHZhbHVlLnB1YmxpY0xpZ2h0aW5nVGF4KSB7CiAgICAgICAgICBwbHRheCA9IHRoaXMuYXV0b0NhbGN1bGF0ZVRheCgKICAgICAgICAgICAgdmFsdWUucHVibGljTGlnaHRpbmdUYXgsCiAgICAgICAgICAgIGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50KSAtIGtlbmRvLnBhcnNlRmxvYXQoZGlzY291bnQpCiAgICAgICAgICApOwogICAgICAgICAgcGx0YXggPSBrZW5kby5wYXJzZUZsb2F0KHBsdGF4KSA/IGtlbmRvLnBhcnNlRmxvYXQocGx0YXgpIDogMDsKICAgICAgICAgIGlmICh2YWx1ZS5wdWJsaWNMaWdodGluZ1RheC5oYXNPd25Qcm9wZXJ0eSgidGF4VHlwZSIpKSB7CiAgICAgICAgICAgIHRheExpc3QucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogdmFsdWUucHVibGljTGlnaHRpbmdUYXgudGF4VHlwZS5uYW1lLAogICAgICAgICAgICAgIGFtb3VudDogcGx0YXgsCiAgICAgICAgICAgICAgaWQ6IHZhbHVlLnB1YmxpY0xpZ2h0aW5nVGF4LnRheFR5cGUuaWQsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAodmFsdWUub3RoZXJUYXgpIHsKICAgICAgICAgIG90aGVyVGF4ID0gdGhpcy5hdXRvQ2FsY3VsYXRlVGF4KAogICAgICAgICAgICB2YWx1ZS5vdGhlclRheCwKICAgICAgICAgICAga2VuZG8ucGFyc2VGbG9hdCh2YWx1ZS5hbW91bnQpIC0ga2VuZG8ucGFyc2VGbG9hdChkaXNjb3VudCkKICAgICAgICAgICk7CiAgICAgICAgICBvdGhlclRheCA9IGtlbmRvLnBhcnNlRmxvYXQob3RoZXJUYXgpCiAgICAgICAgICAgID8ga2VuZG8ucGFyc2VGbG9hdChvdGhlclRheCkKICAgICAgICAgICAgOiAwOwogICAgICAgICAgaWYgKHZhbHVlLm90aGVyVGF4Lmhhc093blByb3BlcnR5KCJ0YXhUeXBlIikpIHsKICAgICAgICAgICAgdGF4TGlzdC5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiB2YWx1ZS5vdGhlclRheC50YXhUeXBlLm5hbWUsCiAgICAgICAgICAgICAgYW1vdW50OiBvdGhlclRheCwKICAgICAgICAgICAgICBpZDogdmFsdWUub3RoZXJUYXgudGF4VHlwZS5pZCwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsdWUudmF0VGF4KSB7CiAgICAgICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2coJ1ZhdCBUYXgnLCB2YWx1ZS52YXRUYXgpCiAgICAgICAgICBsZXQgYW10ID0KICAgICAgICAgICAga2VuZG8ucGFyc2VGbG9hdChzcFRheCA/IHNwVGF4IDogMCkgKwogICAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHBsdGF4ID8gcGx0YXggOiAwKSArCiAgICAgICAgICAgIGtlbmRvLnBhcnNlRmxvYXQob3RoZXJUYXggPyBvdGhlclRheCA6IDApICsKICAgICAgICAgICAgKGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50ID8gdmFsdWUuYW1vdW50IDogMCkgLQogICAgICAgICAgICAgIChkaXNjb3VudCA/IGRpc2NvdW50IDogMCkpOwogICAgICAgICAgdmF0VGF4ID0gdGhpcy5hdXRvQ2FsY3VsYXRlVGF4KHZhbHVlLnZhdFRheCwgYW10KTsKICAgICAgICAgIHZhdFRheCA9IGtlbmRvLnBhcnNlRmxvYXQodmF0VGF4KSA/IGtlbmRvLnBhcnNlRmxvYXQodmF0VGF4KSA6IDA7CiAgICAgICAgICBpZiAodmFsdWUudmF0VGF4Lmhhc093blByb3BlcnR5KCJ0YXhUeXBlIikpIHsKICAgICAgICAgICAgdGF4TGlzdC5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiB2YWx1ZS52YXRUYXgudGF4VHlwZS5uYW1lLAogICAgICAgICAgICAgIGFtb3VudDogdmF0VGF4LAogICAgICAgICAgICAgIGlkOiB2YWx1ZS52YXRUYXgudGF4VHlwZS5pZCwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRvdGFsVGF4ICs9CiAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHNwVGF4ID8gc3BUYXggOiAwKSArCiAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHBsdGF4ID8gcGx0YXggOiAwKSArCiAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KG90aGVyVGF4ID8gb3RoZXJUYXggOiAwKSArCiAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHZhdFRheCA/IHZhdFRheCA6IDApOwogICAgICB9KTsKCiAgICAgIGRpc2NvdW50VG90YWwgPSBkaXNjb3VudFRvdGFsID8gZGlzY291bnRUb3RhbCA6IDA7CgogICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2coc3BUYXgsIHBsdGF4LCBvdGhlclRheCwgdmF0VGF4KQogICAgICBsZXQgdG90YWwgPQogICAgICAgIGtlbmRvLnBhcnNlRmxvYXQoc3ViVG90YWwpIC0KICAgICAgICBrZW5kby5wYXJzZUZsb2F0KGRpc2NvdW50VG90YWwpICsKICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHRvdGFsVGF4KTsKICAgICAgdGhpcy50cmFuc2FjdGlvbi5zdWJUb3RhbCA9IHN1YlRvdGFsOwogICAgICAkKCIjc3VidG90YWwiKS50ZXh0KGtlbmRvLnBhcnNlRmxvYXQoc3ViVG90YWwpKTsKICAgICAgdGhpcy50cmFuc2FjdGlvbi50b3RhbFRheEFtb3VudCA9IGtlbmRvLnBhcnNlRmxvYXQodG90YWxUYXgpOwogICAgICB0aGlzLnRyYW5zYWN0aW9uLmRpc2NvdW50VG90YWwgPSBrZW5kby5wYXJzZUZsb2F0KGRpc2NvdW50VG90YWwpOwogICAgICBpZiAodGhpcy50cmFuc2FjdGlvbi5zcGVjaWZpY0Rpc2NvdW50SXRlbSkgewogICAgICAgIGRpc2NvdW50SW52b2ljZSA9IHRoaXMuYXV0b0NhbGN1bGF0ZURpc2NvdW50KAogICAgICAgICAgdGhpcy50cmFuc2FjdGlvbi5zcGVjaWZpY0Rpc2NvdW50SXRlbSwKICAgICAgICAgIGtlbmRvLnBhcnNlRmxvYXQoc3ViVG90YWwpCiAgICAgICAgKTsKICAgICAgICBkaXNjb3VudEludm9pY2UgPSBkaXNjb3VudEludm9pY2UgPyBkaXNjb3VudEludm9pY2UgOiAwOwogICAgICB9CiAgICAgIC8vIHRoaXMub25PdGhlckNoYXJnZUNoYW5nZSgpCiAgICAgIHRoaXMudHJhbnNhY3Rpb24udG90YWwgPSBrZW5kby5wYXJzZUZsb2F0KHRvdGFsKSAtIGRpc2NvdW50SW52b2ljZTsKICAgICAgdGhpcy50cmFuc2FjdGlvbi5leGNoYW5nZUFtb3VudCA9CiAgICAgICAga2VuZG8ucGFyc2VGbG9hdCh0aGlzLnRyYW5zYWN0aW9uLnRvdGFsKSAqCiAgICAgICAga2VuZG8ucGFyc2VGbG9hdCh0aGlzLnRyYW5zYWN0aW9uLnR4blJhdGUpOwogICAgICB0aGlzLmF1dG9DYWxjdWxhdGVUYXhCeVR5cGUodGF4TGlzdCk7CiAgICAgIHRoaXMuY3VzdG9tZXJEaXNjb3VudEl0ZW0gPSB0aGlzLnJlbW92ZUR1cGxpY2F0ZShkaXNjb3VudEl0ZW0pOwogICAgICB0aGlzLmN1c3RvbWVyU2FsZVVuaXQgPSB0aGlzLnJlbW92ZUR1cGxpY2F0ZShzYWxlVW5pdCk7CiAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygnZGlzY291bnQgJywgdGhpcy5jdXN0b21lckRpc2NvdW50SXRlbSkKICAgIH0sCiAgICByb3dOdW1iZXJUbXBsKGRhdGFJdGVtKSB7CiAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuaXRlbUxpbmVEUy5rZW5kb1dpZGdldCgpLAogICAgICAgIGluZGV4ID0gZHMuaW5kZXhPZihkYXRhSXRlbSk7CiAgICAgIHJldHVybiBpbmRleCArIDE7CiAgICB9LAogICAgYXN5bmMgbG9hZFNhbGVGb3JtQ29udGVudCgpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICBzYWxlRm9ybUNvbnRlbnRIYW5kbGVyLmxpc3QoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuc2FsZUZvcm1Db250ZW50ID0gZGF0YVswXTsKICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhWzBdKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwgMzAwKTsKICAgICAgfSk7CiAgICB9LAogICAgdmF0VGVtcGxhdGUoZGF0YUl0ZW0pIHsKICAgICAgY29uc3QgdmF0ID0gZGF0YUl0ZW0udmF0VGF4OwogICAgICBpZiAodmF0KSB7CiAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke3ZhdC5kZWZhdWx0VGF4ID8gdmF0LmRlZmF1bHRUYXggOiBgYH08L3NwYW4+YDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYGA7CiAgICAgIH0KICAgIH0sCiAgICBpdGVtVGVtcGxhdGUoZGF0YUl0ZW0pIHsKICAgICAgY29uc3QgaXRlbSA9IGRhdGFJdGVtLml0ZW07CiAgICAgIGlmIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke2l0ZW0ubmFtZSA/IGl0ZW0ubmFtZSA6IGBgfTwvc3Bhbj5gOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBgYDsKICAgICAgfQogICAgfSwKICAgIFVPTVRlbXBsYXRlKGRhdGFJdGVtKSB7CiAgICAgIGNvbnN0IHVvbSA9IGRhdGFJdGVtLnVvbTsKICAgICAgaWYgKHVvbSkgewogICAgICAgIHJldHVybiBgPHNwYW4+JHt1b20udW9tID8gdW9tLnVvbS50b1VPTS5uYW1lIDogYGB9PC9zcGFuPmA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGBgOwogICAgICB9CiAgICB9LAogICAgc2FsZVVuaXRUZW1wbGF0ZShkYXRhSXRlbSkgewogICAgICBjb25zdCBzYWxlVW5pdCA9IGRhdGFJdGVtLnNhbGVVbml0OwogICAgICBpZiAoc2FsZVVuaXQpIHsKICAgICAgICByZXR1cm4gYDxzcGFuPiR7c2FsZVVuaXQubmFtZSA/IHNhbGVVbml0Lm5hbWUgOiBgYH08L3NwYW4+YDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYGA7CiAgICAgIH0KICAgIH0sCiAgICBkaXNjb3VudEl0ZW1UZW1wbGF0ZShkYXRhSXRlbSkgewogICAgICBjb25zdCBkaXNjb3VudEl0ZW0gPSBkYXRhSXRlbS5kaXNjb3VudEl0ZW07CiAgICAgIGlmIChkaXNjb3VudEl0ZW0pIHsKICAgICAgICByZXR1cm4gYDxzcGFuPiR7ZGlzY291bnRJdGVtLmNvZGUgPyBkaXNjb3VudEl0ZW0uY29kZSA6IGBgfSAtICR7CiAgICAgICAgICBkaXNjb3VudEl0ZW0ubmFtZSA/IGRpc2NvdW50SXRlbS5uYW1lIDogYGAKICAgICAgICB9PC9zcGFuPmA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGBgOwogICAgICB9CiAgICB9LAogICAgU2VydmljZURhdGVFZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IHJlcXVpcmVkIG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAua2VuZG9EYXRlUGlja2VyKCk7CgogICAgICAvLyBsZXQgZHMgPSB0aGlzLiRyZWZzLml0ZW1MaW5lRFMua2VuZG9XaWRnZXQoKQogICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2coZHMuZGF0YSgpKQogICAgICAvLyAvLyBjb25zdCBkYXRlU3RyaW5nID0ga2VuZG8udG9TdHJpbmcoKG5ldyBEYXRlKG9wdGlvbnMubW9kZWwuaXRlbXMuc2VydmljZURhdGUpKSwgdGhpcy5pdGVtTGluZS5kYXRlRm9ybWF0KQogICAgICAvLyAvLyBjb25zdCBkYXRlU3RyaW5nID0ga2VuZG8udG9TdHJpbmcob3B0aW9ucy5tb2RlbC5pdGVtcy5zZXJ2aWNlRGF0ZSkKICAgICAgLy8gY29uc3QgJGlucHV0ID0gJCgiPGlucHV0IHZhbHVlPSIgKyBvcHRpb25zLm1vZGVsLnNlcnZpY2VEYXRlICsgIiAvPiIpLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgLy8gJGlucHV0LmtlbmRvRGF0ZVBpY2tlcigpCiAgICAgIC8vIC8vICRpbnB1dC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgIC8vIC8vIG9wdGlvbnMubW9kZWwuaXRlbXMuc2VydmljZURhdGUgPSBkYXRlU3RyaW5nCiAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygkaW5wdXQpCiAgICB9LAogICAgU2VydmljZURhdGVUb0VkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAga2VuZG8KICAgICAgICAualF1ZXJ5KCc8aW5wdXQgcmVxdWlyZWQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgIC5rZW5kb0RhdGVQaWNrZXIoKTsKICAgIH0sCiAgICBJdGVtRHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgIGZpbHRlcjogImNvbnRhaW5zIiwKICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJuYW1lIiwKICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgaGVhZGVyVGVtcGxhdGU6CiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJkcm9wZG93bi1oZWFkZXIgay13aWRnZXQgay1oZWFkZXIiPicgKwogICAgICAgICAgICAiPHNwYW4+SXRlbXMgPC9zcGFuPiIgKwogICAgICAgICAgICAiPHNwYW4+PC9zcGFuPiIgKwogICAgICAgICAgICAiPC9kaXY+IiwKICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1uYW1lIzwvc3Bhbj4iLAogICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgc2VydmVyRmlsdGVyaW5nOiB0cnVlLAogICAgICAgICAgICB0cmFuc3BvcnQ6IHsKICAgICAgICAgICAgICByZWFkOiB7CiAgICAgICAgICAgICAgICB1cmw6IHByb2R1Y3RWYXJpYW50SGFuZGxlci5pdGVtU2VhcmNoVVJMKCksCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLAogICAgICAgICAgICB9LAogICAgICAgICAgICBzY2hlbWE6IHsKICAgICAgICAgICAgICBtb2RlbDogewogICAgICAgICAgICAgICAgaWQ6ICJpZCIsCiAgICAgICAgICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgaWQ6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgICAgbmFtZTogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgICBza3U6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIC8vIGRhdGE6IHRoaXMudmFyaWFudHMKICAgICAgICAgIH0pLAogICAgICAgIH0pOwogICAgfSwKICAgIFVPTURyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kbwogICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICBmaWx0ZXI6ICJzdGFydHN3aXRoIiwKICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJ1b20udG9VT00ubmFtZSIsCiAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogInVvbS50b1VPTS5pZCIsCiAgICAgICAgICBjYXNjYWRlRnJvbTogIml0ZW0iLAogICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPXVvbS50b1VPTS5uYW1lIzwvc3Bhbj4iLAogICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgc2VydmVyRmlsdGVyaW5nOiB0cnVlLAogICAgICAgICAgICB0cmFuc3BvcnQ6IHsKICAgICAgICAgICAgICByZWFkOiB7CiAgICAgICAgICAgICAgICB1cmw6IHVvbVByaWNlSGFuZGxlci5nZXRVUkwoCiAgICAgICAgICAgICAgICAgIG9wdGlvbnMubW9kZWwuaXRlbS5pZCwKICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbi5wcmljZUxldmVsLmlkCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgIGlkOiAiaWQiLAogICAgICAgICAgICAgICAgZmllbGRzOiB7CiAgICAgICAgICAgICAgICAgIGlkOiB7IHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgICAgICAgICAgIC8vIG5hbWU6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgIC8vIHNrdToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIC8vIGRhdGE6IHRoaXMudmFyaWFudHMKICAgICAgICAgIH0pLAogICAgICAgIH0pOwogICAgfSwKICAgIERpc2NvdW50SXRlbURyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kbwogICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICBmaWx0ZXI6ICJzdGFydHN3aXRoIiwKICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJuYW1lIiwKICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgY2FzY2FkZUZyb206ICJpdGVtIiwKICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1jb2RlIyAtICM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgIHNlcnZlckZpbHRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgdHJhbnNwb3J0OiB7CiAgICAgICAgICAgICAgcmVhZDogewogICAgICAgICAgICAgICAgdXJsOiBkaXNjb3VudEl0ZW1IYW5kbGVyLmdldFVSTCgpLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgIGlkOiAiaWQiLAogICAgICAgICAgICAgICAgZmllbGRzOiB7CiAgICAgICAgICAgICAgICAgIGlkOiB7IHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgICAgICAgICAgIC8vIG5hbWU6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgIC8vIHNrdToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KSwKICAgICAgICB9KTsKICAgIH0sCiAgICBTcGVjaWZpY1RheERyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kbwogICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICBmaWx0ZXI6ICJzdGFydHN3aXRoIiwKICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJkZWZhdWx0VGF4IiwKICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPWRlZmF1bHRUYXgjPC9zcGFuPiIsCiAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICBkYXRhOiB0aGlzLnNwZWNpZmljVGF4LmZpbHRlcigobSkgPT4gewogICAgICAgICAgICAgIGlmIChvcHRpb25zLm1vZGVsLmhhc093blByb3BlcnR5KCJ2YXRUYXgiKSkgewogICAgICAgICAgICAgICAgY29uc3QgdmF0ID0gb3B0aW9ucy5tb2RlbC52YXRUYXg7CiAgICAgICAgICAgICAgICBpZiAodmF0KSB7CiAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm1vZGVsLnZhdFRheCAhPT0gbnVsbCB8fAogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMubW9kZWwudmF0VGF4ICE9PSAibnVsbCIKICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubW9kZWwudmF0VGF4LmJhc2VBbW91bnQpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICAgICAgICAgIG0uYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpID09PQogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm1vZGVsLnZhdFRheC5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSwKICAgICAgICAgIH0pLAogICAgICAgIH0pOwogICAgfSwKICAgIFB1YmxpY0xpZ2h0aW5nVGF4RHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgZGF0YVRleHRGaWVsZDogImRlZmF1bHRUYXgiLAogICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9ZGVmYXVsdFRheCM8L3NwYW4+IiwKICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgIGRhdGE6IHRoaXMucHVibGljTGlnaHRpbmdUYXguZmlsdGVyKChtKSA9PiB7CiAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubW9kZWwuaGFzT3duUHJvcGVydHkoInZhdFRheCIpKSB7CiAgICAgICAgICAgICAgICBjb25zdCB2YXQgPSBvcHRpb25zLm1vZGVsLnZhdFRheDsKICAgICAgICAgICAgICAgIGlmICh2YXQpIHsKICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMubW9kZWwudmF0VGF4ICE9PSBudWxsICYmCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5tb2RlbC52YXRUYXggIT09ICJudWxsIgogICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlbC52YXRUYXguYmFzZUFtb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICAgICAgbS5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09CiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMubW9kZWwudmF0VGF4LmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKQogICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICByZXR1cm4gbTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLAogICAgICAgICAgfSksCiAgICAgICAgfSk7CiAgICB9LAogICAgT3RoZXJUYXhEcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAga2VuZG8KICAgICAgICAualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgZmlsdGVyOiAic3RhcnRzd2l0aCIsCiAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAiZGVmYXVsdFRheCIsCiAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1kZWZhdWx0VGF4Izwvc3Bhbj4iLAogICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgZGF0YTogdGhpcy5vdGhlclRheC5maWx0ZXIoKG0pID0+IHsKICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlbC5oYXNPd25Qcm9wZXJ0eSgidmF0VGF4IikpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHZhdCA9IG9wdGlvbnMubW9kZWwudmF0VGF4OwogICAgICAgICAgICAgICAgaWYgKHZhdCkgewogICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5tb2RlbC52YXRUYXggIT09IG51bGwgJiYKICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm1vZGVsLnZhdFRheCAhPT0gIm51bGwiCiAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm1vZGVsLnZhdFRheC5iYXNlQW1vdW50KSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgICAgICAgICBtLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0KICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5tb2RlbC52YXRUYXguYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpCiAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBtOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSksCiAgICAgICAgICB9KSwKICAgICAgICB9KTsKICAgIH0sCiAgICBWYXRUYXhEcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAga2VuZG8KICAgICAgICAualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgZmlsdGVyOiAic3RhcnRzd2l0aCIsCiAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAiZGVmYXVsdFRheCIsCiAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1kZWZhdWx0VGF4Izwvc3Bhbj4iLAogICAgICAgICAgb3B0aW9uTGFiZWw6ICItLVNlbGVjdC0tIiwKICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICBkYXRhOiB0aGlzLnZhdFRheCwKICAgICAgICAgIH0pLAogICAgICAgIH0pOwogICAgfSwKICAgIFNhbGVVbml0RHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9Y29kZSMgLSAjPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICBkYXRhOiB0aGlzLnNhbGVVbml0SXRlbUxpc3QsCiAgICAgICAgICB9KSwKICAgICAgICB9KTsKICAgIH0sCiAgICBNb2RpZmllckRyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kbwogICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICBmaWx0ZXI6ICJjb250YWlucyIsCiAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAibmFtZSIsCiAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgIGhlYWRlclRlbXBsYXRlOgogICAgICAgICAgICAnPGRpdiBjbGFzcz0iZHJvcGRvd24taGVhZGVyIGstd2lkZ2V0IGstaGVhZGVyIj4nICsKICAgICAgICAgICAgIjxzcGFuPk1vZGlmaWVyIDwvc3Bhbj4iICsKICAgICAgICAgICAgIjxzcGFuPjwvc3Bhbj4iICsKICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgIHNlcnZlckZpbHRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgdHJhbnNwb3J0OiB7CiAgICAgICAgICAgICAgcmVhZDogewogICAgICAgICAgICAgICAgdXJsOiBpdGVtTW9kaWZpZXJIYW5kbGVyLnNlYXJjaFVSTChvcHRpb25zLm1vZGVsLml0ZW0uaWQpLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgIGlkOiAiaWQiLAogICAgICAgICAgICAgICAgZmllbGRzOiB7CiAgICAgICAgICAgICAgICAgIGlkOiB7IHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgICAgICAgICAgIG5hbWU6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgICAgcHJpY2U6IHsgdHlwZTogIm51bWJlciIgfSwKICAgICAgICAgICAgICAgICAgdW9tOiB7IHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdG90YWw6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgfSksCiAgICAgICAgfSk7CiAgICB9LAogICAgRW1wbG95ZWVEcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAga2VuZG8KICAgICAgICAualF1ZXJ5KCc8aW5wdXQgZGF0YS1iaW5kPSJ2YWx1ZTonICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvTXVsdGlTZWxlY3QoewogICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgIHN1Z2dlc3Q6IHRydWUsCiAgICAgICAgICBmaWx0ZXI6ICJjb250YWlucyIsCiAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAibmFtZSIsCiAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgIGhlYWRlclRlbXBsYXRlOgogICAgICAgICAgICAnPGRpdiBjbGFzcz0iZHJvcGRvd24taGVhZGVyIGstd2lkZ2V0IGstaGVhZGVyIj4nICsKICAgICAgICAgICAgIjxzcGFuPkVtcGxveWVlIDwvc3Bhbj4iICsKICAgICAgICAgICAgIjxzcGFuPjwvc3Bhbj4iICsKICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgIHNlcnZlckZpbHRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgdHJhbnNwb3J0OiB7CiAgICAgICAgICAgICAgcmVhZDogewogICAgICAgICAgICAgICAgdXJsOiBlbXBsb3llZUhhbmRsZXIuc2VhcmNoVVJMKCksCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLAogICAgICAgICAgICB9LAogICAgICAgICAgICBzY2hlbWE6IHsKICAgICAgICAgICAgICBtb2RlbDogewogICAgICAgICAgICAgICAgaWQ6ICJpZCIsCiAgICAgICAgICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgaWQ6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgICAgbmFtZTogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgICAgbGFzdE5hbWU6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KSwKICAgICAgICB9KTsKICAgIH0sCiAgICBlbXBJbXBsKGRhdGFJdGVtKSB7CiAgICAgIGxldCBlbXBJZHMgPSBbXTsKICAgICAgZGF0YUl0ZW0uZW1wbG95ZWUuZm9yRWFjaCgobSkgPT4gewogICAgICAgIGVtcElkcy5wdXNoKG0uZmlyc3ROYW1lICsgIiAtICIgKyBtLmxhc3ROYW1lKTsKICAgICAgfSk7CiAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyhlbXBJZHMuam9pbignLCAnKSkKICAgICAgcmV0dXJuIGA8c3Bhbj4ke2VtcElkcy5qb2luKCIsICIpfTwvc3Bhbj5gOwogICAgfSwKICAgIGFkZFJvdygpIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5pdGVtTGluZURTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgdG90YWwgPSBkcy50b3RhbCgpOwogICAgICB0aGlzLml0ZW1MaW5lLmlkID0gaW52b2ljZVByZWZpeCArIHV1aWQudjEoKTsKICAgICAgZHMuaW5zZXJ0KHRvdGFsLCB0aGlzLml0ZW1MaW5lKTsKICAgIH0sCiAgICBvblNwZWNpZmljRGlzY291bnRDaGFuZ2VkKCkgewogICAgICBpZiAodGhpcy50cmFuc2FjdGlvbi5zcGVjaWZpY0Rpc2NvdW50SXRlbSkgewogICAgICAgIGNvbnN0IGRpc2NvdW50T3JkZXIgPSB0aGlzLmF1dG9DYWxjdWxhdGVEaXNjb3VudCgKICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb24uc3BlY2lmaWNEaXNjb3VudEl0ZW0sCiAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLnN1YlRvdGFsCiAgICAgICAgKTsKICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLnNwZWNpZmljRGlzY291bnRUb3RhbCA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgZGlzY291bnRPcmRlciA/IGRpc2NvdW50T3JkZXIgOiAwLAogICAgICAgICAgIm4iCiAgICAgICAgKTsKICAgICAgICBsZXQgdG90YWwgPQogICAgICAgICAga2VuZG8ucGFyc2VGbG9hdCh0aGlzLnRyYW5zYWN0aW9uLnN1YlRvdGFsKSAtCiAgICAgICAgICAoa2VuZG8ucGFyc2VGbG9hdCh0aGlzLnRyYW5zYWN0aW9uLmRpc2NvdW50VG90YWwpICsKICAgICAgICAgICAga2VuZG8ucGFyc2VGbG9hdCh0aGlzLnRyYW5zYWN0aW9uLnRvdGFsVGF4QW1vdW50KSkgLQogICAgICAgICAgZGlzY291bnRPcmRlcjsKICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLnRvdGFsID0ga2VuZG8udG9TdHJpbmcodG90YWwsICJuIik7CiAgICAgIH0KICAgIH0sCiAgICBvbk90aGVyQW1vdW50KHZhbHVlKSB7CiAgICAgIHJldHVybiB0aGlzLmF1dG9DYWxjdWxhdGVEaXNjb3VudCh2YWx1ZSwgdGhpcy50cmFuc2FjdGlvbi5zdWJUb3RhbCk7CiAgICB9LAogICAgYXN5bmMgbG9hZERpc2NvdW50SXRlbSgpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICBkaXNjb3VudEl0ZW1IYW5kbGVyLmxpc3QoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHRoaXMuc3BlY2lmaWNEaXNjb3VudEl0ZW0gPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9LCAzMDApOwogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBsb2FkU2VnbWVudCgpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICB0aGlzLnNlZ21lbnRzID0gW107CiAgICAgICAgICBzZXR0aW5nc0hhbmRsZXIKICAgICAgICAgICAgLmdldFNlZygpCiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnNlZ21lbnRzID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlZ21lbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCAhPT0gdW5kZWZpbmVkIHx8CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGUucGFyYW1zLmlkICE9ICIiCiAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb24uc2VnbWVudCA9IHRoaXMuc2VnbWVudHNbMF07CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIHRoaXMuc2VnbWVudExpc3QgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKTsKICAgICAgICAgIHsKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0sIDMwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIGxvYWRMb2NhdGlvbigpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICB0aGlzLmxvY2F0aW9ucyA9IFtdOwogICAgICAgICAgbG9jYXRpb25IYW5kbGVyCiAgICAgICAgICAgIC5saXN0KCkKICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb25zID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvY2F0aW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCAhPSAiIgogICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLmxvY2F0aW9uID0gdGhpcy5sb2NhdGlvbnNbMF07CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgpOwogICAgICAgICAgewogICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSwgMzAwKTsKICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgbG9hZFByb2plY3RCeUN1c3RvbWVyKCkgewogICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgIHByb2plY3RIYW5kbGVyCiAgICAgICAgICAgIC5nZXRCeUN1c3RvbWVyKHRoaXMuY3VzdG9tZXIuaWQpCiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmN1c3RvbWVyUHJvamVjdHMgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VzdG9tZXJQcm9qZWN0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0VHJhbnNhY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLnByb2plY3QgPSB0aGlzLmN1c3RvbWVyUHJvamVjdHNbMF07CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgpOwogICAgICAgICAgewogICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSwgMzAwKTsKICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgbG9hZFNhbGVDaGFubmVsKCkgewogICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgc2FsZUNoYW5uZWxIYW5kbGVyLmdldCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuc2FsZUNoYW5uZWxMaXN0ID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICBpZiAodGhpcy5zYWxlQ2hhbm5lbExpc3QubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgIT09IHVuZGVmaW5lZCB8fAogICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgIT0gIiIKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLnNhbGVDaGFubmVsID0gdGhpcy5zYWxlQ2hhbm5lbExpc3RbMF07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwgMzAwKTsKICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgbG9hZFRheCgpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICBzZXR0aW5nSGFuZGxlci5nZXQoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgdGhpcy50YXggPSByZXM7CiAgICAgICAgICAgIHRoaXMub3RoZXJUYXggPSB0aGlzLnRheC5maWx0ZXIoKG0pID0+IG0udGF4VHlwZS50eXBlSWQgPT09IDcpOyAvLyB2YWx1YWJsZSB0YXgKICAgICAgICAgICAgdGhpcy5zcGVjaWZpY1RheCA9IHRoaXMudGF4LmZpbHRlcigKICAgICAgICAgICAgICAobSkgPT4gbS50YXhUeXBlLnR5cGVJZCA9PT0gOCAmJiBtLnRyYW5zYWN0aW9uVHlwZSA9PT0gIlNhbGUiCiAgICAgICAgICAgICk7IC8vIHZhbHVhYmxlIHRheAogICAgICAgICAgICB0aGlzLnB1YmxpY0xpZ2h0aW5nVGF4ID0gdGhpcy50YXguZmlsdGVyKAogICAgICAgICAgICAgIChtKSA9PiBtLnRheFR5cGUudHlwZUlkID09PSA5ICYmIG0udHJhbnNhY3Rpb25UeXBlID09PSAiU2FsZSIKICAgICAgICAgICAgKTsgLy8gdmFsdWFibGUgdGF4CiAgICAgICAgICAgIHRoaXMudmF0VGF4ID0gdGhpcy50YXguZmlsdGVyKAogICAgICAgICAgICAgIChtKSA9PgogICAgICAgICAgICAgICAgKG0udGF4VHlwZS50eXBlSWQgPT09IDEgfHwgbS50YXhUeXBlLnR5cGVJZCA9PT0gOCkgJiYKICAgICAgICAgICAgICAgIG0udHJhbnNhY3Rpb25UeXBlID09PSAiU2FsZSIKICAgICAgICAgICAgKTsgLy8gdmFsdWFibGUgdGF4CiAgICAgICAgICB9KTsKICAgICAgICB9LCAzMDApOwogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBsb2FkU2FsZVVuaXRJdGVtcygpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICBzYWxlVW5pdEl0ZW1IYW5kbGVyLmxpc3QoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkKICAgICAgICAgICAgICB0aGlzLnNhbGVVbml0SXRlbUxpc3QgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgfSk7CiAgICAgICAgfSwgMzAwKTsKICAgICAgfSk7CiAgICB9LAogICAgY2xvc2UoZGF0YSkgewogICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmlkID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBuYW1lOiAiQ3VzdG9tZXJzIiwKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB3aW5kb3cuaGlzdG9yeS5nbygtMSk7CiAgICAgIH0KICAgICAgd2luZG93LmNvbnNvbGUubG9nKGRhdGEsICJjbG9zZSIpOwogICAgICAvLyBsb2NhbFN0b3JhZ2UuZGF0YS5pZCA9IEpTT04uc3RyaW5naWZ5KGRhdGEpCiAgICB9LAogICAgLy9jYXRhbG9nCiAgICBsb2FkSW1hZ2UoZGF0YUl0ZW0pIHsKICAgICAgaWYgKGRhdGFJdGVtLmhhc093blByb3BlcnR5KCJpbWFnZXMiKSkgewogICAgICAgIGlmIChkYXRhSXRlbS5pbWFnZXMuaGFzT3duUHJvcGVydHkoImRlZmF1bHQiKSkgewogICAgICAgICAgY29uc3QgdXJsID0gdGhpcy5pbWdVUkwgKyBkYXRhSXRlbS5pbWFnZXMuZGVmYXVsdC50aHVtYjsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICI8aW1nIHdpZHRoPSc1MCcgaGVpZ2h0PSc1MCcgc3R5bGU9ICdtYXJnaW46IGF1dG87ZGlzcGxheTogYmxvY2s7JyBzcmM9JyIgKwogICAgICAgICAgICB1cmwgKwogICAgICAgICAgICAiJyAvPiIKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGxvYWRDYXRhbG9ncygpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIGNhdGFsb2dIYW5kbGVyLmdldCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuY2F0YWxvZ3MgPSByZXM7CiAgICAgICAgICB9KTsKICAgICAgICB9LCAzMDApOwogICAgICB9KTsKICAgIH0sCiAgICBhZGRDYXRhbG9nKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBsZXQgZ3JpZCA9IGtlbmRvLmpRdWVyeSgiI2dyaWRDYXRhbG9nIikuZGF0YSgia2VuZG9HcmlkIik7CiAgICAgIGxldCBkYXRhSXRlbSA9IGdyaWQuZGF0YUl0ZW0oJChlLmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoInRyIikpOwogICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2coZGF0YUl0ZW0pCiAgICAgIGlmIChkYXRhSXRlbS52YXJpYW50cy5sZW5ndGggPiAwKSB7CiAgICAgICAgZGF0YUl0ZW0udmFyaWFudHMuZm9yRWFjaCgobSkgPT4gewogICAgICAgICAgaWYgKG0uaGFzT3duUHJvcGVydHkoInZhcmlhbnQiKSkgewogICAgICAgICAgICBpZiAobS52YXJpYW50Lmhhc093blByb3BlcnR5KCJpZCIpKSB7CiAgICAgICAgICAgICAgdGhpcy5sb2FkU2luZ2xlSXRlbShtLnZhcmlhbnQuaWQsICJpIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB0aGlzLmRpYWxvZ0NhdGFsb2cgPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAoZGF0YUl0ZW0uc2VydmljZXMubGVuZ3RoID4gMCkgewogICAgICAgIGRhdGFJdGVtLnNlcnZpY2VzLmZvckVhY2goKG0pID0+IHsKICAgICAgICAgIGlmIChtLmhhc093blByb3BlcnR5KCJzZXJ2aWNlIikpIHsKICAgICAgICAgICAgaWYgKG0uc2VydmljZS5oYXNPd25Qcm9wZXJ0eSgiaWQiKSkgewogICAgICAgICAgICAgIHRoaXMubG9hZFNpbmdsZUl0ZW0obS5zZXJ2aWNlLmlkLCAicyIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5kaWFsb2dDYXRhbG9nID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBsb2FkU2luZ2xlSXRlbShpdGVtSWQsIHR5cGUpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICByZXNvbHZlKCJyZXNvbHZlZCIpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgICAgICBwcm9kdWN0SGFuZGxlci5nZXRPbmUoaXRlbUlkKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICBsZXQgZGF0YSA9IHJlczsKICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKGRhdGEpOwogICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLml0ZW1MaW5lRFMua2VuZG9XaWRnZXQoKSwKICAgICAgICAgICAgICB0b3RhbCA9IGRzLnRvdGFsKCk7CiAgICAgICAgICAgIHRoaXMuaXRlbUxpbmUuaWQgPSBpbnZvaWNlUHJlZml4ICsgdXVpZC52MSgpOwogICAgICAgICAgICB0aGlzLml0ZW1MaW5lLml0ZW0gPSBkYXRhOwogICAgICAgICAgICBpZiAodHlwZSA9PSAiaSIpIHsKICAgICAgICAgICAgICB0aGlzLml0ZW1MaW5lLmRlc2NyaXB0aW9uID0gZGF0YS52YXJpYW50LnNhbGVEZXNjcmlwdGlvbjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLml0ZW1MaW5lLmRlc2NyaXB0aW9uID0gZGF0YS5zYWxlRGVzY3JpcHRpb247CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZHMuaW5zZXJ0KHRvdGFsLCB0aGlzLml0ZW1MaW5lKTsKICAgICAgICAgIH0pOwogICAgICAgIH0sIDUwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIGxvYWRQcmVmaXgoKSB7CiAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICByZXNvbHZlKCJyZXNvbHZlZCIpOwogICAgICAgICAgcHJlZml4SGFuZGxlci5nZXQoInNhbGUgb3JkZXIiKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uVHlwZSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNhY3Rpb25UeXBlLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25UeXBlID0gdGhpcy50cmFuc2FjdGlvblR5cGVbMF07CiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaW5pdFRyYW5zYWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVOdW1iZXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0sIDMwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIG9uRW1wbG95ZWVDaGFuZ2VkKGV2ZW50KSB7CiAgICAgIGNvbnN0IHZhbHVlID0gZXZlbnQudmFsdWU7CiAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZVt0ZXh0RmllbGRdID09PSBlbXB0eUl0ZW1bdGV4dEZpZWxkXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLm1FbXBsb3llZSA9IHZhbHVlOwogICAgICB0aGlzLnRyYW5zYWN0aW9uLmVtcGxveWVlID0gdmFsdWU7CiAgICB9LAogICAgYXN5bmMgbG9hZEVtcGxveWVlQ2VudGVyKCkgewogICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgIHRoaXMuZW1wbG95ZWVzID0gW107CiAgICAgICAgICBlbXBsb3llZUhhbmRsZXIKICAgICAgICAgICAgLmNlbnRlcih1bmRlZmluZWQpCiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmVtcGxveWVlcyA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5lbXBsb3llZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLmVtcGxveWVlID0gdGhpcy5lbXBsb3llZXNbMF07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKTsKICAgICAgICAgIHsKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0sIDMwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlbW92ZUVtcHR5TGluZSgpIHsKICAgICAgY29uc3QgZ3JpZCA9IGtlbmRvLmpRdWVyeSgiI2dyaWRJdGVtTGluZSIpLmRhdGEoImtlbmRvR3JpZCIpLAogICAgICAgIGRhdGFTb3VyY2UgPSBncmlkLmRhdGFTb3VyY2U7CiAgICAgIGRhdGFTb3VyY2UuZGF0YSgpLmZvckVhY2goKG0pID0+IHsKICAgICAgICBpZiAobS5pdGVtLmlkID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGRhdGFTb3VyY2UucmVtb3ZlKG0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgbG9hZFRyYW5zYWN0aW9uUmF0ZSgpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodGhpcy50cmFuc2FjdGlvbkRhdGUpCiAgICAgICAgICAgIC50b0lTT1N0cmluZygpCiAgICAgICAgICAgIC5zdWJzdHIoMCwgMTApOwogICAgICAgICAgY29uc3QgcHJpY2VMZXZlbCA9IHRoaXMudHJhbnNhY3Rpb24ucHJpY2VMZXZlbDsKICAgICAgICAgIGxldCBjb2RlID0gIiI7CiAgICAgICAgICBpZiAocHJpY2VMZXZlbC5oYXNPd25Qcm9wZXJ0eSgiY3VycmVuY3kiKSkgewogICAgICAgICAgICBpZiAocHJpY2VMZXZlbC5jdXJyZW5jeS5oYXNPd25Qcm9wZXJ0eSgiY29kZSIpKSB7CiAgICAgICAgICAgICAgY29kZSA9IHByaWNlTGV2ZWwuY3VycmVuY3kuY29kZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKGNvZGUgIT09IHVuZGVmaW5lZCB8fCBjb2RlICE9PSAiIikgewogICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY3VycmVuY3lIYW5kbGVyCiAgICAgICAgICAgICAgLmdldExhc3RFeGNoYW5nZVJhdGVCeURhdGUoZGF0ZSwgY29kZSkKICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgdGhpcy5leGNoYW5nZVJhdGUgPSByZXMuZGF0YS5kYXRhWzBdOwogICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbmN5Q29kZSA9IHRoaXMuZXhjaGFuZ2VSYXRlLmNvZGU7CiAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb25SYXRlID0gdGhpcy5leGNoYW5nZVJhdGUucmF0ZTsKICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbi50eG5SYXRlID0gdGhpcy5leGNoYW5nZVJhdGUucmF0ZTsKICAgICAgICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbi5leGNoYW5nZVJhdGUgPSB0aGlzLmV4Y2hhbmdlUmF0ZTsKICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0sIDMwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vY2FzaCBhY2NvdW50CiAgICBjYXNoQWNjb3VudGF1dG9DYWxjdWxhdGUoKSB7CiAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuc2FsZURlcG9zaXREUy5rZW5kb1dpZGdldCgpLAogICAgICAgIGNvbnZlcnRlZEFtb3VudCA9IDAsCiAgICAgICAgYW1vdW50ID0gMDsKICAgICAgZHMuZGF0YSgpLmZvckVhY2goKHZhbHVlKSA9PiB7CiAgICAgICAgaWYgKHZhbHVlLmFtb3VudCkgewogICAgICAgICAgYW1vdW50ICs9IGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50KTsKICAgICAgICAgIGNvbnZlcnRlZEFtb3VudCArPQogICAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHZhbHVlLmFtb3VudCkgKiB0aGlzLnRyYW5zYWN0aW9uLnR4blJhdGU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5jYXNoQWNjb3VudC5leGNoYW5nZUFtb3VudCA9IGNvbnZlcnRlZEFtb3VudDsKICAgICAgdGhpcy5jYXNoQWNjb3VudC5hbW91bnQgPSBhbW91bnQ7CiAgICB9LAogICAgY2FzaEFjY291bnREU0NoYW5nZWQoZSkgewogICAgICBpZiAoZS5maWVsZCkgewogICAgICAgIHRoaXMuY2FzaEFjY291bnRhdXRvQ2FsY3VsYXRlKCk7CiAgICAgIH0KICAgIH0sCiAgICBhZGRDYXNoQWNjUm93KCkgewogICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLnNhbGVEZXBvc2l0RFMua2VuZG9XaWRnZXQoKSwKICAgICAgICB0b3RhbCA9IGRzLnRvdGFsKCk7CiAgICAgIHRoaXMuY2FzaEFjY291bnRMaW5lLmlkID0gaW52b2ljZVByZWZpeCArIHV1aWQudjEoKTsKICAgICAgZHMuaW5zZXJ0KHRvdGFsLCB0aGlzLmNhc2hBY2NvdW50TGluZSk7CiAgICB9LAogICAgY2FzaEFjY3Jvd051bVRtcGwoZGF0YUl0ZW0pIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5zYWxlRGVwb3NpdERTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgaW5kZXggPSBkcy5pbmRleE9mKGRhdGFJdGVtKTsKICAgICAgcmV0dXJuIGluZGV4ICsgMTsKICAgIH0sCiAgICBhY2NvdW50RHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9bnVtYmVyIyAtICM9IG5hbWUjPC9zcGFuPiIsCiAgICAgICAgICBvcHRpb25MYWJlbDogIi0tU2VsZWN0LS0iLAogICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgIGRhdGE6IHRoaXMuYWNjQ2FzaCwKICAgICAgICAgIH0pLAogICAgICAgIH0pOwogICAgfSwKICAgIG1ldGhvZERyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kbwogICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICBmaWx0ZXI6ICJzdGFydHN3aXRoIiwKICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJuYW1lIiwKICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPWNvZGUjIC0gIz0gbmFtZSM8L3NwYW4+IiwKICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS1TZWxlY3QtLSIsCiAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgZGF0YTogdGhpcy5wYXltZW50TWV0aG9kLAogICAgICAgICAgfSksCiAgICAgICAgfSk7CiAgICB9LAogICAgYWNjb3VudFRlbXBsYXRlKGRhdGFJdGVtKSB7CiAgICAgIGNvbnN0IGFjYyA9IGRhdGFJdGVtLmFjY291bnQ7CiAgICAgIGlmIChhY2MpIHsKICAgICAgICByZXR1cm4gYDxzcGFuPiR7YWNjLm5hbWUgPyBhY2MubmFtZSA6IGBgfTwvc3Bhbj5gOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBgYDsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGxvYWRBY2NvdW50KCkgewogICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgIGFjY291bnRIYW5kbGVyLmdldEFsbCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuZXhwZW5zZUFjY291bnRzID0gcmVzLmRhdGE7CiAgICAgICAgICAgIHRoaXMuYWNjQ2FzaCA9IHJlcy5kYXRhCiAgICAgICAgICAgICAgLmZpbHRlcigobSkgPT4gbS5hY2NvdW50X3R5cGUubnVtYmVyIDw9IDUpCiAgICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0udXVpZCwKICAgICAgICAgICAgICAgICAgdXVpZDogaXRlbS51dWlkLAogICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsCiAgICAgICAgICAgICAgICAgIGxvY2FsX25hbWU6IGl0ZW0ubG9jYWxfbmFtZSwKICAgICAgICAgICAgICAgICAgbnVtYmVyOiBpdGVtLm51bWJlciwKICAgICAgICAgICAgICAgICAgaXNfdGF4YWJsZTogaXRlbS5pc190YXhhYmxlLAogICAgICAgICAgICAgICAgICBiYW5oamlBY2NDb2RlOiBpdGVtLmJhbmhqaUFjY0NvZGUsCiAgICAgICAgICAgICAgICAgIGdyb3VwX2NvZGU6IGl0ZW0uZ3JvdXBfY29kZSwKICAgICAgICAgICAgICAgICAgcGFyZW50X2FjY291bnQ6IGl0ZW0ucGFyZW50X2FjY291bnQsCiAgICAgICAgICAgICAgICAgIHR5cGVfY29kZTogaXRlbS50eXBlX2NvZGUsCiAgICAgICAgICAgICAgICAgIGFjY291bnRfdHlwZTogaXRlbS5hY2NvdW50X3R5cGUsCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSwgMzAwKTsKICAgICAgfSk7CiAgICB9LAogICAgbWV0aG9kVGVtcGxhdGUoZGF0YUl0ZW0pIHsKICAgICAgY29uc3QgbWV0aG9kID0gZGF0YUl0ZW0ubWV0aG9kOwogICAgICBpZiAobWV0aG9kKSB7CiAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke21ldGhvZC5uYW1lID8gbWV0aG9kLm5hbWUgOiBgYH08L3NwYW4+YDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYGA7CiAgICAgIH0KICAgIH0sCiAgICBhbW91bnRUZW1wbGF0ZShkYXRhSXRlbSkgewogICAgICBjb25zdCBhbXQgPSBkYXRhSXRlbS5hbW91bnQ7CiAgICAgIGlmIChhbXQpIHsKICAgICAgICByZXR1cm4ga2VuZG8udG9TdHJpbmcocGFyc2VGbG9hdChhbXQpLCBgJHt0aGlzLmRlY2ltYWxGb3JtYXR9YCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgIH0sCiAgICBhbW91bnRFZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IGRhdGEtYmluZD0idmFsdWU6JyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgIC5rZW5kb051bWVyaWNUZXh0Qm94KHsKICAgICAgICAgIGRlY2ltYWxzOiAzMCwKICAgICAgICAgIGZvcm1hdDogYCR7dGhpcy5kZWNpbWFsRm9ybWF0fWAsCiAgICAgICAgfSk7CiAgICB9LAogICAgY2FzaEFjY1JlbW92ZVJvdyhlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgY29uc3QgZ3JpZCA9IGtlbmRvLmpRdWVyeSgiI2dyaWRTYWxlRGVwb3NpdCIpLmRhdGEoImtlbmRvR3JpZCIpLAogICAgICAgIGRhdGFTb3VyY2UgPSBncmlkLmRhdGFTb3VyY2UsCiAgICAgICAgZGF0YUl0ZW0gPSBncmlkLmRhdGFJdGVtKCQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCJ0ciIpKTsKCiAgICAgIGlmIChkYXRhU291cmNlLnRvdGFsKCkgPiAxKSB7CiAgICAgICAgZGF0YVNvdXJjZS5yZW1vdmUoZGF0YUl0ZW0pOwogICAgICB9CiAgICB9LAogICAgLy9leHNwZW5zZQogICAgZXhwZW5zZUFkZFJvdygpIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5leHBlbnNlQWNjb3VudERTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgbGFzdCA9IGRzLnRvdGFsKCk7CgogICAgICBsZXQgamUgPSBuZXcgRXhwZW5zZUVudHJ5RXh0ZW5kZWRNb2RlbCgpOwogICAgICBkcy5pbnNlcnQobGFzdCwgamUpOwogICAgfSwKICAgIG9uRXhwZW5zZUFjY291bnREU0NoYW5nZXMoZSkgewogICAgICBpZiAoZS5maWVsZCkgewogICAgICAgIGxldCBkYXRhUm93ID0gZS5pdGVtc1swXTsKCiAgICAgICAgaWYgKGUuZmllbGQgPT09ICJhY2NvdW50IikgewogICAgICAgICAgdGhpcy5hZGRFeHRyYVJvdyhkYXRhUm93LnVpZCk7CiAgICAgICAgfSBlbHNlIGlmIChlLmZpZWxkID09PSAicXVhbnRpdHkiIHx8IGUuZmllbGQgPT09ICJwcmljZSIpIHsKICAgICAgICAgIGxldCBhbXQgPQogICAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KGRhdGFSb3cucXVhbnRpdHkpICoKICAgICAgICAgICAga2VuZG8ucGFyc2VGbG9hdChkYXRhUm93LnByaWNlKTsKICAgICAgICAgIGRhdGFSb3cuc2V0KCJhbW91bnQiLCBhbXQpOwogICAgICAgIH0gZWxzZSBpZiAoZS5maWVsZCA9PT0gInVvbSIpIHsKICAgICAgICAgIGlmIChkYXRhUm93LnVvbSkgewogICAgICAgICAgICBkYXRhUm93LnNldCgidW9tX3V1aWQiLCBkYXRhUm93LnVvbS5pZCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLmV4cGVuc2VBdXRvQ2FsY3VsYXRlKCk7CiAgICAgIH0KICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKGUpCiAgICB9LAogICAgZXhwZW5zZUF1dG9DYWxjdWxhdGUoKSB7CiAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuZXhwZW5zZUFjY291bnREUy5rZW5kb1dpZGdldCgpLAogICAgICAgIGNvbnZlcnRlZEFtb3VudCA9IDAsCiAgICAgICAgYW1vdW50ID0gMDsKICAgICAgZHMuZGF0YSgpLmZvckVhY2goKHZhbHVlKSA9PiB7CiAgICAgICAgaWYgKHZhbHVlLmFtb3VudCkgewogICAgICAgICAgYW1vdW50ICs9IGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50KTsKICAgICAgICAgIGNvbnZlcnRlZEFtb3VudCArPQogICAgICAgICAgICBrZW5kby5wYXJzZUZsb2F0KHZhbHVlLmFtb3VudCkgKiB0aGlzLnRyYW5zYWN0aW9uLnR4blJhdGU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5leHBlbnNlQWNjb3VudC5leGNoYW5nZUFtb3VudCA9IGNvbnZlcnRlZEFtb3VudDsKICAgICAgdGhpcy5leHBlbnNlQWNjb3VudC5hbW91bnQgPSBhbW91bnQ7CiAgICB9LAogICAgYWRkRXh0cmFSb3codWlkKSB7CiAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuZXhwZW5zZUFjY291bnREUy5rZW5kb1dpZGdldCgpLAogICAgICAgIHRvdGFsID0gZHMudG90YWwoKSwKICAgICAgICByb3cgPSBkcy5nZXRCeVVpZCh1aWQpLAogICAgICAgIGluZGV4ID0gZHMuaW5kZXhPZihyb3cpOwoKICAgICAgaWYgKGluZGV4ID09IHRvdGFsIC0gMSkgewogICAgICAgIHRoaXMuZXhwZW5zZUFkZFJvdygpOwogICAgICB9CiAgICB9LAogICAgZXhwZW5zZVJlbW92ZVJvdyhlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgY29uc3QgZ3JpZCA9ICQoIiNleHBlbnNlR3JpZCIpLmRhdGEoImtlbmRvR3JpZCIpLAogICAgICAgIGRhdGFTb3VyY2UgPSBncmlkLmRhdGFTb3VyY2UsCiAgICAgICAgZGF0YUl0ZW0gPSBncmlkLmRhdGFJdGVtKCQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCJ0ciIpKTsKCiAgICAgIGlmIChkYXRhU291cmNlLnRvdGFsKCkgPiAxKSB7CiAgICAgICAgZGF0YVNvdXJjZS5yZW1vdmUoZGF0YUl0ZW0pOwogICAgICB9CiAgICB9LAogICAgZXhwZW5zZVJvd051bVRtcGwoZGF0YUl0ZW0pIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5leHBlbnNlQWNjb3VudERTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgaW5kZXggPSBkcy5pbmRleE9mKGRhdGFJdGVtKTsKCiAgICAgIHJldHVybiBpbmRleCArIDE7CiAgICB9LAogICAgZXhwZW5zZUFjY291bnRFZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIHJldHVybiBIZWxwZXIuYWNjb3VudEVkaXRvcihjb250YWluZXIsIG9wdGlvbnMsIHRoaXMuZXhwZW5zZUFjY291bnRzKTsKICAgIH0sCiAgICAvL3NhdmUgYmxvY2sKICAgIGNsZWFyKCkgewogICAgICB3aW5kb3cuY29uc29sZS5sb2coImNsZWFyIik7CiAgICAgIHRoaXMuaWQgPSB1bmRlZmluZWQ7CiAgICAgIHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgdHJhbnNhY3Rpb25Nb2RlbCh7fSk7CiAgICAgIHRoaXMuaXRlbUxpbmVzID0gW107CiAgICAgIHRoaXMuZ2VuZXJhdGVOdW1iZXIoKTsKICAgIH0sCiAgICBzYXZlQ2xvc2UoKSB7CiAgICAgIHRoaXMuaXNTYXZlQ2xvc2UgPSB0cnVlOwogICAgICB0aGlzLnNhdmVPcHRpb24gPSAic2F2ZUNsb3NlIjsKICAgICAgdGhpcy5zYXZlKCk7CiAgICB9LAogICAgc2F2ZVByaW50KCkgewogICAgICB0aGlzLmlzU2F2ZVByaW50ID0gdHJ1ZTsKICAgICAgdGhpcy5zYXZlT3B0aW9uID0gInNhdmVQcmludCI7CiAgICAgIHRoaXMuc2F2ZSgpOwogICAgfSwKICAgIHNhdmVOZXcoKSB7CiAgICAgIHRoaXMuc2F2ZU9wdGlvbiA9ICJzYXZlTmV3IjsKICAgICAgdGhpcy5pc1NhdmVOZXcgPSB0cnVlOwogICAgICB0aGlzLnNhdmUoKTsKICAgIH0sCiAgICBzYXZlRHJhZnQoKSB7CiAgICAgIHRoaXMuc2F2ZU9wdGlvbiA9ICJzYXZlRHJhZnQiOwogICAgICB0aGlzLmlzU2F2ZURyYWZ0ID0gdHJ1ZTsKICAgICAgdGhpcy5zYXZlKCk7CiAgICB9LAogICAgYXN5bmMgc2F2ZSgpIHsKICAgICAgaWYgKCF0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKSkgewogICAgICAgIHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZSgpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgIHRoaXMucmVtb3ZlRW1wdHlMaW5lKCk7CiAgICAgICAgICBsZXQgaXRlbUxpbmVEUyA9IHRoaXMuJHJlZnMuaXRlbUxpbmVEUy5rZW5kb1dpZGdldCgpLAogICAgICAgICAgICB0b3RhbCA9IGl0ZW1MaW5lRFMudG90YWwoKTsKICAgICAgICAgIGlmICh0b3RhbCA8PSAwKSB7CiAgICAgICAgICAgIHRoaXMuJHNub3RpZnkuZXJyb3IoIkZpZWxkIFJlcXVpcmVkISIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgaWQ6IHRoaXMudHJhbnNhY3Rpb24uaWQgPyB0aGlzLnRyYW5zYWN0aW9uLmlkIDogIiIsCiAgICAgICAgICAgIHR5cGU6ICJDYXNoIFJlZnVuZCIsCiAgICAgICAgICAgIHRyYW5zYWN0aW9uVHlwZTogdGhpcy50cmFuc2FjdGlvbi50cmFuc2FjdGlvblR5cGUsCiAgICAgICAgICAgIG51bWJlcjogdGhpcy50cmFuc2FjdGlvbi5udW1iZXIsCiAgICAgICAgICAgIGFiYnI6IHRoaXMudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25UeXBlLmFiYnIsCiAgICAgICAgICAgIHRyYW5zYWN0aW9uRGF0ZTogdGhpcy50cmFuc2FjdGlvbi50cmFuc2FjdGlvbkRhdGUsCiAgICAgICAgICAgIGN1c3RvbWVyOiB0aGlzLnRyYW5zYWN0aW9uLmN1c3RvbWVyLAogICAgICAgICAgICBkaXNjb3VudFByb21vdGlvbjoge30sCiAgICAgICAgICAgIHByaWNlTGV2ZWw6IHRoaXMudHJhbnNhY3Rpb24ucHJpY2VMZXZlbCwKICAgICAgICAgICAgaXRlbUxpbmVzOiBpdGVtTGluZURTLmRhdGEoKSwKICAgICAgICAgICAgc2VnbWVudDogdGhpcy50cmFuc2FjdGlvbi5zZWdtZW50LAogICAgICAgICAgICBsb2NhdGlvbjogdGhpcy50cmFuc2FjdGlvbi5sb2NhdGlvbiwKICAgICAgICAgICAgcHJvamVjdDogdGhpcy50cmFuc2FjdGlvbi5wcm9qZWN0LAogICAgICAgICAgICBzYWxlQ2hhbm5lbDogdGhpcy50cmFuc2FjdGlvbi5zYWxlQ2hhbm5lbCwKICAgICAgICAgICAgdHJhbnNhY3Rpb25Ob3RlOiB0aGlzLnRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uTm90ZSwKICAgICAgICAgICAgam91cm5hbE5vdGU6IHRoaXMudHJhbnNhY3Rpb24uam91cm5hbE5vdGUsCiAgICAgICAgICAgIHN1YlRvdGFsOiB0aGlzLnRyYW5zYWN0aW9uLnN1YlRvdGFsLAogICAgICAgICAgICB0b3RhbDogdGhpcy50cmFuc2FjdGlvbi50b3RhbCwKICAgICAgICAgICAgZGlzY291bnRUb3RhbDogdGhpcy50cmFuc2FjdGlvbi5kaXNjb3VudFRvdGFsLAogICAgICAgICAgICBzcGVjaWZpY0Rpc2NvdW50VG90YWw6IHRoaXMudHJhbnNhY3Rpb24uc3BlY2lmaWNEaXNjb3VudFRvdGFsLAogICAgICAgICAgICB0b3RhbFRheEFtb3VudDogdGhpcy50cmFuc2FjdGlvbi50b3RhbFRheEFtb3VudCwKICAgICAgICAgICAgc2F2ZU9wdGlvbjogdGhpcy5zYXZlT3B0aW9uLAogICAgICAgICAgICB0eG5SYXRlOiB0aGlzLnRyYW5zYWN0aW9uLnR4blJhdGUsCiAgICAgICAgICAgIGV4Y2hhbmdlUmF0ZTogdGhpcy50cmFuc2FjdGlvbi5leGNoYW5nZVJhdGUsCiAgICAgICAgICAgIGV4Y2hhbmdlQW1vdW50OiB0aGlzLnRyYW5zYWN0aW9uLmV4Y2hhbmdlQW1vdW50LAogICAgICAgICAgICBzdGF0dXM6IDEsCiAgICAgICAgICAgIGZvcm1UZW1wbGF0ZTogdGhpcy50cmFuc2FjdGlvbi5mb3JtVGVtcGxhdGUsCiAgICAgICAgICAgIHNwZWNpZmljRGlzY291bnRJdGVtOiB0aGlzLnRyYW5zYWN0aW9uLnNwZWNpZmljRGlzY291bnRJdGVtLAogICAgICAgICAgICB0YXhMaXN0VG90YWw6IHRoaXMudGF4TGlzdFRvdGFsLAogICAgICAgICAgICBjdXN0b21lckRpc2NvdW50SXRlbTogdGhpcy5jdXN0b21lckRpc2NvdW50SXRlbSwKICAgICAgICAgICAgY3VzdG9tZXJTYWxlVW5pdDogdGhpcy5jdXN0b21lclNhbGVVbml0LAogICAgICAgICAgICBsb2dnZWRVc2VyOiB0aGlzLmxvZ2dlZFVzZXIsCiAgICAgICAgICAgIGVtcGxveWVlOiB0aGlzLnRyYW5zYWN0aW9uLmVtcGxveWVlLAogICAgICAgICAgICB1c2VkRGF0ZUF0OiAiIiwKICAgICAgICAgICAgZGVsZXRlZEF0OiAiIiwKICAgICAgICAgICAgZGVsZXRlZDogMCwKICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKSwKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICAgIHRyYW5zYWN0aW9uSGFuZGxlcgogICAgICAgICAgICAuY3JlYXRlKGRhdGEpCiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXNDb2RlID09PSAyMDEpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzU2F2ZU5ldyA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0RGVmYXVsdERhdGEoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UocmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMuZm9ybS5yZXNldCgpOwogICAgICAgICAgICAgICAgdGhpcy4kc25vdGlmeS5zdWNjZXNzKCJTdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgICAgIHRoaXMuJHNub3RpZnkuZXJyb3IoIlNvbWV0aGluZyB3ZW50IHdyb25nIik7CiAgICAgICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChlKTsKICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sIDMwMCk7CiAgICAgIH0pOwogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICBpZCgpIHsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKHRoaXMuaWQsICJmcm9tIHdhdGNoIik7CiAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHdpbmRvdy5oaXN0b3J5LmdvKC0xKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmxvYWRWaWV3KCk7CiAgICAgIH0KICAgIH0sCiAgICBpbml0VHJhbnNhY3Rpb24oKSB7CiAgICAgIHRoaXMuaW5pdGlhbERhdGEoKTsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkVGF4KCk7CiAgICB0aGlzLmxvYWRTYWxlVW5pdEl0ZW1zKCk7CiAgICB0aGlzLmxvYWRBY2NvdW50KCk7CiAgICB0aGlzLmxvYWRTZWdtZW50KCk7CiAgICB0aGlzLmxvYWRMb2NhdGlvbigpOwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGRhdGVGb3JtYXR0ZWQoKSB7CiAgICAgIHJldHVybiBrZW5kby50b1N0cmluZyhuZXcgRGF0ZSgpLCBpbnN0aXR1dGUuZGF0ZUZvcm1hdCk7CiAgICB9LAogICAgZGF0ZVRpbWVGb3JtYXR0ZWQoKSB7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhpbnN0aXR1dGUuZGF0ZUZvcm1hdCArICIgSEg6bW0iLCAiaW5zdCBkYXRlIik7CiAgICAgIHJldHVybiBrZW5kby50b1N0cmluZyhuZXcgRGF0ZSgpLCBpbnN0aXR1dGUuZGF0ZUZvcm1hdCArICIgSEg6bW0iKTsKICAgIH0sCiAgfSwKICBtb3VudGVkOiBhc3luYyBmdW5jdGlvbigpIHsKICAgIGF3YWl0IHRoaXMuaW5pdGlhbERhdGEoKTsKICAgIHByZWZpeEhhbmRsZXIuZ2V0KCJzYWxlIG9yZGVyIikudGhlbigocmVzKSA9PiB7CiAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy50cmFuc2FjdGlvblR5cGUgPSByZXMuZGF0YS5kYXRhOwogICAgICAgIGlmICh0aGlzLnRyYW5zYWN0aW9uVHlwZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCAhPT0gdW5kZWZpbmVkIHx8CiAgICAgICAgICAgIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCAhPSAiIgogICAgICAgICAgKSB7CiAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb24udHJhbnNhY3Rpb25UeXBlID0gdGhpcy50cmFuc2FjdGlvblR5cGVbMF07CiAgICAgICAgICAgIGlmICghdGhpcy5pbml0VHJhbnNhY3Rpb24gJiYgdGhpcy4kcm91dGUucGFyYW1zLmlkID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlTnVtYmVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgdGhpcy5yZXF1ZXN0RGF0YSgwLCB0aGlzLmZpbHRlciwgdGhpcy5jdXNCYXNlVXJsKTsKICAgIGF3YWl0IHRoaXMubG9hZFNhbGVGb3JtQ29udGVudCgpOwogICAgYXdhaXQgdGhpcy5sb2FkUHJpY2VMZXZlbCgpOwogICAgYXdhaXQgdGhpcy5sb2FkRGlzY291bnRJdGVtKDApOwogICAgYXdhaXQgdGhpcy5sb2FkU2FsZUNoYW5uZWwoKTsKICAgIGF3YWl0IHRoaXMubG9hZENhdGFsb2dzKCk7CiAgICBhd2FpdCB0aGlzLmxvYWRFbXBsb3llZUNlbnRlcigpOwogIH0sCn07Cg=="},{"version":3,"sources":["CashRefund.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2jCA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CashRefund.vue","sourceRoot":"src/views/customers","sourcesContent":["<template>\n  <v-app>\n    <v-container>\n      <v-row>\n        <v-col sm=\"12\" cols=\"12\">\n          <v-card\n            outlined\n            dense\n            class=\"pa-4 no_border rounded-sm\"\n            color=\"white\"\n          >\n            <v-row>\n              <v-col\n                class=\"bigSide py-0\"\n                sm=\"8\"\n                cols=\"12\"\n                style=\"transition: .3s ease-in;\"\n                :class=\"{ hide_big_bar_class: isHideBar }\"\n              >\n                <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\n                  <v-card outlined dense class=\"no_border\">\n                    <h2 class=\"mb-0\">{{ $t(\"cash_refund\") }}</h2>\n                    <v-icon\n                      v-if=\"isHideBar\"\n                      onclick=\"window.history.go(-1); return false;\"\n                      style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                      class=\"float-right\"\n                      >close\n                    </v-icon>\n                    <span\n                      style=\"transition: .3s ease-in; z-index:10;\"\n                      :class=\"{\n                        iconArrow: !isHideBar,\n                        iconArrowHide: isHideBar,\n                      }\"\n                    >\n                      <v-icon\n                        size=\"22\"\n                        class=\"arr_icon\"\n                        @click=\"hide_smallsitebar\"\n                        v-if=\"isHideBar\"\n                      >\n                        mdi-chevron-left-circle\n                      </v-icon>\n                      <v-icon\n                        size=\"22\"\n                        class=\"arr_icon\"\n                        @click=\"hide_smallsitebar\"\n                        v-if=\"!isHideBar\"\n                      >\n                        mdi-chevron-right-circle\n                      </v-icon></span\n                    >\n                  </v-card>\n                  <v-card outlined dense class=\"px-3 no_border\" color=\"grayBg\">\n                    <v-row>\n                      <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                        <label class=\"label  mb-0\">{{ $t(\"customer\") }}</label>\n                        <dropdownlist\n                          class=\"v-input__slot\"\n                          :data-items=\"customerList\"\n                          @change=\"onChange\"\n                          :value=\"transaction.customer\"\n                          :data-item-key=\"dataItemKey\"\n                          :text-field=\"textField\"\n                          :default-item=\"defaultItem\"\n                          :filterable=\"true\"\n                          @filterchange=\"onFilterChange\"\n                        >\n                        </dropdownlist>\n                        <label class=\"label  mb-0\">{{ $t(\"date\") }}</label>\n                        <app-datepicker\n                          :initialDate=\"transaction.transactionDate\"\n                          @onChanged=\"onDateChanged\"\n                          @emitDate=\"transaction.transactionDate = $event\"\n                        />\n                        <label class=\"label mb-0 mt-1\">{{\n                          $t(\"number\")\n                        }}</label>\n                        <v-row class=\"mt-1 mr-0\">\n                          <v-col sm=\"3\" cols=\"3\" class=\"pt-0 pr-0\">\n                            <div class=\"code_text text-bold\">\n                              {{ transaction.transactionType.abbr }}\n                            </div>\n                          </v-col>\n                          <v-col sm=\"7\" cols=\"7\" class=\"pt-0 pl-0 pr-1\">\n                            <v-text-field\n                              class=\" custom-border \"\n                              v-model=\"transaction.number\"\n                              outlined\n                              :rules=\"[(v) => !!v || 'Number is required']\"\n                              required\n                            />\n                          </v-col>\n                          <v-col sm=\"2\" cols=\"2\" class=\"pt-0 px-0\">\n                            <v-icon\n                              color=\"black\"\n                              size=\"30\"\n                              class=\"border_qrcode\"\n                              @click=\"generateNumber\"\n                              >mdi-qrcode\n                            </v-icon>\n                          </v-col>\n                        </v-row>\n                      </v-col>\n                      <v-col sm=\"8\" cols=\"12\">\n                        <v-col class=\"pb-0\" sm=\"6\" cols=\"12\">\n                          <label class=\"label mb-0\">{{\n                            $t(\"price_level\")\n                          }}</label>\n                          <v-select\n                            class=\"mt-1\"\n                            v-model=\"transaction.priceLevel\"\n                            :items=\"priceLevel\"\n                            @change=\"loadTransactionRate\"\n                            item-value=\"id\"\n                            item-text=\"name\"\n                            return-object\n                            clearable\n                            placeholder=\"Price Level\"\n                            tage=\"Default Price Level\"\n                            outlined\n                          />\n                        </v-col>\n                        <v-col\n                          sm=\"6\"\n                          col=\"6\"\n                          class=\"d-flex justify-space-between\"\n                        >\n                          <div>\n                            <p class=\"label mb-0\">{{ $t(\"currency\") }}</p>\n                            <p class=\"label mb-0\">{{ currencyCode }}</p>\n                          </div>\n                          <div>\n                            <p class=\"label mb-0\">{{ $t(\"rate\") }}</p>\n                            <p class=\"label mb-0\">{{ transactionRate }}</p>\n                          </div>\n                        </v-col>\n                      </v-col>\n                    </v-row>\n                  </v-card>\n\n                  <v-row class=\"\" style=\"background-color: #fff;\">\n                    <v-col sm=\"12\" cols=\"12\">\n                      <p class=\"mb-0\">Items and deposit to be refunded</p>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"pt-0\">\n                      <kendo-datasource\n                        ref=\"itemLineDS\"\n                        :data=\"itemLines\"\n                        :change=\"dataSourceChanged\"\n                      />\n                      <kendo-grid\n                        id=\"gridItemLine\"\n                        class=\"grid-function\"\n                        :data-source-ref=\"'itemLineDS'\"\n                        :sortable=\"false\"\n                        :column-menu=\"true\"\n                        :editable=\"true\"\n                        :scrollable-virtual=\"true\"\n                      >\n                        <kendo-grid-column\n                          :title=\"$t('no.')\"\n                          :width=\"55\"\n                          :column-menu=\"false\"\n                          :template=\"rowNumberTmpl\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-products',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: products',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'item'\"\n                          :title=\"$t('item')\"\n                          :template=\"itemTemplate\"\n                          :editor=\"ItemDropDownEditor\"\n                          :width=\"200\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'description'\"\n                          :title=\"$t('description')\"\n                          :template=\"'<span>#=description#</span>'\"\n                          :width=\"160\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'qty'\"\n                          :title=\"$t('qty')\"\n                          :format=\"'{0:n}'\"\n                          :template=\"'<span>#=qty#</span>'\"\n                          :width=\"80\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: left; ' }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'uom'\"\n                          :title=\"$t('uom')\"\n                          :width=\"100\"\n                          :template=\"UOMTemplate\"\n                          :editor=\"UOMDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: left',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'price'\"\n                          :title=\"$t('price')\"\n                          :format=\"'{0:n}'\"\n                          :width=\"100\"\n                          :template=\"'<span>#=price#</span>'\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: left',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'amount'\"\n                          :title=\"$t('amount')\"\n                          :format=\"'{0:n}'\"\n                          :width=\"100\"\n                          :template=\"'<span>#=amount#</span>'\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: left',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'discountItem'\"\n                          :title=\"$t('discount_item')\"\n                          :width=\"150\"\n                          :hidden=\"!saleFormContent.discountItem\"\n                          :template=\"discountItemTemplate\"\n                          :editor=\"DiscountItemDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: left',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'vatTax'\"\n                          :title=\"$t('vat')\"\n                          :width=\"150\"\n                          :template=\"vatTemplate\"\n                          :editor=\"VatTaxDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: left' }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'specificTax'\"\n                          :title=\"$t('specificTax')\"\n                          :width=\"150\"\n                          :hidden=\"!saleFormContent.specificTax\"\n                          :template=\"\n                            '<span>#=specificTax.defaultTax?specificTax.defaultTax:``#</span>'\n                          \"\n                          :editor=\"SpecificTaxDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: left' }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'otherTax'\"\n                          :title=\"$t('otherTax')\"\n                          :width=\"150\"\n                          :hidden=\"!saleFormContent.otherTax\"\n                          :template=\"\n                            '<span>#=otherTax.defaultTax?otherTax.defaultTax:``#</span>'\n                          \"\n                          :editor=\"OtherTaxDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: left' }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'publicLightingTax'\"\n                          :title=\"$t('pl_tax')\"\n                          :format=\"'{0:n}'\"\n                          :width=\"150\"\n                          :hidden=\"!saleFormContent.publicLightingTax\"\n                          :template=\"\n                            '<span>#=publicLightingTax.defaultTax?publicLightingTax.defaultTax:``#</span>'\n                          \"\n                          :editor=\"PublicLightingTaxDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: left' }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'saleUnit'\"\n                          :title=\"$t('sale_unit')\"\n                          :width=\"150\"\n                          :hidden=\"!saleFormContent.saleUnit\"\n                          :template=\"saleUnitTemplate\"\n                          :editor=\"SaleUnitDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: left' }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'employee'\"\n                          :title=\"$t('employee')\"\n                          :width=\"150\"\n                          :hidden=\"!saleFormContent.employee\"\n                          :template=\"empImpl\"\n                          :editor=\"EmployeeDropDownEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: left' }\"\n                        />\n                        <kendo-grid-column\n                          :command=\"{\n                            iconClass: 'k-icon k-i-trash',\n                            text: 'Delete',\n                            click: removeRow,\n                            class: 'btn-plus',\n                          }\"\n                          :title=\"'Action'\"\n                          :width=\"100\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: left; background-color: #EDF1F5',\n                          }\"\n                        />\n                      </kendo-grid>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                      <v-row>\n                        <v-col sm=\"5\" cols=\"12\" class=\"\">\n                          <v-btn\n                            class=\"float-left btn_plus mr-2\"\n                            @click=\"addRow\"\n                          >\n                            <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                          </v-btn>\n                          <v-btn\n                            @click=\"dialogCatalog = true\"\n                            class=\"float-left btn_plus mr-2 white--text text-capitalize\"\n                          >\n                            {{ $t(\"catalog\") }}\n                          </v-btn>\n                          <template>\n                            <v-file-input\n                              class=\"mt-0 pt-0 \"\n                              sm=\"3\"\n                              cols=\"6\"\n                              v-model=\"files\"\n                              :placeholder=\"$t('attachment')\"\n                              multiple\n                              prepend-icon=\"mdi-paperclip\"\n                            >\n                              <template v-slot:selection=\"{ text }\">\n                                <v-chip small label color=\"primary\">\n                                  {{ text }}\n                                </v-chip>\n                              </template>\n                            </v-file-input>\n                          </template>\n                        </v-col>\n                      </v-row>\n                    </v-col>\n                  </v-row>\n                  <v-row class=\"\" style=\"background-color: #fff;\">\n                    <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                      <kendo-datasource\n                        ref=\"expenseAccountDS\"\n                        :data=\"expenseLines\"\n                        :change=\"onExpenseAccountDSChanges\"\n                      />\n                      <kendo-grid\n                        id=\"expenseGrid\"\n                        ref=\"expenseGrid\"\n                        class=\"grid-function\"\n                        :data-source-ref=\"'expenseAccountDS'\"\n                        :sortable=\"false\"\n                        :filterable=\"false\"\n                        :column-menu=\"true\"\n                        :editable=\"true\"\n                        :scrollable-virtual=\"true\"\n                      >\n                        <kendo-grid-column\n                          :title=\"$t('no.')\"\n                          :template=\"expenseRowNumTmpl\"\n                          :width=\"55\"\n                          :column-menu=\"false\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-products',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: products',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'account'\"\n                          :title=\"$t('account')\"\n                          :width=\"200\"\n                          :template=\"'<span>#=account.name||``#</span>'\"\n                          :editor=\"expenseAccountEditor\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'description'\"\n                          :title=\"$t('description')\"\n                          :width=\"200\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'quantity'\"\n                          :title=\"$t('qty')\"\n                          :width=\"160\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'uom'\"\n                          :title=\"$t('uom')\"\n                          :editor=\"UomEditor\"\n                          :template=\"'<span>#=uom.name||``#</span>'\"\n                          :width=\"150\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right;',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'price'\"\n                          :title=\"$t('price')\"\n                          :format=\"'{0:n}'\"\n                          :width=\"150\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'amount'\"\n                          :title=\"$t('amount')\"\n                          :format=\"'{0:n}'\"\n                          :width=\"150\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'discount'\"\n                          :title=\"$t('discount')\"\n                          :template=\"'<span>#=discount.name||``#</span>'\"\n                          :editor=\"PurchaseDiscountItemEditor\"\n                          :width=\"150\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'tax_item'\"\n                          :title=\"$t('tax')\"\n                          :template=\"'<span>#=tax_item.defaultTax||``#</span>'\"\n                          :editor=\"PurchaseTaxEditor\"\n                          :width=\"150\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :command=\"{\n                            iconClass: 'k-icon k-i-trash',\n                            text: 'Delete',\n                            click: expenseRemoveRow,\n                            class: 'btn-plus',\n                          }\"\n                          :title=\"'&nbsp;'\"\n                          :width=\"100\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                        />\n                      </kendo-grid>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                      <v-row>\n                        <v-col sm=\"9\" cols=\"12\" class=\"\">\n                          <v-btn\n                            color=\"primary\"\n                            class=\"float-left rounded-0 white--text mr-2\"\n                            @click=\"expenseAddRow\"\n                          >\n                            <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                          </v-btn>\n                        </v-col>\n                      </v-row>\n                    </v-col>\n                  </v-row>\n                  <v-row class=\"\" style=\"background-color: #fff;\">\n                    <v-col sm=\"12\" cols=\"12\" class=\"pt-0\">\n                      <p class=\"mb-0\">\n                        {{ $t(\"cash_account_used_for_refund\") }}\n                      </p>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                      <kendo-datasource\n                        ref=\"saleDepositDS\"\n                        :change=\"cashAccountDSChanged\"\n                        :data=\"cashAccountLine\"\n                      />\n                      <kendo-grid\n                        id=\"gridSaleDeposit\"\n                        class=\"grid-function\"\n                        :data-source-ref=\"'saleDepositDS'\"\n                        :sortable=\"false\"\n                        :filterable=\"false\"\n                        :column-menu=\"true\"\n                        :editable=\"true\"\n                        :scrollable-virtual=\"true\"\n                      >\n                        <kendo-grid-column\n                          :title=\"$t('no.')\"\n                          :width=\"55\"\n                          :template=\"cashAccrowNumTmpl\"\n                          :column-menu=\"false\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-products',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: products',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'account'\"\n                          :title=\"$t('account')\"\n                          :width=\"200\"\n                          :template=\"accountTemplate\"\n                          :editor=\"accountDropDownEditor\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'description'\"\n                          :title=\"$t('description')\"\n                          :width=\"200\"\n                          :template=\"'<span>#=description#</span>'\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'method'\"\n                          :title=\"$t('method')\"\n                          :width=\"160\"\n                          :template=\"methodTemplate\"\n                          :editor=\"methodDropDownEditor\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'refNo'\"\n                          :title=\"$t('payment_ref')\"\n                          :format=\"'{0:n}'\"\n                          :width=\"150\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'amount'\"\n                          :title=\"$t('amount')\"\n                          :format=\"'{0:n}'\"\n                          :width=\"150\"\n                          :template=\"amountTemplate\"\n                          :editor=\"amountEditor\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n\n                        <kendo-grid-column\n                          :command=\"{\n                            iconClass: 'k-icon k-i-trash',\n                            text: 'Delete',\n                            click: cashAccRemoveRow,\n                            class: 'btn-plus',\n                          }\"\n                          :title=\"'&nbsp;'\"\n                          :width=\"100\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                        />\n                      </kendo-grid>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                      <v-row>\n                        <v-col sm=\"7\" cols=\"12\" class=\"pb-0\">\n                          <v-btn\n                            class=\"float-left rounded-0 white--text mr-2\"\n                            color=\"primary\"\n                            @click=\"addCashAccRow\"\n                          >\n                            <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                          </v-btn>\n                        </v-col>\n                      </v-row>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                      <v-row>\n                        <v-col class=\"pt-0\" sm=\"6\" cols=\"6\">\n                          <v-card class=\"no-boxshadow pa-3\" color=\"grayBg\">\n                            <v-row>\n                              <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                                <label>{{\n                                  $t(\"message_on_cash_refund\")\n                                }}</label>\n                                <v-textarea\n                                  class=\" mt-1\"\n                                  outlined\n                                  no-resize\n                                  height=\"70px\"\n                                  rows=\"2\"\n                                  v-model=\"transaction.transactionNote\"\n                                  placeholder=\"This will appear on the invoice\"\n                                />\n                                <label>{{ $t(\"message_for_journal\") }}</label>\n                                <v-textarea\n                                  class=\"mt-1\"\n                                  outlined\n                                  no-resize\n                                  height=\"70px\"\n                                  v-model=\"transaction.journalNote\"\n                                  rows=\"2\"\n                                  placeholder=\"This will appear on the invoice\"\n                                />\n                              </v-col>\n                            </v-row>\n                          </v-card>\n                        </v-col>\n                        <v-col class=\"pt-0\" sm=\"6\" cols=\"6\">\n                          <v-simple-table>\n                            <template v-slot:default>\n                              <tbody>\n                                <tr>\n                                  <td class=\"text-left pr-0\">\n                                    {{ $t(\"subtotal\") }}\n                                  </td>\n                                  <td class=\"text-center\">:</td>\n                                  <td class=\"text-right\">\n                                    {{ numberFormat(transaction.subTotal) }}\n                                  </td>\n                                </tr>\n                                <tr>\n                                  <td class=\"text-left pr-0\">\n                                    {{ $t(\"general_discount\") }}\n                                  </td>\n                                  <td class=\"text-center\">:</td>\n                                  <td class=\"text-right\">\n                                    ({{\n                                      numberFormat(transaction.discountTotal)\n                                    }})\n                                  </td>\n                                </tr>\n                                <tr>\n                                  <td class=\"text-left pr-0\">\n                                    {{ $t(\"total_tax\") }}\n                                    <v-btn\n                                      @click=\"dialogTax = true\"\n                                      class=\"text-white text-bold rounded-0 float-right text-uppercase\"\n                                      style=\"height: 30px !important; background-color: rgb(0, 176, 80) !important\"\n                                    >\n                                      {{ $t(\"tax\") }}\n                                    </v-btn>\n                                  </td>\n                                  <td class=\"text-center\">:</td>\n                                  <td class=\"text-right\">\n                                    {{\n                                      numberFormat(transaction.totalTaxAmount)\n                                    }}\n                                  </td>\n                                </tr>\n                                <tr style=\"background: #e1efd9\">\n                                  <td class=\"text-left text-uppercase pr-0\">\n                                    {{ $t(\"total\") }}\n                                  </td>\n                                  <td class=\"text-center\">:</td>\n                                  <td\n                                    class=\"text-right color_green text-bold\"\n                                    id=\"total\"\n                                  >\n                                    {{ numberFormat(transaction.total) }}\n                                  </td>\n                                </tr>\n                              </tbody>\n                            </template>\n                          </v-simple-table>\n                        </v-col>\n                      </v-row>\n                    </v-col>\n                  </v-row>\n                  <v-divider />\n                  <v-card outlined dense class=\"no_border function_footer\">\n                    <v-alert type=\"warning\" v-model=\"alert\" dismissible>\n                      <span v-html=\"errorMessage\" />\n                    </v-alert>\n                    <v-select\n                      class=\"mr-2 float-left select_template\"\n                      v-model=\"transaction.formTemplate\"\n                      :items=\"formAR\"\n                      item-value=\"id\"\n                      item-text=\"name\"\n                      return-object\n                      clearable\n                      placeholder=\"Select Template\"\n                      outlined\n                    />\n                    <v-btn\n                      class=\"float-left  btn_cancel\"\n                      onclick=\"window.history.go(-1); return false;\"\n                      >{{ $t(\"cancel\") }}</v-btn\n                    >\n                    <v-menu>\n                      <template v-slot:activator=\"{ on }\">\n                        <v-btn class=\"ml-2 float-right save_option\" v-on=\"on\">\n                          {{ $t(\"save_option\") }}\n                          <v-icon size=\"\" class=\"ma-1\">expand_more</v-icon>\n                        </v-btn>\n                      </template>\n                      <v-list rounded>\n                        <v-list-item-group>\n                          <v-list-item>\n                            <v-list-item-content>\n                              <v-list-item-title\n                                v-if=\"!isEdit\"\n                                @click=\"saveNew\"\n                              >\n                                {{ $t(\"save_new\") }}\n                              </v-list-item-title>\n                            </v-list-item-content>\n                          </v-list-item>\n                          <v-list-item>\n                            <v-list-item-content>\n                              <v-list-item-title @click=\"saveClose\"\n                                >{{ $t(\"save_close\") }}\n                              </v-list-item-title>\n                            </v-list-item-content>\n                          </v-list-item>\n                        </v-list-item-group>\n                      </v-list>\n                    </v-menu>\n                    <v-btn\n                      class=\"float-right btn_save_draft\"\n                      @click=\"saveDraft\"\n                    >\n                      {{ $t(\"save_draft\") }}\n                    </v-btn>\n                  </v-card>\n                </v-form>\n              </v-col>\n\n              <v-col\n                class=\"smallSide\"\n                sm=\"4\"\n                style=\"transition: .3s ease-in;\"\n                :class=\"{ hide_small_bar_class: isHideBar }\"\n              >\n                <h3\n                  style=\"color: #b3b5bc; font-size:20px;\"\n                  v-if=\"!isHideBar\"\n                  class=\"text-uppercase float-right mt-n3\"\n                >\n                  Help\n                  <v-icon\n                    onclick=\"window.history.go(-1); return false;\"\n                    style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                    class=\"float-right mt-n1\"\n                    >close\n                  </v-icon>\n                </h3>\n\n                <div v-if=\"!isHideBar\" class=\"small_sidebar mt-9 px-4 grayBg\">\n                  <v-card\n                    class=\"pa-3 no-boxshadow\"\n                    style=\"min-height: 70px; background-color: #00b050 !important;\"\n                  >\n                    <h3\n                      style=\"font-size: 18px\"\n                      class=\"text-white text-uppercase mb-2\"\n                    >\n                      {{ $t(\"amount_returned\") }}\n                    </h3>\n                    <h3\n                      class=\"text-bold float-right text-white\"\n                      style=\"font-size: 22px\"\n                    >\n                      {{ numberFormat(transaction.total) }}\n                    </h3>\n                  </v-card>\n                  <v-row>\n                    <v-col sm=\"12\" cols=\"12\">\n                      <h4 class=\"mb-2 text-uppercase\">{{ $t(\"analysis\") }}</h4>\n                      <label class=\"label mb-0\">{{ $t(\"segment\") }}</label>\n                      <v-select\n                        class=\"mt-2\"\n                        v-model=\"transaction.segment\"\n                        :items=\"segments\"\n                        item-value=\"id\"\n                        :item-text=\"(item) => `${item.code} - ${item.name}`\"\n                        return-object\n                        tage=\"sub Of\"\n                        placeholder=\"Sub Of\"\n                        outlined=\"\"\n                      />\n                      <label class=\"label mb-0\">{{ $t(\"location\") }}</label>\n                      <v-select\n                        class=\"mt-2\"\n                        v-model=\"transaction.location\"\n                        :items=\"locations\"\n                        item-value=\"id\"\n                        :item-text=\"(item) => `${item.code} - ${item.name}`\"\n                        return-object\n                        tage=\"Location\"\n                        placeholder=\"bu/location\"\n                        outlined=\"\"\n                      />\n                      <label class=\"label font_14\">{{ $t(\"project\") }}</label>\n                      <v-select\n                        class=\" my-2\"\n                        v-model=\"transaction.project\"\n                        :items=\"customerProjects\"\n                        :item-text=\"(item) => `${item.code} - ${item.name}`\"\n                        item-value=\"id\"\n                        tage=\"Customer Project\"\n                        placeholder=\"project\"\n                        outlined\n                      />\n                      <label class=\"label font_14\">{{\n                        $t(\"sale_channel\")\n                      }}</label>\n                      <v-select\n                        class=\" my-2\"\n                        v-model=\"transaction.saleChannel\"\n                        :items=\"saleChannelList\"\n                        item-value=\"id\"\n                        item-text=\"name\"\n                        return-object\n                        tage=\"Sale Channel\"\n                        placeholder=\"Channel\"\n                        outlined\n                      />\n                      <label class=\"label font_14\">{{ $t(\"employee\") }}</label>\n                      <v-col\n                        sm=\"12\"\n                        cols=\"12\"\n                        class=\"kendo_dropdown_custom pl-0 pb-3 pt-0\"\n                        style=\"padding: 0\"\n                      >\n                        <dropdownlist\n                          style=\"width: 100%\"\n                          class=\" my-2\"\n                          :data-items=\"employees\"\n                          @change=\"onEmployeeChanged\"\n                          :value=\"mEmployee\"\n                          :data-item-key=\"'id'\"\n                          :text-field=\"'name'\"\n                          :default-item=\"defaultItem\"\n                          :filterable=\"true\"\n                          @filterchange=\"onEmployeeFilterChanged\"\n                        >\n                        </dropdownlist>\n                      </v-col>\n                    </v-col>\n                  </v-row>\n                  <p class=\"mb-0 detial_smallside_p font_14\">\n                    {{ $t(\"cash_refund_funct_desc\") }}\n                  </p>\n                </div>\n              </v-col>\n            </v-row>\n          </v-card>\n        </v-col>\n      </v-row>\n      <LoadingMe\n        :isLoading=\"showLoading\"\n        :fullPage=\"true\"\n        :myLoading=\"true\"\n        :alertMessage=\"loadingAlert\"\n        :color=\"loadingColorAlert\"\n        :alertText=\"loadingTextAlert\"\n      />\n      <v-dialog v-model=\"dialogTax\" max-width=\"450px\">\n        <v-card>\n          <div class=\"modal_header\">\n            <v-card-title>{{ $t(\"tax_list\") }}</v-card-title>\n            <v-icon @click=\"dialogTax = false\">close</v-icon>\n          </div>\n          <v-card-text class=\"modal_text_content\">\n            <v-row>\n              <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                <v-simple-table>\n                  <template v-slot:default>\n                    <tbody>\n                      <tr\n                        v-for=\"(value, name) in taxListTotal\"\n                        v-bind:key=\"name\"\n                      >\n                        <td class=\"text-left\" width=\"180px\">{{ name }}</td>\n                        <td class=\"text-center\">:</td>\n                        <td class=\"text-right\">\n                          {{ numberFormat(value) }}\n                        </td>\n                      </tr>\n                      <tr>\n                        <td class=\"text-left\" width=\"180px\">\n                          {{ $t(\"total\") }}\n                        </td>\n                        <td class=\"text-center\">:</td>\n                        <td class=\"text-right\">\n                          {{ numberFormat(saleOrder.totalTaxAmount) }}\n                        </td>\n                      </tr>\n                    </tbody>\n                  </template>\n                </v-simple-table>\n              </v-col>\n            </v-row>\n          </v-card-text>\n        </v-card>\n      </v-dialog>\n      <v-dialog v-model=\"dialogCatalog\" max-width=\"850px\">\n        <v-card>\n          <div class=\"modal_header\">\n            <v-card-title>{{ $t(\"catalog\") }}</v-card-title>\n            <v-icon @click=\"dialogCatalog = false\">close</v-icon>\n          </div>\n          <v-card-text class=\"modal_text_content\">\n            <v-row>\n              <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                <v-simple-table>\n                  <kendo-datasource\n                    ref=\"catalogDatasource\"\n                    :data=\"catalogs\"\n                    :schema=\"gridSchema\"\n                  />\n                  <kendo-grid\n                    id=\"gridCatalog\"\n                    class=\"grid-function\"\n                    :data-source-ref=\"'catalogDatasource'\"\n                    :style=\"{ width: '100%' }\"\n                    :noRecords=\"true\"\n                    :pageable-numeric=\"false\"\n                    :pageable-previous-next=\"false\"\n                    :pageable-messages-display=\"'Showing {2} data items'\"\n                    :scrollable-virtual=\"true\"\n                  >\n                    <kendo-grid-column\n                      :field=\"'images'\"\n                      :title=\"$t('image')\"\n                      :width=\"50\"\n                      :template=\"loadImage\"\n                      :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                    />\n                    <kendo-grid-column\n                      :field=\"'number'\"\n                      :title=\"$t('number')\"\n                      :width=\"70\"\n                      :template=\"'<span>#=number#</span>'\"\n                      :groupHeaderColumnTemplate=\"'#=value#'\"\n                      :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                    />\n                    <kendo-grid-column\n                      :field=\"'name'\"\n                      :title=\"$t('name')\"\n                      :attributes=\"{ class: 'tb_name_td' }\"\n                      :width=\"100\"\n                      :template=\"'<span>#=name#</span>'\"\n                      :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                    />\n                    <kendo-grid-column\n                      :field=\"'description'\"\n                      :title=\"$t('description')\"\n                      :width=\"100\"\n                      :template=\"'<span>#=description#</span>'\"\n                      :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                    />\n                    <kendo-grid-column\n                      :field=\"'noOfProduct'\"\n                      :title=\"$t('products')\"\n                      :template=\"'<span>#=noOfProduct#</span>'\"\n                      :width=\"50\"\n                      :headerAttributes=\"{\n                        style: 'text-align: left; background-color: #EDF1F5',\n                      }\"\n                    />\n                    <kendo-grid-column\n                      :field=\"''\"\n                      :title=\"$t('action')\"\n                      :width=\"60\"\n                      :command=\"[{ text: $t('add'), click: addCatalog }]\"\n                      :headerAttributes=\"{\n                        style: 'text-align: left; background-color: #EDF1F5',\n                      }\"\n                    />\n                  </kendo-grid>\n                </v-simple-table>\n              </v-col>\n            </v-row>\n          </v-card-text>\n        </v-card>\n      </v-dialog>\n    </v-container>\n  </v-app>\n</template>\n\n<script>\nimport DatePickerComponent from \"@/components/custom_templates/DatePickerComponent\";\nimport kendo from \"@progress/kendo-ui\";\nimport { DropDownList } from \"@progress/kendo-vue-dropdowns\";\nimport SaleFormContentModel from \"@/scripts/model/SaleFormContent\";\nimport ItemLineModel from \"@/scripts/invoice/model/ItemLine\";\nimport { uuid } from \"vue-uuid\";\nimport transactionModel from \"@/scripts/model/Transaction\";\n\n/* Store */\nimport store from \"@/store\";\nconst institute = store.state.institute.institute;\n\nimport CashAccountLineModel from \"@/scripts/sale_deposit/model/ItemLine\";\nimport { ExpenseEntryExtendedModel } from \"@/scripts/model/AppModels\";\nimport Helper from \"@/helper.js\";\nconst cashAccountLineModel = new CashAccountLineModel({});\n////handler\nconst transactionHandler = require(\"@/scripts/transactionHandler\");\nconst billingHandler = require(\"@/scripts/invoice/handler/billingHandler\");\nconst customerHandler = require(\"@/scripts/customerHandler\");\nconst projectHandler = require(\"@/scripts/projectHandler\");\nconst prefixHandler = require(\"@/scripts/prefixHandler\");\nconst priceLevelHandler = require(\"@/scripts/priceLevelHandler\");\nconst saleFormContentHandler = require(\"@/scripts/saleFormContentHandler\");\nconst employeeHandler = require(\"@/scripts/employeeHandler\");\nconst itemModifierHandler = require(\"@/scripts/itemModifierHandler\");\nconst discountItemHandler = require(\"@/scripts/discountItemHandler\");\nconst uomPriceHandler = require(\"@/scripts/uomPriceHandler\");\nconst productVariantHandler = require(\"@/scripts/productVariantHandler\");\nconst locationHandler = require(\"@/scripts/locationHandler\");\nconst settingsHandler = require(\"@/scripts/settingsHandler\");\nconst saleChannelHandler = require(\"@/scripts/saleChannelHandler\");\nconst saleUnitItemHandler = require(\"@/scripts/saleUnitItemHandler\");\nconst settingHandler = require(\"@/scripts/settingHandler\");\nconst catalogHandler = require(\"@/scripts/catalogHandler\");\nconst productHandler = require(\"@/scripts/productHandler\");\nconst currencyHandler = require(\"@/scripts/currency/handler/currencyHandler\");\nconst accountHandler = require(\"@/scripts/handler/accounting/account\");\n//\nconst saleFormContentModel = new SaleFormContentModel({});\nconst itemLineModel = new ItemLineModel({});\nconst expenseLines = new ExpenseEntryExtendedModel({});\n//other\nconst $ = require(\"jquery\");\nconst textField = \"numberName\";\nconst keyField = \"id\";\nconst defaultItem = { [textField]: \"Select customer...\", [keyField]: null };\nconst emptyItem = { [textField]: \"loading ...\" };\nconst invoicePrefix = \"lin-\";\nconst {\n  UomEditor,\n  PurchaseDiscountItemEditor,\n  PurchaseTaxEditor,\n} = require(\"@/scripts/kendo_editor/Collections\");\n\nexport default {\n  name: \"CashRefund\",\n  props: {\n    id: {\n      type: String,\n    },\n    initTransaction: {\n      type: transactionModel,\n    },\n  },\n  components: {\n    LoadingMe: () => import(`@/components/Loading`),\n    \"app-datepicker\": DatePickerComponent,\n    dropdownlist: DropDownList,\n  },\n  data: () => ({\n    transaction: new transactionModel(),\n    isEdit: false,\n    numSelect: [1],\n    dialogTax: false,\n    theDate: \"\",\n    suppliers_item: [],\n    //Catalog\n    dialogCatalog: false,\n    gridSchema: {\n      model: {\n        id: \"id\",\n      },\n    },\n    imgURL: \"https://s3-ap-southeast-1.amazonaws.com/images.banhji/\",\n    // LoadingMe\n    showLoading: false,\n    loadingAlert: false,\n    loadingColorAlert: \"\",\n    loadingTextAlert: \"\",\n    bill_date: \"\",\n    alert: false,\n    files: [],\n    errors: [],\n    // Form validation\n    valid: true,\n    col_expand: 9,\n    col_hide: 3,\n    isHideBar: false,\n    filter: \"\",\n    textField: \"numberName\",\n    dataItemKey: \"id\",\n    defaultItem: defaultItem,\n    //item\n    itemLines: [],\n    itemLine: itemLineModel,\n    dateFormat: itemLineModel.dateFormat,\n    //customer\n    cusBaseUrl: customerHandler.search(),\n    customer: {},\n    customerList: [],\n    employees: [],\n    mEmployee: {},\n    saleChannelList: [],\n    locations: [],\n    customerProjects: [],\n    segments: [],\n    transactionType: {},\n    taxListTotal: {},\n    customerDiscountItem: [],\n    customerSaleUnit: [],\n    saleFormContent: saleFormContentModel,\n    transactionDate: new Date().toISOString().substr(0, 10),\n    specificDiscountItem: [],\n    saleUnitItemList: [],\n    otherTax: [],\n    specificTax: [],\n    publicLightingTax: [],\n    priceLevel: [],\n    vatTax: [],\n    tax: [],\n    loggedUser: {\n      id: \"cf3d10ab-bce6-47b3-8405-b448c23dad84\",\n      name: \"Mr. Inspector\",\n    },\n    catalogs: [],\n    txnList: [],\n    quotes: [],\n    txnLists: [],\n    isSaveNew: false,\n    isSaveClose: false,\n    isSavePrint: false,\n    isSaveDraft: false,\n    exchangeRate: {},\n    baseCurrencyCode: \"\",\n    currencyCode: \"\",\n    transactionRate: 1,\n    saveOption: \"\",\n    formAR: [\n      { id: 1, name: \"Default Form\" },\n      { id: 2, name: \"Form 80mm\" },\n    ],\n    //cash account\n    cashAccount: {},\n    cashAccountLine: cashAccountLineModel,\n    accCash: [],\n    //exspense\n    expenseLines: expenseLines,\n    PurchaseTaxEditor: PurchaseTaxEditor,\n    UomEditor: UomEditor,\n    PurchaseDiscountItemEditor: PurchaseDiscountItemEditor,\n    expenseAccounts: [],\n    expenseAccount: {},\n  }),\n  methods: {\n    initialData() {\n      if (this.initTransaction) {\n        // Edit Mode\n        this.transaction = this.transaction;\n        this.bindData();\n      } else {\n        // Brand New Mode\n        if (this.$route.params.id === undefined) {\n          this.setDefaultData();\n        }\n      }\n    },\n    setDefaultData() {\n      // Brand New Mode\n      this.isEdit = false;\n      this.transaction = new transactionModel({});\n      this.transaction.formTemplate = 1;\n      // Generate Number\n      let ds = this.$refs.itemLineDS.kendoWidget();\n      ds.data([]);\n      // Add 2 default lines\n      this.addRow();\n      this.addCashAccRow();\n      this.expenseAddRow();\n      this.loadPrefix();\n      this.loadSegment();\n      this.loadLocation();\n      this.loadSaleChannel();\n      this.loadPriceLevel();\n      this.mEmployee = {};\n      this.taxListTotal = {};\n      this.isSaveNew = false;\n      this.isSaveClose = false;\n      this.isSavePrint = false;\n      this.isSaveDraft = false;\n    },\n    bindData() {\n      // Edit Mode\n      this.isEdit = true;\n      this.customer = this.transaction.customer;\n      this.taxListTotal = this.transaction.taxListTotal;\n      this.itemLines = this.transaction.itemLines;\n      this.loadProjectByCustomer();\n    },\n    addSelect() {\n      let amount_num = this.numSelect.length;\n      let num = this.numSelect[amount_num - 1];\n      let new_num = num + 1;\n      let lenghtItem = this.specificDiscountItem.length;\n      if (new_num <= lenghtItem) {\n        this.numSelect.push(new_num);\n      }\n    },\n    removeSelect(index) {\n      this.numSelect.splice(index, 1);\n      // window.console.log(index, this.numSelect)\n      // this.selectDiscount.splice(index,1)\n      // window.console.log(\"remove\",this.selectDiscount)\n      // this.selectDiscount = this.selectDiscount.filter(item =>  item.id != val.id);\n    },\n    hide_smallsitebar() {\n      if (!this.isHideBar) {\n        // this.col_expand = 12\n        // this.col_hide = 0\n        this.isHideBar = true;\n      } else {\n        // this.col_expand = 9\n        // this.col_hide = 3\n        this.isHideBar = false;\n      }\n    },\n    errorMessage() {},\n    //number\n    generateNumber() {\n      // window.console.log('generateNumber')\n      let d = new Date().toISOString().substr(0, 10);\n      if (this.transactionDate) {\n        // window.console.log(this.transactionDate)\n        d = this.transactionDate;\n      }\n      let data = {\n        abbr: this.transaction.transactionType.abbr,\n        structure: this.transaction.transactionType.structure,\n        transactionDate: d,\n        type: \"Cash Refund\",\n      };\n      billingHandler\n        .lastNumber(data)\n        .then((response) => {\n          if (response.data.statusCode === 200) {\n            const res = response.data.data;\n            const lastNumber = this.zeroPad(\n              parseInt(res.lastNumber),\n              this.transaction.transactionType.format\n            );\n            const number =\n              res.suffix +\n              this.transaction.transactionType.numberSeparator +\n              lastNumber;\n            this.transaction.number = number;\n          }\n        })\n        .catch((e) => {\n          this.errors.push(e);\n        });\n    },\n    zeroPad(num, places) {\n      return String(num).padStart(places, \"0\");\n    },\n    //customer\n    onChange(event) {\n      window.console.log(event);\n      const value = event.value;\n      if (value && value[textField] === emptyItem[textField]) {\n        return;\n      }\n      this.customer = value;\n      this.transaction.customer = value;\n      const baseCurrency = value.hasOwnProperty(\"baseCurrency\")\n        ? value.baseCurrency\n        : {};\n      if (baseCurrency.hasOwnProperty(\"code\")) {\n        this.baseCurrencyCode = baseCurrency.code;\n      }\n      this.transaction.priceLevel = value.hasOwnProperty(\"priceLevel\")\n        ? value.priceLevel\n        : {};\n      const priceLevel = value.hasOwnProperty(\"priceLevel\")\n        ? value.priceLevel\n        : {};\n      if (priceLevel.hasOwnProperty(\"currency\")) {\n        if (priceLevel.currency.hasOwnProperty(\"id\")) {\n          this.loadTransactionRate();\n        }\n      }\n      this.onDateChanged();\n      this.loadProjectByCustomer();\n    },\n    onFilterChange(event) {\n      const filter = event.filter.value;\n      this.requestData(0, filter, this.cusBaseUrl);\n      this.filter = filter;\n    },\n    requestData(skip, filter, baseUrl) {\n      const url = baseUrl + `?filter=${filter}`;\n      this.requestStarted = true;\n      fetch(url)\n        .then((response) => {\n          return response.json();\n        })\n        .then(this.afterFetch);\n    },\n    afterFetch(json) {\n      this.customerList = json.data;\n    },\n    removeRow(e) {\n      e.preventDefault();\n      const grid = kendo.jQuery(\"#gridItemLine\").data(\"kendoGrid\"),\n        dataSource = grid.dataSource,\n        dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n      if (dataSource.total() > 1) {\n        dataSource.remove(dataItem);\n      }\n    },\n    //date\n    onDateChanged() {\n      if (this.$route.params.id === undefined) {\n        this.generateNumber();\n      }\n    },\n    onEmployeeFilterChanged() {},\n    //number\n    numberFormat(value) {\n      // window.console.log(this.saleFormContent.decimal,'nimol')\n      return kendo.toString(value, `n${this.saleFormContent.decimal}`);\n      // return value\n    },\n    //\n    async loadPriceLevel() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          priceLevelHandler.get().then((res) => {\n            this.priceLevel = res;\n            if (this.priceLevel.length > 0) {\n              if (\n                this.$route.params.id !== undefined ||\n                this.$route.params.id != \"\"\n              ) {\n                this.transaction.priceLevel = this.priceLevel[0];\n                this.loadTransactionRate();\n              }\n            }\n          });\n        }, 300);\n      });\n    },\n    removeDuplicate(array) {\n      const result = [];\n      const map = new Map();\n      for (const item of array) {\n        if (!map.has(item.id)) {\n          map.set(item.id, true); // set any value to Map\n          result.push(item);\n        }\n      }\n      return result;\n    },\n    autoCalculateDiscount(discountItem, subTotal) {\n        if (discountItem) {\n            const nature = discountItem.nature || ''\n            const amount = discountItem.amount || 0\n            if (nature === 'Amount') {\n                return parseFloat(amount)\n            } else if (nature === 'Percentage') {\n                return (subTotal * (parseFloat(amount) / 100))\n            }else{\n                return 0\n            }\n        }else{\n            return 0\n        }\n    },\n    autoCalculateTax(tax, amount) {\n      if (tax) {\n        var formula = tax.formula;\n        var inAmt = kendo.parseFloat(amount);\n        var nAmt = kendo.parseFloat(amount);\n        var taxBase = kendo.parseFloat(tax.taxBase) / 100;\n        var rate = kendo.parseFloat(tax.rate) / 100;\n        var total = eval(formula);\n        window.console.log(inAmt, nAmt, taxBase, rate, formula, total);\n        // window.console.log(amount)\n        return total;\n      }\n      // return 0\n    },\n    autoCalculateTaxByType(tax) {\n      // return by a key\n      const groupAll = (list) =>\n        list.reduce((tax, item) => {\n          const taxAmount = tax[item.name] || 0;\n          return Object.assign({}, tax, {\n            [item.name]: taxAmount + parseFloat(item.amount),\n          });\n        }, {});\n      this.taxListTotal = groupAll(tax);\n      // window.console.log('nimol', groupAll(tax))\n      // this.\n    },\n    dataSourceChanged(e) {\n      if (e.field) {\n        let dataRow = e.items[0];\n        switch (e.field) {\n          case \"item\":\n            // this.attribute_ = this.attributes.filter(m => m.type.id === dataRow.variant.id)\n            dataRow.set(\"description\", dataRow.item.description);\n            // this.itemChange(dataRow)\n            break;\n          case \"uom\":\n            // window.console.log(dataRow.uom,'row-uom')\n            dataRow.set(\"price\", parseFloat(dataRow.uom.price));\n            dataRow.set(\n              \"amount\",\n              parseFloat(dataRow.uom.price) * parseFloat(dataRow.qty)\n            );\n            break;\n          case \"qty\":\n            dataRow.set(\"price\", parseFloat(dataRow.uom.price));\n            dataRow.set(\n              \"amount\",\n              parseFloat(dataRow.uom.price) * parseFloat(dataRow.qty)\n            );\n            break;\n          case \"otherTax\":\n            // window.console.log(\"--\", dataRow)\n            break;\n          default:\n            break;\n        }\n        if (e.field) {\n          this.autoCalculate();\n        }\n      }\n    },\n    autoCalculate() {\n      let ds = this.$refs.itemLineDS.kendoWidget(),\n        subTotal = 0,\n        totalTax = 0,\n        discountTotal = 0,\n        spTax = 0,\n        pltax = 0,\n        otherTax = 0,\n        vatTax = 0,\n        discountInvoice = 0,\n        taxList = [],\n        discountItem = [],\n        saleUnit = [];\n\n      ds.data().forEach((value) => {\n        let modifierPrice = 0;\n        if (value.modifier) {\n          modifierPrice = kendo.parseFloat(value.modifier.price);\n        }\n\n        subTotal += kendo.parseFloat(value.amount) + modifierPrice;\n        let discount = 0;\n        if (value.discountItem) {\n          let subTo =\n            kendo.parseFloat(value.price) * kendo.parseFloat(value.qty);\n          discount = this.autoCalculateDiscount(value.discountItem, subTo);\n          if (value.discountItem.hasOwnProperty(\"id\")) {\n            discountItem.push(value.discountItem);\n          }\n          discountTotal += discount;\n        }\n        if (value.saleUnit) {\n          if (value.saleUnit.hasOwnProperty(\"id\")) {\n            saleUnit.push(value.saleUnit);\n          }\n        }\n        if (value.specificTax) {\n          spTax = this.autoCalculateTax(\n            value.specificTax,\n            kendo.parseFloat(value.amount) - kendo.parseFloat(discount)\n          );\n          // window.console.log('sp ', discount)\n          spTax = kendo.parseFloat(spTax) ? kendo.parseFloat(spTax) : 0;\n          if (value.specificTax.hasOwnProperty(\"taxType\")) {\n            taxList.push({\n              name: value.specificTax.taxType.name,\n              amount: spTax,\n              id: value.specificTax.taxType.id,\n            });\n          }\n        }\n        if (value.publicLightingTax) {\n          pltax = this.autoCalculateTax(\n            value.publicLightingTax,\n            kendo.parseFloat(value.amount) - kendo.parseFloat(discount)\n          );\n          pltax = kendo.parseFloat(pltax) ? kendo.parseFloat(pltax) : 0;\n          if (value.publicLightingTax.hasOwnProperty(\"taxType\")) {\n            taxList.push({\n              name: value.publicLightingTax.taxType.name,\n              amount: pltax,\n              id: value.publicLightingTax.taxType.id,\n            });\n          }\n        }\n        if (value.otherTax) {\n          otherTax = this.autoCalculateTax(\n            value.otherTax,\n            kendo.parseFloat(value.amount) - kendo.parseFloat(discount)\n          );\n          otherTax = kendo.parseFloat(otherTax)\n            ? kendo.parseFloat(otherTax)\n            : 0;\n          if (value.otherTax.hasOwnProperty(\"taxType\")) {\n            taxList.push({\n              name: value.otherTax.taxType.name,\n              amount: otherTax,\n              id: value.otherTax.taxType.id,\n            });\n          }\n        }\n\n        if (value.vatTax) {\n          // window.console.log('Vat Tax', value.vatTax)\n          let amt =\n            kendo.parseFloat(spTax ? spTax : 0) +\n            kendo.parseFloat(pltax ? pltax : 0) +\n            kendo.parseFloat(otherTax ? otherTax : 0) +\n            (kendo.parseFloat(value.amount ? value.amount : 0) -\n              (discount ? discount : 0));\n          vatTax = this.autoCalculateTax(value.vatTax, amt);\n          vatTax = kendo.parseFloat(vatTax) ? kendo.parseFloat(vatTax) : 0;\n          if (value.vatTax.hasOwnProperty(\"taxType\")) {\n            taxList.push({\n              name: value.vatTax.taxType.name,\n              amount: vatTax,\n              id: value.vatTax.taxType.id,\n            });\n          }\n        }\n        totalTax +=\n          kendo.parseFloat(spTax ? spTax : 0) +\n          kendo.parseFloat(pltax ? pltax : 0) +\n          kendo.parseFloat(otherTax ? otherTax : 0) +\n          kendo.parseFloat(vatTax ? vatTax : 0);\n      });\n\n      discountTotal = discountTotal ? discountTotal : 0;\n\n      // window.console.log(spTax, pltax, otherTax, vatTax)\n      let total =\n        kendo.parseFloat(subTotal) -\n        kendo.parseFloat(discountTotal) +\n        kendo.parseFloat(totalTax);\n      this.transaction.subTotal = subTotal;\n      $(\"#subtotal\").text(kendo.parseFloat(subTotal));\n      this.transaction.totalTaxAmount = kendo.parseFloat(totalTax);\n      this.transaction.discountTotal = kendo.parseFloat(discountTotal);\n      if (this.transaction.specificDiscountItem) {\n        discountInvoice = this.autoCalculateDiscount(\n          this.transaction.specificDiscountItem,\n          kendo.parseFloat(subTotal)\n        );\n        discountInvoice = discountInvoice ? discountInvoice : 0;\n      }\n      // this.onOtherChargeChange()\n      this.transaction.total = kendo.parseFloat(total) - discountInvoice;\n      this.transaction.exchangeAmount =\n        kendo.parseFloat(this.transaction.total) *\n        kendo.parseFloat(this.transaction.txnRate);\n      this.autoCalculateTaxByType(taxList);\n      this.customerDiscountItem = this.removeDuplicate(discountItem);\n      this.customerSaleUnit = this.removeDuplicate(saleUnit);\n      // window.console.log('discount ', this.customerDiscountItem)\n    },\n    rowNumberTmpl(dataItem) {\n      let ds = this.$refs.itemLineDS.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    async loadSaleFormContent() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          saleFormContentHandler.list().then((res) => {\n            if (res.data.statusCode === 200) {\n              const data = res.data.data;\n              if (data.length > 0) {\n                this.saleFormContent = data[0];\n                // window.console.log(data[0])\n              }\n            }\n          });\n        }, 300);\n      });\n    },\n    vatTemplate(dataItem) {\n      const vat = dataItem.vatTax;\n      if (vat) {\n        return `<span>${vat.defaultTax ? vat.defaultTax : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    itemTemplate(dataItem) {\n      const item = dataItem.item;\n      if (item) {\n        return `<span>${item.name ? item.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    UOMTemplate(dataItem) {\n      const uom = dataItem.uom;\n      if (uom) {\n        return `<span>${uom.uom ? uom.uom.toUOM.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    saleUnitTemplate(dataItem) {\n      const saleUnit = dataItem.saleUnit;\n      if (saleUnit) {\n        return `<span>${saleUnit.name ? saleUnit.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    discountItemTemplate(dataItem) {\n      const discountItem = dataItem.discountItem;\n      if (discountItem) {\n        return `<span>${discountItem.code ? discountItem.code : ``} - ${\n          discountItem.name ? discountItem.name : ``\n        }</span>`;\n      } else {\n        return ``;\n      }\n    },\n    ServiceDateEditor(container, options) {\n      kendo\n        .jQuery('<input required name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDatePicker();\n\n      // let ds = this.$refs.itemLineDS.kendoWidget()\n      // window.console.log(ds.data())\n      // // const dateString = kendo.toString((new Date(options.model.items.serviceDate)), this.itemLine.dateFormat)\n      // // const dateString = kendo.toString(options.model.items.serviceDate)\n      // const $input = $(\"<input value=\" + options.model.serviceDate + \" />\").appendTo(container)\n      // $input.kendoDatePicker()\n      // // $input.appendTo(container)\n      // // options.model.items.serviceDate = dateString\n      // window.console.log($input)\n    },\n    ServiceDateToEditor(container, options) {\n      kendo\n        .jQuery('<input required name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDatePicker();\n    },\n    ItemDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"contains\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          headerTemplate:\n            '<div class=\"dropdown-header k-widget k-header\">' +\n            \"<span>Items </span>\" +\n            \"<span></span>\" +\n            \"</div>\",\n          template: \"<span>#=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: productVariantHandler.itemSearchURL(),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  name: { type: \"string\" },\n                  sku: { type: \"string\" },\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    UOMDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"uom.toUOM.name\",\n          dataValueField: \"uom.toUOM.id\",\n          cascadeFrom: \"item\",\n          template: \"<span>#=uom.toUOM.name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: uomPriceHandler.getURL(\n                  options.model.item.id,\n                  this.transaction.priceLevel.id\n                ),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  // name: {type: \"string\"},\n                  // sku: {type: \"string\"},\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    DiscountItemDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          cascadeFrom: \"item\",\n          template: \"<span>#=code# - #=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: discountItemHandler.getURL(),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  // name: {type: \"string\"},\n                  // sku: {type: \"string\"},\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n          }),\n        });\n    },\n    SpecificTaxDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"defaultTax\",\n          dataValueField: \"id\",\n          template: \"<span>#=defaultTax#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            data: this.specificTax.filter((m) => {\n              if (options.model.hasOwnProperty(\"vatTax\")) {\n                const vat = options.model.vatTax;\n                if (vat) {\n                  if (\n                    options.model.vatTax !== null ||\n                    options.model.vatTax !== \"null\"\n                  ) {\n                    if (options.model.vatTax.baseAmount) {\n                      return (\n                        m.baseAmount.toLowerCase() ===\n                        options.model.vatTax.baseAmount.toLowerCase()\n                      );\n                    } else {\n                      return m;\n                    }\n                  }\n                } else {\n                  return m;\n                }\n              }\n            }),\n          }),\n        });\n    },\n    PublicLightingTaxDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"defaultTax\",\n          dataValueField: \"id\",\n          template: \"<span>#=defaultTax#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            data: this.publicLightingTax.filter((m) => {\n              if (options.model.hasOwnProperty(\"vatTax\")) {\n                const vat = options.model.vatTax;\n                if (vat) {\n                  if (\n                    options.model.vatTax !== null &&\n                    options.model.vatTax !== \"null\"\n                  ) {\n                    if (options.model.vatTax.baseAmount) {\n                      return (\n                        m.baseAmount.toLowerCase() ===\n                        options.model.vatTax.baseAmount.toLowerCase()\n                      );\n                    } else {\n                      return m;\n                    }\n                  }\n                } else {\n                  return m;\n                }\n              }\n            }),\n          }),\n        });\n    },\n    OtherTaxDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"defaultTax\",\n          dataValueField: \"id\",\n          template: \"<span>#=defaultTax#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            data: this.otherTax.filter((m) => {\n              if (options.model.hasOwnProperty(\"vatTax\")) {\n                const vat = options.model.vatTax;\n                if (vat) {\n                  if (\n                    options.model.vatTax !== null &&\n                    options.model.vatTax !== \"null\"\n                  ) {\n                    if (options.model.vatTax.baseAmount) {\n                      return (\n                        m.baseAmount.toLowerCase() ===\n                        options.model.vatTax.baseAmount.toLowerCase()\n                      );\n                    } else {\n                      return m;\n                    }\n                  }\n                } else {\n                  return m;\n                }\n              }\n            }),\n          }),\n        });\n    },\n    VatTaxDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"defaultTax\",\n          dataValueField: \"id\",\n          template: \"<span>#=defaultTax#</span>\",\n          optionLabel: \"--Select--\",\n          dataSource: new kendo.data.DataSource({\n            data: this.vatTax,\n          }),\n        });\n    },\n    SaleUnitDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          template: \"<span>#=code# - #=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            data: this.saleUnitItemList,\n          }),\n        });\n    },\n    ModifierDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"contains\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          headerTemplate:\n            '<div class=\"dropdown-header k-widget k-header\">' +\n            \"<span>Modifier </span>\" +\n            \"<span></span>\" +\n            \"</div>\",\n          template: \"<span>#=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: itemModifierHandler.searchURL(options.model.item.id),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  name: { type: \"string\" },\n                  price: { type: \"number\" },\n                  uom: { type: \"string\" },\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n          }),\n        });\n    },\n    EmployeeDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input data-bind=\"value:' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoMultiSelect({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          suggest: true,\n          filter: \"contains\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          headerTemplate:\n            '<div class=\"dropdown-header k-widget k-header\">' +\n            \"<span>Employee </span>\" +\n            \"<span></span>\" +\n            \"</div>\",\n          template: \"<span>#=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: employeeHandler.searchURL(),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  name: { type: \"string\" },\n                  firstName: { type: \"string\" },\n                  lastName: { type: \"string\" },\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n          }),\n        });\n    },\n    empImpl(dataItem) {\n      let empIds = [];\n      dataItem.employee.forEach((m) => {\n        empIds.push(m.firstName + \" - \" + m.lastName);\n      });\n      // window.console.log(empIds.join(', '))\n      return `<span>${empIds.join(\", \")}</span>`;\n    },\n    addRow() {\n      let ds = this.$refs.itemLineDS.kendoWidget(),\n        total = ds.total();\n      this.itemLine.id = invoicePrefix + uuid.v1();\n      ds.insert(total, this.itemLine);\n    },\n    onSpecificDiscountChanged() {\n      if (this.transaction.specificDiscountItem) {\n        const discountOrder = this.autoCalculateDiscount(\n          this.transaction.specificDiscountItem,\n          this.transaction.subTotal\n        );\n        this.transaction.specificDiscountTotal = kendo.toString(\n          discountOrder ? discountOrder : 0,\n          \"n\"\n        );\n        let total =\n          kendo.parseFloat(this.transaction.subTotal) -\n          (kendo.parseFloat(this.transaction.discountTotal) +\n            kendo.parseFloat(this.transaction.totalTaxAmount)) -\n          discountOrder;\n        this.transaction.total = kendo.toString(total, \"n\");\n      }\n    },\n    onOtherAmount(value) {\n      return this.autoCalculateDiscount(value, this.transaction.subTotal);\n    },\n    async loadDiscountItem() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          discountItemHandler.list().then((res) => {\n            if (res.data.statusCode === 200) {\n              this.specificDiscountItem = res.data.data;\n            }\n          });\n        }, 300);\n      });\n    },\n    async loadSegment() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.segments = [];\n          settingsHandler\n            .getSeg()\n            .then((res) => {\n              this.showLoading = true;\n              if (res.data.statusCode === 200) {\n                this.showLoading = false;\n                this.segments = res.data.data;\n                if (this.segments.length > 0) {\n                  if (\n                    this.$route.params.id !== undefined ||\n                    this.$route.params.id != \"\"\n                  ) {\n                    this.transaction.segment = this.segments[0];\n                  }\n                }\n                // this.segmentList = res.data.data\n              }\n            })\n            .catch();\n          {\n            this.showLoading = false;\n          }\n        }, 300);\n      });\n    },\n    async loadLocation() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.locations = [];\n          locationHandler\n            .list()\n            .then((res) => {\n              this.showLoading = true;\n              if (res.data.statusCode === 200) {\n                this.showLoading = false;\n                this.locations = res.data.data;\n                if (this.locations.length > 0) {\n                  if (\n                    this.$route.params.id !== undefined ||\n                    this.$route.params.id != \"\"\n                  ) {\n                    this.transaction.location = this.locations[0];\n                  }\n                }\n              }\n            })\n            .catch();\n          {\n            this.showLoading = false;\n          }\n        }, 300);\n      });\n    },\n    async loadProjectByCustomer() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          projectHandler\n            .getByCustomer(this.customer.id)\n            .then((res) => {\n              this.showLoading = true;\n              if (res.data.statusCode === 200) {\n                this.showLoading = false;\n                this.customerProjects = res.data.data;\n                if (this.customerProjects.length > 0) {\n                  if (!this.initTransaction) {\n                    this.transaction.project = this.customerProjects[0];\n                  }\n                }\n              }\n            })\n            .catch();\n          {\n            this.showLoading = false;\n          }\n        }, 300);\n      });\n    },\n    async loadSaleChannel() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.showLoading = true;\n          saleChannelHandler.get().then((res) => {\n            if (res.data.statusCode === 200) {\n              this.showLoading = false;\n              this.saleChannelList = res.data.data;\n              if (this.saleChannelList.length > 0) {\n                if (\n                  this.$route.params.id !== undefined ||\n                  this.$route.params.id != \"\"\n                ) {\n                  this.transaction.saleChannel = this.saleChannelList[0];\n                }\n              }\n            } else {\n              this.showLoading = false;\n            }\n          });\n        }, 300);\n      });\n    },\n    async loadTax() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          settingHandler.get().then((res) => {\n            this.tax = res;\n            this.otherTax = this.tax.filter((m) => m.taxType.typeId === 7); // valuable tax\n            this.specificTax = this.tax.filter(\n              (m) => m.taxType.typeId === 8 && m.transactionType === \"Sale\"\n            ); // valuable tax\n            this.publicLightingTax = this.tax.filter(\n              (m) => m.taxType.typeId === 9 && m.transactionType === \"Sale\"\n            ); // valuable tax\n            this.vatTax = this.tax.filter(\n              (m) =>\n                (m.taxType.typeId === 1 || m.taxType.typeId === 8) &&\n                m.transactionType === \"Sale\"\n            ); // valuable tax\n          });\n        }, 300);\n      });\n    },\n    async loadSaleUnitItems() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          saleUnitItemHandler.list().then((res) => {\n            if (res.data.statusCode === 200)\n              this.saleUnitItemList = res.data.data;\n          });\n        }, 300);\n      });\n    },\n    close(data) {\n      if (this.$route.params.id === undefined) {\n        this.$router.push({\n          name: \"Customers\",\n          params: {\n            data: data,\n          },\n        });\n      } else {\n        window.history.go(-1);\n      }\n      window.console.log(data, \"close\");\n      // localStorage.data.id = JSON.stringify(data)\n    },\n    //catalog\n    loadImage(dataItem) {\n      if (dataItem.hasOwnProperty(\"images\")) {\n        if (dataItem.images.hasOwnProperty(\"default\")) {\n          const url = this.imgURL + dataItem.images.default.thumb;\n          return (\n            \"<img width='50' height='50' style= 'margin: auto;display: block;' src='\" +\n            url +\n            \"' />\"\n          );\n        }\n      } else {\n        return \"\";\n      }\n    },\n    async loadCatalogs() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.showLoading = true;\n          catalogHandler.get().then((res) => {\n            this.showLoading = false;\n            this.catalogs = res;\n          });\n        }, 300);\n      });\n    },\n    addCatalog(e) {\n      e.preventDefault();\n      let grid = kendo.jQuery(\"#gridCatalog\").data(\"kendoGrid\");\n      let dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n      // window.console.log(dataItem)\n      if (dataItem.variants.length > 0) {\n        dataItem.variants.forEach((m) => {\n          if (m.hasOwnProperty(\"variant\")) {\n            if (m.variant.hasOwnProperty(\"id\")) {\n              this.loadSingleItem(m.variant.id, \"i\");\n            }\n          }\n        });\n        this.dialogCatalog = false;\n      }\n      if (dataItem.services.length > 0) {\n        dataItem.services.forEach((m) => {\n          if (m.hasOwnProperty(\"service\")) {\n            if (m.service.hasOwnProperty(\"id\")) {\n              this.loadSingleItem(m.service.id, \"s\");\n            }\n          }\n        });\n        this.dialogCatalog = false;\n      }\n    },\n    async loadSingleItem(itemId, type) {\n      new Promise((resolve) => {\n        resolve(\"resolved\");\n        setTimeout(() => {\n          this.showLoading = true;\n          productHandler.getOne(itemId).then((res) => {\n            this.showLoading = false;\n            let data = res;\n            window.console.log(data);\n            let ds = this.$refs.itemLineDS.kendoWidget(),\n              total = ds.total();\n            this.itemLine.id = invoicePrefix + uuid.v1();\n            this.itemLine.item = data;\n            if (type == \"i\") {\n              this.itemLine.description = data.variant.saleDescription;\n            } else {\n              this.itemLine.description = data.saleDescription;\n            }\n            ds.insert(total, this.itemLine);\n          });\n        }, 500);\n      });\n    },\n    async loadPrefix() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          prefixHandler.get(\"sale order\").then((res) => {\n            if (res.data.statusCode === 200) {\n              this.showLoading = false;\n              this.transactionType = res.data.data;\n              if (this.transactionType.length > 0) {\n                this.transaction.transactionType = this.transactionType[0];\n                if (!this.initTransaction) {\n                  this.generateNumber();\n                }\n              }\n            }\n          });\n        }, 300);\n      });\n    },\n    onEmployeeChanged(event) {\n      const value = event.value;\n      if (value && value[textField] === emptyItem[textField]) {\n        return;\n      }\n      this.mEmployee = value;\n      this.transaction.employee = value;\n    },\n    async loadEmployeeCenter() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.employees = [];\n          employeeHandler\n            .center(undefined)\n            .then((res) => {\n              this.showLoading = true;\n              if (res.data.statusCode === 200) {\n                this.showLoading = false;\n                this.employees = res.data.data;\n                if (this.employees.length > 0) {\n                  this.transaction.employee = this.employees[0];\n                }\n              }\n            })\n            .catch();\n          {\n            this.showLoading = false;\n          }\n        }, 300);\n      });\n    },\n    removeEmptyLine() {\n      const grid = kendo.jQuery(\"#gridItemLine\").data(\"kendoGrid\"),\n        dataSource = grid.dataSource;\n      dataSource.data().forEach((m) => {\n        if (m.item.id === undefined) {\n          dataSource.remove(m);\n        }\n      });\n    },\n    async loadTransactionRate() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          const date = new Date(this.transactionDate)\n            .toISOString()\n            .substr(0, 10);\n          const priceLevel = this.transaction.priceLevel;\n          let code = \"\";\n          if (priceLevel.hasOwnProperty(\"currency\")) {\n            if (priceLevel.currency.hasOwnProperty(\"code\")) {\n              code = priceLevel.currency.code;\n            }\n          }\n          if (code !== undefined || code !== \"\") {\n            this.showLoading = true;\n            currencyHandler\n              .getLastExchangeRateByDate(date, code)\n              .then((res) => {\n                if (res.data.statusCode === 200) {\n                  this.showLoading = false;\n                  this.exchangeRate = res.data.data[0];\n                  this.currencyCode = this.exchangeRate.code;\n                  this.transactionRate = this.exchangeRate.rate;\n                  this.transaction.txnRate = this.exchangeRate.rate;\n                  this.transaction.exchangeRate = this.exchangeRate;\n                  this.showLoading = false;\n                }\n              });\n          }\n        }, 300);\n      });\n    },\n    //cash account\n    cashAccountautoCalculate() {\n      let ds = this.$refs.saleDepositDS.kendoWidget(),\n        convertedAmount = 0,\n        amount = 0;\n      ds.data().forEach((value) => {\n        if (value.amount) {\n          amount += kendo.parseFloat(value.amount);\n          convertedAmount +=\n            kendo.parseFloat(value.amount) * this.transaction.txnRate;\n        }\n      });\n      this.cashAccount.exchangeAmount = convertedAmount;\n      this.cashAccount.amount = amount;\n    },\n    cashAccountDSChanged(e) {\n      if (e.field) {\n        this.cashAccountautoCalculate();\n      }\n    },\n    addCashAccRow() {\n      let ds = this.$refs.saleDepositDS.kendoWidget(),\n        total = ds.total();\n      this.cashAccountLine.id = invoicePrefix + uuid.v1();\n      ds.insert(total, this.cashAccountLine);\n    },\n    cashAccrowNumTmpl(dataItem) {\n      let ds = this.$refs.saleDepositDS.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    accountDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          template: \"<span>#=number# - #= name#</span>\",\n          optionLabel: \"--Select--\",\n          dataSource: new kendo.data.DataSource({\n            data: this.accCash,\n          }),\n        });\n    },\n    methodDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          template: \"<span>#=code# - #= name#</span>\",\n          optionLabel: \"--Select--\",\n          dataSource: new kendo.data.DataSource({\n            data: this.paymentMethod,\n          }),\n        });\n    },\n    accountTemplate(dataItem) {\n      const acc = dataItem.account;\n      if (acc) {\n        return `<span>${acc.name ? acc.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    async loadAccount() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          accountHandler.getAll().then((res) => {\n            this.showLoading = false;\n            this.expenseAccounts = res.data;\n            this.accCash = res.data\n              .filter((m) => m.account_type.number <= 5)\n              .map((item) => {\n                return {\n                  id: item.uuid,\n                  uuid: item.uuid,\n                  name: item.name,\n                  local_name: item.local_name,\n                  number: item.number,\n                  is_taxable: item.is_taxable,\n                  banhjiAccCode: item.banhjiAccCode,\n                  group_code: item.group_code,\n                  parent_account: item.parent_account,\n                  type_code: item.type_code,\n                  account_type: item.account_type,\n                };\n              });\n          });\n        }, 300);\n      });\n    },\n    methodTemplate(dataItem) {\n      const method = dataItem.method;\n      if (method) {\n        return `<span>${method.name ? method.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    amountTemplate(dataItem) {\n      const amt = dataItem.amount;\n      if (amt) {\n        return kendo.toString(parseFloat(amt), `${this.decimalFormat}`);\n      } else {\n        return 0;\n      }\n    },\n    amountEditor(container, options) {\n      kendo\n        .jQuery('<input data-bind=\"value:' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoNumericTextBox({\n          decimals: 30,\n          format: `${this.decimalFormat}`,\n        });\n    },\n    cashAccRemoveRow(e) {\n      e.preventDefault();\n      const grid = kendo.jQuery(\"#gridSaleDeposit\").data(\"kendoGrid\"),\n        dataSource = grid.dataSource,\n        dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n      if (dataSource.total() > 1) {\n        dataSource.remove(dataItem);\n      }\n    },\n    //exspense\n    expenseAddRow() {\n      let ds = this.$refs.expenseAccountDS.kendoWidget(),\n        last = ds.total();\n\n      let je = new ExpenseEntryExtendedModel();\n      ds.insert(last, je);\n    },\n    onExpenseAccountDSChanges(e) {\n      if (e.field) {\n        let dataRow = e.items[0];\n\n        if (e.field === \"account\") {\n          this.addExtraRow(dataRow.uid);\n        } else if (e.field === \"quantity\" || e.field === \"price\") {\n          let amt =\n            kendo.parseFloat(dataRow.quantity) *\n            kendo.parseFloat(dataRow.price);\n          dataRow.set(\"amount\", amt);\n        } else if (e.field === \"uom\") {\n          if (dataRow.uom) {\n            dataRow.set(\"uom_uuid\", dataRow.uom.id);\n          }\n        }\n\n        this.expenseAutoCalculate();\n      }\n      // window.console.log(e)\n    },\n    expenseAutoCalculate() {\n      let ds = this.$refs.expenseAccountDS.kendoWidget(),\n        convertedAmount = 0,\n        amount = 0;\n      ds.data().forEach((value) => {\n        if (value.amount) {\n          amount += kendo.parseFloat(value.amount);\n          convertedAmount +=\n            kendo.parseFloat(value.amount) * this.transaction.txnRate;\n        }\n      });\n      this.expenseAccount.exchangeAmount = convertedAmount;\n      this.expenseAccount.amount = amount;\n    },\n    addExtraRow(uid) {\n      let ds = this.$refs.expenseAccountDS.kendoWidget(),\n        total = ds.total(),\n        row = ds.getByUid(uid),\n        index = ds.indexOf(row);\n\n      if (index == total - 1) {\n        this.expenseAddRow();\n      }\n    },\n    expenseRemoveRow(e) {\n      e.preventDefault();\n      const grid = $(\"#expenseGrid\").data(\"kendoGrid\"),\n        dataSource = grid.dataSource,\n        dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n      if (dataSource.total() > 1) {\n        dataSource.remove(dataItem);\n      }\n    },\n    expenseRowNumTmpl(dataItem) {\n      let ds = this.$refs.expenseAccountDS.kendoWidget(),\n        index = ds.indexOf(dataItem);\n\n      return index + 1;\n    },\n    expenseAccountEditor(container, options) {\n      return Helper.accountEditor(container, options, this.expenseAccounts);\n    },\n    //save block\n    clear() {\n      window.console.log(\"clear\");\n      this.id = undefined;\n      this.transaction = new transactionModel({});\n      this.itemLines = [];\n      this.generateNumber();\n    },\n    saveClose() {\n      this.isSaveClose = true;\n      this.saveOption = \"saveClose\";\n      this.save();\n    },\n    savePrint() {\n      this.isSavePrint = true;\n      this.saveOption = \"savePrint\";\n      this.save();\n    },\n    saveNew() {\n      this.saveOption = \"saveNew\";\n      this.isSaveNew = true;\n      this.save();\n    },\n    saveDraft() {\n      this.saveOption = \"saveDraft\";\n      this.isSaveDraft = true;\n      this.save();\n    },\n    async save() {\n      if (!this.$refs.form.validate()) {\n        this.$refs.form.validate();\n        return;\n      }\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.removeEmptyLine();\n          let itemLineDS = this.$refs.itemLineDS.kendoWidget(),\n            total = itemLineDS.total();\n          if (total <= 0) {\n            this.$snotify.error(\"Field Required!\");\n            return;\n          }\n          let data = {\n            id: this.transaction.id ? this.transaction.id : \"\",\n            type: \"Cash Refund\",\n            transactionType: this.transaction.transactionType,\n            number: this.transaction.number,\n            abbr: this.transaction.transactionType.abbr,\n            transactionDate: this.transaction.transactionDate,\n            customer: this.transaction.customer,\n            discountPromotion: {},\n            priceLevel: this.transaction.priceLevel,\n            itemLines: itemLineDS.data(),\n            segment: this.transaction.segment,\n            location: this.transaction.location,\n            project: this.transaction.project,\n            saleChannel: this.transaction.saleChannel,\n            transactionNote: this.transaction.transactionNote,\n            journalNote: this.transaction.journalNote,\n            subTotal: this.transaction.subTotal,\n            total: this.transaction.total,\n            discountTotal: this.transaction.discountTotal,\n            specificDiscountTotal: this.transaction.specificDiscountTotal,\n            totalTaxAmount: this.transaction.totalTaxAmount,\n            saveOption: this.saveOption,\n            txnRate: this.transaction.txnRate,\n            exchangeRate: this.transaction.exchangeRate,\n            exchangeAmount: this.transaction.exchangeAmount,\n            status: 1,\n            formTemplate: this.transaction.formTemplate,\n            specificDiscountItem: this.transaction.specificDiscountItem,\n            taxListTotal: this.taxListTotal,\n            customerDiscountItem: this.customerDiscountItem,\n            customerSaleUnit: this.customerSaleUnit,\n            loggedUser: this.loggedUser,\n            employee: this.transaction.employee,\n            usedDateAt: \"\",\n            deletedAt: \"\",\n            deleted: 0,\n            createdAt: new Date().toISOString().substr(0, 10),\n          };\n          this.showLoading = true;\n          window.console.log(data);\n          transactionHandler\n            .create(data)\n            .then((response) => {\n              this.showLoading = false;\n              if (response.data.statusCode === 201) {\n                if (this.isSaveNew == true) {\n                  this.setDefaultData();\n                } else {\n                  this.close(response.data.data);\n                }\n                this.$refs.form.reset();\n                this.$snotify.success(\"Successfully\");\n              }\n            })\n            .catch((e) => {\n              this.$snotify.error(\"Something went wrong\");\n              this.errors.push(e);\n              window.console.log(e);\n            });\n        }, 300);\n      });\n    },\n  },\n  watch: {\n    id() {\n      window.console.log(this.id, \"from watch\");\n      if (this.$route.params.id === undefined) {\n        window.history.go(-1);\n      } else {\n        this.loadView();\n      }\n    },\n    initTransaction() {\n      this.initialData();\n    },\n  },\n  created() {\n    this.loadTax();\n    this.loadSaleUnitItems();\n    this.loadAccount();\n    this.loadSegment();\n    this.loadLocation();\n  },\n  computed: {\n    dateFormatted() {\n      return kendo.toString(new Date(), institute.dateFormat);\n    },\n    dateTimeFormatted() {\n      window.console.log(institute.dateFormat + \" HH:mm\", \"inst date\");\n      return kendo.toString(new Date(), institute.dateFormat + \" HH:mm\");\n    },\n  },\n  mounted: async function() {\n    await this.initialData();\n    prefixHandler.get(\"sale order\").then((res) => {\n      if (res.data.statusCode === 200) {\n        this.showLoading = false;\n        this.transactionType = res.data.data;\n        if (this.transactionType.length > 0) {\n          if (\n            this.$route.params.id !== undefined ||\n            this.$route.params.id != \"\"\n          ) {\n            this.transaction.transactionType = this.transactionType[0];\n            if (!this.initTransaction && this.$route.params.id === undefined) {\n              this.generateNumber();\n            }\n          }\n        }\n      }\n    });\n    this.requestData(0, this.filter, this.cusBaseUrl);\n    await this.loadSaleFormContent();\n    await this.loadPriceLevel();\n    await this.loadDiscountItem(0);\n    await this.loadSaleChannel();\n    await this.loadCatalogs();\n    await this.loadEmployeeCenter();\n  },\n};\n</script>\n\n<style scoped>\n.function_wrapper {\n  box-shadow: none !important;\n}\n\n.v-application--is-ltr .v-text-field .v-input__append-inner {\n  margin-top: 0 !important;\n}\n\n.v-input__slot {\n  background-color: #fff !important;\n}\n\n.function_content .label {\n  margin-bottom: 10px;\n  display: inline-block;\n}\n\n.border_radius10 {\n  border-radius: 10px !important;\n  background-color: #f2f2f2;\n}\n\n.pa-3.v-card h4 {\n  font-size: 18px;\n  color: #333;\n}\n\n.pa-3.v-card p {\n  font-size: 12px;\n  color: #b5b5b5;\n}\n\n.attachment_file {\n  background-color: #efeded;\n  border-radius: 0 !important;\n}\n\n.attachment_table.v-data-table table {\n  border: thin solid rgba(0, 0, 0, 0.12);\n}\n\n.attachment_table table tr th {\n  border-left: thin solid rgba(0, 0, 0, 0.12);\n  height: 35px;\n  border-right: thin solid rgba(0, 0, 0, 0.12);\n}\n\n.block_debit,\n.block_credit {\n  border-bottom: 1px solid #fff;\n}\n\n.block_debit p.number,\n.block_credit p.number {\n  font-size: 25px;\n  color: #7f7f7f;\n}\n\n.block_debit h5,\n.block_credit h5,\n.block_difference h5 {\n  text-transform: uppercase;\n  color: #7f7f7f;\n  font-size: 15px;\n  font-weight: normal;\n}\n\n.block_difference h5 {\n  font-size: 18px;\n}\n\n.block_difference h5 span {\n  font-size: 15px;\n}\n\n.custom_grid table th:last-child {\n  text-align: right !important;\n}\n\n.color_green {\n  color: #03b154;\n}\n\n@media (min-width: 1264px) {\n  .container {\n    max-width: 1250px;\n  }\n}\n\n@media (max-width: 576px) {\n  .pt-6.col-sm-5.col-12 {\n    padding-top: 0 !important;\n  }\n\n  .code_text {\n    width: 100%;\n  }\n\n  .phone_no_pt {\n    padding-top: 0 !important;\n  }\n\n  .select_template,\n  .save_option {\n    margin-bottom: 10px;\n  }\n}\n\n.hide_small_bar_class {\n  max-width: 0;\n  transition: 0.5s ease-in;\n  flex: 0 0 0;\n}\n\n.hide_big_bar_class {\n  max-width: 100%;\n  transition: 0.5s ease-in;\n  flex: 0 0 100%;\n}\n\n.info_add {\n  background-color: #ffffff;\n}\n\n.small_sidebar {\n  height: 98%;\n  position: relative;\n  padding: 12px;\n  background-color: #edf1f5;\n}\n\n.iconArrow {\n  right: -35px;\n  position: absolute;\n  bottom: -10px;\n}\n.iconArrowHide {\n  position: absolute;\n  right: -7px;\n  bottom: -10px;\n}\n.color_grey {\n  color: #808080;\n}\n.card_green {\n  min-height: 70px;\n  background-color: #00b050 !important;\n  color: #ffffff;\n}\n.lb_bold {\n  font-size: 12px;\n}\n.detial_smallside_p {\n  position: absolute;\n  bottom: 10px;\n}\n.card_background {\n  background-color: #edf1f5;\n  min-height: 120px;\n}\n.deposite_input {\n  width: 100px;\n}\n.btn_save_draft {\n  color: #ffffff;\n  background-color: #00b0f0 !important;\n  text-transform: capitalize;\n}\n.save_option {\n  background-color: #203864 !important;\n}\n.btn_add_small {\n  height: 27px !important;\n  min-width: 25px !important;\n  font-size: 10px;\n  padding: 0 22px !important;\n  background-color: #00b050 !important;\n  color: #ffffff;\n  border-radius: 0 !important;\n}\n.list_site_inv {\n  background-color: #92d050;\n  color: #ffffff;\n  font-size: 12px;\n}\n.list_site_exp {\n  background-color: #c5e0b4;\n  color: #000000;\n  font-size: 12px;\n  line-height: 16px;\n  min-height: 40px;\n}\n.checkbox_inv {\n  padding: 2px;\n  margin-top: 3px;\n  margin-right: 2px;\n}\n.exp_select {\n  font-size: 12px !important;\n}\n</style>\n"]}]}