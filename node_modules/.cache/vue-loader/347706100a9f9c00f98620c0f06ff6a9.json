{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/products/production/bill_of_material/BillOfMaterial.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/products/production/bill_of_material/BillOfMaterial.vue","mtime":1638499443282},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGkxOG4gfSBmcm9tICJAL2kxOG4iOwppbXBvcnQgQm9tTW9kZWwgZnJvbSAiQC9zY3JpcHRzL21vZGVsL0JvbSI7CmltcG9ydCBrZW5kbyBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdWkiOwppbXBvcnQgU2FsZUZvcm1Db250ZW50TW9kZWwgZnJvbSAiQC9zY3JpcHRzL21vZGVsL1NhbGVGb3JtQ29udGVudCI7CmltcG9ydCBGaW5pc2hQcm9kdWN0TW9kZWwgZnJvbSAiQC9zY3JpcHRzL2JvbS9GaW5pc2hQcm9kdWN0IjsKaW1wb3J0IE90aGVyRmluaXNoUHJvZHVjdE1vZGVsIGZyb20gIkAvc2NyaXB0cy9ib20vT3RoZXJGaW5pc2hQcm9kdWN0IjsKaW1wb3J0IENvbXBvbmVudE1vZGVsIGZyb20gIkAvc2NyaXB0cy9ib20vQ29tcG9uZW50VXNlZCI7CmltcG9ydCB7IHV1aWQgfSBmcm9tICJ2dWUtdXVpZCI7Cgpjb25zdCBwcm9kdWN0VmFyaWFudEhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvcHJvZHVjdFZhcmlhbnRIYW5kbGVyIik7CmNvbnN0IHVvbVByaWNlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy91b21QcmljZUhhbmRsZXIiKTsKY29uc3Qgd2FyZWhvdXNlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy93YXJlaG91c2VIYW5kbGVyIik7CmNvbnN0IGJvbUhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvYm9tSGFuZGxlciIpOwpjb25zdCBwcmVmaXhIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3ByZWZpeEhhbmRsZXIiKTsKY29uc3QgYmlsbGluZ0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvaW52b2ljZS9oYW5kbGVyL2JpbGxpbmdIYW5kbGVyIik7CmNvbnN0IHNhbGVGb3JtQ29udGVudEhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvc2FsZUZvcm1Db250ZW50SGFuZGxlciIpOwpjb25zdCBzYWxlRm9ybUNvbnRlbnRNb2RlbCA9IG5ldyBTYWxlRm9ybUNvbnRlbnRNb2RlbCh7fSk7CmNvbnN0IGN1cnJlbmN5SGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9jdXJyZW5jeS9oYW5kbGVyL2N1cnJlbmN5SGFuZGxlciIpOwoKY29uc3QgYm9tTW9kZWwgPSBuZXcgQm9tTW9kZWwoe30pOwpjb25zdCAkID0gcmVxdWlyZSgianF1ZXJ5Iik7CmNvbnN0IGl0ZW1MaW5lUHJlZml4ID0gImxpbi0iOwpjb25zdCBjb29raWVKUyA9IHJlcXVpcmUoIkAvY29va2llLmpzIik7CmNvbnN0IGNvb2tpZSA9IGNvb2tpZUpTLmdldENvb2tpZSgpOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJCaWxsT2ZNYXRlcmlhbCIsCiAgcHJvcHM6IFsiaWQiXSwKICBjb21wb25lbnRzOiB7CiAgICBMb2FkaW5nTWU6ICgpID0+IGltcG9ydChgQC9jb21wb25lbnRzL0xvYWRpbmdgKSwKICAgIC8vICdhcHAtZGF0ZXBpY2tlcicgOiBEYXRlUGlja2VyQ29tcG9uZW50LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGRpc2FibGVkTWUoKSB7CiAgICAgIHJldHVybiAhIXRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgIH0sCiAgICAvLyB0b3RhbENvc3QoKSB7CiAgICAvLyAgIGlmICh0aGlzLmNvc3RGUCAhPT0gMCB8fCB0aGlzLmNvc3RPRlAgIT09IDApIHsKICAgIC8vICAgICByZXR1cm4gdGhpcy5jb3N0T0ZQICsgdGhpcy5jb3N0RlAKICAgIC8vICAgfSBlbHNlIHsKICAgIC8vICAgICByZXR1cm4gMAogICAgLy8gICB9CiAgICAvLyB9LAogICAgLy8gdmFyaWFuY2VBbW91bnQoKSB7CiAgICAvLyAgIGlmICh0aGlzLmNvc3RGUCAhPT0gMCB8fCB0aGlzLmNvc3RPRlAgIT09IDAgfHwgdGhpcy5jb3N0Q1UgIT09IDAgfHwgdGhpcy5jb3N0T0MgIT09IDApIHsKICAgIC8vICAgICByZXR1cm4gKHRoaXMuY29zdEZQICsgdGhpcy5jb3N0T0ZQKSAtICh0aGlzLmNvc3RDVSArIHRoaXMuY29zdE9DKQogICAgLy8gICB9IGVsc2UgewogICAgLy8gICAgIHJldHVybiAwCiAgICAvLyAgIH0KICAgIC8vIH0KICB9LAogIGRhdGE6ICgpID0+ICh7CiAgICBpc0VkaXQ6IGZhbHNlLAogICAgc2hvd0xvYWRpbmc6IGZhbHNlLAogICAgYWxlcnQ6IGZhbHNlLAogICAgLy8gRm9ybSB2YWxpZGF0aW9uCiAgICB2YWxpZDogdHJ1ZSwKICAgIGlzSGlkZUJhcjogZmFsc2UsCiAgICB3YXJlaG91c2VzOiBbXSwKICAgIGJvbTogYm9tTW9kZWwsCiAgICBib21ObzogIiIsCiAgICBib21UeXBlczogWwogICAgICB7IGlkOiAxLCBuYW1lOiAiT25lIFRpbWUgVXNlIiB9LAogICAgICB7IGlkOiAyLCBuYW1lOiAiTXVsdGlwbGUgVXNlIiB9LAogICAgXSwKICAgIGl0ZW1MaW5lc0ZQOiBuZXcgRmluaXNoUHJvZHVjdE1vZGVsKHt9KSwKICAgIGl0ZW1MaW5lc09QOiBuZXcgT3RoZXJGaW5pc2hQcm9kdWN0TW9kZWwoe30pLAogICAgaXRlbUxpbmVzQ1U6IG5ldyBDb21wb25lbnRNb2RlbCh7fSksCiAgICBpdGVtTGluZXNPQzogYm9tTW9kZWwub3RoZXJDb3N0LAogICAgZmluaXNoUHJvZHVjdEl0ZW1zOiBbXSwKICAgIG90aGVyRmluaXNoUHJvZHVjdEl0ZW1zOiBbXSwKICAgIGNvbXBvbmVudFVzZWRJdGVtczogW10sCiAgICBvdGhlckNvc3RzOiBbXSwKICAgIHRheDogW10sCiAgICB2YXRUYXg6IFtdLAogICAgYWNjb3VudHM6IFtdLAogICAgY29zdEZQOiAwLAogICAgY29zdE9GUDogMCwKICAgIGNvc3RDVTogMCwKICAgIGNvc3RPQzogMCwKICAgIGl0ZW1MaW5lT1A6IFtdLAogICAgaXRlbUxpbmVDVTogW10sCiAgICBpdGVtTGluZUZQOiBbXSwKICAgIGl0ZW1MaW5lT0M6IFtdLAogICAgc2FsZUZvcm1Db250ZW50OiBzYWxlRm9ybUNvbnRlbnRNb2RlbCwKICAgIGJhc2VDdXJyZW5jeToge30sCiAgICBleGNoYW5nZVJhdGU6IHt9LAogICAgbG9nZ2VkVXNlcjogewogICAgICBpZDogY29va2llLmNyZWF0b3IsCiAgICAgIG5hbWU6IGNvb2tpZS5lbWFpbCwKICAgIH0sCiAgICB0ZW1wbGF0ZXM6IFsKICAgICAgeyB0aXRsZTogIkRyYWZ0IiB9LAogICAgICB7IHRpdGxlOiAiT3BlbiIgfSwKICAgICAgeyB0aXRsZTogIlBhcnRpYWxseSBDbG9zZWQiIH0sCiAgICAgIHsgdGl0bGU6ICJDbG9zZWQiIH0sCiAgICBdLAogIH0pLAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGxvYWRWaWV3Qk9NKCkgewogICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgIGJvbUhhbmRsZXIuZ2V0QWxsKCI/aWQ9IiArIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuYm9tID0gcmVzWzBdOwogICAgICAgICAgICAgIC8vIHRoaXMuYXV0b0NhbGN1bGF0ZUdyaWQxKCkKICAgICAgICAgICAgICAvLyB0aGlzLmF1dG9DYWxjdWxhdGVHcmlkMigpCiAgICAgICAgICAgICAgLy8gdGhpcy5hdXRvQ2FsY3VsYXRlR3JpZDMoKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIHRoaXMuYm9tLmZpbmlzaFByb2R1Y3QgPSBbXQogICAgICAgICAgICAvLyB0aGlzLmJvbS5vdGhlckZpbmlzaFByb2R1Y3QgPSBbXQogICAgICAgICAgICAvLyB0aGlzLmJvbS5jb21wb25lbnRVc2VkID0gW10KICAgICAgICAgICAgdGhpcy5hZGRSb3dGaW5pc2hQcm9kdWN0KCk7CiAgICAgICAgICAgIHRoaXMuYWRkUm93T3RoZXJQcm9kdWN0KCk7CiAgICAgICAgICAgIHRoaXMuYWRkUm93Q29tcG9uZW50VXNlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgMTApOwogICAgICB9KTsKICAgIH0sCiAgICBudW1iZXJGb3JtYXQodmFsdWUpIHsKICAgICAgcmV0dXJuIGtlbmRvLnRvU3RyaW5nKHZhbHVlLCBgbiR7dGhpcy5zYWxlRm9ybUNvbnRlbnQuZGVjaW1hbH1gKTsKICAgIH0sCiAgICBudW1iZXJFZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IGRhdGEtYmluZD0idmFsdWU6JyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgIC5rZW5kb051bWVyaWNUZXh0Qm94KHsKICAgICAgICAgIGRlY2ltYWxzOiAzMCwKICAgICAgICAgIG1pbjogMCwKICAgICAgICAgIGZvcm1hdDogYCR7dGhpcy5zYWxlRm9ybUNvbnRlbnQuZGVjaW1hbH1gLAogICAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIGxvYWRTYWxlRm9ybUNvbnRlbnQoKSB7CiAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICByZXNvbHZlKCJyZXNvbHZlZCIpOwogICAgICAgICAgc2FsZUZvcm1Db250ZW50SGFuZGxlci5saXN0KCkudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNhbGVGb3JtQ29udGVudCA9IGRhdGFbMF07CiAgICAgICAgICAgICAgICB0aGlzLmJhc2VDdXJyZW5jeSA9IGRhdGFbMF0uYmFzZUN1cnJlbmN5OwogICAgICAgICAgICAgICAgdGhpcy5ib20uY3VycmVuY3kgPSB0aGlzLmJhc2VDdXJyZW5jeTsKICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFRyYW5zYWN0aW9uUmF0ZSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwgMTApOwogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBsb2FkVHJhbnNhY3Rpb25SYXRlKCkgewogICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKTsKICAgICAgICAgIGNvbnN0IGN1cnJlbmN5ID0gdGhpcy5iYXNlQ3VycmVuY3k7CiAgICAgICAgICBsZXQgY29kZSA9ICIiOwogICAgICAgICAgaWYgKGN1cnJlbmN5Lmhhc093blByb3BlcnR5KCJjb2RlIikpIHsKICAgICAgICAgICAgY29kZSA9IGN1cnJlbmN5LmNvZGU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoY29kZSAhPT0gdW5kZWZpbmVkIHx8IGNvZGUgIT09ICIiKSB7CiAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICBjdXJyZW5jeUhhbmRsZXIKICAgICAgICAgICAgICAuZ2V0TGFzdEV4Y2hhbmdlUmF0ZUJ5RGF0ZShkYXRlLCBjb2RlKQogICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICB0aGlzLmV4Y2hhbmdlUmF0ZSA9IHJlcy5kYXRhLmRhdGFbMF07CiAgICAgICAgICAgICAgICAgIHRoaXMuYm9tLnR4blJhdGUgPSB0aGlzLmV4Y2hhbmdlUmF0ZS5yYXRlOwogICAgICAgICAgICAgICAgICB0aGlzLmJvbS5leGNoYW5nZVJhdGUgPSB0aGlzLmV4Y2hhbmdlUmF0ZTsKICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0sIDEwKTsKICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgbG9hZFByZWZpeCgpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICBwcmVmaXhIYW5kbGVyLmdldCgiYmlsbCBvZiBtYXRlcmlhbCIpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb25UeXBlcyA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNhY3Rpb25UeXBlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmJvbS50cmFuc2FjdGlvblR5cGUgPSB0aGlzLnRyYW5zYWN0aW9uVHlwZXNbMF07CiAgICAgICAgICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmlkID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZU51bWJlcigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwgMTApOwogICAgICB9KTsKICAgIH0sCiAgICBnZW5lcmF0ZU51bWJlcigpIHsKICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgYWJicjogdGhpcy5ib20udHJhbnNhY3Rpb25UeXBlLmFiYnIsCiAgICAgICAgc3RydWN0dXJlOiB0aGlzLmJvbS50cmFuc2FjdGlvblR5cGUuc3RydWN0dXJlLAogICAgICAgIHRyYW5zYWN0aW9uRGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCksCiAgICAgICAgc2VxdWNlbmNpbmc6IHRoaXMuYm9tLnRyYW5zYWN0aW9uVHlwZS5zZXF1Y2VuY2luZywKICAgICAgICB0eXBlOiAiQmlsbCBPZiBNYXRlcmlhbCIsCiAgICAgICAgZW50aXR5OiAyLAogICAgICB9OwogICAgICB0aGlzLmJvbS5hYmJyID0gZGF0YS5hYmJyOwogICAgICB0aGlzLmJvbS5zdHJ1Y3R1cmUgPSBkYXRhLnN0cnVjdHVyZTsKICAgICAgdGhpcy5ib20uc2VxdWNlbmNpbmcgPSBkYXRhLnNlcXVjZW5jaW5nOwogICAgICB0aGlzLmJvbS50eXBlID0gZGF0YS50eXBlOwogICAgICB0aGlzLmJvbS50cmFuc2FjdGlvbkRhdGUgPSBkYXRhLnRyYW5zYWN0aW9uRGF0ZTsKICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgIGJpbGxpbmdIYW5kbGVyCiAgICAgICAgLmxhc3ROdW1iZXIoZGF0YSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgY29uc3QgbGFzdE51bWJlciA9IHRoaXMuemVyb1BhZCgKICAgICAgICAgICAgICBwYXJzZUludChyZXMubGFzdE51bWJlciksCiAgICAgICAgICAgICAgdGhpcy5ib20udHJhbnNhY3Rpb25UeXBlLmZvcm1hdAogICAgICAgICAgICApOwogICAgICAgICAgICB0aGlzLmJvbS5udW1iZXIgPQogICAgICAgICAgICAgIHJlcy5zdWZmaXggKwogICAgICAgICAgICAgIHRoaXMuYm9tLnRyYW5zYWN0aW9uVHlwZS5udW1iZXJTZXBhcmF0b3IgKwogICAgICAgICAgICAgIGxhc3ROdW1iZXI7CiAgICAgICAgICAgIHRoaXMuYm9tLmxhc3ROdW1iZXIgPSByZXMuc3VmZml4ICsgbGFzdE51bWJlcjsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZSkgPT4gewogICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChlKTsKICAgICAgICB9KTsKICAgIH0sCiAgICB6ZXJvUGFkKG51bSwgcGxhY2VzKSB7CiAgICAgIHJldHVybiBTdHJpbmcobnVtKS5wYWRTdGFydChwbGFjZXMsICIwIik7CiAgICB9LAogICAgc3VmZml4KHRyYW5zYWN0aW9uRGF0ZSkgewogICAgICByZXR1cm4ga2VuZG8udG9TdHJpbmcobmV3IERhdGUodHJhbnNhY3Rpb25EYXRlKSwgYHl5bW1gKTsKICAgIH0sCiAgICBhc3luYyBsb2FkV2FyZWhvdXNlcygpIHsKICAgICAgd2FyZWhvdXNlSGFuZGxlci5nZXRXYXJlaG91c2VTZXR0aW5nQWxsKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy53YXJlaG91c2VzID0gcmVzOwogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBnZXREYXRhU291cmNlKCkgewogICAgICBsZXQgZHNGUCA9IHRoaXMuJHJlZnMuZmluaXNoUHJvZHVjdERTLmtlbmRvV2lkZ2V0KCk7CiAgICAgIGxldCBkYXRhUm93RlAgPSBkc0ZQLmRhdGEoKTsKICAgICAgdGhpcy5pdGVtTGluZUZQID0gW107CiAgICAgIGRhdGFSb3dGUC5mb3JFYWNoKChpKSA9PiB7CiAgICAgICAgdGhpcy5pdGVtTGluZUZQLnB1c2goewogICAgICAgICAgaWQ6IGkuaWQsCiAgICAgICAgICBpdGVtOiBpLml0ZW0sCiAgICAgICAgICBkZXNjcmlwdGlvbjogaS5kZXNjcmlwdGlvbiwKICAgICAgICAgIGJ1b206IGkuYnVvbSwKICAgICAgICAgIHVvbTogaS51b20sCiAgICAgICAgICB5aWVsZFF0eTogaS55aWVsZFF0eSwKICAgICAgICAgIGNvc3Q6IGkuY29zdCwKICAgICAgICAgIGFtb3VudDogaS5hbW91bnQsCiAgICAgICAgICBza3U6IGkuc2t1LAogICAgICAgICAgZGVjaW1hbEZvcm1hdDogaS5kZWNpbWFsRm9ybWF0IHx8ICJuMiIsCiAgICAgICAgICBpbnZlbnRvcnlBY2NvdW50OiBpLmludmVudG9yeUFjY291bnQsCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBsZXQgZHNPUCA9IHRoaXMuJHJlZnMub3RoZXJQcm9kdWN0RFMua2VuZG9XaWRnZXQoKSwKICAgICAgICBkYXRhUm93T1AgPSBkc09QLmRhdGEoKTsKICAgICAgdGhpcy5pdGVtTGluZU9QID0gW107CiAgICAgIGRhdGFSb3dPUC5mb3JFYWNoKChpKSA9PiB7CiAgICAgICAgdGhpcy5pdGVtTGluZU9QLnB1c2goewogICAgICAgICAgaWQ6IGkuaWQsCiAgICAgICAgICBpdGVtOiBpLml0ZW0sCiAgICAgICAgICBkZXNjcmlwdGlvbjogaS5kZXNjcmlwdGlvbiwKICAgICAgICAgIGJ1b206IGkuYnVvbSwKICAgICAgICAgIHVvbTogaS51b20sCiAgICAgICAgICB5aWVsZFF0eTogaS55aWVsZFF0eSwKICAgICAgICAgIGNvc3Q6IGkuY29zdCwKICAgICAgICAgIGFtb3VudDogaS5hbW91bnQsCiAgICAgICAgICBza3U6IGkuc2t1LAogICAgICAgICAgZGVjaW1hbEZvcm1hdDogaS5kZWNpbWFsRm9ybWF0IHx8ICJuMiIsCiAgICAgICAgICBpbnZlbnRvcnlBY2NvdW50OiBpLmludmVudG9yeUFjY291bnQsCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBsZXQgZHNDVSA9IHRoaXMuJHJlZnMuY29tcG9uZW50VXNlRFMua2VuZG9XaWRnZXQoKSwKICAgICAgICBkYXRhUm93Q1UgPSBkc0NVLmRhdGEoKTsKICAgICAgdGhpcy5pdGVtTGluZUNVID0gW107CiAgICAgIGRhdGFSb3dDVS5mb3JFYWNoKChpKSA9PiB7CiAgICAgICAgdGhpcy5pdGVtTGluZUNVLnB1c2goewogICAgICAgICAgaWQ6IGkuaWQsCiAgICAgICAgICBpdGVtOiBpLml0ZW0sCiAgICAgICAgICBkZXNjcmlwdGlvbjogaS5kZXNjcmlwdGlvbiwKICAgICAgICAgIGJ1b206IGkuYnVvbSwKICAgICAgICAgIHVvbTogaS51b20sCiAgICAgICAgICBxdHk6IGkucXR5LAogICAgICAgICAgY29zdDogaS5jb3N0LAogICAgICAgICAgYW1vdW50OiBpLmFtb3VudCwKICAgICAgICAgIHNrdTogaS5za3UsCiAgICAgICAgICBkZWNpbWFsRm9ybWF0OiBpLmRlY2ltYWxGb3JtYXQgfHwgIm4yIiwKICAgICAgICAgIGludmVudG9yeUFjY291bnQ6IGkuaW52ZW50b3J5QWNjb3VudCwKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIC8vIGxldCBkc09DID0gdGhpcy4kcmVmcy5vdGhlckNvc3REUy5rZW5kb1dpZGdldCgpLAogICAgICAvLyAgICAgZGF0YVJvd09DID0gZHNPQy5kYXRhKCkKICAgICAgdGhpcy5pdGVtTGluZU9DID0gW107CiAgICAgIC8vIGRhdGFSb3dPQy5mb3JFYWNoKGkgPT4gewogICAgICAvLyAgIHRoaXMuaXRlbUxpbmVPQy5wdXNoKHsKICAgICAgLy8gICAgIGlkOiBpLmlkLAogICAgICAvLyAgICAgYWNjb3VudDogaS5hY2NvdW50LAogICAgICAvLyAgICAgZGVzY3JpcHRpb246IGkuZGVzY3JpcHRpb24sCiAgICAgIC8vICAgICBhbW91bnQ6IGkuYW1vdW50LAogICAgICAvLyAgICAgdGF4OiBpLnRheCwKICAgICAgLy8gICB9KQogICAgICAvLyB9KQogICAgfSwKICAgIHNhdmVQcmludCgpIHt9LAogICAgYXN5bmMgc2F2ZU5ldygpIHt9LAogICAgYXN5bmMgc2F2ZUNsb3NlKCkgewogICAgICBpZiAodGhpcy5ib20udmFyaWFuY2UgIT09IDApIHsKICAgICAgICB0aGlzLiRzbm90aWZ5LmVycm9yKCJQbGVhc2UgY2hlY2sgeW91ciB2YXJpYW5jZSBhbW91bnQiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYXdhaXQgdGhpcy5nZXREYXRhU291cmNlKCk7CiAgICAgIHRoaXMuYm9tLmZpbmlzaFByb2R1Y3QgPSB0aGlzLml0ZW1MaW5lRlA7CiAgICAgIHRoaXMuYm9tLml0ZW1JZCA9IHRoaXMuaXRlbUxpbmVGUFswXS5pdGVtCiAgICAgICAgPyB0aGlzLml0ZW1MaW5lRlBbMF0uaXRlbS5pZAogICAgICAgIDogIiI7CiAgICAgIC8vIHRoaXMuYm9tLm90aGVyRmluaXNoUHJvZHVjdCA9IHRoaXMuaXRlbUxpbmVPUAogICAgICAvLyB0aGlzLmJvbS5jb21wb25lbnRVc2VkID0gdGhpcy5pdGVtTGluZUNVCiAgICAgIC8vIHRoaXMuYm9tLm90aGVyQ29zdCA9IHRoaXMuaXRlbUxpbmVPQwogICAgICAvLyB0aGlzLmJvbS5hbW91bnQgPSB0aGlzLnRvdGFsQ29zdAogICAgICAvLyB0aGlzLmJvbS5leGNoYW5nZUFtb3VudCA9IHRoaXMudG90YWxDb3N0CiAgICAgIC8vIHRoaXMuYm9tLnZhcmlhbmNlID0gdGhpcy52YXJpYW5jZUFtb3VudAogICAgICB0aGlzLmJvbS5zdGF0dXMgPSAxOwogICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgYXdhaXQgYm9tSGFuZGxlci5zYXZlKHRoaXMuYm9tKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogIlByb2R1Y3RzIiwKICAgICAgICAgIHBhdGg6ICJwcm9kdWN0IiwKICAgICAgICAgIHBhcmFtczogeyBkYXRhQm9tOiByZXMgfSwKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgcmVtb3ZlUm93KCkge30sCiAgICBlcnJvck1lc3NhZ2UoKSB7fSwKICAgIGFzeW5jIGRhdGFTb3VyY2VDaGFuZ2VkKGUpIHsKICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICBsZXQgZGF0YVJvdyA9IGUuaXRlbXNbMF0sCiAgICAgICAgICBidW9tID0ge307CiAgICAgICAgc3dpdGNoIChlLmZpZWxkKSB7CiAgICAgICAgICBjYXNlICJpdGVtIjoKICAgICAgICAgICAgLy8gdGhpcy5hdHRyaWJ1dGVfID0gdGhpcy5hdHRyaWJ1dGVzLmZpbHRlcihtID0+IG0udHlwZS5pZCA9PT0gZGF0YVJvdy52YXJpYW50LmlkKQogICAgICAgICAgICBkYXRhUm93LnNldCgiZGVzY3JpcHRpb24iLCBkYXRhUm93Lml0ZW0uZGVzY3JpcHRpb24pOwogICAgICAgICAgICBkYXRhUm93LnNldCgieWllbGRRdHkiLCAxKTsKICAgICAgICAgICAgYnVvbSA9IGRhdGFSb3cuaXRlbS51b207CiAgICAgICAgICAgIGRhdGFSb3cuc2V0KCJidW9tIiwgYnVvbSk7CiAgICAgICAgICAgIGF3YWl0IHRoaXMuaW52ZW50b3J5QmFsYW5jZUJ5SXRlbShkYXRhUm93LCBkYXRhUm93Lml0ZW0uaWQsIDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIC8vIGNhc2UgInVvbSI6CiAgICAgICAgICAvLyAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhUm93LnVvbSwncm93LXVvbScpCiAgICAgICAgICAvLyAgIGRhdGFSb3cuc2V0KCdjb3N0JywgcGFyc2VGbG9hdChkYXRhUm93LnVvbS5wcmljZSkpCiAgICAgICAgICAvLyAgIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhUm93LnlpZWxkUXR5KQogICAgICAgICAgLy8gICBpZiAoZGF0YVJvdy55aWVsZFF0eSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAvLyAgICAgZGF0YVJvdy5zZXQoJ2Nvc3QnLCBwYXJzZUZsb2F0KGRhdGFSb3cudW9tLnByaWNlKSAqIHBhcnNlRmxvYXQoZGF0YVJvdy55aWVsZFF0eSkpCiAgICAgICAgICAvLyAgICAgdGhpcy5jb3N0RlAgPSBkYXRhUm93LmNvc3QKICAgICAgICAgIC8vICAgfQogICAgICAgICAgLy8gICBicmVhawogICAgICAgICAgY2FzZSAiY29zdCI6CiAgICAgICAgICAgIGRhdGFSb3cuc2V0KAogICAgICAgICAgICAgICJhbW91bnQiLAogICAgICAgICAgICAgIHBhcnNlRmxvYXQoZGF0YVJvdy5jb3N0KSAqIHBhcnNlRmxvYXQoZGF0YVJvdy55aWVsZFF0eSkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgdGhpcy5jb3N0RlAgPSBkYXRhUm93LmFtb3VudDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICAgIHRoaXMuYXV0b0NhbGN1bGF0ZUdyaWQxKCk7CiAgICAgICAgICB0aGlzLmF1dG9DYWxjdWxhdGVHcmlkMigpOwogICAgICAgICAgdGhpcy5hdXRvQ2FsY3VsYXRlR3JpZDMoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBkYXRhU291cmNlQ2hhbmdlZE9QKGUpIHsKICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICBsZXQgZGF0YVJvdyA9IGUuaXRlbXNbMF0sCiAgICAgICAgICBidW9tID0ge307CiAgICAgICAgc3dpdGNoIChlLmZpZWxkKSB7CiAgICAgICAgICBjYXNlICJpdGVtIjoKICAgICAgICAgICAgZGF0YVJvdy5zZXQoImRlc2NyaXB0aW9uIiwgZGF0YVJvdy5pdGVtLmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgZGF0YVJvdy5zZXQoInlpZWxkUXR5IiwgMSk7CiAgICAgICAgICAgIGJ1b20gPSBkYXRhUm93Lml0ZW0udW9tOwogICAgICAgICAgICBkYXRhUm93LnNldCgiYnVvbSIsIGJ1b20pOwogICAgICAgICAgICBhd2FpdCB0aGlzLmludmVudG9yeUJhbGFuY2VCeUl0ZW0oZGF0YVJvdywgZGF0YVJvdy5pdGVtLmlkLCAxKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJ5aWVsZFF0eSI6CiAgICAgICAgICAgIGRhdGFSb3cuc2V0KAogICAgICAgICAgICAgICJhbW91bnQiLAogICAgICAgICAgICAgIHBhcnNlRmxvYXQoZGF0YVJvdy5jb3N0KSAqIHBhcnNlRmxvYXQoZGF0YVJvdy55aWVsZFF0eSkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgLy8gdGhpcy5jb3N0T0ZQID0gZGF0YVJvdy5hbW91bnQKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJjb3N0IjoKICAgICAgICAgICAgZGF0YVJvdy5zZXQoCiAgICAgICAgICAgICAgImFtb3VudCIsCiAgICAgICAgICAgICAgcGFyc2VGbG9hdChkYXRhUm93LmNvc3QpICogcGFyc2VGbG9hdChkYXRhUm93LnlpZWxkUXR5KQogICAgICAgICAgICApOwogICAgICAgICAgICAvLyB0aGlzLmNvc3RPRlAgPSBkYXRhUm93LmFtb3VudAogICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coZGF0YVJvdy5jb3N0KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICAgIHRoaXMuYXV0b0NhbGN1bGF0ZUdyaWQxKCk7CiAgICAgICAgICB0aGlzLmF1dG9DYWxjdWxhdGVHcmlkMigpOwogICAgICAgICAgdGhpcy5hdXRvQ2FsY3VsYXRlR3JpZDMoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlR3JpZDEoKSB7CiAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuZmluaXNoUHJvZHVjdERTLmtlbmRvV2lkZ2V0KCk7CiAgICAgIGNvbnN0IHJvdyA9IGRzLmRhdGEoKTsKICAgICAgbGV0IGFtb3VudCA9IDA7CiAgICAgIHJvdy5mb3JFYWNoKChuKSA9PiB7CiAgICAgICAgYW1vdW50ICs9IG4uYW1vdW50IHx8IDA7CiAgICAgIH0pOwogICAgICB0aGlzLmNvc3RGUCA9IGFtb3VudDsKICAgICAgdGhpcy5ib20uYW1vdW50ID0gdGhpcy5jb3N0T0ZQICsgdGhpcy5jb3N0RlA7CiAgICAgIHRoaXMuYm9tLmV4Y2hhbmdlQW1vdW50ID0gdGhpcy5jb3N0T0ZQICsgdGhpcy5jb3N0RlA7CiAgICAgIHRoaXMuYm9tLnZhcmlhbmNlID0KICAgICAgICB0aGlzLmNvc3RGUCArIHRoaXMuY29zdE9GUCAtICh0aGlzLmNvc3RDVSArIHRoaXMuY29zdE9DKTsKICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlR3JpZDIoKSB7CiAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMub3RoZXJQcm9kdWN0RFMua2VuZG9XaWRnZXQoKTsKICAgICAgY29uc3Qgcm93ID0gZHMuZGF0YSgpOwogICAgICBsZXQgYW1vdW50ID0gMDsKICAgICAgcm93LmZvckVhY2goKG4pID0+IHsKICAgICAgICBhbW91bnQgKz0gbi5hbW91bnQgfHwgMDsKICAgICAgfSk7CiAgICAgIHRoaXMuY29zdE9GUCA9IGFtb3VudDsKICAgICAgdGhpcy5ib20uYW1vdW50ID0gdGhpcy5jb3N0T0ZQICsgdGhpcy5jb3N0RlA7CiAgICAgIHRoaXMuYm9tLmV4Y2hhbmdlQW1vdW50ID0gdGhpcy5jb3N0T0ZQICsgdGhpcy5jb3N0RlA7CiAgICAgIHRoaXMuYm9tLnZhcmlhbmNlID0KICAgICAgICB0aGlzLmNvc3RGUCArIHRoaXMuY29zdE9GUCAtICh0aGlzLmNvc3RDVSArIHRoaXMuY29zdE9DKTsKICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlR3JpZDMoKSB7CiAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuY29tcG9uZW50VXNlRFMua2VuZG9XaWRnZXQoKTsKICAgICAgY29uc3Qgcm93ID0gZHMuZGF0YSgpOwogICAgICBsZXQgYW1vdW50ID0gMDsKICAgICAgcm93LmZvckVhY2goKG4pID0+IHsKICAgICAgICBhbW91bnQgKz0gbi5hbW91bnQgfHwgMDsKICAgICAgfSk7CiAgICAgIHRoaXMuY29zdENVID0gYW1vdW50OwogICAgICB0aGlzLmJvbS5hbW91bnQgPSB0aGlzLmNvc3RPRlAgKyB0aGlzLmNvc3RGUDsKICAgICAgdGhpcy5ib20uZXhjaGFuZ2VBbW91bnQgPSB0aGlzLmNvc3RPRlAgKyB0aGlzLmNvc3RGUDsKICAgICAgdGhpcy5ib20udmFyaWFuY2UgPQogICAgICAgIHRoaXMuY29zdEZQICsgdGhpcy5jb3N0T0ZQIC0gKHRoaXMuY29zdENVICsgdGhpcy5jb3N0T0MpOwogICAgICB3aW5kb3cuY29uc29sZS5sb2coCiAgICAgICAgInRoaXMuYm9tLmV4Y2hhbmdlQW1vdW50IiwKICAgICAgICB0aGlzLmJvbS5leGNoYW5nZUFtb3VudCwKICAgICAgICAidmFyaWFuY2UiLAogICAgICAgIHRoaXMuYm9tLnZhcmlhbmNlCiAgICAgICk7CiAgICB9LAogICAgYXN5bmMgZGF0YVNvdXJjZUNoYW5nZWRPQyhlKSB7CiAgICAgIGlmIChlLmZpZWxkKSB7CiAgICAgICAgbGV0IGRhdGFSb3cgPSBlLml0ZW1zWzBdOwogICAgICAgIHN3aXRjaCAoZS5maWVsZCkgewogICAgICAgICAgY2FzZSAiYWNjb3VudCI6CiAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhUm93LmFjY291bnQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgInRheCI6CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiYW1vdW50IjoKICAgICAgICAgICAgdGhpcy5jb3N0T0MgPSBkYXRhUm93LmFtb3VudDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBkYXRhU291cmNlQ2hhbmdlZENVKGUpIHsKICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICBsZXQgZGF0YVJvdyA9IGUuaXRlbXNbMF0sCiAgICAgICAgICBidW9tID0ge307CiAgICAgICAgc3dpdGNoIChlLmZpZWxkKSB7CiAgICAgICAgICBjYXNlICJpdGVtIjoKICAgICAgICAgICAgZGF0YVJvdy5zZXQoImRlc2NyaXB0aW9uIiwgZGF0YVJvdy5pdGVtLmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgZGF0YVJvdy5zZXQoInF0eSIsIDEpOwogICAgICAgICAgICBidW9tID0gZGF0YVJvdy5pdGVtLnVvbTsKICAgICAgICAgICAgZGF0YVJvdy5zZXQoImJ1b20iLCBidW9tKTsKICAgICAgICAgICAgYXdhaXQgdGhpcy5pbnZlbnRvcnlCYWxhbmNlQnlJdGVtKGRhdGFSb3csIGRhdGFSb3cuaXRlbS5pZCwgMik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgLy8gY2FzZSAidW9tIjoKICAgICAgICAgIC8vICAgLy8gd2luZG93LmNvbnNvbGUubG9nKGRhdGFSb3cudW9tLCdyb3ctdW9tJykKICAgICAgICAgIC8vICAgZGF0YVJvdy5zZXQoJ2Nvc3QnLCBwYXJzZUZsb2F0KGRhdGFSb3cudW9tLnByaWNlKSkKICAgICAgICAgIC8vICAgd2luZG93LmNvbnNvbGUubG9nKGRhdGFSb3cucXR5KQogICAgICAgICAgLy8gICBpZiAoZGF0YVJvdy5xdHkgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgLy8gICAgIGRhdGFSb3cuc2V0KCdjb3N0JywgcGFyc2VGbG9hdChkYXRhUm93LnVvbS5wcmljZSkgKiBwYXJzZUZsb2F0KGRhdGFSb3cucXR5KSkKICAgICAgICAgIC8vICAgICB0aGlzLmNvc3RDVSA9IGRhdGFSb3cuY29zdAogICAgICAgICAgLy8gICB9CiAgICAgICAgICAvLyAgIGJyZWFrCiAgICAgICAgICBjYXNlICJxdHkiOgogICAgICAgICAgICAvLyBkYXRhUm93LnNldCgncHJpY2UnLCBwYXJzZUZsb2F0KGRhdGFSb3cudW9tLnByaWNlKSkKICAgICAgICAgICAgLy8gZGF0YVJvdy5zZXQoJ2Nvc3QnLCBwYXJzZUZsb2F0KGRhdGFSb3cudW9tLnByaWNlKSAqIHBhcnNlRmxvYXQoZGF0YVJvdy5xdHkpKQogICAgICAgICAgICBkYXRhUm93LnNldCgKICAgICAgICAgICAgICAiYW1vdW50IiwKICAgICAgICAgICAgICBwYXJzZUZsb2F0KGRhdGFSb3cuY29zdCkgKiBwYXJzZUZsb2F0KGRhdGFSb3cucXR5KQogICAgICAgICAgICApOwogICAgICAgICAgICAvLyB0aGlzLmNvc3RDVSA9IGRhdGFSb3cuYW1vdW50CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiY29zdCI6CiAgICAgICAgICAgIGRhdGFSb3cuc2V0KAogICAgICAgICAgICAgICJhbW91bnQiLAogICAgICAgICAgICAgIHBhcnNlRmxvYXQoZGF0YVJvdy5jb3N0KSAqIHBhcnNlRmxvYXQoZGF0YVJvdy5xdHkpCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIC8vIHRoaXMuY29zdENVID0gZGF0YVJvdy5hbW91bnQKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICAgIHRoaXMuYXV0b0NhbGN1bGF0ZUdyaWQxKCk7CiAgICAgICAgICB0aGlzLmF1dG9DYWxjdWxhdGVHcmlkMigpOwogICAgICAgICAgdGhpcy5hdXRvQ2FsY3VsYXRlR3JpZDMoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICByb3dOdW1iZXJGUChkYXRhSXRlbSkgewogICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmZpbmlzaFByb2R1Y3REUy5rZW5kb1dpZGdldCgpLAogICAgICAgIGluZGV4ID0gZHMuaW5kZXhPZihkYXRhSXRlbSk7CiAgICAgIHJldHVybiBpbmRleCArIDE7CiAgICB9LAogICAgVU9NRHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvCiAgICAgICAgLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgZGF0YVRleHRGaWVsZDogInVvbS50b1VPTS5uYW1lIiwKICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAidW9tLnRvVU9NLmlkIiwKICAgICAgICAgIGNhc2NhZGVGcm9tOiAiaXRlbSIsCiAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9dW9tLnRvVU9NLm5hbWUjPC9zcGFuPiIsCiAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICBzZXJ2ZXJGaWx0ZXJpbmc6IHRydWUsCiAgICAgICAgICAgIHRyYW5zcG9ydDogewogICAgICAgICAgICAgIHJlYWQ6IHsKICAgICAgICAgICAgICAgIHVybDogdW9tUHJpY2VIYW5kbGVyLmdldFVybChvcHRpb25zLm1vZGVsLml0ZW0uaWQpLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgIGlkOiAiaWQiLAogICAgICAgICAgICAgICAgZmllbGRzOiB7CiAgICAgICAgICAgICAgICAgIGlkOiB7IHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgICAgICAgICAgIC8vIG5hbWU6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgIC8vIHNrdToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIC8vIGRhdGE6IHRoaXMudmFyaWFudHMKICAgICAgICAgIH0pLAogICAgICAgIH0pOwogICAgfSwKICAgIFVPTVRlbXBsYXRlKGRhdGFJdGVtKSB7CiAgICAgIGNvbnN0IHVvbSA9IGRhdGFJdGVtLmJ1b207CiAgICAgIGlmICh1b20pIHsKICAgICAgICByZXR1cm4gYDxzcGFuPiR7dW9tLm5hbWUgPyB1b20ubmFtZSA6IGBgfTwvc3Bhbj5gOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBgYDsKICAgICAgfQogICAgfSwKICAgIEl0ZW1Ecm9wRG93bkVkaXRvckZQKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kbwogICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICBmaWx0ZXI6ICJjb250YWlucyIsCiAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAibmFtZSIsCiAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgIGhlYWRlclRlbXBsYXRlOgogICAgICAgICAgICAnPGRpdiBjbGFzcz0iZHJvcGRvd24taGVhZGVyIGstd2lkZ2V0IGstaGVhZGVyIj4nICsKICAgICAgICAgICAgIjxzcGFuPkl0ZW1zIDwvc3Bhbj4iICsKICAgICAgICAgICAgIjxzcGFuPjwvc3Bhbj4iICsKICAgICAgICAgICAgIjwvZGl2PiIsCiAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgIHNlcnZlckZpbHRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgdHJhbnNwb3J0OiB7CiAgICAgICAgICAgICAgcmVhZDogewogICAgICAgICAgICAgICAgdXJsOiBwcm9kdWN0VmFyaWFudEhhbmRsZXIuaXRlbVZhcmlhbnRTZWFyY2hVUkwoKSwgLy8gdmFyaWFudCBvbmx5CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLAogICAgICAgICAgICB9LAogICAgICAgICAgICBzY2hlbWE6IHsKICAgICAgICAgICAgICBtb2RlbDogewogICAgICAgICAgICAgICAgaWQ6ICJpZCIsCiAgICAgICAgICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgaWQ6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgICAgbmFtZTogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgICBza3U6IHsgdHlwZTogInN0cmluZyIgfSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIC8vIGRhdGE6IHRoaXMudmFyaWFudHMKICAgICAgICAgIH0pLAogICAgICAgIH0pOwogICAgfSwKICAgIEl0ZW1Ecm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAga2VuZG8KICAgICAgICAualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgZmlsdGVyOiAiY29udGFpbnMiLAogICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgICBoZWFkZXJUZW1wbGF0ZToKICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImRyb3Bkb3duLWhlYWRlciBrLXdpZGdldCBrLWhlYWRlciI+JyArCiAgICAgICAgICAgICI8c3Bhbj5JdGVtcyA8L3NwYW4+IiArCiAgICAgICAgICAgICI8c3Bhbj48L3NwYW4+IiArCiAgICAgICAgICAgICI8L2Rpdj4iLAogICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICBzZXJ2ZXJGaWx0ZXJpbmc6IHRydWUsCiAgICAgICAgICAgIHRyYW5zcG9ydDogewogICAgICAgICAgICAgIHJlYWQ6IHsKICAgICAgICAgICAgICAgIHVybDogcHJvZHVjdFZhcmlhbnRIYW5kbGVyLml0ZW1TZWFyY2hVUkwoKSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNjaGVtYTogewogICAgICAgICAgICAgIG1vZGVsOiB7CiAgICAgICAgICAgICAgICBpZDogImlkIiwKICAgICAgICAgICAgICAgIGZpZWxkczogewogICAgICAgICAgICAgICAgICBpZDogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgICBuYW1lOiB7IHR5cGU6ICJzdHJpbmciIH0sCiAgICAgICAgICAgICAgICAgIHNrdTogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHRvdGFsOiBmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEuY291bnQ7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgLy8gZGF0YTogdGhpcy52YXJpYW50cwogICAgICAgICAgfSksCiAgICAgICAgfSk7CiAgICB9LAogICAgaXRlbVRlbXBsYXRlKGRhdGFJdGVtKSB7CiAgICAgIGNvbnN0IGl0ZW0gPSBkYXRhSXRlbS5pdGVtOwogICAgICBpZiAoaXRlbSkgewogICAgICAgIHJldHVybiBgPHNwYW4+JHtpdGVtLm5hbWUgPyBpdGVtLm5hbWUgOiBgYH08L3NwYW4+YDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYGA7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBpbnZlbnRvcnlCYWxhbmNlQnlJdGVtKGRhdGFSb3csIGl0ZW1JZCwgZmxhZyA9IDEpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zdWJzdHIoMCwgMTApOwogICAgICAgICAgbGV0IHN0ckZpbHRlciA9ICI/YXNPZj0iICsgc3RhcnREYXRlICsgIiZpZD0iICsgaXRlbUlkOwogICAgICAgICAgYmlsbGluZ0hhbmRsZXIuaW52ZW50b3J5QmFsYW5jZShzdHJGaWx0ZXIpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgY29uc3QgYmFsYW5jZSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgaWYgKGJhbGFuY2UubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoImNvc3QiLCBiYWxhbmNlWzBdLndhYyk7CiAgICAgICAgICAgICAgICBkYXRhUm93LnNldCgicW9oIiwgYmFsYW5jZVswXS5xb2gpOwogICAgICAgICAgICAgICAgaWYgKGZsYWcgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoCiAgICAgICAgICAgICAgICAgICAgImFtb3VudCIsCiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChiYWxhbmNlWzBdLndhYykgKiBwYXJzZUZsb2F0KGRhdGFSb3cueWllbGRRdHkpCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBkYXRhUm93LnNldCgKICAgICAgICAgICAgICAgICAgICAiYW1vdW50IiwKICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KGJhbGFuY2VbMF0ud2FjKSAqIHBhcnNlRmxvYXQoZGF0YVJvdy5xdHkpCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCJjb3N0IiwgMCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIH0pOwogICAgICAgIH0sIDEwKTsKICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgYWRkUm93RmluaXNoUHJvZHVjdCgpIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5maW5pc2hQcm9kdWN0RFMua2VuZG9XaWRnZXQoKSwKICAgICAgICB0b3RhbCA9IGRzLnRvdGFsKCk7CiAgICAgIHRoaXMuaXRlbUxpbmVzRlAuaWQgPSBpdGVtTGluZVByZWZpeCArIHV1aWQudjEoKTsKICAgICAgdGhpcy5pdGVtTGluZXNGUC5kZWNpbWFsRm9ybWF0ID0gIm4iICsgdGhpcy5zYWxlRm9ybUNvbnRlbnQuZGVjaW1hbDsKICAgICAgaWYgKHRvdGFsID09PSAwKSB7CiAgICAgICAgZHMuaW5zZXJ0KHRvdGFsLCB0aGlzLml0ZW1MaW5lc0ZQKTsKICAgICAgfQogICAgfSwKCiAgICBVT01Ecm9wRG93bkVkaXRvck9QKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kbwogICAgICAgIC5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICBmaWx0ZXI6ICJzdGFydHN3aXRoIiwKICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJ1b20udG9VT00ubmFtZSIsCiAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogInVvbS50b1VPTS5pZCIsCiAgICAgICAgICBjYXNjYWRlRnJvbTogIml0ZW0iLAogICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPXVvbS50b1VPTS5uYW1lIzwvc3Bhbj4iLAogICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgc2VydmVyRmlsdGVyaW5nOiB0cnVlLAogICAgICAgICAgICB0cmFuc3BvcnQ6IHsKICAgICAgICAgICAgICByZWFkOiB7CiAgICAgICAgICAgICAgICB1cmw6IHVvbVByaWNlSGFuZGxlci5nZXRVcmwob3B0aW9ucy5tb2RlbC5pdGVtLmlkKSwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNjaGVtYTogewogICAgICAgICAgICAgIG1vZGVsOiB7CiAgICAgICAgICAgICAgICBpZDogImlkIiwKICAgICAgICAgICAgICAgIGZpZWxkczogewogICAgICAgICAgICAgICAgICBpZDogeyB0eXBlOiAic3RyaW5nIiB9LAogICAgICAgICAgICAgICAgICAvLyBuYW1lOiB7dHlwZTogInN0cmluZyJ9LAogICAgICAgICAgICAgICAgICAvLyBza3U6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdG90YWw6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICAvLyBkYXRhOiB0aGlzLnZhcmlhbnRzCiAgICAgICAgICB9KSwKICAgICAgICB9KTsKICAgIH0sCiAgICBVT01UZW1wbGF0ZU9QKGRhdGFJdGVtKSB7CiAgICAgIGNvbnN0IHVvbSA9IGRhdGFJdGVtLnVvbTsKICAgICAgaWYgKHVvbSkgewogICAgICAgIHJldHVybiBgPHNwYW4+JHt1b20udW9tID8gdW9tLnVvbS50b1VPTS5uYW1lIDogYGB9PC9zcGFuPmA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGBgOwogICAgICB9CiAgICB9LAogICAgcm93TnVtYmVyT1AoZGF0YUl0ZW0pIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5vdGhlclByb2R1Y3REUy5rZW5kb1dpZGdldCgpLAogICAgICAgIGluZGV4ID0gZHMuaW5kZXhPZihkYXRhSXRlbSk7CiAgICAgIHJldHVybiBpbmRleCArIDE7CiAgICB9LAogICAgYWRkUm93T3RoZXJQcm9kdWN0KCkgewogICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLm90aGVyUHJvZHVjdERTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgdG90YWwgPSBkcy50b3RhbCgpOwogICAgICB0aGlzLml0ZW1MaW5lc09QLmlkID0gaXRlbUxpbmVQcmVmaXggKyB1dWlkLnYxKCk7CiAgICAgIHRoaXMuaXRlbUxpbmVzT1AuZGVjaW1hbEZvcm1hdCA9ICJuIiArIHRoaXMuc2FsZUZvcm1Db250ZW50LmRlY2ltYWw7CiAgICAgIGRzLmluc2VydCh0b3RhbCwgdGhpcy5pdGVtTGluZXNPUCk7CiAgICB9LAogICAgcmVtb3ZlUm93T1AoZSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGNvbnN0IGdyaWQgPSBrZW5kby5qUXVlcnkoIiNncmlkT3RoZXJQcm9kdWN0IikuZGF0YSgia2VuZG9HcmlkIiksCiAgICAgICAgZGF0YVNvdXJjZSA9IGdyaWQuZGF0YVNvdXJjZSwKICAgICAgICBkYXRhSXRlbSA9IGdyaWQuZGF0YUl0ZW0oJChlLmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoInRyIikpOwoKICAgICAgaWYgKGRhdGFTb3VyY2UudG90YWwoKSA+IDEpIHsKICAgICAgICBkYXRhU291cmNlLnJlbW92ZShkYXRhSXRlbSk7CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVSb3dDVShlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgY29uc3QgZ3JpZCA9IGtlbmRvLmpRdWVyeSgiI2dyaWRDb21wb25lbnRVc2UiKS5kYXRhKCJrZW5kb0dyaWQiKSwKICAgICAgICBkYXRhU291cmNlID0gZ3JpZC5kYXRhU291cmNlLAogICAgICAgIGRhdGFJdGVtID0gZ3JpZC5kYXRhSXRlbSgkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdCgidHIiKSk7CgogICAgICBpZiAoZGF0YVNvdXJjZS50b3RhbCgpID4gMSkgewogICAgICAgIGRhdGFTb3VyY2UucmVtb3ZlKGRhdGFJdGVtKTsKICAgICAgfQogICAgfSwKICAgIFVPTVRlbXBsYXRlQ1UoZGF0YUl0ZW0pIHsKICAgICAgY29uc3QgdW9tID0gZGF0YUl0ZW0udW9tOwogICAgICBpZiAodW9tKSB7CiAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke3VvbS51b20gPyB1b20udW9tLnRvVU9NLm5hbWUgOiBgYH08L3NwYW4+YDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYGA7CiAgICAgIH0KICAgIH0sCgogICAgcm93TnVtYmVyQ1UoZGF0YUl0ZW0pIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5jb21wb25lbnRVc2VEUy5rZW5kb1dpZGdldCgpLAogICAgICAgIGluZGV4ID0gZHMuaW5kZXhPZihkYXRhSXRlbSk7CiAgICAgIHJldHVybiBpbmRleCArIDE7CiAgICB9LAogICAgYWRkUm93Q29tcG9uZW50VXNlKCkgewogICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmNvbXBvbmVudFVzZURTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgdG90YWwgPSBkcy50b3RhbCgpOwogICAgICB0aGlzLml0ZW1MaW5lc0NVLmlkID0gaXRlbUxpbmVQcmVmaXggKyB1dWlkLnYxKCk7CiAgICAgIHRoaXMuaXRlbUxpbmVzQ1UuZGVjaW1hbEZvcm1hdCA9ICJuIiArIHRoaXMuc2FsZUZvcm1Db250ZW50LmRlY2ltYWw7CiAgICAgIGRzLmluc2VydCh0b3RhbCwgdGhpcy5pdGVtTGluZXNDVSk7CiAgICB9LAogICAgY2FuY2VsKCkgewogICAgICB0aGlzLiRzd2FsKHsKICAgICAgICB0aXRsZTogaTE4bi50KCJtc2dfdGl0bGVfd2FybmluZyIpLAogICAgICAgIHRleHQ6IGkxOG4udCgibXNnX2Rpc2NhcmQiKSwKICAgICAgICBpY29uOiAid2FybmluZyIsCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBpMThuLnQoImNhbmNlbCIpLAogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiM0ZDQ4NDgiLAogICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAiI0VEMUEzQSIsCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6IGkxOG4udCgiZGlzY2FyZCIpLAogICAgICB9KS50aGVuKChyZXN1bHRDZW4pID0+IHsKICAgICAgICBpZiAocmVzdWx0Q2VuLnZhbHVlKSB7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIGF3YWl0IHRoaXMubG9hZFNhbGVGb3JtQ29udGVudCgpOwogICAgYXdhaXQgdGhpcy5sb2FkUHJlZml4KCk7CiAgICBhd2FpdCB0aGlzLmxvYWRXYXJlaG91c2VzKCk7CiAgICBhd2FpdCB0aGlzLmxvYWRWaWV3Qk9NKCk7CiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgLy8gYXdhaXQgdGhpcy5sb2FkVGF4KCkKICAgIC8vIGF3YWl0IHRoaXMubG9hZEFjY291bnQoKQogIH0sCiAgYWN0aXZhdGVkKCkgewogICAgdGhpcy5ib20uZmluaXNoUHJvZHVjdCA9IFtdOwogICAgdGhpcy5ib20ub3RoZXJGaW5pc2hQcm9kdWN0ID0gW107CiAgICB0aGlzLmJvbS5jb21wb25lbnRVc2VkID0gW107CiAgICB0aGlzLmxvYWRWaWV3Qk9NKCk7CiAgfSwKICBkZWFjdGl2YXRlZCgpIHsKICAgIHRoaXMuYm9tLmZpbmlzaFByb2R1Y3QgPSBbXTsKICAgIHRoaXMuYm9tLm90aGVyRmluaXNoUHJvZHVjdCA9IFtdOwogICAgdGhpcy5ib20uY29tcG9uZW50VXNlZCA9IFtdOwogICAgLy8gdGhpcy5hZGRSb3dGaW5pc2hQcm9kdWN0KCkKICAgIC8vIHRoaXMuYWRkUm93T3RoZXJQcm9kdWN0KCkKICAgIC8vIHRoaXMuYWRkUm93Q29tcG9uZW50VXNlKCkKICB9LAogIHdhdGNoOiB7CiAgICAvLyAnJHJvdXRlcic6ICdsb2FkVmlld0JPTScKICB9LAp9Owo="},{"version":3,"sources":["BillOfMaterial.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BillOfMaterial.vue","sourceRoot":"src/views/products/production/bill_of_material","sourcesContent":["<template>\n  <v-app>\n    <v-container>\n      <v-row>\n        <v-col cols=\"12\" sm=\"12\">\n          <v-card\n            outlined\n            dense\n            class=\"pa-4 no_border rounded-sm\"\n            color=\"white\"\n          >\n            <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\n              <v-card outlined dense class=\"no_border\">\n                <h2 class=\"mb-0\">{{ $t(\"bill_of_material\") }}</h2>\n                <v-icon\n                  @click=\"cancel()\"\n                  style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                  class=\"float-right\"\n                  >close\n                </v-icon>\n              </v-card>\n\n              <v-card outlined dense class=\"px-3 no_border\" color=\"grayBg\">\n                <v-row>\n                  <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                    <label class=\"label  mb-0\">{{ $t(\"bom_no\") }}</label>\n                    <v-row class=\"mt-1 mr-0\">\n                      <v-col sm=\"3\" cols=\"3\" class=\"pt-0 pr-0\">\n                        <div class=\"code_text\">{{ bom.abbr }}</div>\n                      </v-col>\n                      <v-col sm=\"7\" cols=\"7\" class=\"pt-0 pl-0 pr-1\">\n                        <v-text-field\n                          class=\" custom-border \"\n                          v-model=\"bom.number\"\n                          disabled\n                          outlined\n                          tage=\"Bom No.\"\n                          :rules=\"[(v) => !!v || 'Number is required']\"\n                          required\n                        />\n                      </v-col>\n                      <v-col sm=\"2\" cols=\"2\" class=\"pt-0 px-0\">\n                        <v-icon\n                          color=\"black\"\n                          size=\"30\"\n                          class=\"border_qrcode\"\n                          :disabled=\"disabledMe\"\n                          @click=\"generateNumber\"\n                          >mdi-qrcode\n                        </v-icon>\n                      </v-col>\n                    </v-row>\n                  </v-col>\n                  <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                    <label class=\"label  mb-0 mt-1\" style=\"\">{{\n                      $t(\"bom_type\")\n                    }}</label>\n                    <v-select\n                      class=\"mt-1\"\n                      :items=\"bomTypes\"\n                      v-model=\"bom.typeBom\"\n                      item-text=\"name\"\n                      item-value=\"id\"\n                      return-object\n                      :placeholder=\"$t('type')\"\n                      tage=\"Bom Type\"\n                      outlined\n                    />\n                  </v-col>\n                  <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                    <label class=\"label  mb-0 mt-1\" style=\"\">{{\n                      $t(\"warehouse\")\n                    }}</label>\n                    <v-select\n                      class=\"mt-1\"\n                      :items=\"warehouses\"\n                      v-model=\"bom.warehouse\"\n                      return-object\n                      item-value=\"id\"\n                      item-text=\"name\"\n                      :placeholder=\"$t('warehouse')\"\n                      tage=\"Warehouse\"\n                      outlined\n                    />\n                  </v-col>\n                  <!--                                    <v-col sm=\"3\" cols=\"12\" class=\"my_radio\">-->\n                  <!--                                        <input v-model=\"bom.materialType\" id=\"radio1\" :selected-value=\"{id: 1, name: 'Build Assembly'}\" name=\"radio\" type=\"radio\">-->\n                  <!--                                        <label for=\"radio1\">{{ $t('build_assembly') }}</label>-->\n                  <!--                                        <input v-model=\"bom.materialType\" :selected-value=\"{id: 2, name: 'Production'}\" id=\"radio2\" name=\"radio\" type=\"radio\">-->\n                  <!--                                        <label for=\"radio2\">{{ $t('production') }}</label>-->\n                  <!--                                    </v-col>-->\n                </v-row>\n              </v-card>\n              <v-row>\n                <v-col sm=\"12\" cols=\"12\" class=\"pt-0\">\n                  <!-- Grid One -->\n                  <v-row style=\"background-color: #fff;\">\n                    <v-col cols=\"12\" class=\"py-1 pb-0\">\n                      <h2 class=\"primary--text mb-0 font_18 text-uppercase\">\n                        {{ $t(\"finished_product\") }}\n                      </h2>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"pt-1\">\n                      <kendo-datasource\n                        ref=\"finishProductDS\"\n                        :change=\"dataSourceChanged\"\n                        :data=\"bom.finishProduct\"\n                      />\n                      <kendo-grid\n                        id=\"gridFinishProduct\"\n                        class=\"grid-function\"\n                        :data-source-ref=\"'finishProductDS'\"\n                        :sortable=\"false\"\n                        :filterable=\"false\"\n                        :column-menu=\"true\"\n                        :editable=\"true\"\n                        :scrollable-virtual=\"true\"\n                      >\n                        <kendo-grid-column\n                          :template=\"rowNumberFP\"\n                          :title=\"$t('no.')\"\n                          :width=\"55\"\n                          :column-menu=\"false\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-variants',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: variants',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'item'\"\n                          :title=\"$t('items')\"\n                          :width=\"200\"\n                          :editable=\"\n                            () => {\n                              return true;\n                            }\n                          \"\n                          :template=\"itemTemplate\"\n                          :editor=\"ItemDropDownEditorFP\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'buom'\"\n                          :title=\"$t('base_uom')\"\n                          :width=\"150\"\n                          :template=\"UOMTemplate\"\n                          :editor=\"UOMDropDownEditor\"\n                          :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: right; ' }\"\n                        />\n                        <!-- <kendo-grid-column\n                          :field=\"'description'\"\n                          :title=\"$t('description')\"\n                          :width=\"200\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        /> -->\n\n                        <kendo-grid-column\n                          :field=\"'yieldQty'\"\n                          :title=\"$t('yield_qty')\"\n                          :attributes=\"{\n                            class: 'k-state-disabled',\n                            style: 'text-align: right',\n                          }\"\n                          :width=\"150\"\n                          :template=\"\n                            '<span>#=kendo.toString(yieldQty || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'cost'\"\n                          :title=\"$t('cost')\"\n                          :width=\"150\"\n                          :editor=\"numberEditor\"\n                          :template=\"\n                            '<span>#=kendo.toString(cost || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'amount'\"\n                          :title=\"$t('amount')\"\n                          :width=\"150\"\n                          :template=\"\n                            '<span>#=kendo.toString(amount || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                      </kendo-grid>\n                    </v-col>\n                  </v-row>\n                  <!-- Grid Two -->\n                  <v-row style=\"background-color: #fff;\">\n                    <v-col cols=\"12\" class=\"pt-0 pb-0\">\n                      <h2 class=\"primary--text mb-0 font_18 text-uppercase\">\n                        {{ $t(\"by_product\") }}\n                      </h2>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"pt-1\">\n                      <kendo-datasource\n                        ref=\"otherProductDS\"\n                        :change=\"dataSourceChangedOP\"\n                        :data=\"bom.otherFinishProduct\"\n                      />\n                      <kendo-grid\n                        id=\"gridOtherProduct\"\n                        class=\"grid-function\"\n                        :data-source-ref=\"'otherProductDS'\"\n                        :sortable=\"false\"\n                        :filterable=\"false\"\n                        :column-menu=\"true\"\n                        :editable=\"true\"\n                        :scrollable-virtual=\"true\"\n                      >\n                        <kendo-grid-column\n                          :template=\"rowNumberOP\"\n                          :title=\"$t('no.')\"\n                          :width=\"55\"\n                          :column-menu=\"false\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-variants',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: variants',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'item'\"\n                          :title=\"$t('item')\"\n                          :width=\"200\"\n                          :template=\"itemTemplate\"\n                          :editor=\"ItemDropDownEditorFP\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <!-- <kendo-grid-column\n                          :field=\"'description'\"\n                          :title=\"$t('description')\"\n                          :width=\"200\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        /> -->\n                        <kendo-grid-column\n                          :field=\"'buom'\"\n                          :title=\"$t('base_uom')\"\n                          :width=\"150\"\n                          :template=\"UOMTemplate\"\n                          :editor=\"UOMDropDownEditorOP\"\n                          :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{ style: 'text-align: right; ' }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'yieldQty'\"\n                          :title=\"$t('yield_qty')\"\n                          :width=\"150\"\n                          :template=\"\n                            '<span>#=kendo.toString(yieldQty || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'cost'\"\n                          :title=\"$t('cost')\"\n                          :width=\"150\"\n                          :template=\"\n                            '<span>#=kendo.toString(cost || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'amount'\"\n                          :title=\"$t('amount')\"\n                          :width=\"150\"\n                          :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                          :template=\"\n                            '<span>#=kendo.toString(amount || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :command=\"{\n                            iconClass: 'k-icon k-i-trash',\n                            text: 'Delete',\n                            click: removeRowOP,\n                            class: 'btn-plus',\n                          }\"\n                          :title=\"'&nbsp;'\"\n                          :width=\"100\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                        />\n                      </kendo-grid>\n                    </v-col>\n                    <v-col cols=\"12\" class=\"pt-0\">\n                      <v-btn\n                        color=\"primary\"\n                        class=\"float-left btn_plus rounded-4 white--text mr-2\"\n                        @click=\"addRowOtherProduct\"\n                      >\n                        <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                      </v-btn>\n                    </v-col>\n                  </v-row>\n                  <!-- Grid Three -->\n                  <v-row style=\"background-color: #fff;\">\n                    <v-col cols=\"12\" class=\"pt-0 pb-0\">\n                      <h2 class=\"primary--text mb-0 font_18 text-uppercase\">\n                        {{ $t(\"components_used\") }}\n                      </h2>\n                    </v-col>\n                    <v-col sm=\"12\" cols=\"12\" class=\"pt-1\">\n                      <kendo-datasource\n                        ref=\"componentUseDS\"\n                        :change=\"dataSourceChangedCU\"\n                        :data=\"bom.componentUsed\"\n                      />\n                      <kendo-grid\n                        id=\"gridComponentUse\"\n                        class=\"grid-function\"\n                        :data-source-ref=\"'componentUseDS'\"\n                        :sortable=\"false\"\n                        :filterable=\"false\"\n                        :column-menu=\"true\"\n                        :editable=\"true\"\n                        :scrollable-virtual=\"true\"\n                      >\n                        <kendo-grid-column\n                          :template=\"rowNumberCU\"\n                          :title=\"$t('no.')\"\n                          :width=\"55\"\n                          :column-menu=\"false\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5;',\n                            class: 'text-variants',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: variants',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'item'\"\n                          :title=\"$t('item')\"\n                          :width=\"200\"\n                          :template=\"itemTemplate\"\n                          :editor=\"ItemDropDownEditor\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <!-- <kendo-grid-column\n                          :field=\"'description'\"\n                          :title=\"$t('description')\"\n                          :width=\"200\"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        /> -->\n                        <kendo-grid-column\n                          :template=\"UOMTemplate\"\n                          :editor=\"UOMDropDownEditorOP\"\n                          :field=\"'buom'\"\n                          :title=\"$t('base_uom')\"\n                          :width=\"160\"\n                          :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                          :headerAttributes=\"{\n                            style: 'background-color: #EDF1F5',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'qty'\"\n                          :title=\"$t('qty')\"\n                          :width=\"150\"\n                          :editor=\"numberEditor\"\n                          :template=\"\n                            '<span>#=kendo.toString(qty || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'cost'\"\n                          :title=\"$t('cost')\"\n                          :width=\"150\"\n                          :editor=\"numberEditor\"\n                          :template=\"\n                            '<span>#=kendo.toString(cost || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :field=\"'amount'\"\n                          :title=\"$t('amount')\"\n                          :width=\"150\"\n                          :editable=\"\n                            () => {\n                              return false;\n                            }\n                          \"\n                          :template=\"\n                            '<span>#=kendo.toString(amount || 0, decimalFormat) || 0#</span>'\n                          \"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                          :attributes=\"{\n                            style: 'text-align: right',\n                          }\"\n                        />\n                        <kendo-grid-column\n                          :command=\"{\n                            iconClass: 'k-icon k-i-trash',\n                            text: 'Delete',\n                            click: removeRowCU,\n                            class: 'btn-plus',\n                          }\"\n                          :title=\"'&nbsp;'\"\n                          :width=\"100\"\n                          :headerAttributes=\"{\n                            style:\n                              'text-align: right; background-color: #EDF1F5',\n                          }\"\n                        />\n                      </kendo-grid>\n                    </v-col>\n                    <v-col cols=\"12\" class=\"pt-0\">\n                      <v-btn\n                        color=\"primary\"\n                        class=\"float-left btn_plus rounded-4 white--text mr-2\"\n                        @click=\"addRowComponentUse\"\n                      >\n                        <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                      </v-btn>\n                    </v-col>\n                  </v-row>\n                  <v-row style=\"background-color: #fff;\">\n                    <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                      <v-row>\n                        <v-col sm=\"6\" cols=\"6\" class=\"py-0\">\n                          <v-textarea\n                            class=\"mt-1\"\n                            outlined\n                            clearable\n                            rows=\"3\"\n                            no-resize\n                            v-model=\"bom.transactionNote\"\n                            height=\"90px\"\n                            tag=\"Memo\"\n                            placeholder=\"Memo\"\n                          />\n                        </v-col>\n                        <v-col sm=\"6\" cols=\"6\" class=\"py-0\">\n                          <v-simple-table>\n                            <template v-slot:default>\n                              <tbody>\n                                <tr>\n                                  <td class=\"text-left text-uppercase\">\n                                    {{ $t(\"total_cost\") }}\n                                  </td>\n                                  <td class=\"text-center\">:</td>\n                                  <td class=\"text-bold text-right\">\n                                    {{ numberFormat(bom.exchangeAmount) }}\n                                  </td>\n                                </tr>\n                                <tr>\n                                  <td class=\"text-left text-uppercase\">\n                                    {{ $t(\"variance\") }}\n                                  </td>\n                                  <td class=\"text-center\">:</td>\n                                  <td\n                                    v-bind:class=\"[\n                                      bom.variance >= 0 ? '' : 'redText',\n                                    ]\"\n                                    class=\"text-right text-bold\"\n                                  >\n                                    {{ numberFormat(bom.variance) }}\n                                  </td>\n                                </tr>\n                              </tbody>\n                            </template>\n                          </v-simple-table>\n                        </v-col>\n                      </v-row>\n                    </v-col>\n                  </v-row>\n                </v-col>\n              </v-row>\n              <v-divider />\n              <v-card outlined dense class=\"no_border function_footer\">\n                <v-alert type=\"warning\" v-model=\"alert\" dismissible>\n                  <span v-html=\"errorMessage\" />\n                </v-alert>\n                <v-menu>\n                  <v-list>\n                    <v-list-item\n                      v-for=\"(item, index) in templates\"\n                      :key=\"index\"\n                    >\n                      <v-list-item-title>{{ item.title }}</v-list-item-title>\n                    </v-list-item>\n                  </v-list>\n                </v-menu>\n                <v-btn\n                  color=\"black\"\n                  class=\"text-capitalize rounded-pill white--text float-left\"\n                  @click=\"cancel\"\n                >\n                  {{ $t(\"cancel\") }}\n                </v-btn>\n                <v-btn\n                  color=\"primary\"\n                  @click=\"saveClose()\"\n                  class=\"mr-2 float-right white--text text-capitalize rounded-pill\"\n                >\n                  {{ $t(\"save_close\") }}\n                </v-btn>\n              </v-card>\n            </v-form>\n          </v-card>\n        </v-col>\n      </v-row>\n      <LoadingMe\n        :isLoading=\"showLoading\"\n        :fullPage=\"false\"\n        type=\"loading\"\n        :myLoading=\"true\"\n      />\n    </v-container>\n  </v-app>\n</template>\n\n<script>\nimport { i18n } from \"@/i18n\";\nimport BomModel from \"@/scripts/model/Bom\";\nimport kendo from \"@progress/kendo-ui\";\nimport SaleFormContentModel from \"@/scripts/model/SaleFormContent\";\nimport FinishProductModel from \"@/scripts/bom/FinishProduct\";\nimport OtherFinishProductModel from \"@/scripts/bom/OtherFinishProduct\";\nimport ComponentModel from \"@/scripts/bom/ComponentUsed\";\nimport { uuid } from \"vue-uuid\";\n\nconst productVariantHandler = require(\"@/scripts/productVariantHandler\");\nconst uomPriceHandler = require(\"@/scripts/uomPriceHandler\");\nconst warehouseHandler = require(\"@/scripts/warehouseHandler\");\nconst bomHandler = require(\"@/scripts/bomHandler\");\nconst prefixHandler = require(\"@/scripts/prefixHandler\");\nconst billingHandler = require(\"@/scripts/invoice/handler/billingHandler\");\nconst saleFormContentHandler = require(\"@/scripts/saleFormContentHandler\");\nconst saleFormContentModel = new SaleFormContentModel({});\nconst currencyHandler = require(\"@/scripts/currency/handler/currencyHandler\");\n\nconst bomModel = new BomModel({});\nconst $ = require(\"jquery\");\nconst itemLinePrefix = \"lin-\";\nconst cookieJS = require(\"@/cookie.js\");\nconst cookie = cookieJS.getCookie();\n\nexport default {\n  name: \"BillOfMaterial\",\n  props: [\"id\"],\n  components: {\n    LoadingMe: () => import(`@/components/Loading`),\n    // 'app-datepicker' : DatePickerComponent,\n  },\n  computed: {\n    disabledMe() {\n      return !!this.$route.params.id;\n    },\n    // totalCost() {\n    //   if (this.costFP !== 0 || this.costOFP !== 0) {\n    //     return this.costOFP + this.costFP\n    //   } else {\n    //     return 0\n    //   }\n    // },\n    // varianceAmount() {\n    //   if (this.costFP !== 0 || this.costOFP !== 0 || this.costCU !== 0 || this.costOC !== 0) {\n    //     return (this.costFP + this.costOFP) - (this.costCU + this.costOC)\n    //   } else {\n    //     return 0\n    //   }\n    // }\n  },\n  data: () => ({\n    isEdit: false,\n    showLoading: false,\n    alert: false,\n    // Form validation\n    valid: true,\n    isHideBar: false,\n    warehouses: [],\n    bom: bomModel,\n    bomNo: \"\",\n    bomTypes: [\n      { id: 1, name: \"One Time Use\" },\n      { id: 2, name: \"Multiple Use\" },\n    ],\n    itemLinesFP: new FinishProductModel({}),\n    itemLinesOP: new OtherFinishProductModel({}),\n    itemLinesCU: new ComponentModel({}),\n    itemLinesOC: bomModel.otherCost,\n    finishProductItems: [],\n    otherFinishProductItems: [],\n    componentUsedItems: [],\n    otherCosts: [],\n    tax: [],\n    vatTax: [],\n    accounts: [],\n    costFP: 0,\n    costOFP: 0,\n    costCU: 0,\n    costOC: 0,\n    itemLineOP: [],\n    itemLineCU: [],\n    itemLineFP: [],\n    itemLineOC: [],\n    saleFormContent: saleFormContentModel,\n    baseCurrency: {},\n    exchangeRate: {},\n    loggedUser: {\n      id: cookie.creator,\n      name: cookie.email,\n    },\n    templates: [\n      { title: \"Draft\" },\n      { title: \"Open\" },\n      { title: \"Partially Closed\" },\n      { title: \"Closed\" },\n    ],\n  }),\n  methods: {\n    async loadViewBOM() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          if (this.$route.params.id) {\n            this.showLoading = true;\n            bomHandler.getAll(\"?id=\" + this.$route.params.id).then((res) => {\n              this.showLoading = false;\n              this.bom = res[0];\n              // this.autoCalculateGrid1()\n              // this.autoCalculateGrid2()\n              // this.autoCalculateGrid3()\n            });\n          } else {\n            // this.bom.finishProduct = []\n            // this.bom.otherFinishProduct = []\n            // this.bom.componentUsed = []\n            this.addRowFinishProduct();\n            this.addRowOtherProduct();\n            this.addRowComponentUse();\n          }\n        }, 10);\n      });\n    },\n    numberFormat(value) {\n      return kendo.toString(value, `n${this.saleFormContent.decimal}`);\n    },\n    numberEditor(container, options) {\n      kendo\n        .jQuery('<input data-bind=\"value:' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoNumericTextBox({\n          decimals: 30,\n          min: 0,\n          format: `${this.saleFormContent.decimal}`,\n        });\n    },\n    async loadSaleFormContent() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          saleFormContentHandler.list().then(async (res) => {\n            if (res.data.statusCode === 200) {\n              const data = res.data.data;\n              if (data.length > 0) {\n                this.saleFormContent = data[0];\n                this.baseCurrency = data[0].baseCurrency;\n                this.bom.currency = this.baseCurrency;\n                await this.loadTransactionRate();\n              }\n            }\n          });\n        }, 10);\n      });\n    },\n    async loadTransactionRate() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          const date = new Date().toISOString().substr(0, 10);\n          const currency = this.baseCurrency;\n          let code = \"\";\n          if (currency.hasOwnProperty(\"code\")) {\n            code = currency.code;\n          }\n          if (code !== undefined || code !== \"\") {\n            this.showLoading = true;\n            currencyHandler\n              .getLastExchangeRateByDate(date, code)\n              .then((res) => {\n                if (res.data.statusCode === 200) {\n                  this.showLoading = false;\n                  this.exchangeRate = res.data.data[0];\n                  this.bom.txnRate = this.exchangeRate.rate;\n                  this.bom.exchangeRate = this.exchangeRate;\n                  this.showLoading = false;\n                }\n              });\n          }\n        }, 10);\n      });\n    },\n    async loadPrefix() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          prefixHandler.get(\"bill of material\").then((res) => {\n            if (res.data.statusCode === 200) {\n              this.showLoading = false;\n              this.transactionTypes = res.data.data;\n              if (this.transactionTypes.length > 0) {\n                this.bom.transactionType = this.transactionTypes[0];\n                if (this.$route.params.id === undefined) {\n                  this.generateNumber();\n                }\n              }\n            }\n          });\n        }, 10);\n      });\n    },\n    generateNumber() {\n      let data = {\n        abbr: this.bom.transactionType.abbr,\n        structure: this.bom.transactionType.structure,\n        transactionDate: new Date().toISOString().substr(0, 10),\n        sequcencing: this.bom.transactionType.sequcencing,\n        type: \"Bill Of Material\",\n        entity: 2,\n      };\n      this.bom.abbr = data.abbr;\n      this.bom.structure = data.structure;\n      this.bom.sequcencing = data.sequcencing;\n      this.bom.type = data.type;\n      this.bom.transactionDate = data.transactionDate;\n      this.showLoading = true;\n      billingHandler\n        .lastNumber(data)\n        .then((response) => {\n          if (response.data.statusCode === 200) {\n            this.showLoading = false;\n            const res = response.data.data;\n            const lastNumber = this.zeroPad(\n              parseInt(res.lastNumber),\n              this.bom.transactionType.format\n            );\n            this.bom.number =\n              res.suffix +\n              this.bom.transactionType.numberSeparator +\n              lastNumber;\n            this.bom.lastNumber = res.suffix + lastNumber;\n          }\n        })\n        .catch((e) => {\n          this.showLoading = false;\n          this.errors.push(e);\n        });\n    },\n    zeroPad(num, places) {\n      return String(num).padStart(places, \"0\");\n    },\n    suffix(transactionDate) {\n      return kendo.toString(new Date(transactionDate), `yymm`);\n    },\n    async loadWarehouses() {\n      warehouseHandler.getWarehouseSettingAll().then((res) => {\n        this.warehouses = res;\n      });\n    },\n    async getDataSource() {\n      let dsFP = this.$refs.finishProductDS.kendoWidget();\n      let dataRowFP = dsFP.data();\n      this.itemLineFP = [];\n      dataRowFP.forEach((i) => {\n        this.itemLineFP.push({\n          id: i.id,\n          item: i.item,\n          description: i.description,\n          buom: i.buom,\n          uom: i.uom,\n          yieldQty: i.yieldQty,\n          cost: i.cost,\n          amount: i.amount,\n          sku: i.sku,\n          decimalFormat: i.decimalFormat || \"n2\",\n          inventoryAccount: i.inventoryAccount,\n        });\n      });\n      let dsOP = this.$refs.otherProductDS.kendoWidget(),\n        dataRowOP = dsOP.data();\n      this.itemLineOP = [];\n      dataRowOP.forEach((i) => {\n        this.itemLineOP.push({\n          id: i.id,\n          item: i.item,\n          description: i.description,\n          buom: i.buom,\n          uom: i.uom,\n          yieldQty: i.yieldQty,\n          cost: i.cost,\n          amount: i.amount,\n          sku: i.sku,\n          decimalFormat: i.decimalFormat || \"n2\",\n          inventoryAccount: i.inventoryAccount,\n        });\n      });\n      let dsCU = this.$refs.componentUseDS.kendoWidget(),\n        dataRowCU = dsCU.data();\n      this.itemLineCU = [];\n      dataRowCU.forEach((i) => {\n        this.itemLineCU.push({\n          id: i.id,\n          item: i.item,\n          description: i.description,\n          buom: i.buom,\n          uom: i.uom,\n          qty: i.qty,\n          cost: i.cost,\n          amount: i.amount,\n          sku: i.sku,\n          decimalFormat: i.decimalFormat || \"n2\",\n          inventoryAccount: i.inventoryAccount,\n        });\n      });\n      // let dsOC = this.$refs.otherCostDS.kendoWidget(),\n      //     dataRowOC = dsOC.data()\n      this.itemLineOC = [];\n      // dataRowOC.forEach(i => {\n      //   this.itemLineOC.push({\n      //     id: i.id,\n      //     account: i.account,\n      //     description: i.description,\n      //     amount: i.amount,\n      //     tax: i.tax,\n      //   })\n      // })\n    },\n    savePrint() {},\n    async saveNew() {},\n    async saveClose() {\n      if (this.bom.variance !== 0) {\n        this.$snotify.error(\"Please check your variance amount\");\n        return;\n      }\n      await this.getDataSource();\n      this.bom.finishProduct = this.itemLineFP;\n      this.bom.itemId = this.itemLineFP[0].item\n        ? this.itemLineFP[0].item.id\n        : \"\";\n      // this.bom.otherFinishProduct = this.itemLineOP\n      // this.bom.componentUsed = this.itemLineCU\n      // this.bom.otherCost = this.itemLineOC\n      // this.bom.amount = this.totalCost\n      // this.bom.exchangeAmount = this.totalCost\n      // this.bom.variance = this.varianceAmount\n      this.bom.status = 1;\n      this.showLoading = true;\n      await bomHandler.save(this.bom).then((res) => {\n        this.showLoading = false;\n        this.$router.push({\n          name: \"Products\",\n          path: \"product\",\n          params: { dataBom: res },\n        });\n      });\n    },\n    removeRow() {},\n    errorMessage() {},\n    async dataSourceChanged(e) {\n      if (e.field) {\n        let dataRow = e.items[0],\n          buom = {};\n        switch (e.field) {\n          case \"item\":\n            // this.attribute_ = this.attributes.filter(m => m.type.id === dataRow.variant.id)\n            dataRow.set(\"description\", dataRow.item.description);\n            dataRow.set(\"yieldQty\", 1);\n            buom = dataRow.item.uom;\n            dataRow.set(\"buom\", buom);\n            await this.inventoryBalanceByItem(dataRow, dataRow.item.id, 1);\n            break;\n          // case \"uom\":\n          //   // window.console.log(dataRow.uom,'row-uom')\n          //   dataRow.set('cost', parseFloat(dataRow.uom.price))\n          //   window.console.log(dataRow.yieldQty)\n          //   if (dataRow.yieldQty !== undefined) {\n          //     dataRow.set('cost', parseFloat(dataRow.uom.price) * parseFloat(dataRow.yieldQty))\n          //     this.costFP = dataRow.cost\n          //   }\n          //   break\n          case \"cost\":\n            dataRow.set(\n              \"amount\",\n              parseFloat(dataRow.cost) * parseFloat(dataRow.yieldQty)\n            );\n            this.costFP = dataRow.amount;\n            break;\n          default:\n            break;\n        }\n        if (e.field) {\n          this.autoCalculateGrid1();\n          this.autoCalculateGrid2();\n          this.autoCalculateGrid3();\n        }\n      }\n    },\n    async dataSourceChangedOP(e) {\n      if (e.field) {\n        let dataRow = e.items[0],\n          buom = {};\n        switch (e.field) {\n          case \"item\":\n            dataRow.set(\"description\", dataRow.item.description);\n            dataRow.set(\"yieldQty\", 1);\n            buom = dataRow.item.uom;\n            dataRow.set(\"buom\", buom);\n            await this.inventoryBalanceByItem(dataRow, dataRow.item.id, 1);\n            break;\n          case \"yieldQty\":\n            dataRow.set(\n              \"amount\",\n              parseFloat(dataRow.cost) * parseFloat(dataRow.yieldQty)\n            );\n            // this.costOFP = dataRow.amount\n            break;\n          case \"cost\":\n            dataRow.set(\n              \"amount\",\n              parseFloat(dataRow.cost) * parseFloat(dataRow.yieldQty)\n            );\n            // this.costOFP = dataRow.amount\n            window.console.log(dataRow.cost);\n            break;\n          default:\n            break;\n        }\n        if (e.field) {\n          this.autoCalculateGrid1();\n          this.autoCalculateGrid2();\n          this.autoCalculateGrid3();\n        }\n      }\n    },\n    autoCalculateGrid1() {\n      let ds = this.$refs.finishProductDS.kendoWidget();\n      const row = ds.data();\n      let amount = 0;\n      row.forEach((n) => {\n        amount += n.amount || 0;\n      });\n      this.costFP = amount;\n      this.bom.amount = this.costOFP + this.costFP;\n      this.bom.exchangeAmount = this.costOFP + this.costFP;\n      this.bom.variance =\n        this.costFP + this.costOFP - (this.costCU + this.costOC);\n    },\n    autoCalculateGrid2() {\n      let ds = this.$refs.otherProductDS.kendoWidget();\n      const row = ds.data();\n      let amount = 0;\n      row.forEach((n) => {\n        amount += n.amount || 0;\n      });\n      this.costOFP = amount;\n      this.bom.amount = this.costOFP + this.costFP;\n      this.bom.exchangeAmount = this.costOFP + this.costFP;\n      this.bom.variance =\n        this.costFP + this.costOFP - (this.costCU + this.costOC);\n    },\n    autoCalculateGrid3() {\n      let ds = this.$refs.componentUseDS.kendoWidget();\n      const row = ds.data();\n      let amount = 0;\n      row.forEach((n) => {\n        amount += n.amount || 0;\n      });\n      this.costCU = amount;\n      this.bom.amount = this.costOFP + this.costFP;\n      this.bom.exchangeAmount = this.costOFP + this.costFP;\n      this.bom.variance =\n        this.costFP + this.costOFP - (this.costCU + this.costOC);\n      window.console.log(\n        \"this.bom.exchangeAmount\",\n        this.bom.exchangeAmount,\n        \"variance\",\n        this.bom.variance\n      );\n    },\n    async dataSourceChangedOC(e) {\n      if (e.field) {\n        let dataRow = e.items[0];\n        switch (e.field) {\n          case \"account\":\n            window.console.log(dataRow.account);\n            break;\n          case \"tax\":\n            break;\n          case \"amount\":\n            this.costOC = dataRow.amount;\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    async dataSourceChangedCU(e) {\n      if (e.field) {\n        let dataRow = e.items[0],\n          buom = {};\n        switch (e.field) {\n          case \"item\":\n            dataRow.set(\"description\", dataRow.item.description);\n            dataRow.set(\"qty\", 1);\n            buom = dataRow.item.uom;\n            dataRow.set(\"buom\", buom);\n            await this.inventoryBalanceByItem(dataRow, dataRow.item.id, 2);\n            break;\n          // case \"uom\":\n          //   // window.console.log(dataRow.uom,'row-uom')\n          //   dataRow.set('cost', parseFloat(dataRow.uom.price))\n          //   window.console.log(dataRow.qty)\n          //   if (dataRow.qty !== undefined) {\n          //     dataRow.set('cost', parseFloat(dataRow.uom.price) * parseFloat(dataRow.qty))\n          //     this.costCU = dataRow.cost\n          //   }\n          //   break\n          case \"qty\":\n            // dataRow.set('price', parseFloat(dataRow.uom.price))\n            // dataRow.set('cost', parseFloat(dataRow.uom.price) * parseFloat(dataRow.qty))\n            dataRow.set(\n              \"amount\",\n              parseFloat(dataRow.cost) * parseFloat(dataRow.qty)\n            );\n            // this.costCU = dataRow.amount\n            break;\n          case \"cost\":\n            dataRow.set(\n              \"amount\",\n              parseFloat(dataRow.cost) * parseFloat(dataRow.qty)\n            );\n            // this.costCU = dataRow.amount\n            break;\n          default:\n            break;\n        }\n        if (e.field) {\n          this.autoCalculateGrid1();\n          this.autoCalculateGrid2();\n          this.autoCalculateGrid3();\n        }\n      }\n    },\n    rowNumberFP(dataItem) {\n      let ds = this.$refs.finishProductDS.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    UOMDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"uom.toUOM.name\",\n          dataValueField: \"uom.toUOM.id\",\n          cascadeFrom: \"item\",\n          template: \"<span>#=uom.toUOM.name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: uomPriceHandler.getUrl(options.model.item.id),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  // name: {type: \"string\"},\n                  // sku: {type: \"string\"},\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    UOMTemplate(dataItem) {\n      const uom = dataItem.buom;\n      if (uom) {\n        return `<span>${uom.name ? uom.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    ItemDropDownEditorFP(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"contains\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          headerTemplate:\n            '<div class=\"dropdown-header k-widget k-header\">' +\n            \"<span>Items </span>\" +\n            \"<span></span>\" +\n            \"</div>\",\n          template: \"<span>#=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: productVariantHandler.itemVariantSearchURL(), // variant only\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  name: { type: \"string\" },\n                  sku: { type: \"string\" },\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    ItemDropDownEditor(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"contains\",\n          dataTextField: \"name\",\n          dataValueField: \"id\",\n          headerTemplate:\n            '<div class=\"dropdown-header k-widget k-header\">' +\n            \"<span>Items </span>\" +\n            \"<span></span>\" +\n            \"</div>\",\n          template: \"<span>#=name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: productVariantHandler.itemSearchURL(),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  name: { type: \"string\" },\n                  sku: { type: \"string\" },\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    itemTemplate(dataItem) {\n      const item = dataItem.item;\n      if (item) {\n        return `<span>${item.name ? item.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    async inventoryBalanceByItem(dataRow, itemId, flag = 1) {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.showLoading = true;\n          const startDate = new Date().toISOString().substr(0, 10);\n          let strFilter = \"?asOf=\" + startDate + \"&id=\" + itemId;\n          billingHandler.inventoryBalance(strFilter).then((res) => {\n            if (res.data.statusCode === 200) {\n              const balance = res.data.data;\n              if (balance.length > 0) {\n                dataRow.set(\"cost\", balance[0].wac);\n                dataRow.set(\"qoh\", balance[0].qoh);\n                if (flag === 1) {\n                  dataRow.set(\n                    \"amount\",\n                    parseFloat(balance[0].wac) * parseFloat(dataRow.yieldQty)\n                  );\n                } else {\n                  dataRow.set(\n                    \"amount\",\n                    parseFloat(balance[0].wac) * parseFloat(dataRow.qty)\n                  );\n                }\n              } else {\n                dataRow.set(\"cost\", 0);\n              }\n            }\n            this.showLoading = false;\n          });\n        }, 10);\n      });\n    },\n    async addRowFinishProduct() {\n      let ds = this.$refs.finishProductDS.kendoWidget(),\n        total = ds.total();\n      this.itemLinesFP.id = itemLinePrefix + uuid.v1();\n      this.itemLinesFP.decimalFormat = \"n\" + this.saleFormContent.decimal;\n      if (total === 0) {\n        ds.insert(total, this.itemLinesFP);\n      }\n    },\n\n    UOMDropDownEditorOP(container, options) {\n      kendo\n        .jQuery('<input name=\"' + options.field + '\"/>')\n        .appendTo(container)\n        .kendoDropDownList({\n          autoBind: true,\n          autoWidth: true,\n          height: 400,\n          filter: \"startswith\",\n          dataTextField: \"uom.toUOM.name\",\n          dataValueField: \"uom.toUOM.id\",\n          cascadeFrom: \"item\",\n          template: \"<span>#=uom.toUOM.name#</span>\",\n          optionLabel: \"--- Select ---\",\n          dataSource: new kendo.data.DataSource({\n            serverFiltering: true,\n            transport: {\n              read: {\n                url: uomPriceHandler.getUrl(options.model.item.id),\n              },\n              dataType: \"json\",\n            },\n            schema: {\n              model: {\n                id: \"id\",\n                fields: {\n                  id: { type: \"string\" },\n                  // name: {type: \"string\"},\n                  // sku: {type: \"string\"},\n                },\n              },\n              data: function(response) {\n                return response.data;\n              },\n              total: function(response) {\n                return response.data.count;\n              },\n            },\n            // data: this.variants\n          }),\n        });\n    },\n    UOMTemplateOP(dataItem) {\n      const uom = dataItem.uom;\n      if (uom) {\n        return `<span>${uom.uom ? uom.uom.toUOM.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n    rowNumberOP(dataItem) {\n      let ds = this.$refs.otherProductDS.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    addRowOtherProduct() {\n      let ds = this.$refs.otherProductDS.kendoWidget(),\n        total = ds.total();\n      this.itemLinesOP.id = itemLinePrefix + uuid.v1();\n      this.itemLinesOP.decimalFormat = \"n\" + this.saleFormContent.decimal;\n      ds.insert(total, this.itemLinesOP);\n    },\n    removeRowOP(e) {\n      e.preventDefault();\n      const grid = kendo.jQuery(\"#gridOtherProduct\").data(\"kendoGrid\"),\n        dataSource = grid.dataSource,\n        dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n      if (dataSource.total() > 1) {\n        dataSource.remove(dataItem);\n      }\n    },\n    removeRowCU(e) {\n      e.preventDefault();\n      const grid = kendo.jQuery(\"#gridComponentUse\").data(\"kendoGrid\"),\n        dataSource = grid.dataSource,\n        dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n      if (dataSource.total() > 1) {\n        dataSource.remove(dataItem);\n      }\n    },\n    UOMTemplateCU(dataItem) {\n      const uom = dataItem.uom;\n      if (uom) {\n        return `<span>${uom.uom ? uom.uom.toUOM.name : ``}</span>`;\n      } else {\n        return ``;\n      }\n    },\n\n    rowNumberCU(dataItem) {\n      let ds = this.$refs.componentUseDS.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    addRowComponentUse() {\n      let ds = this.$refs.componentUseDS.kendoWidget(),\n        total = ds.total();\n      this.itemLinesCU.id = itemLinePrefix + uuid.v1();\n      this.itemLinesCU.decimalFormat = \"n\" + this.saleFormContent.decimal;\n      ds.insert(total, this.itemLinesCU);\n    },\n    cancel() {\n      this.$swal({\n        title: i18n.t(\"msg_title_warning\"),\n        text: i18n.t(\"msg_discard\"),\n        icon: \"warning\",\n        showCancelButton: true,\n        cancelButtonText: i18n.t(\"cancel\"),\n        confirmButtonColor: \"#4d4848\",\n        cancelButtonColor: \"#ED1A3A\",\n        confirmButtonText: i18n.t(\"discard\"),\n      }).then((resultCen) => {\n        if (resultCen.value) {\n          this.$router.go(-1);\n        }\n      });\n    },\n  },\n  async mounted() {\n    await this.loadSaleFormContent();\n    await this.loadPrefix();\n    await this.loadWarehouses();\n    await this.loadViewBOM();\n  },\n  async created() {\n    // await this.loadTax()\n    // await this.loadAccount()\n  },\n  activated() {\n    this.bom.finishProduct = [];\n    this.bom.otherFinishProduct = [];\n    this.bom.componentUsed = [];\n    this.loadViewBOM();\n  },\n  deactivated() {\n    this.bom.finishProduct = [];\n    this.bom.otherFinishProduct = [];\n    this.bom.componentUsed = [];\n    // this.addRowFinishProduct()\n    // this.addRowOtherProduct()\n    // this.addRowComponentUse()\n  },\n  watch: {\n    // '$router': 'loadViewBOM'\n  },\n};\n</script>\n<style scoped>\n.redText {\n  color: red !important;\n}\n\n.small_sidebar {\n  height: 97%;\n  position: relative;\n  padding: 12px;\n}\n\n.hide_small_bar_class {\n  max-width: 0;\n  transition: 0.5s ease-in;\n  flex: 0 0 0;\n  padding: 0;\n}\n\n.hide_big_bar_class {\n  max-width: 100%;\n  transition: 0.5s ease-in;\n  flex: 0 0 100%;\n}\n\n.iconArrow {\n  right: -35px;\n  position: absolute;\n  bottom: -10px;\n}\n\n.iconArrowHide {\n  position: absolute;\n  right: -7px;\n  bottom: -10px;\n}\n\n.theme--light.v-data-table\n  > .v-data-table__wrapper\n  > table\n  > tbody\n  > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {\n  background-color: transparent !important;\n}\n\n.detial_smallside_p {\n  position: absolute;\n  bottom: 10px;\n}\n\n@media (min-width: 1264px) {\n  .container {\n    /* max-width: 1185px; */\n    max-width: 1080px !important;\n  }\n}\n</style>\n"]}]}