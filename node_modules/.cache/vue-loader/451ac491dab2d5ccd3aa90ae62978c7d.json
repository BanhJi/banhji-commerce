{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/banking/BankReconciliationBankFeeds.vue?vue&type=style&index=0&id=870859f2&scoped=true&lang=css&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/banking/BankReconciliationBankFeeds.vue","mtime":1638499443117},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBtZWRpYSAobWluLXdpZHRoOiAxMjY0cHgpIHsKICAgIC5jb250YWluZXIgewogICAgICAgIG1heC13aWR0aDogMTA4MHB4ICFpbXBvcnRhbnQ7CiAgICB9Cn0KCnRhYmxlewogICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKfQp0YWJsZSB0aGVhZCB0ciB0aHsKICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjMDAwMDAwOwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICMwMDAwMDA7CiAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICMwMDAwMDA7CiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjMDAwMDAwOwp9Cg=="},{"version":3,"sources":["BankReconciliationBankFeeds.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2yBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BankReconciliationBankFeeds.vue","sourceRoot":"src/views/banking","sourcesContent":["<template>\n    <v-app>\n        <v-container>\n            <v-row>\n                <v-col cols=\"12\" sm=\"12\">\n                    <v-card outlined dense class=\"pa-4 no_border rounded-sm\" color=\"white\">\n                        <v-card outlined dense class=\"no_border\">\n                            <h2 class=\"mb-0\">{{ $t(\"bank_reconciliation_bank_feeds\") }}</h2>\n                            <v-icon\n                                    onclick=\"window.history.go(-1); return false;\"\n                                    style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                                    class=\"float-right\"\n                            >close\n                            </v-icon>\n                        </v-card>\n\n                        <v-row>\n                            <v-col sm=\"4\" cols=\"12\" class=\"pb-0\">\n                                <v-card outlined dense class=\"px-4 py-3 no_border mb-3\" height=\"365\" color=\"grayBg\">\n                                    <label class=\"label\">{{$t('financial_institution')}}</label>\n                                    <v-select class=\" mb-3\"\n                                        @change=\"onBankChanges\"\n                                        v-model=\"bank\"\n                                        :items=\"banks\"\n                                        item-value=\"uuid\"\n                                        item-text=\"name\"\n                                        placeholder=\"Select Financial Institution\"\n                                        outlined />\n\n                                    <label class=\"label\">{{$t('bank_account')}}</label>\n                                    <v-select class=\" mb-3\"\n                                        :disabled=\"bank === null\"\n                                        :items=\"bankAccounts\"\n                                        item-value=\"uuid\"\n                                        item-text=\"number\"\n                                        v-model=\"bankAccount\"\n                                        placeholder=\"Select Bank Account\"\n                                        return-object\n                                        outlined\n                                        required >\n                                        <template slot='selection' slot-scope='{ item }'>\n                                            {{ item.number }} ({{ item.currency.code }})\n                                        </template>\n                                        <template slot='item' slot-scope='{ item }'>\n                                            {{ item.number }} ({{ item.currency.code }})\n                                        </template>\n                                    </v-select>\n\n                                    <label class=\"label\">{{ $t(\"reconcile_date\") }}</label>\n                                    <v-row>\n                                        <v-col sm=\"3\" cols=\"12\" class=\"pb-0\">\n                                            <h3 class=\"mt-2\">{{ $t(\"from\") }}</h3>\n                                        </v-col>\n                                        <v-col sm=\"9\" cols=\"12\" class=\"py-0\">\n                                            <app-datepicker\n                                                :initialDate=\"reconcile.start_date\"\n                                                @emitDate=\"reconcile.start_date = $event\"\n                                            />\n                                        </v-col>\n                                    </v-row>\n                                    <v-row class=\"\">\n                                        <v-col sm=\"3\" cols=\"12\" class=\"py-0 pt-n3\">\n                                            <h3 class=\"mt-5\">{{ $t(\"to\") }}</h3>\n                                        </v-col>\n                                        <v-col sm=\"9\" cols=\"12\" class=\"py-0 pt-n3\">\n                                            <app-datepicker\n                                                :initialDate=\"reconcile.end_date\"\n                                                @emitDate=\"reconcile.end_date = $event\"\n                                            />\n                                        </v-col>\n                                    </v-row>\n                                    <v-col sm=\"12\" cols=\"12\" class=\"text-center py-0\">\n                                        <v-btn \n                                            :disabled=\"bankAccount === null\"\n                                            outlined width=\"150\" \n                                            class=\"primary white--text text-capitalize \" \n                                            @click=\"getData\">{{$t('get_data')}}\n                                        </v-btn>\n                                    </v-col>\n                                </v-card>\n                            </v-col>\n                            <v-col sm=\"8\" cols=\"12\" class=\"pb-0\">\n                                <v-card outlined dense class=\"px-4 no_border pb-4\" height=\"365\" color=\"grayBg\">\n                                    <v-row>\n                                        <v-col sm=\"6\" cols=\"12\" class=\"pb-0\">\n                                            <label class=\"label\">{{ $t(\"reconcile_date\") }}</label>\n                                            <app-datepicker\n                                                    :initialDate=\"reconcile.ending_balance_date\"\n                                                    @emitDate=\"reconcile.ending_balance_date = $event\"\n                                            />\n                                        </v-col>\n                                        <v-col sm=\"6\" cols=\"12\" class=\"pb-0\">\n                                            <label class=\"label\">{{ $t(\"number\") }}</label>\n                                            <v-row>\n                                                <v-col sm=\"2\" cols=\"3\" class=\"pl-0 pr-0\">\n                                                    <div class=\"code_text\" v-text=\"reconcile.abbr\"></div>\n                                                </v-col>\n                                                <v-col sm=\"8\" cols=\"7\" class=\"pl-0\">\n                                                    <v-text-field class=\" custom-border\"\n                                                                  v-model=\"reconcile.number\"\n                                                                  outlined\n                                                                  :rules=\"[v => !!v || 'Number is required']\"\n                                                                  required/>\n                                                </v-col>\n                                                <v-col sm=\"2\" cols=\"2\" class=\"pl-0\">\n                                                    <v-icon color=\"black\" size=\"30\" class=\"border_qrcode\"\n                                                            @click=\"generateNumber\">mdi-qrcode\n                                                    </v-icon>\n                                                </v-col>\n                                            </v-row>\n                                        </v-col>\n                                    </v-row>\n                                    <v-row >\n                                        <v-col sm=\"6\" cols=\"12\" class=\"pt-0\">\n                                            <v-card outlined dense class=\"pa-4 no_border text-center primary--text\" color=\"white\">\n                                                <h3 style=\"font-size: 25px\"  class=\"mb-3\">{{ Number(reconcile.opening_balance).toLocaleString() }}</h3>\n                                                <p class=\"mb-0 text-uppercase\">{{$t('bank_ending_balance')}}</p>\n                                            </v-card>\n                                        </v-col>\n                                        <v-col sm=\"6\" cols=\"12\" class=\"pt-0\">\n                                            <v-card outlined dense class=\"pa-4 text-center no_border white--text\" color=\"primary\">\n                                                <h3 style=\"font-size: 25px\" class=\"mb-3\">{{ Number(reportingEndingBalance).toLocaleString() }}</h3>\n                                                <p class=\"mb-0 text-uppercase\">{{$t('reported_ending_balance')}}</p>\n                                            </v-card>\n                                        </v-col>\n                                    </v-row>\n                                    <v-row>\n                                        <v-col sm=\"6\" cols=\"12\" class=\"py-0\">\n                                            <label class=\"label text-uppercase\">{{ $t(\"variant\") }}</label>\n                                            <v-text-field class=\"mt-1\"\n                                                v-model=\"reconcile.variance_amount\"\n                                                outlined\n                                                required />\n                                        </v-col>\n                                        <v-col sm=\"6\" cols=\"12\" class=\"py-0\">\n                                            <label class=\"label\">{{ $t(\"adjustment_account\") }}</label>\n                                            <v-select class=\" mb-3 mt-3\"\n                                                    :disabled=\"reconcile.variance_amount === 0\"\n                                                    v-model=\"adjustmentAccount\"\n                                                    :items=\"adjustmentAccounts\"\n                                                    item-value=\"number\"\n                                                    item-text=\"name\"                                                    \n                                                    no-data-text=\"No data found.\"\n                                                    placeholder=\"Select Adjustment Account\"\n                                                    return-object\n                                                    outlined\n                                                >\n                                                    <!-- <template slot='selection' slot-scope='{ item }'>\n                                                        {{ item.number }} - {{ item.name }}\n                                                    </template> -->\n                                                    <template slot='item' slot-scope='{ item }'>\n                                                        {{ item.number }} - {{ item.name }}\n                                                    </template>\n                                                </v-select>\n                                        </v-col>\n                                    </v-row>\n                                </v-card>\n                            </v-col>\n                        </v-row>\n\n                        <br>\n\n                        <v-row>\n                            <v-col sm=\"12\" cols=\"12\" class=\"\">\n                                <table>\n                                    <thead>\n                                        <tr>\n                                            <th>From Bank</th>\n                                            <th colspan=\"2\">Matched</th>\n                                            <th>From BanhJi</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        <tr>\n                                            <td>\n                                                <v-text-field class=\" custom-border\"\n                                                    v-model=\"searchBankTxnValue\"\n                                                    @change=\"searchBankTxn\"\n                                                    placeholder='search...'\n                                                    outlined />\n                                                <kendo-listbox id=\"bankTxnListBox\"\n                                                    ref=\"bankTxnListBox\"\n                                                    :data-source=\"bankTransactions\"\n                                                    :data-text-field=\"'transactionType'\"\n                                                    :data-value-field=\"'uuid'\"\n                                                    :template=\"bankListBoxTmpl\"\n                                                    :connect-with=\"'bankReconciledListBox'\"\n                                                    :drop-sources=\"['bankReconciledListBox']\"\n                                                    :draggable=\"true\">\n                                                </kendo-listbox>\n                                            </td>\n                                            <td>\n                                                <kendo-listbox id=\"bankReconciledListBox\"\n                                                    ref=\"bankReconciledListBox\"\n                                                    :connect-with=\"'bankTxnListBox'\"\n                                                    :drop-sources=\"['bankTxnListBox']\"\n                                                    :data-text-field=\"'transactionType'\"\n                                                    :data-value-field=\"'uuid'\"\n                                                    :template=\"bankListBoxTmpl\"\n                                                    :draggable=\"true\"\n                                                    style=\"height:280px;\">\n                                                </kendo-listbox>\n                                            </td>\n                                            <td>\n                                                <kendo-listbox id=\"banhjiReconciledListBox\"\n                                                    ref=\"banhjiReconciledListBox\"\n                                                    :connect-with=\"'banhjiTxnListBox'\"\n                                                    :drop-sources=\"['banhjiTxnListBox']\"\n                                                    :data-text-field=\"'journal_type'\"\n                                                    :data-value-field=\"'entry_uuid'\"\n                                                    :template=\"banhjiListBoxTmpl\"\n                                                    :draggable=\"true\"\n                                                    style=\"height:280px;\">\n                                                </kendo-listbox>\n                                            </td>\n                                            <td>\n                                                <v-text-field class=\" custom-border\"\n                                                    v-model=\"searchBanhjiTxnValue\"\n                                                    @change=\"searchBanhjiTxn\"\n                                                    placeholder='search...'\n                                                    outlined />\n                                                <kendo-listbox id=\"banhjiTxnListBox\"\n                                                    ref=\"banhjiTxnListBox\"\n                                                    :data-source=\"banhjiTransactions\"\n                                                    :data-text-field=\"'journal_type'\"\n                                                    :data-value-field=\"'entry_uuid'\"\n                                                    :template=\"banhjiListBoxTmpl\"\n                                                    :connect-with=\"'banhjiReconciledListBox'\"\n                                                    :drop-sources=\"['banhjiReconciledListBox']\"\n                                                    :draggable=\"true\">\n                                                </kendo-listbox>\n                                            </td>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                            </v-col>\n                        </v-row>\n\n                        <v-divider/>\n\n                        <v-card outlined dense class=\"no_border function_footer\">\n                            <v-alert type=\"warning\"\n                                     v-model=\"alert\"\n                                     dismissible>\n                                <span v-html=\"errorMessage\"/>\n                            </v-alert>\n                            <v-menu>\n                                <template v-slot:activator=\"{ on }\">\n                                    <v-btn color=\"black\" outlined\n                                           class=\"mr-2 text-capitalize  black--text float-left\" v-on=\"on\">\n                                        {{$t('select_template')}}\n                                        <v-icon size=\"\" class=\"ma-1\">expand_more</v-icon>\n                                    </v-btn>\n                                </template>\n                                <v-list>\n                                    <v-list-item v-for=\"(item, index) in templates\" :key=\"index\">\n                                        <v-list-item-title>{{ item.title }}</v-list-item-title>\n                                    </v-list-item>\n                                </v-list>\n                            </v-menu>\n                            <v-btn color=\"black\" outlined class=\"text-capitalize  black--text float-left\"\n                                   @click=\"cancel\">{{$t('cancel')}}\n                            </v-btn>\n                            <v-btn color=\"primary\" class=\"ml-2 float-right text-capitalize  white--text\">\n                                {{$t('reconcile')}}\n                            </v-btn>\n                            <v-btn color=\"primary\" class=\" float-right text-capitalize  white--text\">\n                                {{$t('save_for_later')}}\n                            </v-btn>\n                        </v-card>\n                    </v-card>\n                </v-col>\n            </v-row>\n        </v-container>\n    </v-app>\n</template>\n\n<script>\n    import kendo from \"@progress/kendo-ui\"\n    import DatePickerComponent from \"@/components/custom_templates/DatePickerComponent\"\n    import helper from \"@/helper.js\"\n    import { ReconcileModel, JournalModel, JournalEntryModel } from \"@/scripts/model/AppModels\"\n    import {\n        accountHandler,\n        journalHandler,\n        bankHandler,\n        bankAccountHandler,\n        reconcileHandler,\n    } from \"@/scripts/AppHandlers\"\n\n    /* Store */\n    import store from \"@/store\"\n    const institute = store.state.institute.institute\n\n    const instituteId = institute.id\n    const CryptoJS = require(\"crypto-js\")\n\n    export default {\n        name: \"BankReconcilliationBankFeeds\",\n        components: {\n            \"app-datepicker\": DatePickerComponent,\n        },\n        data: () => ({\n            reconcile       : [],\n            journal         : [],\n            journal_entries : [],\n            // LoadingMe\n            showLoading: false,\n            loadingAlert: false,\n            loadingColorAlert: \"\",\n            loadingTextAlert: \"\",\n            // Form validation\n            valid: true,\n            isEdit: false,\n            saveMode: \"\",\n            alert: false,\n            errorMessage: \"\",\n            reportingEndingBalance  : 0,\n            bank                : null,\n            banks               : [],\n            bankAccount         : null,\n            bankAccounts        : [],\n            bankAccountList     : [],\n            adjustmentAccount   : null,\n            adjustmentAccounts  : [],\n            templates           : [],\n            searchBankTxnValue  : '',\n            searchBanhjiTxnValue: '',\n            bankRules           : [],\n            bankTransactions    : [],\n            banhjiTransactions  : [],\n        }),\n        methods: {\n            // Set default data\n            setDefaultData() {\n                this.reconcile = new ReconcileModel({\n                    start_date  : new Date().toISOString().substr(0, 10),\n                    end_date    : new Date().toISOString().substr(0, 10), \n                })\n                this.reconcile.abbr = 'BF'\n\n                // Generate Number\n                this.generateNumber();\n            },\n            // Load journal according to query string {id}\n            loadObj() {\n                let self = this;\n\n                // Access Query String\n                let q = this.$route.params;\n                if (q.id !== undefined) {\n                    // Set Edit Mode\n                    this.isEdit = true;\n\n                    this.showLoading = true;\n                    journalHandler\n                        .getOne(q.id)\n                        .then((res) => {\n                            // Bind Obj\n                            if (res) {\n                                let j = new JournalModel(res)\n\n                                // Number\n                                let numberSplited = j.number.split(\"-\")\n                                if (numberSplited.length > 0) {\n                                    j.abbr = numberSplited[0]\n                                    j.number = numberSplited[1]\n                                }\n\n                                // Advance Settlement\n                                this.journal = j\n                            }\n                        })\n                        .finally(() => {\n                            self.showLoading = false;\n                        });\n                } else {\n                    this.isEdit = false;\n                }\n            },\n            /* Kendo */\n            // Row Number Template\n            rowNumberTmpl(dataItem) {\n                let ds = this.$refs.dataSource.kendoWidget(),\n                    index = ds.indexOf(dataItem)\n\n                return index + 1\n            },\n            bankTransactionTmpl(dataItem) {\n                let tmpl = `<table><tr><td>${ dataItem.transaction_date }\n                                            ${ dataItem.code }\n                                            ${ dataItem.name }\n                            </td></tr></table>`\n\n                return tmpl\n            },\n            banhJiTransactionTmpl(dataItem) {\n                let tmpl = `<table><tr><td>${ dataItem.transaction_date }\n                                            ${ dataItem.code }\n                                            ${ dataItem.name }\n                            </td></tr></table>`\n\n                return tmpl\n            },\n            bankListBoxTmpl (e) {\n                let template = kendo.template(`#=sk#\n                                                #=transactionType#\n                                                #=amount#\n                                                #=currency#\n                                            `)\n                return template(e)\n            },\n            banhjiListBoxTmpl (e) {\n                let template = kendo.template(`#=journal_date#\n                                                #=journal_number#\n                                                #=journal_type#\n                                                #=amount#\n                                            `)\n                return template(e)\n            },\n            // Search\n            searchBankTxn () {\n                let listBox = this.$refs.bankTxnListBox.kendoWidget()\n\n                listBox.dataSource.filter({ field: \"transactionType\", operator: \"contains\", value: this.searchBankTxnValue })\n            },\n            searchBanhjiTxn () {\n                let listBox = this.$refs.banhjiTxnListBox.kendoWidget()\n\n                listBox.dataSource.filter({ field: \"journal_type\", operator: \"contains\", value: this.searchBanhjiTxnValue })\n            },\n            // Matching\n            matching () {\n                let rule = this.bankRules,\n                    bankTxns = this.bankTransactions\n                    // banhjiTxns = this.bankTransactions\n\n                let dataSource = new kendo.data.DataSource({\n                    data: bankTxns,\n                    filter: {\n                        // leave data items which are \"Food\" or \"Tea\"\n                        logic: rule.condition,\n                        filters: [\n                            { field: \"category\", operator: \"eq\", value: \"Food\" },\n                            { field: \"name\", operator: \"eq\", value: \"Tea\" }\n                        ]\n                    }\n                })\n                dataSource.fetch(function(){\n                    let view = dataSource.view()\n                    window.console.log(view.length); // displays \"2\"\n                    window.console.log(view[0].amount); // displays \"Tea\"\n                    window.console.log(view[1].amount); // displays \"Ham\"\n                });\n            },\n            // On Bank Change\n            onBankChanges () {\n                let bankId = this.bank\n\n                this.bankAccounts = []\n                if(bankId !== null){\n                    this.bankAccounts = this.bankAccountList.filter(value => value.bank.uuid === bankId)\n                }\n            },\n            // Number\n            generateNumber () {\n                this.reconcile.number = new Date().getTime()\n            },\n            // Get Data\n            getData () {\n                let ba = this.bankAccount,\n                    rc = this.reconcile,\n                    sdate = rc.start_date,\n                    edate = rc.end_date\n                    \n                if (sdate && edate) {\n                    sdate = kendo.toString(new Date(sdate), 'yyyy-MM-dd') + 'T00:00:00.000Z'\n\n                    edate = new Date(edate)\n                    edate = kendo.toString(edate, 'yyyy-MM-dd') + 'T23:59:59.999Z'\n                } else {\n                    sdate = 0\n                    edate = 0\n                }\n\n                reconcileHandler.getBankFeed(ba.account.uuid, {\n                    params: {\n                        start_date \t: sdate,\n                        end_date \t: edate,\n                    }\n                })\n                .then(res => {\n                    this.bankTransactions = res.bankTxns\n                    this.bankRules = res.bankRules\n                    this.banhjiTransactions = res.banhjiTxns.entries_detail\n                })\n            },\n            // Add Journal\n            addJournal() {\n                let j = this.journal,\n                    je = []\n\n                // Settlement on Dr\n                je.push(\n                    new JournalEntryModel({\n                        account             : [],\n                        primary_contact     : {},\n                        secondary_contact   : {},\n                        description         : j.description,\n                        ref_number          : \"\",\n                        amount              : 0,\n                        currency            : {},\n                        exchange_rate       : 1,\n                        exchanged_amount    : 0,\n                    })\n                )\n\n                j.journal_entries = je\n            },\n            // Shrink Data\n            shrinkData() {\n                let j = this.journal;\n\n                // Number combine abbr + number\n                j.number = j.abbr + \"-\" + j.number;\n\n                // Journal Date\n                j.journal_date = helper.toISODate(j.journal_date);\n\n                // Filter cash_advance_uuid\n                j.cash_advance = j.cash_advance.uuid;\n\n                // User\n                let user = {\n                    uuid: institute.creator,\n                    user_name: institute.legalName, //change later (fullname)\n                    cognitoId: institute.sk,\n                    email: institute.email,\n                };\n                if (this.isEdit) {\n                    j.modified_by = user;\n                } else {\n                    j.created_by = user;\n                }\n            },\n            // Validating\n            validateForm() {\n                let result = true,\n                    msg = \"\";\n\n                // Cash Account\n                if (kendo.parseFloat(this.received_amount) > 0 || this.remaining < 0) {\n                    if (this.cashAccount === null) {\n                        msg += \"<p>Please select cash account</p>\";\n                        result = false;\n                    }\n                }\n\n                // Show Alert\n                this.errorMessage = msg;\n                if (result === false) {\n                    this.alert = true;\n                }\n\n                return result;\n            },\n            // Validate Closing Date\n            validateClosingDate() {\n                let today = new Date();\n                let objDate = new Date(this.journal.journal_date)\n                    .toISOString()\n                    .substr(0, 10);\n\n                // Approved Reporting Date\n                if (new Date(objDate) < new Date(institute.fishScaleDate)) {\n                    if (today <= new Date(institute.afterClosingDatePeriod)) {\n                        this.save();\n                    } else {\n                        this.alertError(\n                            \"Sorry, you can not save this transaction. Please contact your Admin.\"\n                        );\n                    }\n                } else {\n                    // Closing Date\n                    if (\n                        new Date(objDate) <= new Date(institute.closingDate) &&\n                        institute.closingStatus === 1\n                    ) {\n                        this.$swal({\n                            title: \"Please Enter Password!\",\n                            icon: \"warning\",\n                            input: \"password\",\n                            inputPlaceholder: \"Password...\",\n                            inputAttributes: {\n                                autocapitalize: \"off\",\n                                autocorrect: \"off\",\n                            },\n                            showCancelButton: true,\n                            confirmButtonText: \"Submit\",\n                            showLoaderOnConfirm: true,\n                            preConfirm: (password) => {\n                                // Decrypt (Password, Key)\n                                let pswInBytes = CryptoJS.AES.decrypt(\n                                    institute.closingDatePassword,\n                                    instituteId\n                                );\n                                let originalPsw = pswInBytes.toString(CryptoJS.enc.Utf8);\n\n                                // Compare Password\n                                if (password === originalPsw) {\n                                    this.save();\n                                } else {\n                                    this.$swal.showValidationMessage(\"Password Does Not Macth!\");\n                                }\n                            },\n                            allowOutsideClick: () => !this.$swal.isLoading(),\n                        });\n                    } else {\n                        this.save();\n                    }\n                }\n            },\n            // All Saves\n            onSaveOptionClick(mode) {\n                if (this.$refs.form.validate() && this.validateForm()) {\n                    this.saveMode = mode;\n                    this.validateClosingDate();\n                } else {\n                    this.alertError();\n                }\n            },\n            cancel() {\n                this.$swal({\n                    title: \"Are you sure?\",\n                    text: \"You won't be able to revert this!\",\n                    icon: \"warning\",\n                    showCancelButton: true,\n                    confirmButtonColor: \"#4d4848\",\n                    cancelButtonColor: \"#ED1A3A\",\n                    confirmButtonText: \"Yes, discard it!\",\n                }).then((result) => {\n                    if (result.value) {\n                        this.clear();\n                        this.$router.go(-1);\n                    }\n                });\n            },\n            clear() {\n                // Reset Form\n                this.$refs.form.reset();\n\n                this.employee = null;\n\n                // Datasoure\n                let ds = this.$refs.dataSource.kendoWidget();\n                ds.data([]);\n\n                // Set default data\n                this.setDefaultData();\n            },\n            save() {\n                let self = this,\n                    j = this.journal;\n\n                // Add Journal\n                this.addJournal();\n\n                // Draft Mode\n                if (this.saveMode === \"saveDraft\") {\n                    j.is_draft = 1;\n                } else {\n                    j.is_draft = 0;\n                }\n\n                // Shrink Data\n                this.shrinkData();\n\n                // Sync Data\n                this.showLoading = true;\n                journalHandler\n                    .save(this.journal)\n                    .then((response) => {\n                        if (response) {\n                            self.responseStatus(response.status);\n                        } else {\n                            self.alertError();\n                        }\n                    })\n                    .catch((error) => {\n                        self.alertError(error);\n                    });\n            },\n            // Response Status\n            responseStatus(status) {\n                switch (status) {\n                    case 200: // Ok\n                        this.showAlert();\n\n                        // Reset to default data\n                        this.clear();\n\n                        break;\n                    case 201: // Duplicate\n                        this.alertError(\"Duplicate entry!\");\n                        break;\n                    default:\n                        break;\n                }\n            },\n            // Sweetalert2\n            changeAlertStatus() {\n                this.loadingAlert = true;\n                setTimeout(() => {\n                    this.loadingAlert = false;\n                }, 6200);\n            },\n            showAlert() {\n                this.showLoading = false;\n                this.changeAlertStatus();\n                this.loadingTextAlert = \"Added Successful\";\n                this.loadingColorAlert = \"#3DA72E\";\n                switch (this.saveMode) {\n                    case \"saveClose\": // Save Close\n                        // this.$swal({\n                        // \tposition: 'products',\n                        // \ticon: 'success',\n                        // \ttitle: 'Your work has been saved',\n                        // \tshowConfirmButton: true,\n                        // }).then((result) => {\n                        // \tif (result.value) {\n                        // \t\twindow.history.go(-1)\n\n                        // \t\treturn false\n                        // \t}\n                        // })\n                        this.$router.go(-1);\n                        break;\n                    default:\n                        // Save New\n                        // this.$swal({\n                        // \tposition: 'products',\n                        // \ticon: 'success',\n                        // \ttitle: 'Your work has been saved',\n                        // \tshowConfirmButton: false,\n                        // \ttimer: 1500\n                        // })\n                        break;\n                }\n                this.saveMode = \"\";\n            },\n            alertError(msg) {\n                if (msg) {\n                    this.$swal({\n                        position: \"center\",\n                        icon: \"error\",\n                        title: \"Oops...!\",\n                        text: msg,\n                        showConfirmButton: true,\n                    });\n                } else {\n                    this.showLoading = false;\n                    this.loadingTextAlert = \"Failed!\";\n                    this.loadingColorAlert = \"#eb8334\";\n                    this.changeAlertStatus();\n                }\n            },\n        },\n        watch: {\n            // call again the method if the route changes\n            $route: \"loadObj\",\n        },\n        created() {\n            // fetch the data when the view is created and the data is\n            // already being observed\n            this.loadObj()\n        },\n        mounted() {\n            // Set default data\n            this.setDefaultData()\n\n            // Call Bank List\n            bankHandler.getAll()\n\t\t\t.then(res => {\n\t\t\t\tif(res){\n                    this.banks = res.data\n\t\t\t\t}\n            })\n\n            // Call Bank Account List\n            bankAccountHandler.getAll()\n            .then(res => {\n                if(res){\n                    this.bankAccountList = res.data\n                }\n            })\n\n            // Call Account List\n            accountHandler.getAll()\n            .then(res => {\n                if (res) {\n                    this.adjustmentAccounts = res.data\n                }\n            })\n        },\n    };\n</script>\n\n<style scoped>\n\n\n\n    @media (min-width: 1264px) {\n        .container {\n            max-width: 1080px !important;\n        }\n    }\n\n    table{\n        border-collapse: collapse;\n    }\n    table thead tr th{\n        border-top: 1px solid #000000;\n        border-bottom: 1px solid #000000;\n        border-left: 1px solid #000000;\n        border-right: 1px solid #000000;\n    }\n</style>\n"]}]}