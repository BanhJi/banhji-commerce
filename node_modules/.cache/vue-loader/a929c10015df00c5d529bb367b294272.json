{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/accounting/closing/VarianceReport.vue?vue&type=style&index=0&id=0fa7d94f&scoped=true&lang=css&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/accounting/closing/VarianceReport.vue","mtime":1638499443092},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYXR0YWNobWVudF90YWJsZS52LWRhdGEtdGFibGUgPiAudi1kYXRhLXRhYmxlX193cmFwcGVyID4gdGFibGUgPiB0aGVhZCA+IHRyID4gdGgsIC5hdHRhY2htZW50X3RhYmxlLnYtZGF0YS10YWJsZSA+IC52LWRhdGEtdGFibGVfX3dyYXBwZXIgPiB0YWJsZSA+IHRib2R5ID4gdHIgPiB0ZCB7CiAgICBib3JkZXItcmlnaHQ6IG5vbmUgIWltcG9ydGFudDsKfQpAbWVkaWEgKG1heC13aWR0aDogNTc2cHgpIHsKICAgIC5tdC02IHsKICAgICAgICBtYXJnaW4tdG9wOiAwICFpbXBvcnRhbnQ7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgIH0KICAgIC5yb3cgKyAucm93IHsKICAgICAgICBtYXJnaW4tdG9wOiAwICFpbXBvcnRhbnQ7CiAgICB9Cn0K"},{"version":3,"sources":["VarianceReport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VarianceReport.vue","sourceRoot":"src/views/accounting/closing","sourcesContent":["<template>\n    <v-row>\n        <v-col cols=\"12\" sm=\"12\" class=\"pt-3\">\n            <v-row>\n                <v-col cols=\"12\" sm=\"12\" class=\"py-0\">\n                    <h2 class=\"mb-3 font_20 float-left\">\n                        {{ $t(\"variance_report\") }}\n                    </h2>\n                </v-col> \n                <v-col cols=\"12\" sm=\"12\" class=\"py-0\">\n                    <v-row>\n                        <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n                            <label class=\"label pr-3\">{{$t('account_type')}}</label>\n                            <app-account-type-dropdownlist \n                                :initAccountType=\"accountType\" \n                                @emitAccountType=\"accountType = $event\" \n                                @onChanged=\"onAccountTypeChanges\"/>\n                        </v-col>\n                        <v-col cols=\"12\" sm=\"4\"  class=\"py-0\">\n                            <label class=\"label pr-3\">{{$t('account_group')}}</label>\n                            <app-account-group-dropdownlist \n                                :initAccountGroup=\"accountGroup\" \n                                @emitAccountGroup=\"accountGroup = $event\" \n                                :initAccountTypeCode=\"accountTypeCode\" />\n                        </v-col>\n                        <v-col cols=\"12\" sm=\"4\"  class=\"py-0\">\n                            <label class=\"label pr-3\">{{$t('segment')}}</label>\n                            <app-segment-dropdownlist :initialSegment=\"segment\" @emitSegment=\"segment = $event\" />\n                        </v-col>\n                    </v-row>\n                    <v-row>\n                        <v-col cols=\"12\" sm=\"4\"  class=\"py-0\">\n                            <label class=\"label pr-3\">{{$t('base_month')}}</label>\n                            <app-month-of-picker :initMonthOf=\"baseMonthOf\" @emitMonthOf=\"baseMonthOf = $event\" />\n                        </v-col>\n                        <v-col cols=\"12\" sm=\"4\"  class=\"py-0\">\n                            <label class=\"label pr-3\">{{$t('compare_month')}}</label>\n                            <app-month-of-picker :initMonthOf=\"compareMonthOf\" @emitMonthOf=\"compareMonthOf = $event\" />\n                        </v-col>\n                        <v-col cols=\"12\" sm=\"4\"  class=\"py-0\">\n                            <v-btn color=\"primary\"\n                                   class=\" white--text mt-6 float-right\"\n                                   @click=\"search\">\n                                {{$t('run_report')}}\n                            </v-btn>\n                        </v-col>\n                    </v-row>\n                </v-col>\n                <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                    <v-row>\n                        <v-col cols=\"12\" sm=\"8\" class=\"py-0\">\n                            <p class=\"mb-0 float-left\">\n                                {{ $t(\"variance_report_desc\") }}\n                            </p>\n                        </v-col>\n                        <v-col cols=\"12\" sm=\"4\"  class=\"py-0\">\n                            <app-variance-rule-dropdownlist \n                                :initVarianceRule=\"varianceRule\" \n                                @emitVarianceRule=\"varianceRule = $event\"\n                                @onChanged=\"applyRule\" />\n                        </v-col>\n                    </v-row>\n                </v-col>\n                <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                    <template>\n                        <v-data-table\n                            :headers=\"headers\"\n                            :items=\"varianceReports\"\n                            :items-per-page=\"50\"\n                            sort-by=\"account.number\"\n                            class=\"attachment_table elevation-1\">\n\n                            <!-- Account -->\n                            <template v-slot:[`item.account`]=\"{ item }\">\n                                {{ item.account.number }} - {{ item.account.name }}\n                            </template>\n\n                            <!-- Base Amount -->\n                            <template v-slot:[`item.selectedMonthBalance`]=\"{ item }\">\n                                {{ Number(item.selectedMonthBalance).toLocaleString() }}\n                            </template>\n\n                            <!-- Compare Amount -->\n                            <template v-slot:[`item.previouseMonthBalance`]=\"{ item }\">\n                                {{ Number(item.previouseMonthBalance).toLocaleString() }}\n                            </template>\n\n                            <!-- Variance Amount -->\n                            <template v-slot:[`item.variance`]=\"{ item }\">\n                                {{ Number(item.variance).toLocaleString() }}\n                            </template>\n\n                            <!-- Account -->\n                            <template v-slot:[`item.varianceRule`]=\"{ item }\">\n                                {{ item.varianceRule !== null ? item.varianceRule.name : '' }}\n                            </template>\n\n                        </v-data-table>\n                    </template>\n\n                    <LoadingMe\n                        :isLoading=\"showLoading\"\n                        :fullPage=\"true\"\n                        :myLoading=\"true\"\n                        :alertMessage=\"loadingAlert\"\n                        :color=\"loadingColorAlert\"\n                        :alertText=\"loadingTextAlert\"\n                    />\n\n                </v-col>\n            </v-row>\n        </v-col>\n    </v-row>\n</template>\n<script>\n    import {i18n} from '@/i18n';\n    import kendo from '@progress/kendo-ui';\n    import { VarianceRuleModel, AccountTypeModel, AccountGroupModel, SegmentModel } from \"@/scripts/model/AppModels\";\n\n    const { varianceReportHandler } = require(\"@/scripts/AppHandlers\");\n\n    export default {\n        components: {\n            \"LoadingMe\": () => import('@/components/Loading'),\n            'app-month-of-picker': ()=>import(\"@/components/kendo_templates/MonthOfPicker\"),\n            \"app-variance-rule-dropdownlist\": () => import('@/components/kendo_templates/VarianceRuleDropDownList'),\n            \"app-account-type-dropdownlist\": () => import('@/components/dropdownlist/AccountType'),\n            \"app-account-group-dropdownlist\": () => import('@/components/dropdownlist/AccountGroup'),\n            \"app-segment-dropdownlist\": () => import('@/components/dropdownlist/Segment'),\n        },\n        data: ()=>({\n            baseMonthOf : new Date().toISOString().substr(0, 7),\n            compareMonthOf : new Date().toISOString().substr(0, 7),\n            varianceRule: new VarianceRuleModel(),\n            accountType: new AccountTypeModel(),\n            accountGroup: new AccountGroupModel(),\n            segment: new SegmentModel(),\n            accountTypeCode: 0,\n            headers: [\n                { text: i18n.t(\"account\"), value: 'account' },\n                { text: i18n.t(\"base_month\"), value: 'selectedMonthBalance' },\n                { text: i18n.t(\"compare_month\"), value: 'previouseMonthBalance' },\n                { text: i18n.t(\"variance\"), value: 'variance' },\n                { text: i18n.t(\"variance_rule\"), value: 'varianceRule' },\n            ],\n            varianceReports: [],\n            varianceReportList: [],\n            // LoadingMe\n            showLoading: false,\n            loadingAlert: false,\n            loadingColorAlert: \"\",\n            loadingTextAlert: \"\",\n        }),\n        methods:  {\n            // On Account Type Changes\n            onAccountTypeChanges () {\n                this.accountTypeCode = this.accountType.code;\n            },\n            // Search\n            search () {\n\t\t\t\t// Empty dataSource\n\t\t\t\tthis.varianceReports = [];\n                this.varianceRule = new VarianceRuleModel();\n\t\t\t\t\n\t\t\t\tif(this.baseMonthOf && this.compareMonthOf){\n\t\t\t\t\t// Query\n\t\t\t\t\tthis.showLoading = true;\n\t\t\t\t\tvarianceReportHandler.getReport({\n\t\t\t\t\t\tparams : {\n\t\t\t\t\t\t\tmonth_of : kendo.toString(new Date(this.baseMonthOf), \"yyyy-MM\"),\n                            compare_month_of : kendo.toString(new Date(this.compareMonthOf), \"yyyy-MM\"),\n                            acc_type_code : this.accountType.code,\n                            acc_group_code : this.accountGroup.code,\n                            segment_uuid : this.segment.uuid,\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tif(res.data){\n\t\t\t\t\t\t\tthis.varianceReports = res.data;\n                            this.varianceReportList = res.data;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tthis.showLoading = false;\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n            applyRule () {\n                if(this.varianceRule.uuid !== ''){\n                    let varianList = [];\n\n                    this.varianceReportList.forEach(value => {\n                        switch (this.varianceRule.rule.toLowerCase()) {\n                            case \"amount\": // Amount Rule\n                                if(Math.abs(value.variance) >= this.varianceRule.value){\n                                    varianList.push(value);\n                                }\n                                break;\n\n                            case \"percentage\": // Percentage Rule\n                                var amtInPercentage = 0;\n                                if(value.previouseMonthBalance !== 0){\n                                    amtInPercentage = (value.selectedMonthBalance - value.previouseMonthBalance) / value.previouseMonthBalance;\n\n                                    if(Math.abs(amtInPercentage) >= this.varianceRule.value){\n                                        varianList.push(value);\n                                    }\n                                }else{\n                                    if(value.selectedMonthBalance !== 0){\n                                        varianList.push(value);\n                                    }\n                                }\n                                break;\n                        \n                            default:\n                                break;\n                        }\n                    });\n\n                    // Bind variance report by rule\n                    this.varianceReports = varianList;\n                }\n            },\n        },\n    }\n</script>\n<style scoped>\n    .attachment_table.v-data-table > .v-data-table__wrapper > table > thead > tr > th, .attachment_table.v-data-table > .v-data-table__wrapper > table > tbody > tr > td {\n        border-right: none !important;\n    }\n    @media (max-width: 576px) {\n        .mt-6 {\n            margin-top: 0 !important;\n            margin-bottom: 15px;\n        }\n        .row + .row {\n            margin-top: 0 !important;\n        }\n    }\n</style>"]}]}