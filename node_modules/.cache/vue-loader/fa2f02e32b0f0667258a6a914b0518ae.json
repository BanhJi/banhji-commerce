{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/order_sale/reports/sale_reports_analysis/ByCustomer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/order_sale/reports/sale_reports_analysis/ByCustomer.vue","mtime":1643702774582},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJbnZvaWNlTW9kZWwgZnJvbSAiQC9zY3JpcHRzL2ludm9pY2UvbW9kZWwvSW52b2ljZSI7CmltcG9ydCBrZW5kbyBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdWkiOwppbXBvcnQgTGlua1RlbXBsYXRlIGZyb20gIkAvY29tcG9uZW50cy9rZW5kb190ZW1wbGF0ZXMvTGlua1RlbXBsYXRlIjsKCmNvbnN0IGJpbGxpbmdIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2ludm9pY2UvaGFuZGxlci9iaWxsaW5nSGFuZGxlciIpOwpjb25zdCBpbnZvaWNlTW9kZWwgPSBuZXcgSW52b2ljZU1vZGVsKHt9KTsKCmltcG9ydCBKU1ppcCBmcm9tICJqc3ppcCI7CmNvbnN0ICQgPSBrZW5kby5qUXVlcnk7IC8vcmVxdWlyZSgianF1ZXJ5IikKCndpbmRvdy5KU1ppcCA9IEpTWmlwOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlNhbGVUcmFuc2FjdGlvbiIsCiAgY29tcG9uZW50czogewogICAgTG9hZGluZ01lOiAoKSA9PiBpbXBvcnQoYEAvY29tcG9uZW50cy9Mb2FkaW5nYCksCiAgICAiYXBwLWRhdGVwaWNrZXIiOiAoKSA9PgogICAgICBpbXBvcnQoYEAvY29tcG9uZW50cy9jdXN0b21fdGVtcGxhdGVzL0RhdGVQaWNrZXJDb21wb25lbnRgKSwKICB9LAogIGRhdGE6ICgpID0+ICh7CiAgICBsb2FkaW5nU2VhcmNoOiBmYWxzZSwKICAgIHN0YXJ0RGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCksCiAgICBlbmREYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKSwKICAgIGRhdGVTb3J0ZXJzOiBbCiAgICAgICJUb2RheSIsCiAgICAgICJUaGlzIFdlZWsiLAogICAgICAiVGhpcyBNb250aCIsCiAgICAgICJUaGlzIFllYXIiLAogICAgICAiTGFzdCBNb250aCIsCiAgICAgICJMYXN0IFllYXIiLAogICAgXSwKICAgIG1EYXRlU29ydGVyOiAiVG9kYXkiLAogICAgc2hvd0xvYWRpbmc6IGZhbHNlLAogICAgdHJhbnNhY3Rpb25zOiBbXSwKICAgIHRyYW5EUzogW10sCiAgICBzYWxlRm9ybUNvbnRlbnQ6IHt9LAogICAgaXNMb2FkZWQ6IGZhbHNlLAogICAgaW52b2ljZTogaW52b2ljZU1vZGVsLAogICAgdG90YWxSZXZlbnVlOiAwLAogICAgdG90YWxTYWxlTGVhZDogMCwKICAgIHRvdGFsU2FsZVF1b3RlOiAwLAogICAgdG90YWxTYWxlT3JkZXI6IDAsCiAgICBncm91cDogeyBmaWVsZDogIm5hbWUiIH0sCiAgICBzb3J0OiB7IGZpZWxkOiAicmVmZXJlbmNlTm8iLCBkaXI6ICJBU0MiIH0sCiAgICBhZ2dyZWdhdGVEZWZpbml0aW9uOiBbCiAgICAgIHsgZmllbGQ6ICJleGNoYW5nZUFtb3VudCIsIGFnZ3JlZ2F0ZTogInN1bSIgfSwKICAgICAgeyBmaWVsZDogImV4Y2hhbmdlU3ViVG90YWwiLCBhZ2dyZWdhdGU6ICJzdW0iIH0sCiAgICAgIHsgZmllbGQ6ICJleGNoYW5nZURpc2NvdW50VG90YWwiLCBhZ2dyZWdhdGU6ICJzdW0iIH0sCiAgICBdLAogICAgcGFnZWFibGU6IHsKICAgICAgYnV0dG9uQ291bnQ6IDUsCiAgICAgIGluZm86IGZhbHNlLAogICAgICB0eXBlOiAibnVtZXJpYyIsCiAgICAgIHBhZ2VTaXplczogZmFsc2UsCiAgICAgIHByZXZpb3VzTmV4dDogdHJ1ZSwKICAgIH0sCiAgICBwYXJhbXM6IHsKICAgICAgaXNEb25vcjogZmFsc2UsCiAgICAgIHNlYXJjaDogIiIsCiAgICAgIHR5cGU6ICJjdXMiLAogICAgICBrZXk6IHt9LAogICAgfSwKICAgIHBhZ2luZzoge30sCiAgICB0eG5CeUN1c3RvbWVyczogW10sCiAgICBkaXNhYmxlZE1lOiB0cnVlLAogICAgYWN0aW9uOiAiIiwKICB9KSwKICBtZXRob2RzOiB7CiAgICBwZGZFeHBvcnQ6IGZ1bmN0aW9uIChlKSB7CiAgICAgIC8vIGNvbnN0IHBpdm90ID0gdGhpcy4kcmVmcy5ncmlkVHJhbnNhY3Rpb25EUy5rZW5kb1dpZGdldCgpCiAgICAgIC8vIHBpdm90LnNhdmVBc1BERigpCiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygicGRmRXhwb3J0Iik7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhlLmRhdGEpOwogICAgfSwKICAgIHBhZ2VDaGFuZ2VIYW5kbGVyOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgYWxlcnQoImNoYW5nZSIsIGV2ZW50KTsKICAgIH0sCiAgICBvblNvcnRlckNoYW5nZXModmFsKSB7CiAgICAgIGxldCB0b2RheSA9IG5ldyBEYXRlKCk7CiAgICAgIHN3aXRjaCAodmFsKSB7CiAgICAgICAgY2FzZSAiVG9kYXkiOgogICAgICAgICAgdGhpcy5zdGFydERhdGUgPSBrZW5kby50b1N0cmluZyh0b2RheSwgInl5eXktTU0tZGQiKTsKICAgICAgICAgIHRoaXMuZW5kRGF0ZSA9IGtlbmRvLnRvU3RyaW5nKHRvZGF5LCAieXl5eS1NTS1kZCIpOwoKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgIlRoaXMgV2VlayI6CiAgICAgICAgICB2YXIgZmlyc3QgPSB0b2RheS5nZXREYXRlKCkgLSB0b2RheS5nZXREYXkoKSwKICAgICAgICAgICAgbGFzdCA9IGZpcnN0ICsgNjsKCiAgICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICBuZXcgRGF0ZSh0b2RheS5zZXREYXRlKGZpcnN0KSksCiAgICAgICAgICAgICJ5eXl5LU1NLWRkIgogICAgICAgICAgKTsKICAgICAgICAgIHRvZGF5ID0gbmV3IERhdGUoKTsKICAgICAgICAgIHRoaXMuZW5kRGF0ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICBuZXcgRGF0ZSh0b2RheS5zZXREYXRlKGxhc3QpKSwKICAgICAgICAgICAgInl5eXktTU0tZGQiCiAgICAgICAgICApOwoKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgIlRoaXMgTW9udGgiOgogICAgICAgICAgdGhpcy5zdGFydERhdGUgPSBrZW5kby50b1N0cmluZygKICAgICAgICAgICAgbmV3IERhdGUodG9kYXkuZ2V0RnVsbFllYXIoKSwgdG9kYXkuZ2V0TW9udGgoKSwgMSksCiAgICAgICAgICAgICJ5eXl5LU1NLWRkIgogICAgICAgICAgKTsKICAgICAgICAgIHRoaXMuZW5kRGF0ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICBuZXcgRGF0ZSh0b2RheS5nZXRGdWxsWWVhcigpLCB0b2RheS5nZXRNb250aCgpLCAzMSksCiAgICAgICAgICAgICJ5eXl5LU1NLWRkIgogICAgICAgICAgKTsKCiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJUaGlzIFllYXIiOgogICAgICAgICAgdGhpcy5zdGFydERhdGUgPSBrZW5kby50b1N0cmluZygKICAgICAgICAgICAgbmV3IERhdGUodG9kYXkuZ2V0RnVsbFllYXIoKSwgMCwgMSksCiAgICAgICAgICAgICJ5eXl5LU1NLWRkIgogICAgICAgICAgKTsKICAgICAgICAgIHRoaXMuZW5kRGF0ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICBuZXcgRGF0ZSh0b2RheS5nZXRGdWxsWWVhcigpLCAxMSwgMzEpLAogICAgICAgICAgICAieXl5eS1NTS1kZCIKICAgICAgICAgICk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJMYXN0IE1vbnRoIjoKICAgICAgICAgIHRoaXMuc3RhcnREYXRlID0ga2VuZG8udG9TdHJpbmcoCiAgICAgICAgICAgIG5ldyBEYXRlKHRvZGF5LmdldEZ1bGxZZWFyKCksIHRvZGF5LmdldE1vbnRoKCksIC0zMCksCiAgICAgICAgICAgICJ5eXl5LU1NLWRkIgogICAgICAgICAgKTsKICAgICAgICAgIHRoaXMuZW5kRGF0ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICBuZXcgRGF0ZSh0b2RheS5nZXRGdWxsWWVhcigpLCB0b2RheS5nZXRNb250aCgpIC0gMSwgKzMxKSwKICAgICAgICAgICAgInl5eXktTU0tZGQiCiAgICAgICAgICApOwoKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgIkxhc3QgWWVhciI6CiAgICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICBuZXcgRGF0ZSh0b2RheS5nZXRGdWxsWWVhcigpLCAtMTEsIC0zMCksCiAgICAgICAgICAgICJ5eXl5LU1NLWRkIgogICAgICAgICAgKTsKICAgICAgICAgIHRoaXMuZW5kRGF0ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICBuZXcgRGF0ZSh0b2RheS5nZXRGdWxsWWVhcigpLCAtMSwgKzMxKSwKICAgICAgICAgICAgInl5eXktTU0tZGQiCiAgICAgICAgICApOwoKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9ICIiOwogICAgICAgICAgdGhpcy5lbmREYXRlID0gIiI7CiAgICAgIH0KICAgIH0sCiAgICBudW1iZXJGb3JtYXQodmFsdWUpIHsKICAgICAgcmV0dXJuIGtlbmRvLnRvU3RyaW5nKHZhbHVlLCBgbiR7dGhpcy5zYWxlRm9ybUNvbnRlbnQuZGVjaW1hbH1gKTsKICAgIH0sCiAgICByZWZlcmVuY2VUZW1wbGF0ZShkYXRhKSB7CiAgICAgIGxldCB1cmwgPSAiIjsKICAgICAgaWYgKGRhdGEudHlwZSA9PT0gIkludm9pY2UiKSB7CiAgICAgICAgdXJsID0gYGludm9pY2Vfdmlldy8ke2RhdGEuaWR9YDsKICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09ICJTYWxlIERlcG9zaXQiKSB7CiAgICAgICAgdXJsID0gYHNhbGVfZGVwb3NpdF92aWV3LyR7ZGF0YS5pZH1gOwogICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gIlB1cmNoYXNlIikgewogICAgICAgIHVybCA9IGBjcmVkaXRfcHVyY2hhc2Vfdmlldy8ke2RhdGEuaWR9YDsKICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09ICJTYWxlIFF1b3RlIikgewogICAgICAgIHVybCA9IGBzYWxlX3F1b3RlX3ZpZXcvJHtkYXRhLmlkfWA7CiAgICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSAiQ2FzaCBSZWNlaXB0IikgewogICAgICAgIHVybCA9IGBjYXNoX3JlY2VpcHRfdmlldy8ke2RhdGEuaWR9YDsKICAgICAgfSBlbHNlIGlmIChkYXRhLnR5cGUgPT09ICJTYWxlIE9yZGVyIikgewogICAgICAgIHVybCA9IGBzYWxlX29yZGVyX3ZpZXcvJHtkYXRhLmlkfWA7CiAgICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSAiUHVyY2hhc2UgRGVwb3NpdCIpIHsKICAgICAgICB1cmwgPSBgcHVyY2hhc2VfZGVwb3NpdF92aWV3LyR7ZGF0YS5pZH1gOwogICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gIkNyZWRpdCBNZW1vIikgewogICAgICAgIHVybCA9IGBzYWxlX3JldHVybl92aWV3LyR7ZGF0YS5pZH1gOwogICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gIkRlYml0IE1lbW8iKSB7CiAgICAgICAgdXJsID0gYHB1cmNoYXNlX3JldHVybl92aWV3LyR7ZGF0YS5pZH1gOwogICAgICB9IGVsc2UgaWYgKGRhdGEudHlwZSA9PT0gIkNhc2ggUGF5bWVudCIpIHsKICAgICAgICB1cmwgPSBgY2FzaF9wYXltZW50X3ZpZXcvJHtkYXRhLmlkfWA7CiAgICAgIH0gZWxzZSBpZiAoZGF0YS50eXBlID09PSAiU2FsZSBMZWFkIikgewogICAgICAgIHVybCA9IGBsZWFkLyR7ZGF0YS5pZH1gOwogICAgICB9CiAgICAgIGNvbnN0IHJlZkZyb20gPSBkYXRhLnJlZkZyb20gfHwgW107CiAgICAgIGNvbnN0IHJlZlRvID0gZGF0YS5yZWZUbyB8fCBbXTsKICAgICAgbGV0IGFyZ3MgPSB7CiAgICAgICAgdGV4dDogZGF0YS5yZWZlcmVuY2VObywKICAgICAgICByZWxhdGVkOiAhIXJlZkZyb20ubGVuZ3RoID4gMCB8fCAhIXJlZlRvLmxlbmd0aCA+IDAsCiAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgZGF0YTogZGF0YSwKICAgICAgfTsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJyZWxhdGVkIiwgcmVmRnJvbSwgISFyZWZGcm9tLmxlbmd0aCA+IDApOwogICAgICByZXR1cm4gewogICAgICAgIHRlbXBsYXRlOiBMaW5rVGVtcGxhdGUsCiAgICAgICAgdGVtcGxhdGVBcmdzOiBhcmdzLAogICAgICB9OwogICAgfSwKICAgIGdvVG9Db252ZXJ0KGUpIHsKICAgICAgdGhpcy5uZXdDbGljayA9IGZhbHNlOwogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIC8vIGxldCBncmlkID0ga2VuZG8ualF1ZXJ5KCIjZ3JpZEFkZHJlc3MiKS5kYXRhKCJrZW5kb0dyaWQiKQogICAgICAvLyBsZXQgZGF0YUl0ZW0gPSBncmlkLmRhdGFJdGVtKCQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCJ0ciIpKQogICAgICAvLyB0aGlzLmFkZHJlc3MgPSBkYXRhSXRlbQogICAgICAvLyB0aGlzLm1Db3VudHJ5ID0gZGF0YUl0ZW0uY291bnRyeQogICAgICAvLyB0aGlzLmRpYWxvZ00yID0gdHJ1ZQogICAgfSwKICAgIHJvd051bWJlclRtcGwoZGF0YUl0ZW0pIHsKICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5ncmlkVHJhbnNhY3Rpb25EUy5rZW5kb1dpZGdldCgpLAogICAgICAgIGluZGV4ID0gZHMuaW5kZXhPZihkYXRhSXRlbSk7CiAgICAgIHJldHVybiBpbmRleCArIDE7CiAgICB9LAogICAgYXN5bmMgbG9hZFRyYW5zYWN0aW9ucygpIHsKICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIHJlc29sdmUoInJlc29sdmVkIik7CiAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIGJpbGxpbmdIYW5kbGVyLmxpc3QoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb25zID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSByZXMuZGF0YS5yZXN1bHQ7CiAgICAgICAgICAgICAgdGhpcy50b3RhbFJldmVudWUgPSBrZW5kby50b1N0cmluZygKICAgICAgICAgICAgICAgIHJlc3VsdC5SZXZlbnVlLAogICAgICAgICAgICAgICAgcmVzdWx0LmRlY2ltYWxGb3JtYXQKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHRoaXMudG90YWxTYWxlTGVhZCA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICAgICAgcmVzdWx0LlNhbGVMZWFkLAogICAgICAgICAgICAgICAgcmVzdWx0LmRlY2ltYWxGb3JtYXQKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHRoaXMudG90YWxTYWxlT3JkZXIgPSBrZW5kby50b1N0cmluZygKICAgICAgICAgICAgICAgIHJlc3VsdC5TYWxlT3JkZXIsCiAgICAgICAgICAgICAgICByZXN1bHQuZGVjaW1hbEZvcm1hdAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgdGhpcy50b3RhbFNhbGVRdW90ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICAgICAgcmVzdWx0LlNhbGVRdW90ZSwKICAgICAgICAgICAgICAgIHJlc3VsdC5kZWNpbWFsRm9ybWF0CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB9KTsKICAgICAgICB9LCAxMCk7CiAgICAgIH0pOwogICAgfSwKCiAgICBhc3luYyBzZWFyY2hUcmFuc2FjdGlvbih0eXBlKSB7CiAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICByZXNvbHZlKCJyZXNvbHZlZCIpOwogICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgICAgICB0aGlzLmxvYWRpbmdTZWFyY2ggPSB0cnVlOwogICAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gdGhpcy5zdGFydERhdGU7CiAgICAgICAgICBjb25zdCBlbmREYXRlID0gdGhpcy5lbmREYXRlOwogICAgICAgICAgdGhpcy5wYXJhbXMgPSB7CiAgICAgICAgICAgIHNlYXJjaDogIiIsCiAgICAgICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgICAgIHN0YXJ0OiBzdGFydERhdGUsCiAgICAgICAgICAgIGVuZDogZW5kRGF0ZSwKICAgICAgICAgICAga2V5OiB0aGlzLnBhZ2luZywKICAgICAgICAgICAgaXNTdW1tYXJpemU6IDAsCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5kaXNhYmxlZE5leHRQYWdlKHRydWUpOwogICAgICAgICAgYmlsbGluZ0hhbmRsZXIubGlzdCh0aGlzLnBhcmFtcykudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZWFyY2ggPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJpbSBzZWFyY2giLCByZXMpOwogICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IHJlcy5kYXRhLmRhdGEgfHwgW107CiAgICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbnMgPSByZXNwb25zZURhdGE7CiAgICAgICAgICAgICAgdGhpcy5wYWdpbmcgPSByZXMuZGF0YS5rZXk7CiAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJrZXkiLCByZXMuZGF0YS5rZXkpOwogICAgICAgICAgICAgIHRoaXMudHhuQnlDdXN0b21lcnMucHVzaChyZXNwb25zZURhdGEpOwogICAgICAgICAgICAgIC8vICAgY29uc3QgcmVzdWx0ID0gcmVzLmRhdGEucmVzdWx0OwogICAgICAgICAgICAgIC8vICAgdGhpcy50b3RhbFJldmVudWUgPSBrZW5kby50b1N0cmluZygKICAgICAgICAgICAgICAvLyAgICAgcmVzdWx0LlJldmVudWUsCiAgICAgICAgICAgICAgLy8gICAgIHJlc3VsdC5kZWNpbWFsRm9ybWF0CiAgICAgICAgICAgICAgLy8gICApOwogICAgICAgICAgICAgIC8vICAgdGhpcy50b3RhbFNhbGVMZWFkID0ga2VuZG8udG9TdHJpbmcoCiAgICAgICAgICAgICAgLy8gICAgIHJlc3VsdC5TYWxlTGVhZCwKICAgICAgICAgICAgICAvLyAgICAgcmVzdWx0LmRlY2ltYWxGb3JtYXQKICAgICAgICAgICAgICAvLyAgICk7CiAgICAgICAgICAgICAgLy8gICB0aGlzLnRvdGFsU2FsZU9yZGVyID0ga2VuZG8udG9TdHJpbmcoCiAgICAgICAgICAgICAgLy8gICAgIHJlc3VsdC5TYWxlT3JkZXIsCiAgICAgICAgICAgICAgLy8gICAgIHJlc3VsdC5kZWNpbWFsRm9ybWF0CiAgICAgICAgICAgICAgLy8gICApOwogICAgICAgICAgICAgIC8vICAgdGhpcy50b3RhbFNhbGVRdW90ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICAgIC8vICAgICByZXN1bHQuU2FsZVF1b3RlLAogICAgICAgICAgICAgIC8vICAgICByZXN1bHQuZGVjaW1hbEZvcm1hdAogICAgICAgICAgICAgIC8vICAgKTsKCiAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMucGFnaW5nKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkTmV4dFBhZ2UoZmFsc2UpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVkTmV4dFBhZ2UodHJ1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRoaXMuaXRlbVJldHVuZWQodGhpcyk7CiAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKAogICAgICAgICAgICAgICAgInR4bkJ5Q3VzdG9tZXJzIiwKICAgICAgICAgICAgICAgIHRoaXMudHhuQnlDdXN0b21lcnMsCiAgICAgICAgICAgICAgICByZXMuZGF0YS5rZXkKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlYXJjaCA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwgMTApOwogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyB0cmFuc2FjdGlvblN1bW1hcml6ZSh0eXBlKSB7CiAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICByZXNvbHZlKCJyZXNvbHZlZCIpOwogICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IHRydWU7CiAgICAgICAgICB0aGlzLmxvYWRpbmdTZWFyY2ggPSB0cnVlOwogICAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gdGhpcy5zdGFydERhdGU7CiAgICAgICAgICBjb25zdCBlbmREYXRlID0gdGhpcy5lbmREYXRlOwogICAgICAgICAgdGhpcy5wYXJhbXMgPSB7CiAgICAgICAgICAgIHNlYXJjaDogIiIsCiAgICAgICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgICAgIHN0YXJ0OiBzdGFydERhdGUsCiAgICAgICAgICAgIGVuZDogZW5kRGF0ZSwKICAgICAgICAgICAgaXNTdW1tYXJpemU6IDEsCiAgICAgICAgICAgIGtleToge30sCiAgICAgICAgICB9OwogICAgICAgICAgYmlsbGluZ0hhbmRsZXIubGlzdCh0aGlzLnBhcmFtcykudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZWFyY2ggPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gcmVzLmRhdGEuZGF0YVswXSB8fCB7fTsKICAgICAgICAgICAgICB0aGlzLnRvdGFsUmV2ZW51ZSA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICAgICAgcmVzdWx0LlJldmVudWUsCiAgICAgICAgICAgICAgICByZXN1bHQuZGVjaW1hbEZvcm1hdAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgdGhpcy50b3RhbFNhbGVMZWFkID0ga2VuZG8udG9TdHJpbmcoCiAgICAgICAgICAgICAgICByZXN1bHQuU2FsZUxlYWQsCiAgICAgICAgICAgICAgICByZXN1bHQuZGVjaW1hbEZvcm1hdAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgdGhpcy50b3RhbFNhbGVPcmRlciA9IGtlbmRvLnRvU3RyaW5nKAogICAgICAgICAgICAgICAgcmVzdWx0LlNhbGVPcmRlciwKICAgICAgICAgICAgICAgIHJlc3VsdC5kZWNpbWFsRm9ybWF0CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB0aGlzLnRvdGFsU2FsZVF1b3RlID0ga2VuZG8udG9TdHJpbmcoCiAgICAgICAgICAgICAgICByZXN1bHQuU2FsZVF1b3RlLAogICAgICAgICAgICAgICAgcmVzdWx0LmRlY2ltYWxGb3JtYXQKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlYXJjaCA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwgMTApOwogICAgICB9KTsKICAgIH0sCiAgICBvblNlYXJjaCh0eXBlKSB7CiAgICAgIHRoaXMuYWN0aW9uID0gdHlwZTsKICAgICAgdGhpcy50eG5CeUN1c3RvbWVycyA9IFtdOwogICAgICAvLyAgICQoIi5rLXBhZ2VyLXdyYXAiKS5lbXB0eSgpOwogICAgICAvLyAgICQoIi5ieWN1cy1wYWdlLW51bWJlciIpLmVtcHR5KCk7CiAgICAgIHRoaXMubG9hZFBhZ2UodGhpcyk7CiAgICAgIHRoaXMucGFnaW5nID0ge307CiAgICAgIC8vICAgdGhpcy5wYXJhbXMgPSB7CiAgICAgIC8vICAgICBzZWFyY2g6ICIiLAogICAgICAvLyAgICAgdHlwZTogdHlwZSwKICAgICAgLy8gICAgIHN0YXJ0OiB0aGlzLnN0YXJ0RGF0ZSwKICAgICAgLy8gICAgIGVuZDogdGhpcy5lbmREYXRlLAogICAgICAvLyAgICAga2V5OiB7fSwKICAgICAgLy8gICB9OwogICAgICB0aGlzLnNlYXJjaFRyYW5zYWN0aW9uKHR5cGUpOwogICAgICB0aGlzLnRyYW5zYWN0aW9uU3VtbWFyaXplKHR5cGUpOwogICAgfSwKICAgIGRhdGVGb3JtYXQoZGF0YUl0ZW0pIHsKICAgICAgcmV0dXJuIGtlbmRvLnRvU3RyaW5nKAogICAgICAgIG5ldyBEYXRlKGRhdGFJdGVtLnRyYW5zYWN0aW9uRGF0ZSksCiAgICAgICAgYCR7dGhpcy5pbnZvaWNlLmRhdGVGb3JtYXR9YAogICAgICApOwogICAgfSwKICAgIC8vIGxpbmtUbyhkYXRhSXRlbSkgewogICAgLy8gICAgIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhSXRlbSkKICAgIC8vICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAvLyAgICAgICAgIHBhdGg6ICdpbnZvaWNlJyArIGAvJHtkYXRhSXRlbS5pZH1gLAogICAgLy8gICAgICAgICBwYXJhbXM6IHtpZDogZGF0YUl0ZW0uaWR9LAogICAgLy8gICAgICAgICBxdWVyeToge3R5cGU6ICdlZGl0J30KICAgIC8vICAgICB9KQogICAgLy8gfSwKICAgIHN0YXR1cyhkYXRhSXRlbSkgewogICAgICBsZXQgc3RhdHVzID0gIiIsCiAgICAgICAgdHlwZSA9IGRhdGFJdGVtLnR5cGUgfHwgIiI7CiAgICAgIHN3aXRjaCAoZGF0YUl0ZW0uc3RhdHVzKSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgc3RhdHVzID0gIk9wZW4iOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgaWYgKAogICAgICAgICAgICB0eXBlID09PSAiU2FsZSBMZWFkIiB8fAogICAgICAgICAgICB0eXBlID09PSAiU2FsZSBRdW90ZSIgfHwKICAgICAgICAgICAgdHlwZSA9PT0gIlNhbGUgT3JkZXIiCiAgICAgICAgICApIHsKICAgICAgICAgICAgc3RhdHVzID0gIkFwcGxpZWQiOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RhdHVzID0gIlBhcnRpYWxseSBQYWlkIjsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHN0YXR1cyA9ICJQYWlkIjsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHN0YXR1cyA9ICJWb2lkIjsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIHJldHVybiBzdGF0dXM7CiAgICB9LAogICAgY2FsbGJhY2soKSB7CiAgICAgIGlmICgKICAgICAgICB0aGlzLiRyb3V0ZS5wYXJhbXMgIT09IG51bGwgJiYKICAgICAgICB0aGlzLiRyb3V0ZS5wYXJhbXMuaGFzT3duUHJvcGVydHkoImRhdGEiKQogICAgICApIHsKICAgICAgICBjb25zdCBkYXRhID0gdGhpcy4kcm91dGUucGFyYW1zLmRhdGE7CiAgICAgICAgaWYgKGRhdGEudHJhbnNhY3Rpb25UeXBlID09PSAiZGVsZXRlIikgewogICAgICAgICAgdGhpcy5sb2FkVHJhbnNhY3Rpb25zKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygiaW0gY2hhbmdlZCIsIHRoaXMuJHJvdXRlLnBhcmFtcyk7CiAgICB9LAogICAgYXN5bmMgbG9hZFBhZ2UodGhhdCkgewogICAgICAkKCIuYnljdXMtcGFnZXIgLmstcGFnZXItd3JhcCIpLmh0bWwoYAogICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJsYWJlbCBieWN1cy1pdGVtLXJldHVybmVkIj4wPC9sYWJlbD4KICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiAncm93JyI+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnljdXMtbmV4dC1wYWdlIiB0aXRsZT0icHJldmlvdXMiIHN0eWxlPSJ3aWR0aDogMjRweDsgZm9udC1zaXplOiAxOXB4OyI+IDwgPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPHVsIGNsYXNzPSJieWN1cy1wYWdlLW51bWJlciIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7bGlzdC1zdHlsZTogbm9uZTsgcGFkZGluZy1sZWZ0OiAwcHg7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGxpIHN0eWxlPSJwYWRkaW5nOiA2cHg7IiAgZGF0YS1wYWdlPSIxIiBjbGFzcz0iYnljdXMtcGFnZS1saW5rIHRleHQtYm9sZC1saW5rIiA+MTwvbGk+CiAgICAgICAgICAgICAgICAgICAgPC91bD4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJieWN1cy1uZXh0LXBhZ2UiIHRpdGxlPSJuZXh0IiBzdHlsZT0id2lkdGg6IDI0cHg7IGZvbnQtc2l6ZTogMTlweDsiPiA+IDwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIGApOwogICAgICAkKGRvY3VtZW50KS5vbigiY2xpY2siLCAiLmJ5Y3VzLXBhZ2UtbGluayIsIGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zdCBwYWdlID0gJCh0aGlzKS5kYXRhKCJwYWdlIik7CiAgICAgICAgJCgiLmJ5Y3VzLXBhZ2UtbGluayIpLnJlbW92ZUNsYXNzKCJ0ZXh0LWJvbGQtbGluayIpOwogICAgICAgICQodGhpcykuYWRkQ2xhc3MoInRleHQtYm9sZC1saW5rIik7CiAgICAgICAgdGhhdC5iYWNrVG9QYWdlKHRoYXQsIHBhZ2UgLSAxKTsKICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cocGFnZSAtIDEpOwogICAgICB9KTsKICAgICAgLy8gJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5ieWN1cy1uZXh0LXBhZ2UnLCBmdW5jdGlvbiAoKSB7CiAgICAgICQoIi5ieWN1cy1uZXh0LXBhZ2UiKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc3QgcGFnZV9udW1iZXIgPSAkKHRoaXMpCiAgICAgICAgICAucGFyZW50KCkKICAgICAgICAgIC5jaGlsZHJlbigiLmJ5Y3VzLXBhZ2UtbnVtYmVyIikKICAgICAgICAgIC5maW5kKCJsaSIpCiAgICAgICAgICAubGFzdCgpCiAgICAgICAgICAuZGF0YSgicGFnZSIpOwogICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygiYnljdXMtcGFnZV9udW1iZXIiLCBwYWdlX251bWJlcik7CiAgICAgICAgY29uc3QgaXNQcmV2aW91cyA9ICQodGhpcykuYXR0cigidGl0bGUiKTsKICAgICAgICBpZiAoaXNQcmV2aW91cyA9PSAicHJldmlvdXMiKSB7CiAgICAgICAgICBjb25zdCBjdXJyZWN0cGFnZSA9ICQoIi50ZXh0LWJvbGQtbGluayIpLmRhdGEoInBhZ2UiKTsKCiAgICAgICAgICBpZiAoY3VycmVjdHBhZ2UgPT0gMSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICAkKCIuYnljdXMtcGFnZS1saW5rIikucmVtb3ZlQ2xhc3MoInRleHQtYm9sZC1saW5rIik7CiAgICAgICAgICAkKGAuYnljdXMtcGFnZS1saW5rOmVxKCR7Y3VycmVjdHBhZ2UgLSAxfSlgKS5hZGRDbGFzcygKICAgICAgICAgICAgInRleHQtYm9sZC1saW5rIgogICAgICAgICAgKTsKICAgICAgICAgIHRoYXQuYmFja1RvUGFnZSh0aGF0LCBjdXJyZWN0cGFnZSAtIDIpOwogICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJ0aGlzIGN1cnJlY3RwYWdlIGJhY2siLCBjdXJyZWN0cGFnZSAtIDIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkKCIuYnljdXMtcGFnZS1saW5rIikucmVtb3ZlQ2xhc3MoInRleHQtYm9sZC1saW5rIik7CiAgICAgICAgICB0aGF0LnBhcmFtcyA9IHsKICAgICAgICAgICAgc2VhcmNoOiB0aGF0LnNlYXJjaCB8fCAiIiwKICAgICAgICAgICAgdHlwZTogdGhhdC5hY3Rpb24sCiAgICAgICAgICAgIHN0YXJ0OiB0aGF0LnN0YXJ0RGF0ZSwKICAgICAgICAgICAgZW5kOiB0aGF0LmVuZERhdGUsCiAgICAgICAgICAgIGtleTogdGhhdC5wYWdpbmcsCiAgICAgICAgICB9OwogICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJwYXJhbXMiLCB0aGF0LnBhcmFtcyk7CiAgICAgICAgICB0aGF0LnNlYXJjaFRyYW5zYWN0aW9uKHRoYXQuYWN0aW9uKTsKICAgICAgICAgICQodGhpcykKICAgICAgICAgICAgLnBhcmVudCgpCiAgICAgICAgICAgIC5jaGlsZHJlbigiLmJ5Y3VzLXBhZ2UtbnVtYmVyIikKICAgICAgICAgICAgLmFwcGVuZCgKICAgICAgICAgICAgICBgPGxpIGNsYXNzPSJieWN1cy1wYWdlLWxpbmsgdGV4dC1ib2xkLWxpbmsiIHN0eWxlPSJwYWRkaW5nOiA2cHg7IiBkYXRhLXBhZ2U9IiR7CiAgICAgICAgICAgICAgICBwYWdlX251bWJlciArIDEKICAgICAgICAgICAgICB9Ij4ke3BhZ2VfbnVtYmVyICsgMX08L2xpPmAKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJ0aGlzIiwgcGFnZV9udW1iZXIgKyAxKTsKICAgICAgfSk7CiAgICB9LAogICAgaXRlbVJldHVuZWQodGhhdCkgewogICAgICBsZXQgdG90YWxSb3cgPSAwOwogICAgICB0aGF0LnR4bkJ5Q3VzdG9tZXJzLmZvckVhY2goKGspID0+IHsKICAgICAgICB0b3RhbFJvdyArPSBrLmxlbmd0aDsKICAgICAgfSk7CiAgICAgICQoIi5ieWN1cy1pdGVtLXJldHVybmVkIikudGV4dCgiSXRlbXMgcmV0dXJuZWQgKCIgKyB0b3RhbFJvdyArICIpIik7CiAgICB9LAogICAgZGlzYWJsZWROZXh0UGFnZSh2YWx1ZSkgewogICAgICAkKCIuYnljdXMtbmV4dC1wYWdlIikucHJvcCgiZGlzYWJsZWQiLCB2YWx1ZSk7CiAgICB9LAogICAgYmFja1RvUGFnZSh0aGF0LCBpbmRleCkgewogICAgICB0cnkgewogICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygKICAgICAgICAgICJMZW5ndGggb2YgdHhuQnlDdXN0b21lcnMiLAogICAgICAgICAgdGhhdC50eG5CeUN1c3RvbWVycy5sZW5ndGgKICAgICAgICApOwogICAgICAgIGNvbnN0IGJ5Q3VzdG9tZXIgPSB0aGF0LnR4bkJ5Q3VzdG9tZXJzLmF0KGluZGV4KTsKICAgICAgICB0aGF0LnRyYW5zYWN0aW9ucyA9IGJ5Q3VzdG9tZXI7CiAgICAgICAgLy8gdGhhdC5yZWZyZXNoR3JpZERhdGEoY3VzdG9tZXIpCiAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJ0aGF0LnR4bkJ5Q3VzdG9tZXJzW2luZGV4XSIsIGJ5Q3VzdG9tZXIpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKCJFUlJPUiBvbiBiYWNrVG9QYWdlIiwgaW5kZXgpOwogICAgICB9CiAgICB9LAogICAgcmVmcmVzaEdyaWREYXRhKGRhdGEpIHsKICAgICAgJCgiI2dyaWRUcmFuc2FjdGlvbiIpLmRhdGEoImtlbmRvR3JpZCIpLmRhdGFTb3VyY2UuZGF0YShbXSk7CiAgICAgICQoIiNncmlkVHJhbnNhY3Rpb24iKS5kYXRhKCJrZW5kb0dyaWQiKS5kYXRhU291cmNlLmRhdGEoZGF0YSk7CiAgICB9LAogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIHRoaXMuZ3JvdXAgPSBbCiAgICAgIHsKICAgICAgICBmaWVsZDogIm5hbWUiLAogICAgICAgIGFnZ3JlZ2F0ZXM6IHRoaXMuYWdncmVnYXRlRGVmaW5pdGlvbiwKICAgICAgfSwKICAgIF07CiAgICAvLyBhd2FpdCB0aGlzLnNlYXJjaFRyYW5zYWN0aW9uKCIiKTsKICAgICQoZG9jdW1lbnQpLm9uKCJjbGljayIsICIuay1wYWdlci1uYXYiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygidGhpcyIsICQodGhpcykuZGF0YSgicGFnZSIpKTsKICAgIH0pOwogIH0sCiAgY29tcHV0ZWQ6IHsKICB9LAogIHdhdGNoOiB7CiAgICAvLyAkcm91dGU6ICJjYWxsYmFjayIsCiAgfSwKfTsK"},{"version":3,"sources":["ByCustomer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuTA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ByCustomer.vue","sourceRoot":"src/views/order_sale/sale_reports_analysis","sourcesContent":["<template>\n  <v-row>\n    <v-col sm=\"12\" cols=\"12\" class=\"grayBg px-6\">\n      <v-card color=\"white\" class=\"pa-3 no_border\" elevation=\"0\">\n        <h2 class=\"mb-0 font_20\">{{ $t(\"sale_by_customers\") }}</h2>\n        <p class=\"mb-2\">{{ $t(\"sale_by_customers_desc\") }}</p>\n        <LoadingMe\n          :isLoading=\"showLoading\"\n          :fullPage=\"false\"\n          type=\"loading\"\n          :myLoading=\"true\"\n        >\n        </LoadingMe>\n        <v-row>\n          <v-col sm=\"4\" cols=\"12\" class=\"py-0\">\n            <v-select\n              class=\"mt-1\"\n              :items=\"dateSorters\"\n              v-model=\"mDateSorter\"\n              @change=\"onSorterChanges\"\n              clearable\n              outlined\n              placeholder=\"ALL\"\n            />\n          </v-col>\n\n          <v-col sm=\"3\" cols=\"12\" class=\"py-0\">\n            <app-datepicker\n              :initialDate=\"startDate\"\n              @emitDate=\"startDate = $event\"\n            />\n          </v-col>\n\n          <v-col sm=\"3\" cols=\"12\" class=\"py-0\">\n            <app-datepicker\n              :initialDate=\"endDate\"\n              @emitDate=\"endDate = $event\"\n            />\n          </v-col>\n\n          <v-col sm=\"1\" cols=\"1\" class=\"pt-1\">\n            <v-btn\n              color=\"primary white--text\"\n              :loading=\"loadingSearch\"\n              @click=\"onSearch('')\"\n            >\n              <i\n                class=\"b-search\"\n                style=\"font-size: 18px; color: #fff !important\"\n              />\n            </v-btn>\n          </v-col>\n        </v-row>\n        <v-row class=\"mt-0\">\n          <v-col sm=\"3\" cols=\"12\" class=\"pt-0\">\n            <v-card\n              outlined\n              dense\n              class=\"pa-3 no_border rounded-4 white--text\"\n              color=\"third\"\n              height=\"60px\"\n              @click=\"onSearch('Invoice')\"\n            >\n              <h3 class=\"text-left flex-1 font_12 text-uppercase\">\n                {{ $t(\"total_revenue\") }}\n              </h3>\n              <h3 class=\"font_20 mt-0 flex-1 text-right white--text\">\n                {{ numberFormat(totalRevenue) }}\n              </h3>\n            </v-card>\n          </v-col>\n          <v-col sm=\"3\" cols=\"12\" class=\"pt-0\">\n            <v-card\n              outlined\n              dense\n              color=\"third\"\n              class=\"pa-3 rounded-4 no_border white--text\"\n              height=\"60px\"\n              @click=\"onSearch('Sale Lead')\"\n            >\n              <h3 class=\"text-left flex-1 font_12 text-uppercase\">\n                {{ $t(\"open_lead\") }}\n              </h3>\n              <h3 class=\"font_20 mt-0 flex-1 text-right white--text\">\n                {{ numberFormat(totalSaleLead) }}\n              </h3>\n            </v-card>\n          </v-col>\n          <v-col sm=\"3\" cols=\"12\" class=\"pt-0\">\n            <v-card\n              outlined\n              dense\n              color=\"third\"\n              class=\"pa-3 rounded-4 no_border white--text\"\n              height=\"60px\"\n              @click=\"onSearch('Sale Quote')\"\n            >\n              <h3 class=\"text-left flex-1 font_12 text-uppercase\">\n                {{ $t(\"open_sale_quote\") }}\n              </h3>\n              <h3 class=\"font_20 mt-0 flex-1 text-right white--text\">\n                {{ numberFormat(totalSaleQuote) }}\n              </h3>\n            </v-card>\n          </v-col>\n          <v-col sm=\"3\" cols=\"12\" class=\"pt-0\">\n            <v-card\n              outlined\n              dense\n              class=\"pa-3 rounded-4 no_border white--text\"\n              color=\"third\"\n              height=\"60px\"\n              @click=\"onSearch('Sale Order')\"\n            >\n              <h3 class=\"text-left flex-1 font_12 text-uppercase\">\n                {{ $t(\"open_sale_order\") }}\n              </h3>\n              <h3 class=\"font_20 mt-0 flex-1 text-right white--text\">\n                {{ numberFormat(totalSaleOrder) }}\n              </h3>\n            </v-card>\n          </v-col>\n        </v-row>\n\n        <v-row>\n          <v-col sm=\"12\" cols=\"12\" class=\"py-0 custom_pagination bycus-pager\">\n            <template>\n              <kendo-datasource\n                ref=\"gridTransactionDS\"\n                :type=\"'JSON'\"\n                :data=\"transactions\"\n                :group=\"group\"\n                :server-paging=\"false\"\n              />\n              <kendo-grid\n                id=\"gridTransaction\"\n                class=\"grid-function\"\n                :data-source-ref=\"'gridTransactionDS'\"\n                :editable=\"false\"\n                :groupable=\"true\"\n                :sortable=\"true\"\n                :column-menu=\"true\"\n                :filterable=\"true\"\n                :resizable=\"true\"\n                :pageable=\"true\"\n                @pagechange=\"pageChangeHandler\"\n                :toolbar=\"['excel']\"\n                :excel-file-name=\"'SaleAnalysisByCustomer.xlsx'\"\n                :excel-filterable=\"true\"\n                :excel-all-pages=\"true\"\n                :scrollable-virtual=\"true\"\n              >\n                <!--                <kendo-grid-column-->\n                <!--                    :field=\"'no'\"-->\n                <!--                    :title=\"$t('no')\"-->\n                <!--                    :template=\"rowNumberTmpl\"-->\n                <!--                    :width=\"90\"-->\n                <!--                    :column-menu=\"false\"-->\n                <!--                    :headerAttributes=\"{ style: 'background-color: #EDF1F5;', class: 'text-center'\t}\"-->\n                <!--                    :attributes=\"{style: 'text-align: center'}\"/>-->\n                <kendo-grid-column\n                  :field=\"'transactionDate'\"\n                  :title=\"$t('date')\"\n                  :width=\"120\"\n                  :sortable=\"false\"\n                  :group-footer-template=\"$t('total')\"\n                  :template=\"dateFormat\"\n                  :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                />\n                <kendo-grid-column\n                  :field=\"'name'\"\n                  :attributes=\"{ class: 'tb_name_td' }\"\n                  :title=\"$t('name')\"\n                  :width=\"200\"\n                  :sortable=\"false\"\n                  :filterable-multi=\"true\"\n                  :filterable-search=\"true\"\n                  :template=\"'<span>#=name#</span>'\"\n                  :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                />\n                <kendo-grid-column\n                  :field=\"'transactionType'\"\n                  :title=\"$t('type')\"\n                  :width=\"120\"\n                  :sortable=\"false\"\n                  :template=\"'<span>#=transactionType#</span>'\"\n                  :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                />\n                <kendo-grid-column\n                  :field=\"'referenceNo'\"\n                  :title=\"$t('num')\"\n                  :width=\"150\"\n                  :sortable=\"true\"\n                  :template=\"referenceTemplate\"\n                  :headerAttributes=\"{\n                    style: 'background-color: #EDF1F5, color: green !important',\n                  }\"\n                />\n                <!--                                <kendo-grid-column-->\n                <!--                                    :field=\"'referenceNo'\"-->\n                <!--                                    :title=\"$t('ref_from')\"-->\n                <!--                                    :width=\"180\"-->\n                <!--                                    :template=\"referenceTemplate\"-->\n                <!--                                    :headerAttributes=\"{ style: 'background-color: #EDF1F5, color: green !important' }\"/>-->\n                <!--                                <kendo-grid-column-->\n                <!--                                    :field=\"'referenceNo'\"-->\n                <!--                                    :title=\"$t('ref_to')\"-->\n                <!--                                    :width=\"180\"-->\n                <!--                                    :template=\"referenceTemplate\"-->\n                <!--                                    :headerAttributes=\"{ style: 'background-color: #EDF1F5, color: green !important' }\"/>-->\n                <kendo-grid-column\n                  :field=\"'exchangeSubTotal'\"\n                  :title=\"$t('sub_total')\"\n                  :width=\"200\"\n                  :group-footer-template=\"'#= kendo.toString(sum, `n2`)#'\"\n                  :aggregates=\"['sum']\"\n                  :footerAttributes=\"{ style: 'text-align: right;' }\"\n                  :attributes=\"{ style: 'text-align: right; ' }\"\n                  :template=\"'<span>#=kendo.toString(exchangeSubTotal, decimalFormat)#</span>'\"\n                  :headerAttributes=\"{\n                    style: 'text-align: right;background-color: #EDF1F5',\n                  }\"\n                />\n                <kendo-grid-column\n                  :field=\"'exchangeDiscountTotal'\"\n                  :title=\"$t('discount')\"\n                  :width=\"150\"\n                  :group-footer-template=\"'#= kendo.toString(sum, `n2`)#'\"\n                  :aggregates=\"['sum']\"\n                  :footerAttributes=\"{ style: 'text-align: right;' }\"\n                  :attributes=\"{ style: 'text-align: right; ' }\"\n                  :template=\"'<span>#=kendo.toString(exchangeDiscountTotal, decimalFormat)#</span>'\"\n                  :headerAttributes=\"{\n                    style: 'text-align: right;background-color: #EDF1F5',\n                  }\"\n                />\n                <kendo-grid-column\n                  :field=\"'exchangeAmount'\"\n                  :title=\"$t('amount')\"\n                  :width=\"200\"\n                  :group-footer-template=\"'#= kendo.toString(sum, `n2`)#'\"\n                  :aggregates=\"['sum']\"\n                  :footerAttributes=\"{ style: 'text-align: right;' }\"\n                  :attributes=\"{ style: 'text-align: right; ' }\"\n                  :template=\"'<span>#=kendo.toString(exchangeAmount, decimalFormat)#</span>'\"\n                  :headerAttributes=\"{\n                    style: 'text-align: right;background-color: #EDF1F5',\n                  }\"\n                />\n                <kendo-grid-column\n                  :field=\"'segment.name'\"\n                  :title=\"$t('segment')\"\n                  :width=\"200\"\n                  :sortable=\"false\"\n                  :filterable-multi=\"true\"\n                  :filterable-search=\"true\"\n                  :attributes=\"{ style: 'text-align: left; ' }\"\n                  :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                />\n                <kendo-grid-column\n                  :field=\"'location.name'\"\n                  :title=\"$t('location')\"\n                  :width=\"200\"\n                  :sortable=\"false\"\n                  :filterable-multi=\"true\"\n                  :filterable-search=\"true\"\n                  :attributes=\"{ style: 'text-align: left; ' }\"\n                  :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                />\n                <kendo-grid-column\n                  :field=\"'project.name'\"\n                  :title=\"$t('project')\"\n                  :width=\"200\"\n                  :sortable=\"false\"\n                  :filterable-multi=\"true\"\n                  :filterable-search=\"true\"\n                  :attributes=\"{ style: 'text-align: left; ' }\"\n                  :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                />\n\n                <!--                <kendo-grid-column-->\n                <!--                    :field=\"'status'\"-->\n                <!--                    :title=\"$t('progressing_status')\"-->\n                <!--                    :width=\"180\"-->\n                <!--                    :template=\"status\"-->\n                <!--                    :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>-->\n                <kendo-grid-column\n                  :field=\"'status'\"\n                  :title=\"$t('status')\"\n                  :width=\"180\"\n                  :sortable=\"false\"\n                  :filterable=\"{ multi: true }\"\n                  :template=\"status\"\n                  :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"\n                />\n                <!--                <kendo-grid-column-->\n                <!--                    :field=\"''\"-->\n                <!--                    :title=\"$t('action')\"-->\n                <!--                    :width=\"100\"-->\n                <!--                    :command=\"[{  text: 'Convert', click: goToConvert }]\"-->\n                <!--                    :headerAttributes=\"{style: 'text-align: left; background-color: #EDF1F5'}\"/>-->\n              </kendo-grid>\n            </template>\n          </v-col>\n        </v-row>\n      </v-card>\n    </v-col>\n  </v-row>\n</template>\n\n<script>\nimport InvoiceModel from \"@/scripts/invoice/model/Invoice\";\nimport kendo from \"@progress/kendo-ui\";\nimport LinkTemplate from \"@/components/kendo_templates/LinkTemplate\";\n\nconst billingHandler = require(\"@/scripts/invoice/handler/billingHandler\");\nconst invoiceModel = new InvoiceModel({});\n\nimport JSZip from \"jszip\";\nconst $ = kendo.jQuery; //require(\"jquery\")\n\nwindow.JSZip = JSZip;\nexport default {\n  name: \"SaleTransaction\",\n  components: {\n    LoadingMe: () => import(`@/components/Loading`),\n    \"app-datepicker\": () =>\n      import(`@/components/custom_templates/DatePickerComponent`),\n  },\n  data: () => ({\n    loadingSearch: false,\n    startDate: new Date().toISOString().substr(0, 10),\n    endDate: new Date().toISOString().substr(0, 10),\n    dateSorters: [\n      \"Today\",\n      \"This Week\",\n      \"This Month\",\n      \"This Year\",\n      \"Last Month\",\n      \"Last Year\",\n    ],\n    mDateSorter: \"Today\",\n    showLoading: false,\n    transactions: [],\n    tranDS: [],\n    saleFormContent: {},\n    isLoaded: false,\n    invoice: invoiceModel,\n    totalRevenue: 0,\n    totalSaleLead: 0,\n    totalSaleQuote: 0,\n    totalSaleOrder: 0,\n    group: { field: \"name\" },\n    sort: { field: \"referenceNo\", dir: \"ASC\" },\n    aggregateDefinition: [\n      { field: \"exchangeAmount\", aggregate: \"sum\" },\n      { field: \"exchangeSubTotal\", aggregate: \"sum\" },\n      { field: \"exchangeDiscountTotal\", aggregate: \"sum\" },\n    ],\n    pageable: {\n      buttonCount: 5,\n      info: false,\n      type: \"numeric\",\n      pageSizes: false,\n      previousNext: true,\n    },\n    params: {\n      isDonor: false,\n      search: \"\",\n      type: \"cus\",\n      key: {},\n    },\n    paging: {},\n    txnByCustomers: [],\n    disabledMe: true,\n    action: \"\",\n  }),\n  methods: {\n    pdfExport: function (e) {\n      // const pivot = this.$refs.gridTransactionDS.kendoWidget()\n      // pivot.saveAsPDF()\n      window.console.log(\"pdfExport\");\n      window.console.log(e.data);\n    },\n    pageChangeHandler: function (event) {\n      alert(\"change\", event);\n    },\n    onSorterChanges(val) {\n      let today = new Date();\n      switch (val) {\n        case \"Today\":\n          this.startDate = kendo.toString(today, \"yyyy-MM-dd\");\n          this.endDate = kendo.toString(today, \"yyyy-MM-dd\");\n\n          break;\n        case \"This Week\":\n          var first = today.getDate() - today.getDay(),\n            last = first + 6;\n\n          this.startDate = kendo.toString(\n            new Date(today.setDate(first)),\n            \"yyyy-MM-dd\"\n          );\n          today = new Date();\n          this.endDate = kendo.toString(\n            new Date(today.setDate(last)),\n            \"yyyy-MM-dd\"\n          );\n\n          break;\n        case \"This Month\":\n          this.startDate = kendo.toString(\n            new Date(today.getFullYear(), today.getMonth(), 1),\n            \"yyyy-MM-dd\"\n          );\n          this.endDate = kendo.toString(\n            new Date(today.getFullYear(), today.getMonth(), 31),\n            \"yyyy-MM-dd\"\n          );\n\n          break;\n        case \"This Year\":\n          this.startDate = kendo.toString(\n            new Date(today.getFullYear(), 0, 1),\n            \"yyyy-MM-dd\"\n          );\n          this.endDate = kendo.toString(\n            new Date(today.getFullYear(), 11, 31),\n            \"yyyy-MM-dd\"\n          );\n          break;\n        case \"Last Month\":\n          this.startDate = kendo.toString(\n            new Date(today.getFullYear(), today.getMonth(), -30),\n            \"yyyy-MM-dd\"\n          );\n          this.endDate = kendo.toString(\n            new Date(today.getFullYear(), today.getMonth() - 1, +31),\n            \"yyyy-MM-dd\"\n          );\n\n          break;\n        case \"Last Year\":\n          this.startDate = kendo.toString(\n            new Date(today.getFullYear(), -11, -30),\n            \"yyyy-MM-dd\"\n          );\n          this.endDate = kendo.toString(\n            new Date(today.getFullYear(), -1, +31),\n            \"yyyy-MM-dd\"\n          );\n\n          break;\n        default:\n          this.startDate = \"\";\n          this.endDate = \"\";\n      }\n    },\n    numberFormat(value) {\n      return kendo.toString(value, `n${this.saleFormContent.decimal}`);\n    },\n    referenceTemplate(data) {\n      let url = \"\";\n      if (data.type === \"Invoice\") {\n        url = `invoice_view/${data.id}`;\n      } else if (data.type === \"Sale Deposit\") {\n        url = `sale_deposit_view/${data.id}`;\n      } else if (data.type === \"Purchase\") {\n        url = `credit_purchase_view/${data.id}`;\n      } else if (data.type === \"Sale Quote\") {\n        url = `sale_quote_view/${data.id}`;\n      } else if (data.type === \"Cash Receipt\") {\n        url = `cash_receipt_view/${data.id}`;\n      } else if (data.type === \"Sale Order\") {\n        url = `sale_order_view/${data.id}`;\n      } else if (data.type === \"Purchase Deposit\") {\n        url = `purchase_deposit_view/${data.id}`;\n      } else if (data.type === \"Credit Memo\") {\n        url = `sale_return_view/${data.id}`;\n      } else if (data.type === \"Debit Memo\") {\n        url = `purchase_return_view/${data.id}`;\n      } else if (data.type === \"Cash Payment\") {\n        url = `cash_payment_view/${data.id}`;\n      } else if (data.type === \"Sale Lead\") {\n        url = `lead/${data.id}`;\n      }\n      const refFrom = data.refFrom || [];\n      const refTo = data.refTo || [];\n      let args = {\n        text: data.referenceNo,\n        related: !!refFrom.length > 0 || !!refTo.length > 0,\n        url: url,\n        data: data,\n      };\n      window.console.log(\"related\", refFrom, !!refFrom.length > 0);\n      return {\n        template: LinkTemplate,\n        templateArgs: args,\n      };\n    },\n    goToConvert(e) {\n      this.newClick = false;\n      e.preventDefault();\n      // let grid = kendo.jQuery(\"#gridAddress\").data(\"kendoGrid\")\n      // let dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"))\n      // this.address = dataItem\n      // this.mCountry = dataItem.country\n      // this.dialogM2 = true\n    },\n    rowNumberTmpl(dataItem) {\n      let ds = this.$refs.gridTransactionDS.kendoWidget(),\n        index = ds.indexOf(dataItem);\n      return index + 1;\n    },\n    async loadTransactions() {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.showLoading = true;\n          billingHandler.list().then((res) => {\n            if (res.data.statusCode === 200) {\n              window.console.log(res);\n              this.transactions = res.data.data;\n              const result = res.data.result;\n              this.totalRevenue = kendo.toString(\n                result.Revenue,\n                result.decimalFormat\n              );\n              this.totalSaleLead = kendo.toString(\n                result.SaleLead,\n                result.decimalFormat\n              );\n              this.totalSaleOrder = kendo.toString(\n                result.SaleOrder,\n                result.decimalFormat\n              );\n              this.totalSaleQuote = kendo.toString(\n                result.SaleQuote,\n                result.decimalFormat\n              );\n            }\n            this.showLoading = false;\n          });\n        }, 10);\n      });\n    },\n\n    async searchTransaction(type) {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.showLoading = true;\n          this.loadingSearch = true;\n          const startDate = this.startDate;\n          const endDate = this.endDate;\n          this.params = {\n            search: \"\",\n            type: type,\n            start: startDate,\n            end: endDate,\n            key: this.paging,\n            isSummarize: 0,\n          };\n          this.disabledNextPage(true);\n          billingHandler.list(this.params).then((res) => {\n            if (res.data.statusCode === 200) {\n              this.loadingSearch = false;\n              this.showLoading = false;\n              window.console.log(\"im search\", res);\n              const responseData = res.data.data || [];\n              this.transactions = responseData;\n              this.paging = res.data.key;\n              window.console.log(\"key\", res.data.key);\n              this.txnByCustomers.push(responseData);\n              //   const result = res.data.result;\n              //   this.totalRevenue = kendo.toString(\n              //     result.Revenue,\n              //     result.decimalFormat\n              //   );\n              //   this.totalSaleLead = kendo.toString(\n              //     result.SaleLead,\n              //     result.decimalFormat\n              //   );\n              //   this.totalSaleOrder = kendo.toString(\n              //     result.SaleOrder,\n              //     result.decimalFormat\n              //   );\n              //   this.totalSaleQuote = kendo.toString(\n              //     result.SaleQuote,\n              //     result.decimalFormat\n              //   );\n\n              if (Object.keys(this.paging).length > 0) {\n                this.disabledNextPage(false);\n              } else {\n                this.disabledNextPage(true);\n              }\n              this.itemRetuned(this);\n              window.console.log(\n                \"txnByCustomers\",\n                this.txnByCustomers,\n                res.data.key\n              );\n            } else {\n              this.loadingSearch = false;\n              this.showLoading = false;\n            }\n          });\n        }, 10);\n      });\n    },\n    async transactionSummarize(type) {\n      new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(\"resolved\");\n          this.showLoading = true;\n          this.loadingSearch = true;\n          const startDate = this.startDate;\n          const endDate = this.endDate;\n          this.params = {\n            search: \"\",\n            type: type,\n            start: startDate,\n            end: endDate,\n            isSummarize: 1,\n            key: {},\n          };\n          billingHandler.list(this.params).then((res) => {\n            if (res.data.statusCode === 200) {\n              this.loadingSearch = false;\n              this.showLoading = false;\n              const result = res.data.data[0] || {};\n              this.totalRevenue = kendo.toString(\n                result.Revenue,\n                result.decimalFormat\n              );\n              this.totalSaleLead = kendo.toString(\n                result.SaleLead,\n                result.decimalFormat\n              );\n              this.totalSaleOrder = kendo.toString(\n                result.SaleOrder,\n                result.decimalFormat\n              );\n              this.totalSaleQuote = kendo.toString(\n                result.SaleQuote,\n                result.decimalFormat\n              );\n            } else {\n              this.loadingSearch = false;\n              this.showLoading = false;\n            }\n          });\n        }, 10);\n      });\n    },\n    onSearch(type) {\n      this.action = type;\n      this.txnByCustomers = [];\n      //   $(\".k-pager-wrap\").empty();\n      //   $(\".bycus-page-number\").empty();\n      this.loadPage(this);\n      this.paging = {};\n      //   this.params = {\n      //     search: \"\",\n      //     type: type,\n      //     start: this.startDate,\n      //     end: this.endDate,\n      //     key: {},\n      //   };\n      this.searchTransaction(type);\n      this.transactionSummarize(type);\n    },\n    dateFormat(dataItem) {\n      return kendo.toString(\n        new Date(dataItem.transactionDate),\n        `${this.invoice.dateFormat}`\n      );\n    },\n    // linkTo(dataItem) {\n    //     window.console.log(dataItem)\n    //     this.$router.push({\n    //         path: 'invoice' + `/${dataItem.id}`,\n    //         params: {id: dataItem.id},\n    //         query: {type: 'edit'}\n    //     })\n    // },\n    status(dataItem) {\n      let status = \"\",\n        type = dataItem.type || \"\";\n      switch (dataItem.status) {\n        case 1:\n          status = \"Open\";\n          break;\n        case 2:\n          if (\n            type === \"Sale Lead\" ||\n            type === \"Sale Quote\" ||\n            type === \"Sale Order\"\n          ) {\n            status = \"Applied\";\n          } else {\n            status = \"Partially Paid\";\n          }\n          break;\n        case 3:\n          status = \"Paid\";\n          break;\n        case 4:\n          status = \"Void\";\n          break;\n      }\n      return status;\n    },\n    callback() {\n      if (\n        this.$route.params !== null &&\n        this.$route.params.hasOwnProperty(\"data\")\n      ) {\n        const data = this.$route.params.data;\n        if (data.transactionType === \"delete\") {\n          this.loadTransactions();\n        }\n      }\n      window.console.log(\"im changed\", this.$route.params);\n    },\n    async loadPage(that) {\n      $(\".bycus-pager .k-pager-wrap\").html(`\n                <label class=\"label bycus-item-returned\">0</label>\n                <div style=\"display: flex; flex-direction: 'row'\">\n                    <button class=\"bycus-next-page\" title=\"previous\" style=\"width: 24px; font-size: 19px;\"> < </button>\n                    <ul class=\"bycus-page-number\" style=\"display: flex;list-style: none; padding-left: 0px;\">\n                        <li style=\"padding: 6px;\"  data-page=\"1\" class=\"bycus-page-link text-bold-link\" >1</li>\n                    </ul>\n                    <button class=\"bycus-next-page\" title=\"next\" style=\"width: 24px; font-size: 19px;\"> > </button>\n                </div>\n            `);\n      $(document).on(\"click\", \".bycus-page-link\", function () {\n        const page = $(this).data(\"page\");\n        $(\".bycus-page-link\").removeClass(\"text-bold-link\");\n        $(this).addClass(\"text-bold-link\");\n        that.backToPage(that, page - 1);\n        window.console.log(page - 1);\n      });\n      // $(document).on('click', '.bycus-next-page', function () {\n      $(\".bycus-next-page\").click(function () {\n        const page_number = $(this)\n          .parent()\n          .children(\".bycus-page-number\")\n          .find(\"li\")\n          .last()\n          .data(\"page\");\n        window.console.log(\"bycus-page_number\", page_number);\n        const isPrevious = $(this).attr(\"title\");\n        if (isPrevious == \"previous\") {\n          const currectpage = $(\".text-bold-link\").data(\"page\");\n\n          if (currectpage == 1) {\n            return;\n          }\n          $(\".bycus-page-link\").removeClass(\"text-bold-link\");\n          $(`.bycus-page-link:eq(${currectpage - 1})`).addClass(\n            \"text-bold-link\"\n          );\n          that.backToPage(that, currectpage - 2);\n          window.console.log(\"this currectpage back\", currectpage - 2);\n        } else {\n          $(\".bycus-page-link\").removeClass(\"text-bold-link\");\n          that.params = {\n            search: that.search || \"\",\n            type: that.action,\n            start: that.startDate,\n            end: that.endDate,\n            key: that.paging,\n          };\n          window.console.log(\"params\", that.params);\n          that.searchTransaction(that.action);\n          $(this)\n            .parent()\n            .children(\".bycus-page-number\")\n            .append(\n              `<li class=\"bycus-page-link text-bold-link\" style=\"padding: 6px;\" data-page=\"${\n                page_number + 1\n              }\">${page_number + 1}</li>`\n            );\n        }\n        window.console.log(\"this\", page_number + 1);\n      });\n    },\n    itemRetuned(that) {\n      let totalRow = 0;\n      that.txnByCustomers.forEach((k) => {\n        totalRow += k.length;\n      });\n      $(\".bycus-item-returned\").text(\"Items returned (\" + totalRow + \")\");\n    },\n    disabledNextPage(value) {\n      $(\".bycus-next-page\").prop(\"disabled\", value);\n    },\n    backToPage(that, index) {\n      try {\n        window.console.log(\n          \"Length of txnByCustomers\",\n          that.txnByCustomers.length\n        );\n        const byCustomer = that.txnByCustomers.at(index);\n        that.transactions = byCustomer;\n        // that.refreshGridData(customer)\n        window.console.log(\"that.txnByCustomers[index]\", byCustomer);\n      } catch (e) {\n        window.console.log(\"ERROR on backToPage\", index);\n      }\n    },\n    refreshGridData(data) {\n      $(\"#gridTransaction\").data(\"kendoGrid\").dataSource.data([]);\n      $(\"#gridTransaction\").data(\"kendoGrid\").dataSource.data(data);\n    },\n  },\n  async mounted() {\n    this.group = [\n      {\n        field: \"name\",\n        aggregates: this.aggregateDefinition,\n      },\n    ];\n    // await this.searchTransaction(\"\");\n    $(document).on(\"click\", \".k-pager-nav\", function () {\n      window.console.log(\"this\", $(this).data(\"page\"));\n    });\n  },\n  computed: {\n  },\n  watch: {\n    // $route: \"callback\",\n  },\n};\n</script>\n<style scoped>\n.k-pdf-export .k-grid {\n  font-family: \"DejaVu Sans\", \"Arial\", sans-serif;\n}\n\n/* Hide the Grid header and pager during export */\n.k-pdf-export .k-grid-toolbar,\n.k-pdf-export .k-pager-wrap {\n  display: none;\n}\n</style>"]}]}