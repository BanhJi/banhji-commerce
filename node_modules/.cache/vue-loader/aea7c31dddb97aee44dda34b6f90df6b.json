{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/accounting/closing/VarianceReport.vue?vue&type=style&index=0&id=0fa7d94f&scoped=true&lang=css&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/accounting/closing/VarianceReport.vue","mtime":1642155812602},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmF0dGFjaG1lbnRfdGFibGUudi1kYXRhLXRhYmxlCiAgPiAudi1kYXRhLXRhYmxlX193cmFwcGVyCiAgPiB0YWJsZQogID4gdGhlYWQKICA+IHRyCiAgPiB0aCwKLmF0dGFjaG1lbnRfdGFibGUudi1kYXRhLXRhYmxlCiAgPiAudi1kYXRhLXRhYmxlX193cmFwcGVyCiAgPiB0YWJsZQogID4gdGJvZHkKICA+IHRyCiAgPiB0ZCB7CiAgYm9yZGVyLXJpZ2h0OiBub25lICFpbXBvcnRhbnQ7Cn0KQG1lZGlhIChtYXgtd2lkdGg6IDU3NnB4KSB7CiAgLm10LTYgewogICAgbWFyZ2luLXRvcDogMCAhaW1wb3J0YW50OwogICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICB9CiAgLnJvdyArIC5yb3cgewogICAgbWFyZ2luLXRvcDogMCAhaW1wb3J0YW50OwogIH0KfQo="},{"version":3,"sources":["VarianceReport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VarianceReport.vue","sourceRoot":"src/views/accounting/closing","sourcesContent":["<template>\n  <v-row>\n    <v-col cols=\"12\" sm=\"12\" class=\"pt-3\">\n      <v-row>\n        <v-col cols=\"12\" sm=\"12\" class=\"py-0\">\n          <h2 class=\"mb-3 font_20 float-left\">\n            {{ $t(\"variance_report\") }}\n          </h2>\n        </v-col>\n        <v-col cols=\"12\" sm=\"12\" class=\"py-0\">\n          <v-row>\n            <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n              <label class=\"label pr-3\">{{ $t(\"account_type\") }}</label>\n              <app-account-type-dropdownlist\n                :initAccountType=\"accountType\"\n                @emitAccountType=\"accountType = $event\"\n                @onChanged=\"onAccountTypeChanges\"\n              />\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n              <label class=\"label pr-3\">{{ $t(\"account_group\") }}</label>\n              <app-account-group-dropdownlist\n                :initAccountGroup=\"accountGroup\"\n                @emitAccountGroup=\"accountGroup = $event\"\n                :initAccountTypeCode=\"accountTypeCode\"\n              />\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n              <label class=\"label pr-3\">{{ $t(\"segment\") }}</label>\n              <app-segment-dropdownlist\n                :initialSegment=\"segment\"\n                @emitSegment=\"segment = $event\"\n              />\n            </v-col>\n          </v-row>\n          <v-row>\n            <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n              <label class=\"label pr-3\">{{ $t(\"base_month\") }}</label>\n              <app-month-of-picker\n                :initMonthOf=\"baseMonthOf\"\n                @emitMonthOf=\"baseMonthOf = $event\"\n              />\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n              <label class=\"label pr-3\">{{ $t(\"compare_month\") }}</label>\n              <app-month-of-picker\n                :initMonthOf=\"compareMonthOf\"\n                @emitMonthOf=\"compareMonthOf = $event\"\n              />\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n              <v-btn\n                color=\"primary\"\n                class=\"white--text mt-6 float-right\"\n                @click=\"search\"\n              >\n                <i\n                  class=\"b-search\"\n                  style=\"font-size: 18px; color: #fff !important\"\n                />\n              </v-btn>\n            </v-col>\n          </v-row>\n        </v-col>\n        <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n          <v-row>\n            <v-col cols=\"12\" sm=\"8\" class=\"py-0\">\n              <p class=\"mb-0 float-left\">\n                {{ $t(\"variance_report_desc\") }}\n              </p>\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\" class=\"py-0\">\n              <app-variance-rule-dropdownlist\n                :initVarianceRule=\"varianceRule\"\n                @emitVarianceRule=\"varianceRule = $event\"\n                @onChanged=\"applyRule\"\n              />\n            </v-col>\n          </v-row>\n        </v-col>\n        <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n          <template>\n            <v-data-table\n              :headers=\"headers\"\n              :items=\"varianceReports\"\n              :items-per-page=\"50\"\n              sort-by=\"account.number\"\n              class=\"attachment_table elevation-1\"\n            >\n              <!-- Account -->\n              <template v-slot:[`item.account`]=\"{ item }\">\n                {{ item.account.number }} - {{ item.account.name }}\n              </template>\n\n              <!-- Base Amount -->\n              <template v-slot:[`item.selectedMonthBalance`]=\"{ item }\">\n                <p class=\"pt-5 text-right font_14\">\n                  {{ Number(item.selectedMonthBalance).toLocaleString() }}\n                </p>\n              </template>\n\n              <!-- Compare Amount -->\n              <template v-slot:[`item.previouseMonthBalance`]=\"{ item }\">\n                <p class=\"pt-5 text-right font_14\">\n                  {{ Number(item.previouseMonthBalance).toLocaleString() }}\n                </p>\n              </template>\n\n              <!-- Variance Amount -->\n              <template v-slot:[`item.variance`]=\"{ item }\">\n                <p class=\"pt-5 text-right font_14\">\n                  {{ Number(item.variance).toLocaleString() }}\n                </p>\n              </template>\n\n              <!-- Account -->\n              <template v-slot:[`item.varianceRule`]=\"{ item }\">\n                {{ item.varianceRule !== null ? item.varianceRule.name : \"\" }}\n              </template>\n            </v-data-table>\n          </template>\n\n          <LoadingMe\n            :isLoading=\"showLoading\"\n            :fullPage=\"true\"\n            :myLoading=\"true\"\n            :alertMessage=\"loadingAlert\"\n            :color=\"loadingColorAlert\"\n            :alertText=\"loadingTextAlert\"\n          />\n        </v-col>\n      </v-row>\n    </v-col>\n  </v-row>\n</template>\n<script>\nimport { i18n } from \"@/i18n\";\nimport kendo from \"@progress/kendo-ui\";\nimport {\n  VarianceRuleModel,\n  AccountTypeModel,\n  AccountGroupModel,\n  SegmentModel,\n} from \"@/scripts/model/AppModels\";\n\nconst { varianceReportHandler } = require(\"@/scripts/AppHandlers\");\n\nexport default {\n  components: {\n    LoadingMe: () => import(\"@/components/Loading\"),\n    \"app-month-of-picker\": () =>\n      import(\"@/components/kendo_templates/MonthOfPicker\"),\n    \"app-variance-rule-dropdownlist\": () =>\n      import(\"@/components/kendo_templates/VarianceRuleDropDownList\"),\n    \"app-account-type-dropdownlist\": () =>\n      import(\"@/components/dropdownlist/AccountType\"),\n    \"app-account-group-dropdownlist\": () =>\n      import(\"@/components/dropdownlist/AccountGroup\"),\n    \"app-segment-dropdownlist\": () =>\n      import(\"@/components/dropdownlist/Segment\"),\n  },\n  data: () => ({\n    baseMonthOf: new Date().toISOString().substr(0, 7),\n    compareMonthOf: new Date().toISOString().substr(0, 7),\n    varianceRule: new VarianceRuleModel(),\n    accountType: new AccountTypeModel(),\n    accountGroup: new AccountGroupModel(),\n    segment: new SegmentModel(),\n    accountTypeCode: 0,\n    headers: [\n      { text: i18n.t(\"account\"), value: \"account\" },\n      { text: i18n.t(\"base_month\"), value: \"selectedMonthBalance\" },\n      { text: i18n.t(\"compare_month\"), value: \"previouseMonthBalance\" },\n      { text: i18n.t(\"variance\"), value: \"variance\" },\n      { text: i18n.t(\"variance_rule\"), value: \"varianceRule\" },\n    ],\n    varianceReports: [],\n    varianceReportList: [],\n    // LoadingMe\n    showLoading: false,\n    loadingAlert: false,\n    loadingColorAlert: \"\",\n    loadingTextAlert: \"\",\n  }),\n  methods: {\n    // On Account Type Changes\n    onAccountTypeChanges() {\n      this.accountTypeCode = this.accountType.code;\n    },\n    // Search\n    search() {\n      // Empty dataSource\n      this.varianceReports = [];\n      this.varianceRule = new VarianceRuleModel();\n\n      if (this.baseMonthOf && this.compareMonthOf) {\n        // Query\n        this.showLoading = true;\n        varianceReportHandler\n          .getReport({\n            params: {\n              month_of: kendo.toString(new Date(this.baseMonthOf), \"yyyy-MM\"),\n              compare_month_of: kendo.toString(\n                new Date(this.compareMonthOf),\n                \"yyyy-MM\"\n              ),\n              acc_type_code: this.accountType.code,\n              acc_group_code: this.accountGroup.code,\n              segment_uuid: this.segment.uuid,\n            },\n          })\n          .then((res) => {\n            if (res.data) {\n              this.varianceReports = res.data;\n              this.varianceReportList = res.data;\n            }\n          })\n          .finally(() => {\n            this.showLoading = false;\n          });\n      }\n    },\n    applyRule() {\n      if (this.varianceRule.uuid !== \"\") {\n        let varianList = [];\n\n        this.varianceReportList.forEach((value) => {\n          switch (this.varianceRule.rule.toLowerCase()) {\n            case \"amount\": // Amount Rule\n              if (Math.abs(value.variance) >= this.varianceRule.value) {\n                varianList.push(value);\n              }\n              break;\n\n            case \"percentage\": // Percentage Rule\n              var amtInPercentage = 0;\n              if (value.previouseMonthBalance !== 0) {\n                amtInPercentage =\n                  (value.selectedMonthBalance - value.previouseMonthBalance) /\n                  value.previouseMonthBalance;\n\n                if (Math.abs(amtInPercentage) >= this.varianceRule.value) {\n                  varianList.push(value);\n                }\n              } else {\n                if (value.selectedMonthBalance !== 0) {\n                  varianList.push(value);\n                }\n              }\n              break;\n\n            default:\n              break;\n          }\n        });\n\n        // Bind variance report by rule\n        this.varianceReports = varianList;\n      }\n    },\n  },\n};\n</script>\n<style scoped>\n.attachment_table.v-data-table\n  > .v-data-table__wrapper\n  > table\n  > thead\n  > tr\n  > th,\n.attachment_table.v-data-table\n  > .v-data-table__wrapper\n  > table\n  > tbody\n  > tr\n  > td {\n  border-right: none !important;\n}\n@media (max-width: 576px) {\n  .mt-6 {\n    margin-top: 0 !important;\n    margin-bottom: 15px;\n  }\n  .row + .row {\n    margin-top: 0 !important;\n  }\n}\n</style>"]}]}