{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/payroll/payroll_run/Adjustment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/payroll/payroll_run/Adjustment.vue","mtime":1639966363945},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBrZW5kbyBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdWkiCmltcG9ydCBQYXlyb2xsTGlzdCBmcm9tICJAL3NjcmlwdHMvbW9kZWwvUGF5cm9sbExpc3QiCmltcG9ydCBQYXlyb2xsUnVuIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9QYXlyb2xsUnVuIjsKaW1wb3J0IEFkanVzdG1lbnQgZnJvbSAiQC9zY3JpcHRzL21vZGVsL0FkanVzdG1lbnQiCmNvbnN0IHNldHRpbmdzSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9zZXR0aW5nc0hhbmRsZXIiKQpjb25zdCBwYXlyb2xsSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9wYXlyb2xsSGFuZGxlciIpCmNvbnN0IGVtcGxveWVlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9lbXBsb3llZUhhbmRsZXIiKQpjb25zdCBwYXlyb2xsTGlzdE1vZGVsID0gbmV3IFBheXJvbGxMaXN0KHt9KQpjb25zdCBhZGp1c3RtZW50TW9kZWwgPSBuZXcgQWRqdXN0bWVudCh7fSkKY29uc3QgJCA9IHJlcXVpcmUoImpxdWVyeSIpCmNvbnN0IGNvb2tpZUpTID0gcmVxdWlyZSgiQC9jb29raWUuanMiKTsKY29uc3QgY29va2llID0gY29va2llSlMuZ2V0Q29va2llKCk7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBwcm9wczpbJ3Byb3BBZGp1c3RtZW50J10sCiAgICBkYXRhOiAoKSA9Pih7CiAgICAgICAgam91cm5hbF9kYXRlOiAiIiwKICAgICAgICBkaWFsb2dtOiBmYWxzZSwKICAgICAgICBweXJvbGxMaXN0OiBbXSwKICAgICAgICBzaG93TG9hZGluZzogZmFsc2UsCiAgICAgICAgcGF5cm9sbExpc3Q6IHBheXJvbGxMaXN0TW9kZWwsCiAgICAgICAgYWRqdXN0bWVudDogYWRqdXN0bWVudE1vZGVsLAogICAgICAgIGFkanVzdG1lbnRMaXN0OiBbXSwKICAgICAgICBzZWdtZW50czogW10sCiAgICAgICAgbG9nZ2VkVXNlcjogewogICAgICAgICAgICBpZDogY29va2llLmNyZWF0b3IsCiAgICAgICAgICAgIG5hbWU6IGNvb2tpZS5lbWFpbAogICAgICAgIH0sCiAgICAgICAgcmVjb3JkOiB7fQogICAgfSksCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgTG9hZGluZ01lOiAoKSA9PiBpbXBvcnQoYEAvY29tcG9uZW50cy9Mb2FkaW5nYCkKICAgIH0sCiAgICBtZXRob2RzOnsKICAgICAgICBsb2FkUGF5cm9sbExpc3QoKXsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHBheXJvbGxIYW5kbGVyLmdldFBheXJvbGwodGhpcy4kcm91dGUucGFyYW1zLmlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0UGF5ID0gcmVzLmRhdGEuZGF0YVswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0UGF5LnN0ZXAgPj0gMil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkUGF5cm9sbEl0ZW0ocmVzdWx0UGF5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBsb2FkUGF5cm9sbEl0ZW0ocmVzdWx0KXsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbXBsb3llZSA9IFtdCiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0UGF5cm9sbEl0ZW0ocmVzdWx0LmlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1dGxfaXRlbSA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkUGF5cm9sbHMgPSByZXN1dGxfaXRlbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXlyb2xscyAgID0gcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQuYWRqdXN0bWVudC5sZW5ndGggPiAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkanVzdG1lbnRMaXN0ID0gcmVzdWx0LmFkanVzdG1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuZGF0YVNvdXJjZUFkanVzLmtlbmRvV2lkZ2V0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGp1c3RtZW50TGlzdCA9IGRzLmRhdGEoW10pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRSb3coKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlQWRqdXN0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZFN1Y2Nlc3MocmVzLmRhdGEuc3RhdHVzQ29kZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDMwMCkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRTZWdtZW50KCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJykKICAgICAgICAgICAgICAgICAgICB0aGlzLnNlZ21lbnRzID0gW10KICAgICAgICAgICAgICAgICAgICBzZXR0aW5nc0hhbmRsZXIuZ2V0U2VnKCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VnbWVudHMgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCAzMDApCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICByb3dOdW1iZXJUbXBsKGRhdGFJdGVtKSB7CiAgICAgICAgICAgIHZhciBkcyA9IHRoaXMuJHJlZnMuZGF0YVNvdXJjZUFkanVzLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgICAgICAgICBpbmRleCA9IGRzLmluZGV4T2YoZGF0YUl0ZW0pOwogICAgICAgICAgICByZXR1cm4gaW5kZXggKyAxOwogICAgICAgIH0sCiAgICAgICAgYWRkUm93KCkgewogICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLmRhdGFTb3VyY2VBZGp1cy5rZW5kb1dpZGdldCgpLAogICAgICAgICAgICAgICAgdG90YWwgPSBkcy50b3RhbCgpOwogICAgICAgICAgICBkcy5pbnNlcnQodG90YWwsewogICAgICAgICAgICAgICAgcGF5cm9sbENvbXBvbmVudDogewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICctLSBTZWxlY3QgLS0nLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGVtcGxveWVlOiB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogJy0tIFNlbGVjdCAtLScsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYW1vdW50OiAwLAogICAgICAgICAgICAgICAgc2VnbWVudDogewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICctLSBTZWxlY3QgLS0nLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAgewogICAgICAgICAgICAgICAgICAgIGNvZGU6ICcnLAogICAgICAgICAgICAgICAgICAgIG5hbWU6ICctIFNlbGVjdCAtLScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICByZW1vdmVSb3coZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIGNvbnN0IGdyaWQgPSBrZW5kby5qUXVlcnkoIiNncmlkQWRqdXMiKS5kYXRhKCJrZW5kb0dyaWQiKSwKICAgICAgICAgICAgICAgIGRhdGFTb3VyY2UgPSBncmlkLmRhdGFTb3VyY2UsCiAgICAgICAgICAgICAgICBkYXRhSXRlbSA9IGdyaWQuZGF0YUl0ZW0oJChlLmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoInRyIikpOwogICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS50b3RhbCgpID4gMSkgewogICAgICAgICAgICAgICAgZGF0YVNvdXJjZS5yZW1vdmUoZGF0YUl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkNoYW5nZXMoZSl7CiAgICAgICAgICAgIHRoaXMubG9hZEVtcGxveWVlKCkgICAKICAgICAgICAgICAgdGhpcy5sb2FkUGF5cm9sbENvbXBvbmVudCgpIAogICAgICAgICAgICB0aGlzLmxvYWRTZWdtZW50KCkgCiAgICAgICAgICAgIGlmIChlLmZpZWxkID09PSAiZW1wbG95ZWUiKSB7CiAgICAgICAgICAgICAgICBsZXQgZGF0YUl0ZW0gPSBlLml0ZW1zWzBdCiAgICAgICAgICAgICAgICBsZXQgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICAgIHN0YXR1czogMSwKICAgICAgICAgICAgICAgICAgICBlbXBsb3llZUlkOiBkYXRhSXRlbS5lbXBsb3llZS5lbXBsb3llZUlkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIHRoaXMubG9hZFJlY29yZChwYXJhbXMsIGRhdGFJdGVtKQogICAgICAgICAgICB9ICAgCiAgICAgICAgfSwKICAgICAgICBlbXBsb3llZURyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucyl7CiAgICAgICAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgICAgICAgZmlsdGVyOiAiY29udGFpbnMiLAogICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJuYW1lIiwKICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1uYW1lIzwvc3Bhbj4iLAogICAgICAgICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLmVtcGxveWVlLAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIHBheXJvbGxDb21wb25lbnREcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgICAgICAgIGZpbHRlcjogImNvbnRhaW5zIiwKICAgICAgICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJuYW1lIiwKICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAibmFtZSIsCiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgZGF0YTogdGhpcy5wYXlyb2xsQ29tcG9uZW50LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIHNlZ21lbnREcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCByZXF1aXJlZCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgICAgICAgYXV0b0JpbmQ6IGZhbHNlLAogICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAibmFtZSIsCiAgICAgICAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogIm5hbWUiLAogICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuc2VnbWVudHMsCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZEVtcGxveWVlKCl7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgIHRoaXMuZW1wbG95ZWUgPSBbXQogICAgICAgICAgICAgICAgICAgIGVtcGxveWVlSGFuZGxlci5jZW50ZXIoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbXBsb3llZSA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDMwMCkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRQYXlyb2xsQ29tcG9uZW50KCl7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgIHRoaXMucGF5cm9sbENvbXBvbmVudCA9IFtdCiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbEhhbmRsZXIuZ2V0Q29tcG9uZW50KCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVzID0gWydkZWR1Y3Rpb24nLCdiZW5lZml0JywnZ3Jvc3Nfc2FsYXJ5J10KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGF5cm9sbENvbXBvbmVudCA9ICByZXMuZGF0YS5kYXRhLmZpbHRlcihtID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdCA9IHR5cGVzLmZpbHRlcihuPT4gbiA9PT0gbS5jb21wb1R5cGUuaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGV4aXN0Lmxlbmd0aCA+IDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDMwMCkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGNhbGN1bGF0ZUFkanVzdCgpewogICAgICAgICAgICBsZXQgcGF5cm9sbExpc3QgPSB0aGlzLmxvYWRQYXlyb2xsczsKICAgICAgICAgICAgZm9yIChjb25zdCBwYSBvZiBwYXlyb2xsTGlzdCl7CiAgICAgICAgICAgICAgICBpZihwYS5iZW5lZml0KXsKICAgICAgICAgICAgICAgICAgICBwYS5iZW5lZml0LmZvckVhY2goaT0+ewogICAgICAgICAgICAgICAgICAgICAgICBpZihpLmFtb3VudCA+IDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGp1c3RtZW50TGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbXBsb3llZTogICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGRyZXNzOiAgICAgICAgICAgICAgICBwYS5lbXBsb3llZS5hZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiYW5rOiAgICAgICAgICAgICAgICAgICBwYS5lbXBsb3llZS5iYW5rLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiYW5rQWNjb3VudDogICAgICAgICAgICBwYS5lbXBsb3llZS5iYW5rQWNjb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY291bnRyeTogICAgICAgICAgICAgICAgcGEuZW1wbG95ZWUuY291bnRyeSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG9iOiAgICAgICAgICAgICAgICAgICAgcGEuZW1wbG95ZWUuZG9iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbWFpbDogICAgICAgICAgICAgICAgICBwYS5lbXBsb3llZS5lbWFpbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVJZDogICAgICAgICAgICAgcGEuZW1wbG95ZWUuZW1wbG95ZWVJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW1wbG95ZWVUeXBlOiAgICAgICAgICAgcGEuZW1wbG95ZWUuZW1wbG95ZWVUeXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmaXJzdE5hbWU6ICAgICAgICAgICAgICBwYS5lbXBsb3llZS5maXJzdE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpcnN0TmFtZUxvY2FsZTogICAgICAgIHBhLmVtcGxveWVlLmZpcnN0TmFtZUxvY2FsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2VuZGVyOiAgICAgICAgICAgICAgICAgcGEuZW1wbG95ZWUuZ2VuZGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogICAgICAgICAgICAgICAgICAgICBwYS5lbXBsb3llZS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWRlbnRpdHlJZDogICAgICAgICAgICAgcGEuZW1wbG95ZWUuaWRlbnRpdHlJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWRlbnRpdHlUeXBlOiAgICAgICAgICAgcGEuZW1wbG95ZWUuaWRlbnRpdHlUeXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbWFnZTogICAgICAgICAgICAgICAgICBwYS5lbXBsb3llZS5pbWFnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGFzdE5hbWU6ICAgICAgICAgICAgICAgcGEuZW1wbG95ZWUubGFzdE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxhc3ROYW1lTG9jYWxlOiAgICAgICAgIHBhLmVtcGxveWVlLmxhc3ROYW1lTG9jYWxlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYXJpdGFsU3RhdHVzOiAgICAgICAgICBwYS5lbXBsb3llZS5tYXJpdGFsU3RhdHVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBuYXRpb25hbGl0eTogICAgICAgICAgICBwYS5lbXBsb3llZS5uYXRpb25hbGl0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbmF0dXJlRW1wbG95ZWU6ICAgICAgICAgcGEuZW1wbG95ZWUubmF0dXJlRW1wbG95ZWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vT2ZDaGlsZHJlbjogICAgICAgICAgIHBhLmVtcGxveWVlLm5vT2ZDaGlsZHJlbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF5bWVudE1ldGhvZDogICAgICAgICAgcGEuZW1wbG95ZWUucGF5bWVudE1ldGhvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF5bWVudFBlcmlvZDogICAgICAgICAgcGEuZW1wbG95ZWUucGF5bWVudFBlcmlvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF5cm9sbExpYWJpbGl0aWU6ICAgICAgcGEuZW1wbG95ZWUucGF5cm9sbExpYWJpbGl0aWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBob25lOiAgICAgICAgICAgICAgICAgIHBhLmVtcGxveWVlLnBob25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzYWxhcnlBY2M6ICAgICAgICAgICAgICBwYS5lbXBsb3llZS5zYWxhcnlBY2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNhbGFyeUFkdmFuY2VBY2M6ICAgICAgIHBhLmVtcGxveWVlLnNhbGFyeUFkdmFuY2VBY2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNwb3VzZUdlbmRlcjogICAgICAgICAgIHBhLmVtcGxveWVlLnNwb3VzZUdlbmRlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3BvdXNlTmFtZTogICAgICAgICAgICAgcGEuZW1wbG95ZWUuc3BvdXNlTmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3BvdXNlTmF0dXJlRW1wbG95ZWU6ICAgcGEuZW1wbG95ZWUuc3BvdXNlTmF0dXJlRW1wbG95ZWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXR1czogICAgICAgICAgICAgICAgIHBhLmVtcGxveWVlLnN0YXR1cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd29ya2luZ1N0YXR1czogICAgICAgICAgcGEuZW1wbG95ZWUud29ya2luZ1N0YXR1cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogICAgICAgICAgICAgICAgICAgcGEuZW1wbG95ZWUuZW1wbG95ZWVJZCArICcgLSAnICsgIHBhLmVtcGxveWVlLmZpcnN0TmFtZSArJyAnKyBwYS5lbXBsb3llZS5sYXN0TmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheXJvbGxDb21wb25lbnQ6ICAgICAgICAgICBpLmNvbXBvbmVudCA/IGkuY29tcG9uZW50OiB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW5jeTogICAgICAgICAgICAgICAgICAgcGEuY3VycmVuY3kgfHwge30sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiAgICAgICAgICAgICAgICAgICAgIGkuYW1vdW50ID8gaS5hbW91bnQ6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VnbWVudDogICAgICAgICAgICAgICAgICAgIGkuc2VnbWVudCA/IGkuc2VnbWVudDoge30KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzYXZlQWRqdXN0KCl7CiAgICAgICAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuZGF0YVNvdXJjZUFkanVzLmtlbmRvV2lkZ2V0KCk7CiAgICAgICAgICAgIGxldCBkczEgPSBkcy5kYXRhKCkKICAgICAgICAgICAgbGV0IGRhdGFTb3VyY2UgPSBkczEubWFwKGluZGV4PT57CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGFtb3VudDogICAgICAgICAgICAgaW5kZXguYW1vdW50LAogICAgICAgICAgICAgICAgICAgIGVtcGxveWVlOiAgICAgICAgICAgaW5kZXguZW1wbG95ZWUsCiAgICAgICAgICAgICAgICAgICAgcGF5cm9sbENvbXBvbmVudDogICBpbmRleC5wYXlyb2xsQ29tcG9uZW50LAogICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5OiAgICAgICAgICAgaW5kZXguY3VycmVuY3kKICAgICAgICAgICAgICAgICAgICAvLyBzZWdtZW50OiAgICAgICAgICAgIGluZGV4LnNlZ21lbnQsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGxldCBwYXlyb2xsTGlzdCA9IHRoaXMubG9hZFBheXJvbGxzOwogICAgICAgICAgICBsZXQgaGVscGVyID0ge307CiAgICAgICAgICAgIGxldCByZXN1bHQgPSBkYXRhU291cmNlLnJlZHVjZShmdW5jdGlvbihpbmRleCwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIGlmKHZhbHVlLmVtcGxveWVlLmlkKXsKICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gdmFsdWUucGF5cm9sbENvbXBvbmVudC5jb21wb1R5cGUubmFtZSArJy0nK3ZhbHVlLmVtcGxveWVlLmVtcGxveWVlSWQgOwogICAgICAgICAgICAgICAgICAgIGlmKCFoZWxwZXJba2V5XSkgewogICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXJba2V5XSA9IE9iamVjdC5hc3NpZ24oe30sIHZhbHVlKTsgLy8gY3JlYXRlIGEgY29weSBvZiBvCiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LnB1c2goaGVscGVyW2tleV0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlcltrZXldLmFtb3VudCArPSBwYXJzZUZsb2F0KHZhbHVlLmFtb3VudCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlcltrZXldLmNvbnBvbmVudFR5cGUgPSB2YWx1ZS5wYXlyb2xsQ29tcG9uZW50LmNvbXBvVHlwZS5uYW1lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBpbmRleAogICAgICAgICAgICB9LCBbXSk7CiAgICAgICAgICAgIGxldCBwYXlMaXN0ID0gW107CiAgICAgICAgICAgIGZvciAoY29uc3QgcGEgb2YgcGF5cm9sbExpc3QpewogICAgICAgICAgICAgICAgbGV0IGJlbmVmaXQgPSAwCiAgICAgICAgICAgICAgICBsZXQgZGVkdWN0aW9uMiA9IDA7CiAgICAgICAgICAgICAgICBsZXQgc2FsYXJ5QWRkID0gMDsKICAgICAgICAgICAgICAgIHJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uKHIpewogICAgICAgICAgICAgICAgICAgIGlmKHIucGF5cm9sbENvbXBvbmVudC5uYW1lID09PSAiRGVkdWN0aW9uIiAmJiByLmVtcGxveWVlLmlkID09IHBhLmVtcGxveWVlVXVpZCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZHVjdGlvbjIgPSBwYXJzZUZsb2F0KHIuYW1vdW50KTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihyLnBheXJvbGxDb21wb25lbnQubmFtZSA9PT0gIkJlbmVmaXRzIiAmJiByLmVtcGxveWVlLmlkID09IHBhLmVtcGxveWVlVXVpZCl7CiAgICAgICAgICAgICAgICAgICAgICAgYmVuZWZpdCA9IHBhcnNlRmxvYXQoci5hbW91bnQpCiAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoci5wYXlyb2xsQ29tcG9uZW50LmNvbXBvVHlwZS5pZCA9PT0gImdyb3NzX3NhbGFyeSIgJiYgci5lbXBsb3llZS5pZCA9PSBwYS5lbXBsb3llZVV1aWQpewogICAgICAgICAgICAgICAgICAgICAgICBzYWxhcnlBZGQgPSBwYXJzZUZsb2F0KHIuYW1vdW50KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBwYXlMaXN0LnB1c2goIG5ldyBQYXlyb2xsTGlzdCh7CiAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVVdWlkOiAgICAgICAgICAgICAgIHBhLmVtcGxveWVlVXVpZCwKICAgICAgICAgICAgICAgICAgICBkZWR1Y3Rpb246ICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICBkZWR1Y3Rpb24yOiAgICAgICAgICAgICAgICAgZGVkdWN0aW9uMiwKICAgICAgICAgICAgICAgICAgICBiYW5rOiAgICAgICAgICAgICAgICAgICAgICAgcGEuYmFuaywgCiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3k6ICAgICAgICAgICAgICAgICAgIHBhLmN1cnJlbmN5ID8gcGEuY3VycmVuY3k6IHt9LAogICAgICAgICAgICAgICAgICAgIHRvdGFsQmVuZWZpdDogICAgICAgICAgICAgICBiZW5lZml0LAogICAgICAgICAgICAgICAgICAgIGVtcGxveWVlTmFtZTogICAgICAgICAgICAgICBwYS5lbXBsb3llZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVJZDogICAgICAgICAgICAgICAgIHBhLmVtcGxveWVlSWQsCiAgICAgICAgICAgICAgICAgICAgZ2VuZGVyOiAgICAgICAgICAgICAgICAgICAgIHBhLmdlbmRlciwKICAgICAgICAgICAgICAgICAgICBuYXR1cmVFbXBsb3llZTogICAgICAgICAgICAgcGEubmF0dXJlRW1wbG95ZWUsCiAgICAgICAgICAgICAgICAgICAgbmF0dXJlQ29udHJhY3Q6ICAgICAgICAgICAgIHBhLm5hdHVyZUNvbnRyYWN0LAogICAgICAgICAgICAgICAgICAgIHBheW1lbnRNZXRob2Q6ICAgICAgICAgICAgICBwYS5wYXltZW50TWV0aG9kLAogICAgICAgICAgICAgICAgICAgIHBheXJvbGxMaWFiaWxpdGllOiAgICAgICAgICBwYS5wYXlyb2xsTGlhYmlsaXRpZSwKICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogICAgICAgICAgICAgICAgICAgcGEubG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgb3ZlclRpbWVIb2xpZGF5OiAgICAgICAgICAgIHBhLm92ZXJUaW1lSG9saWRheSwKICAgICAgICAgICAgICAgICAgICBvdmVyVGltZVdlZWtlbmQ6ICAgICAgICAgICAgcGEub3ZlclRpbWVXZWVrZW5kLAogICAgICAgICAgICAgICAgICAgIG92ZXJUaW1lTmlnaHQ6ICAgICAgICAgICAgICBwYS5vdmVyVGltZU5pZ2h0LAogICAgICAgICAgICAgICAgICAgIHBhaWRIb3VyczogICAgICAgICAgICAgICAgICBwYS5wYWlkSG91cnMsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICAgICAgICAgICAgICAgICAgIHBhLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgIHNlZ21lbnQ6ICAgICAgICAgICAgICAgICAgICBwYS5zZWdtZW50LAogICAgICAgICAgICAgICAgICAgIHNhbGFyeTogICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHBhLnNhbGFyeTEpICsgc2FsYXJ5QWRkLAogICAgICAgICAgICAgICAgICAgIHNhbGFyeTE6ICAgICAgICAgICAgICAgICAgICBwYS5zYWxhcnkxLAogICAgICAgICAgICAgICAgICAgIHNhbGFyeTI6ICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHBhLnNhbGFyeTEpICsgc2FsYXJ5QWRkLAogICAgICAgICAgICAgICAgICAgIHNhbGFyeVR5cGU6ICAgICAgICAgICAgICAgICBwYS5zYWxhcnlUeXBlLAogICAgICAgICAgICAgICAgICAgIHdvcmtEYXk6ICAgICAgICAgICAgICAgICAgICBwYS53b3JrRGF5LAogICAgICAgICAgICAgICAgICAgIHdvcmtUaW1lOiAgICAgICAgICAgICAgICAgICBwYS53b3JrVGltZSwgCiAgICAgICAgICAgICAgICAgICAgc3BvdXNlTmF0dXJlRW1wbG95ZWU6ICAgICAgIHBhLnNwb3VzZU5hdHVyZUVtcGxveWVlLAogICAgICAgICAgICAgICAgICAgIHdvcmtpbmdTdGF0dXM6ICAgICAgICAgICAgICBwYS53b3JraW5nU3RhdHVzLAogICAgICAgICAgICAgICAgICAgIHNwb3VzZUdlbmRlcjogICAgICAgICAgICAgICBwYS5zcG91c2VHZW5kZXIsCiAgICAgICAgICAgICAgICAgICAgbm9PZkNoaWxkcmVuOiAgICAgICAgICAgICAgIHBhLm5vT2ZDaGlsZHJlbgogICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5wYXlMaXN0ID0gcGF5TGlzdAogICAgICAgICAgICBsZXQgcGF5cm9sbHMgPSB0aGlzLnBheXJvbGxzCiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gbmV3IFBheXJvbGxSdW4oewogICAgICAgICAgICAgICAgICAgICAgICBpZDogICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGUucGFyYW1zLmlkLAogICAgICAgICAgICAgICAgICAgICAgICBtb250aE9mOiAgICAgICAgICAgICAgcGF5cm9sbHMubW9udGhPZiwKICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogICAgICAgICAgICAgICAgIHBheXJvbGxzLmRhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQ6ICAgICAgICAgICAgICBwYXlyb2xscy5jcmVhdGVkLAogICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEVtcGxveWVlOiAgICAgICAgcGF5cm9sbHMudG90YWxFbXBsb3llZSwKICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiAgICAgICAgICAgICAgIHBheXJvbGxzLm51bWJlciwKICAgICAgICAgICAgICAgICAgICAgICAgbGFzdE51bWJlcjogICAgICAgICAgIHBheXJvbGxzLmxhc3ROdW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIGFiYnI6ICAgICAgICAgICAgICAgICBwYXlyb2xscy5hYmJyLAogICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOdW1iZXI6ICAgICAgcGF5cm9sbHMucmVmZXJlbmNlTnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgICBwYXlOdW1iZXI6ICAgICAgICAgICAgcGF5cm9sbHMucGF5TnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAgICAgICAgICAgICAgICAgcGF5cm9sbHMudHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVuY3k6ICAgICAgICAgICAgIHBheXJvbGxzLmN1cnJlbmN5LAogICAgICAgICAgICAgICAgICAgICAgICBleGNoYW5nZVJhdGU6ICAgICAgICAgcGF5cm9sbHMuZXhjaGFuZ2VSYXRlLAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogICAgICAgICAgICAgcGF5cm9sbHMubG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdG1lbnQ6ICAgICAgICAgICBkYXRhU291cmNlLAogICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsTGlzdDogICAgICAgICAgdGhpcy5wYXlMaXN0LAogICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsTGlzdDE6ICAgICAgICAgcGF5cm9sbHMucGF5cm9sbExpc3QxLAogICAgICAgICAgICAgICAgICAgICAgICBwYXlyb2xsTGlzdDI6ICAgICAgICAgdGhpcy5wYXlMaXN0LAogICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiAgICAgICAgICAgICAgICAgMywKICAgICAgICAgICAgICAgICAgICAgICAgZGVwYXJ0bWVudDogICAgICAgICAgIHBheXJvbGxzLmRlcGFydG1lbnQgfHwgJycsCiAgICAgICAgICAgICAgICAgICAgICAgIG5hdHVyZUNvbnRyYWN0OiAgICAgICBwYXlyb2xscy5uYXR1cmVDb250cmFjdCB8fCAnJywKICAgICAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVHcm91cDogICAgICAgIHBheXJvbGxzLmVtcGxveWVlR3JvdXAgfHwgJycsCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlZFVzZXI6ICAgICAgICAgICB0aGlzLmxvZ2dlZFVzZXIKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIHBheXJvbGxIYW5kbGVyLmNyZWF0ZVBheXJvbGwoZGF0YSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzbm90aWZ5LnN1Y2Nlc3MoJ1N1Y2Nlc3MnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkU3VjY2VzcyhyZXNwb25zZS5kYXRhLnN0YXR1c0NvZGUpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc25vdGlmeS5lcnJvcignU29tZXRoaW5nIHdlbnQgd3JvbmcnKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9ycy5wdXNoKGUpCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBsb2FkU3VjY2VzcyhkYXRhKXsKICAgICAgICAgICAgdGhpcy4kZW1pdCgnaGVhZGxpbmUnLGRhdGEpCiAgICAgICAgfSwKICAgICAgICBhc3luYyBnb0JhY2soKXsKICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuZ28oLTEpCiAgICAgICAgfSwKICAgICAgICBsb2FkUmVjb3JkKHBhcmFtcywgZGF0YUl0ZW0pewogICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgZW1wbG95ZWVIYW5kbGVyLmdldFJlY29yZChwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzLmRhdGEuc3RhdHVzQ29kZSA9PSAyMDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0Lmxlbmd0aCA+IDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb3JkID0gcmVzLmRhdGEuZGF0YVswXS5jdXJyZW5jeQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFJdGVtLnNldCgnY3VycmVuY3knLCB0aGlzLnJlY29yZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9LAogICAgbW91bnRlZDogYXN5bmMgZnVuY3Rpb24gKCl7CiAgICAgICAgYXdhaXQgdGhpcy5hZGRSb3coKQogICAgICAgIGF3YWl0IHRoaXMubG9hZFBheXJvbGxMaXN0KCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZWdtZW50KCkKICAgIH0sCiAgICB3YXRjaDogewogICAgICAgIHByb3BBZGp1c3RtZW50KCl7CiAgICAgICAgICAgIGlmICh0aGlzLnByb3BBZGp1c3RtZW50ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHRoaXMubG9hZFBheXJvbGxMaXN0KCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDp7CgogICAgfQp9Cg=="},{"version":3,"sources":["Adjustment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Adjustment.vue","sourceRoot":"src/views/payroll/payroll_run","sourcesContent":["<template>\n    <v-row>\n        <v-col cols=\"12\" class=\"pt-0\">\n            <v-row>\n                <v-col sm=\"4\" cols=\"12\">\n                    <h3>{{$t('payroll_adjustment')}}</h3>\n                </v-col>\n            </v-row>\n        </v-col>\n        <v-col cols=\"12\">\n            <kendo-datasource ref=\"dataSourceAdjus\"\n                :data=\"adjustmentList\"\n                :change=\"onChanges\"/>\n                <kendo-grid id=\"gridAdjus\" class=\"grid-function\"\n                    :data-source-ref=\"'dataSourceAdjus'\"\n                    :editable=\"true\"\n                    :scrollable-virtual=\"true\">\n                <kendo-grid-column\n                    :field=\"'no'\"\n                    :title=\"$t('no')\"\n                    :template=\"rowNumberTmpl\"\n                    :width=\"80\"\n                    :column-menu=\"false\"\n                    :headerAttributes=\"{ style: 'background-color: #EDF1F5;', class: 'text-center'\t}\"\n                    :attributes=\"{style: 'text-align: center'}\"/>\n                <kendo-grid-column\n                    :field=\"'employee'\"\n                    :width=\"250\"\n                    :title=\"$t('employee_name')\"\n                    :template=\"'<span>#= employee.name#</span>'\"\n                    :editor=\"employeeDropDownEditor\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"/>\n                <kendo-grid-column\n                    :field=\"'payrollComponent'\"\n                    :width=\"220\"\n                    :title=\"$t('payroll_component')\"\n                    :template=\"'<span>#= payrollComponent.name#</span>'\"\n                    :editor=\"payrollComponentDropDownEditor\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"/>\n                <!-- <kendo-grid-column\n                    :field=\"'segment'\"\n                    :title=\"$t('segment')\"\n                    :width=\"150\"\n                    :template=\"'<span>#=segment.name#</span>'\"\n                    :editor=\"segmentDropDownEditor\"\n                    :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/> -->\n                <kendo-grid-column\n                    :field=\"'currency'\"\n                    :title=\"$t('currency')\"\n                    :width=\"200\"\n                    :editable=\"() => {return false;}\"\n                    :template=\"'<span>#=currency.code# - #=currency.name#</span>'\"\n                    :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                <kendo-grid-column\n                    :field=\"'amount'\"\n                    :title=\"$t('amount')\"\n                    :template=\"'<span>#= kendo.toString(amount,`n2`)#</span>'\"\n                    :headerAttributes=\"{\n                        style: 'background-color: #EDF1F5'\n                    }\"\n                    :attributes=\"{\n                        style: 'text-align: right;'\n                    }\"/>\n                 <kendo-grid-column\n                    :width=\"100\"\n                    :command=\"{ iconClass: 'k-icon k-i-trash', text: ' ', click: removeRow, class: 'btn-plus' }\"\n                    :title=\"$t('action')\"\n                    :headerAttributes=\"{style: 'text-align: center; background-color: #EDF1F5'}\"\n                    :attributes=\"{style: 'text-align: center'}\"/>\n            </kendo-grid>\n            <v-btn color=\"primary\"\n                    class=\"float-left rounded-0 white--text mt-3\"\n                    @click=\"addRow\">\n                <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n            </v-btn>\n        </v-col>\n        <LoadingMe :isLoading=\"showLoading\" :fullPage=\"true\" :myLoading=\"true\"  type=\"loading\"/>\n    </v-row>\n</template>\n<script>\n    import kendo from \"@progress/kendo-ui\"\n    import PayrollList from \"@/scripts/model/PayrollList\"\n    import PayrollRun from \"@/scripts/model/PayrollRun\";\n    import Adjustment from \"@/scripts/model/Adjustment\"\n    const settingsHandler = require(\"@/scripts/settingsHandler\")\n    const payrollHandler = require(\"@/scripts/payrollHandler\")\n    const employeeHandler = require(\"@/scripts/employeeHandler\")\n    const payrollListModel = new PayrollList({})\n    const adjustmentModel = new Adjustment({})\n    const $ = require(\"jquery\")\n    const cookieJS = require(\"@/cookie.js\");\n    const cookie = cookieJS.getCookie();\n\n    export default {\n        props:['propAdjustment'],\n        data: () =>({\n            journal_date: \"\",\n            dialogm: false,\n            pyrollList: [],\n            showLoading: false,\n            payrollList: payrollListModel,\n            adjustment: adjustmentModel,\n            adjustmentList: [],\n            segments: [],\n            loggedUser: {\n                id: cookie.creator,\n                name: cookie.email\n            },\n            record: {}\n        }),\n        components: {\n            LoadingMe: () => import(`@/components/Loading`)\n        },\n        methods:{\n            loadPayrollList(){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        this.showLoading = true;\n                        payrollHandler.getPayroll(this.$route.params.id).then(res => {\n                            this.showLoading = true;\n                            if(res.data.statusCode === 200){\n                                const resultPay = res.data.data[0]\n                                if(resultPay.step >= 2){\n                                    this.loadPayrollItem(resultPay)\n                                }\n                            }\n                        })\n                    }, 300);\n                })\n            },\n            loadPayrollItem(result){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved')\n                        this.employee = []\n                        payrollHandler.getPayrollItem(result.id).then(res => {\n                            this.showLoading = true\n                            if (res.data.statusCode === 200) {\n                                let resutl_item = res.data.data\n                                this.showLoading = false\n                                this.loadPayrolls = resutl_item\n                                this.payrolls   = result\n                                if(result.adjustment.length > 0){\n                                    this.adjustmentList = result.adjustment\n                                }else{\n                                    let ds = this.$refs.dataSourceAdjus.kendoWidget();\n                                    this.adjustmentList = ds.data([])\n                                    this.addRow()\n                                    this.calculateAdjust()\n                                }\n                                this.loadSuccess(res.data.statusCode)\n                                this.showLoading = false;\n                            }\n                        }).catch()\n                        {\n                            this.showLoading = false\n                        }\n                    }, 300)\n                })\n            },\n            async loadSegment() {\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved')\n                        this.segments = []\n                        settingsHandler.getSeg().then(res => {\n                            this.showLoading = true\n                            if (res.data.statusCode === 200) {\n                                this.showLoading = false\n                                this.segments = res.data.data\n                            }\n                        }).catch()\n                        {\n                            this.showLoading = false\n                        }\n                    }, 300)\n                })\n            },\n            rowNumberTmpl(dataItem) {\n                var ds = this.$refs.dataSourceAdjus.kendoWidget(),\n                    index = ds.indexOf(dataItem);\n                return index + 1;\n            },\n            addRow() {\n                let ds = this.$refs.dataSourceAdjus.kendoWidget(),\n                    total = ds.total();\n                ds.insert(total,{\n                    payrollComponent: {\n                        name: '-- Select --',\n                    },\n                    employee: {\n                        name: '-- Select --',\n                    },\n                    amount: 0,\n                    segment: {\n                        name: '-- Select --',\n                    },\n                    currency:  {\n                        code: '',\n                        name: '- Select --'\n                    }\n                });\n            },\n            removeRow(e) {\n                e.preventDefault();\n                const grid = kendo.jQuery(\"#gridAdjus\").data(\"kendoGrid\"),\n                    dataSource = grid.dataSource,\n                    dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n                if (dataSource.total() > 1) {\n                    dataSource.remove(dataItem);\n                }\n            },\n            onChanges(e){\n                this.loadEmployee()   \n                this.loadPayrollComponent() \n                this.loadSegment() \n                if (e.field === \"employee\") {\n                    let dataItem = e.items[0]\n                    let params = {\n                        status: 1,\n                        employeeId: dataItem.employee.employeeId\n                    }\n                   this.loadRecord(params, dataItem)\n                }   \n            },\n            employeeDropDownEditor(container, options){\n                kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"contains\",\n                    dataTextField: \"name\",\n                    dataValueField: \"name\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.employee,\n                    })\n                })\n            },\n            payrollComponentDropDownEditor(container, options){\n                kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"contains\",\n                    dataTextField: \"name\",\n                    dataValueField: \"name\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.payrollComponent,\n                    })\n                })\n            },\n            segmentDropDownEditor(container, options){\n                kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 400,\n                    dataTextField: \"name\",\n                    dataValueField: \"name\",\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.segments,\n                    })\n                })\n            },\n            async loadEmployee(){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved')\n                        this.employee = []\n                        employeeHandler.center().then(res => {\n                            this.showLoading = true\n                            if (res.data.statusCode === 200) {\n                                this.showLoading = false\n                                this.employee = res.data.data\n                            }\n                        }).catch()\n                        {\n                            this.showLoading = false\n                        }\n                    }, 300)\n                })\n            },\n            async loadPayrollComponent(){\n                new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved')\n                        this.payrollComponent = []\n                        payrollHandler.getComponent().then(res => {\n                            this.showLoading = true\n                            if (res.data.statusCode === 200) {\n                                this.showLoading = false\n                                const types = ['deduction','benefit','gross_salary']\n                                this.payrollComponent =  res.data.data.filter(m => {\n                                    const exist = types.filter(n=> n === m.compoType.id)\n                                        if(exist.length > 0){\n                                            return m\n                                        }\n                                    }\n                                )\n                            }\n                        }).catch()\n                        {\n                            this.showLoading = false\n                        }\n                    }, 300)\n                })\n            },\n            calculateAdjust(){\n                let payrollList = this.loadPayrolls;\n                for (const pa of payrollList){\n                    if(pa.benefit){\n                        pa.benefit.forEach(i=>{\n                            if(i.amount > 0){\n                                this.adjustmentList.push({\n                                    employee:                   {\n                                        // address:                pa.employee.address,\n                                        // bank:                   pa.employee.bank,\n                                        // bankAccount:            pa.employee.bankAccount,\n                                        // country:                pa.employee.country,\n                                        // dob:                    pa.employee.dob,\n                                        // email:                  pa.employee.email,\n                                        employeeId:             pa.employee.employeeId,\n                                        // employeeType:           pa.employee.employeeType,\n                                        // firstName:              pa.employee.firstName,\n                                        // firstNameLocale:        pa.employee.firstNameLocale,\n                                        // gender:                 pa.employee.gender,\n                                        id:                     pa.employee.id,\n                                        // identityId:             pa.employee.identityId,\n                                        // identityType:           pa.employee.identityType,\n                                        // image:                  pa.employee.image,\n                                        // lastName:               pa.employee.lastName,\n                                        // lastNameLocale:         pa.employee.lastNameLocale,\n                                        // maritalStatus:          pa.employee.maritalStatus,\n                                        // nationality:            pa.employee.nationality,\n                                        // natureEmployee:         pa.employee.natureEmployee,\n                                        // noOfChildren:           pa.employee.noOfChildren,\n                                        // paymentMethod:          pa.employee.paymentMethod,\n                                        // paymentPeriod:          pa.employee.paymentPeriod,\n                                        // payrollLiabilitie:      pa.employee.payrollLiabilitie,\n                                        // phone:                  pa.employee.phone,\n                                        // salaryAcc:              pa.employee.salaryAcc,\n                                        // salaryAdvanceAcc:       pa.employee.salaryAdvanceAcc,\n                                        // spouseGender:           pa.employee.spouseGender,\n                                        // spouseName:             pa.employee.spouseName,\n                                        // spouseNatureEmployee:   pa.employee.spouseNatureEmployee,\n                                        // status:                 pa.employee.status,\n                                        // workingStatus:          pa.employee.workingStatus,\n                                        name:                   pa.employee.employeeId + ' - ' +  pa.employee.firstName +' '+ pa.employee.lastName,\n                                    },\n                                    payrollComponent:           i.component ? i.component: {},\n                                    currency:                   pa.currency || {},\n                                    amount:                     i.amount ? i.amount: 0,\n                                    // segment:                    i.segment ? i.segment: {}\n                                })\n                            }\n                        })\n                    }\n                }\n            },\n            saveAdjust(){\n                let ds = this.$refs.dataSourceAdjus.kendoWidget();\n                let ds1 = ds.data()\n                let dataSource = ds1.map(index=>{\n                    return {\n                        amount:             index.amount,\n                        employee:           index.employee,\n                        payrollComponent:   index.payrollComponent,\n                        currency:           index.currency\n                        // segment:            index.segment,\n                    }\n                })\n                let payrollList = this.loadPayrolls;\n                let helper = {};\n                let result = dataSource.reduce(function(index, value) {\n                    if(value.employee.id){\n                        let key = value.payrollComponent.compoType.name +'-'+value.employee.employeeId ;\n                        if(!helper[key]) {\n                            helper[key] = Object.assign({}, value); // create a copy of o\n                            index.push(helper[key]);\n                        } else {\n                            helper[key].amount += parseFloat(value.amount);\n                            helper[key].conponentType = value.payrollComponent.compoType.name;\n                        }\n                    }\n                    return index\n                }, []);\n                let payList = [];\n                for (const pa of payrollList){\n                    let benefit = 0\n                    let deduction2 = 0;\n                    let salaryAdd = 0;\n                    result.forEach(function(r){\n                        if(r.payrollComponent.name === \"Deduction\" && r.employee.id == pa.employeeUuid){\n                            deduction2 = parseFloat(r.amount);\n                        }else if(r.payrollComponent.name === \"Benefits\" && r.employee.id == pa.employeeUuid){\n                           benefit = parseFloat(r.amount)\n                        }else if(r.payrollComponent.compoType.id === \"gross_salary\" && r.employee.id == pa.employeeUuid){\n                            salaryAdd = parseFloat(r.amount)\n                        }\n                    })\n                    payList.push( new PayrollList({\n                        employeeUuid:               pa.employeeUuid,\n                        deduction:                  0,\n                        deduction2:                 deduction2,\n                        bank:                       pa.bank, \n                        currency:                   pa.currency ? pa.currency: {},\n                        totalBenefit:               benefit,\n                        employeeName:               pa.employeeName,\n                        employeeId:                 pa.employeeId,\n                        gender:                     pa.gender,\n                        natureEmployee:             pa.natureEmployee,\n                        natureContract:             pa.natureContract,\n                        paymentMethod:              pa.paymentMethod,\n                        payrollLiabilitie:          pa.payrollLiabilitie,\n                        location:                   pa.location,\n                        overTimeHoliday:            pa.overTimeHoliday,\n                        overTimeWeekend:            pa.overTimeWeekend,\n                        overTimeNight:              pa.overTimeNight,\n                        paidHours:                  pa.paidHours,\n                        position:                   pa.position,\n                        segment:                    pa.segment,\n                        salary:                     parseFloat(pa.salary1) + salaryAdd,\n                        salary1:                    pa.salary1,\n                        salary2:                    parseFloat(pa.salary1) + salaryAdd,\n                        salaryType:                 pa.salaryType,\n                        workDay:                    pa.workDay,\n                        workTime:                   pa.workTime, \n                        spouseNatureEmployee:       pa.spouseNatureEmployee,\n                        workingStatus:              pa.workingStatus,\n                        spouseGender:               pa.spouseGender,\n                        noOfChildren:               pa.noOfChildren\n                    }))\n                }\n                this.payList = payList\n                let payrolls = this.payrolls\n                new Promise(resolve => {\n                    setTimeout(() => {\n                    resolve('resolved');\n                        let data = new PayrollRun({\n                            id:                   this.$route.params.id,\n                            monthOf:              payrolls.monthOf,\n                            date:                 payrolls.date,\n                            created:              payrolls.created,\n                            totalEmployee:        payrolls.totalEmployee,\n                            number:               payrolls.number,\n                            lastNumber:           payrolls.lastNumber,\n                            abbr:                 payrolls.abbr,\n                            referenceNumber:      payrolls.referenceNumber,\n                            payNumber:            payrolls.payNumber,\n                            type:                 payrolls.type,\n                            currency:             payrolls.currency,\n                            exchangeRate:         payrolls.exchangeRate,\n                            location:             payrolls.location,\n                            adjustment:           dataSource,\n                            payrollList:          this.payList,\n                            payrollList1:         payrolls.payrollList1,\n                            payrollList2:         this.payList,\n                            step:                 3,\n                            department:           payrolls.department || '',\n                            natureContract:       payrolls.natureContract || '',\n                            employeeGroup:        payrolls.employeeGroup || '',\n                            loggedUser:           this.loggedUser\n                        });\n                        this.showLoading = true\n                        payrollHandler.createPayroll(data).then(response => {\n                            this.showLoading = true\n                            if (response.data.statusCode === 201) {\n                                this.showLoading = false\n                                this.$snotify.success('Success')\n                                this.loadSuccess(response.data.statusCode)\n                            }\n                        }).catch(e => {\n                            this.$snotify.error('Something went wrong')\n                            this.errors.push(e)\n                        })\n                    }, 300);\n                })\n            },\n            loadSuccess(data){\n                this.$emit('headline',data)\n            },\n            async goBack(){\n                window.history.go(-1)\n            },\n            loadRecord(params, dataItem){\n                 new Promise(resolve => {\n                    setTimeout(() => {\n                        resolve('resolved');\n                        this.showLoading = true\n                        employeeHandler.getRecord(params).then(res => {\n                            if(res.data.statusCode == 200){\n                                this.showLoading = false\n                                let result = res.data.data\n                                if(result.length > 0){\n                                    this.record = res.data.data[0].currency\n                                    dataItem.set('currency', this.record)\n                                }\n                            }\n                        })\n\n                    }, 300);\n                })\n            }\n        },\n        mounted: async function (){\n            await this.addRow()\n            await this.loadPayrollList()\n            await this.loadSegment()\n        },\n        watch: {\n            propAdjustment(){\n                if (this.propAdjustment !== undefined) {\n                    this.loadPayrollList()\n                }\n            }\n        },\n        computed:{\n    \n        }\n    }\n</script>\n<style scoped>\n    .grayBg{\n        background-color: #F8F8F9;\n    }\n    .my_table_darkv .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr > th {\n        color: rgba(0, 0, 0, 0.6);\n        background: #222a35;\n        color: #fff !important;\n    }"]}]}