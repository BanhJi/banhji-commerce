{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/products_services/service/TransactionItems.vue?vue&type=style&index=0&id=7ff16ccc&scoped=true&lang=css&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/products_services/service/TransactionItems.vue","mtime":1643017405547},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmZ1bmN0aW9uX2Zvb3RlciB7CiAgICBwYWRkaW5nOiAxNXB4OwogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwp9CgpwIHsKICAgIGNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuODcpOwp9CgouYWN0aW9uQnRuIHsKICAgIGhlaWdodDogNDcuMnB4ICFpbXBvcnRhbnQ7Cn0KCi50ZXh0X3RpcCB7CiAgICBmb250LXNpemU6IDlweDsKICAgIGxpbmUtaGVpZ2h0OiAxMHB4Owp9CgpAbWVkaWEgKG1heC13aWR0aDogNTc2cHgpIHsKfQo="},{"version":3,"sources":["TransactionItems.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoXA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"TransactionItems.vue","sourceRoot":"src/views/products_services/service","sourcesContent":["<template>\n    <v-row>\n        <v-col sm=\"12\" cols=\"12\" class=\"pt-0\">\n            <h2 class=\"mb-0 font_20\">{{ $t('transaction_items') }}</h2>\n            <v-dialog v-model=\"dialogM3\" max-width=\"600px\">\n                <template v-slot:activator=\"{ on }\">\n                    <v-btn color=\"primary\" class=\" white--text float-right text-capitalize\"\n                           v-on=\"on\" @click=\"newClick\">\n                        {{ $t('new_transaction_item') }}\n                    </v-btn>\n                </template>\n                <v-card>\n                    <div class=\"modal_header\">\n                        <v-card-title>{{ $t('transaction_item') }}</v-card-title>\n                        <v-icon @click=\"dialogM3 = false\">close</v-icon>\n                    </div>\n                    <v-card-text class=\"modal_text_content\">\n                        <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\n                            <v-row>\n                                <v-col sm=\"6\" cols=\"12\" class=\"pb-0\">\n                                    <label>{{ $t('number') }}</label>\n                                    <v-text-field class=\"mt-1\"\n                                                  v-model=\"transactionItem.number\"\n                                                  outlined\n                                                  clearable\n                                                  :rules=\"[v => !!v || $t('is_required')]\"/>\n\n                                    <label>{{ $t('name') }}</label>\n                                    <v-text-field class=\"mt-1\"\n                                                  v-model=\"transactionItem.name\"\n                                                  outlined\n                                                  clearable\n                                                  :rules=\"[v => !!v || $t('is_required')]\"/>\n\n                                    <label>{{ $t('account') }}</label>\n                                    <v-select class=\"mt-1\"\n                                              outlined\n                                              tage=\"Account\"\n                                              v-model=\"mAccount\"\n                                              :items=\"account\"\n                                              item-value=\"id\"\n                                              :item-text=\"item =>`${item.number} - ${item.name}`\"\n                                              :rules=\"[v => !!v['id'] || $t('is_required')]\"\n                                              return-object\n                                              clearable/>\n                                </v-col>\n                                <v-col sm=\"6\" cols=\"12\" class=\"pb-0\">\n                                    <label class=\"label\">{{ $t('uom') }}</label>\n                                    <v-select class=\"mt-1\"\n                                              outlined\n                                              tage=\"Uom\"\n                                              v-model=\"mUOM\"\n                                              :items=\"uom\"\n                                              item-value=\"id\"\n                                              :item-text=\"item =>`${item.category?item.category.name: ''} - ${item.name}`\"\n                                              :rules=\"[v => !!v['id'] || $t('is_required')]\"\n                                              return-object\n                                              clearable/>\n\n                                    <label>{{ $t('descriptions') }}</label>\n                                    <v-textarea rows=\"4\" class=\"mt-1\" no-resize height=\"122px\"\n                                                v-model=\"transactionItem.description\"\n                                                outlined clearable/>\n\n                                </v-col>\n                            </v-row>\n                        </v-form>\n                    </v-card-text>\n                    <v-card-actions class=\"modal_footer\">\n                        <v-row>\n                            <v-col sm=\"6\" cols=\"6\" class=\"py-0 text-left\">\n                                <v-btn color=\"black\" outlined\n                                       class=\" text-capitalize  black--text float-left\"\n                                       @click=\"dialogM3 = false\">{{ $t('cancel') }}\n                                </v-btn>\n                            </v-col>\n                            <v-col sm=\"6\" cols=\"6\" class=\"py-0 text-right\">\n                                <v-btn color=\"primary\" class=\"px-3  white--text text-capitalize\"\n                                       @click=\"onSaveClose\">\n                                    {{ $t('save_close') }}\n                                </v-btn>\n                            </v-col>\n                        </v-row>\n                    </v-card-actions>\n                </v-card>\n            </v-dialog>\n\n        </v-col>\n\n        <v-col sm=\"12\" cols=\"12\" class=\"pl-4\">\n            <LoadingMe :isLoading=\"showLoading\" :fullPage=\"false\" :myLoading=\"true\" type=\"loading\"/>\n            <template>\n                <kendo-datasource ref=\"transactionItemDS\"\n                                  :data=\"transactionList\"/>\n                <kendo-grid id=\"gridTranItem\" class=\"grid-function\"\n                            :data-source-ref=\"'transactionItemDS'\"\n                            :editable=\"false\"\n                            :toolbar=\"toolbarTemplate\"\n                            :excel-export=\"excelExport\"\n                            :excel-file-name=\"'TransactionItems.xlsx'\"\n                            :excel-filterable=\"true\"\n                            :excel-all-pages=\"true\"\n                            :scrollable-virtual=\"true\">\n                    <kendo-grid-column\n                        :field=\"'no'\"\n                        :title=\"$t('no')\"\n                        :template=\"rowNumberTmpl\"\n                        :width=\"60\"\n                        :column-menu=\"false\"\n                        :headerAttributes=\"{ style: 'background-color: #EDF1F5;', class: 'text-center'\t}\"\n                        :attributes=\"{style: 'text-align: center'}\"/>\n                    <kendo-grid-column\n                        :field=\"'number'\"\n                        :title=\"$t('number')\"\n                        :width=\"100\"\n                        :template=\"'<span>#=number#</span>'\"\n                        :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                    <kendo-grid-column\n                        :field=\"'name'\"\n                        :title=\"$t('name')\"\n                        :attributes=\"{class:'tb_name_td'}\"\n                        :width=\"180\"\n                        :template=\"'<span>#=name#</span>'\"\n                        :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                    <kendo-grid-column\n                        :field=\"'account'\"\n                        :title=\"$t('account')\"\n\n                        :hidden=\"true\"\n                        :template=\"'<span>#=account.name#</span>'\"\n                        :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                    <kendo-grid-column\n                        :field=\"'uom'\"\n                        :title=\"$t('uom')\"\n                        :width=\"100\"\n                        :template=\"'<span>#=uom.name#</span>'\"\n                        :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                    <kendo-grid-column\n                        :field=\"'description'\"\n                        :title=\"$t('description')\"\n                        :width=\"200\"\n                        :template=\"'<span>#=description#</span>'\"\n                        :headerAttributes=\"{ style: 'background-color: #EDF1F5' }\"/>\n                    <kendo-grid-column\n                        :field=\"''\"\n                        :title=\"$t('action')\"\n                        :width=\"100\"\n                        :command=\"[{ iconClass: 'k-icon k-i-edit', text: 'Edit', click: goEdit }]\"\n                        :headerAttributes=\"{style: ' background-color: #EDF1F5'}\"/>\n                </kendo-grid>\n            </template>\n        </v-col>\n    </v-row>\n</template>\n<script>\nimport TransactionItemModel from \"@/scripts/model/TransactionItems\";\nimport kendo from \"@progress/kendo-ui\";\n\nconst transactionItemHandler = require(\"@/scripts/transactionItemHandler\")\nconst transactionItemModel = new TransactionItemModel({})\nconst uomHandler = require(\"@/scripts/uomHandler\")\nconst accountHandler = require(\"@/scripts/handler/accounting/account\")\nconst $ = kendo.jQuery\nexport default {\n    data: () => ({\n        showLoading: false,\n        dialogM3: false,\n        account: [],\n        uom: [],\n        mUOM: {},\n        transactionList: [],\n        mAccount: {},\n        schemaDefinition: {\n            model: {\n                id: \"id\"\n            }\n        },\n        valid: true,\n        transactionItem: transactionItemModel\n    }),\n    props: {},\n    methods: {\n        rowNumberTmpl(dataItem) {\n            let ds = this.$refs.transactionItemDS.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        async loadAccount() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    accountHandler.getAll().then(res => {\n                        this.showLoading = false\n                        this.account = res.data.map(item => {\n                            return {\n                                id: item.uuid,\n                                uuid: item.uuid,\n                                name: item.name,\n                                local_name: item.local_name,\n                                number: item.number,\n                                is_taxable: item.is_taxable,\n                                banhjiAccCode: item.banhjiAccCode,\n                                group_code: item.group_code,\n                                parent_account: item.parent_account,\n                                type_code: item.type_code,\n                                account_type: item.account_type\n                            }\n                        })\n                        if (this.account.length > 0) {\n                            this.mAccount = this.account[0]\n                        }\n                    })\n                }, 300);\n            })\n        },\n        async loadUOM() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    uomHandler.get().then(res => {\n                        this.showLoading = false\n                        this.uom = res\n                        if (this.uom.length > 0) {\n                            this.mUOM = this.uom[0]\n                        }\n                    })\n                }, 300);\n            })\n        },\n        async loadTransactionItems() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    this.showLoading = true\n                    transactionItemHandler.list().then(res => {\n                        if (res.data.statusCode === 200)\n                            this.showLoading = false\n                        this.transactionList = res.data.data\n                    })\n                }, 300);\n            })\n        },\n        async onSaveClose() {\n            if (!this.$refs.form.validate()) {\n                this.$refs.form.validate()\n                return\n            }\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    let data = {\n                        id: this.transactionItem.id,\n                        name: this.transactionItem.name,\n                        number: this.transactionItem.number,\n                        description: this.transactionItem.description,\n                        uom: this.mUOM,\n                        account: this.mAccount,\n                        type: \"Transaction Item\",\n                        status: 1,\n                        actionType: this.transactionItem.id ? 'edit' : 'new'\n                    }\n                    transactionItemHandler.create(data).then(response => {\n                        if (response.data.statusCode === 201) {\n\n                            const res = response.data.data\n                            const index = this.transactionList.findIndex(item => {\n                                return (res.id === item.id)\n                            })\n                            if (this.transactionList.length === 0) {\n                                this.loadTransactionItems()\n                            } else {\n                                if (index < 0) {\n                                    this.transactionList.push(res)\n                                } else {\n                                    this.transactionList.splice(index, 1, res)\n                                }\n                            }\n\n                            this.$snotify.success('Success')\n                            this.close()\n                        }\n                    }).catch(e => {\n                        this.$snotify.error('Something went wrong')\n                        this.errors.push(e)\n                    })\n                })\n            })\n        },\n        cancel() {\n            this.dialogM3 = false\n        },\n        close() {\n            this.dialogM3 = false\n        },\n        newClick() {\n            this.transactionItem = {}\n            this.mAccount = {}\n            this.mUOM = {}\n            this.dialogM3 = true\n\n        },\n        goEdit(e) {\n            e.preventDefault();\n            let grid = kendo.jQuery(\"#gridTranItem\").data(\"kendoGrid\");\n            let dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"))\n            this.transactionItem = dataItem\n            this.mUOM = dataItem.uom\n            this.mAccount = dataItem.account\n            this.dialogM3 = true\n        },\n\n        initToolbar(that) {\n            let grid = $(\"#gridTranItem\").data(\"kendoGrid\");\n            let gridElement = grid.element;\n            let toolbarElement = gridElement.find(\".k-grid-toolbar\");\n            toolbarElement.on(\"click\", \".k-pager-refresh\", function (e) {\n                e.preventDefault();\n                onReloadData(that);\n            });\n            toolbarElement.on(\"click\", \".k-pager-excel\", function (e) {\n                e.preventDefault();\n                onExportExcel(that);\n            });\n\n            function onReloadData(that) {\n                that.loadTransactionItems();\n            }\n\n            function onExportExcel(that) {\n                that.exportToExcel();\n            }\n        },\n        exportToExcel() {\n            const grid = $(\"#gridTranItem\").data(\"kendoGrid\")\n            grid.saveAsExcel()\n        },\n        toolbarTemplate: function () {\n            const templateHtml =\n                '<span>' +\n                '<a class=\"k-pager-excel k-link k-button excel\" title=\"Export to Excel\"> <span class=\"k-icon k-i-excel\"></span>Export to excel </a>' +\n                '</span><span>&nbsp;&nbsp;</span>' +\n                '<span style=\"position:absolute; right:5px\">' +\n                '</span>' +\n                '<span>' +\n                '<a class=\"k-pager-refresh k-link k-button reload\" title=\"Refresh\"><span class=\"k-icon k-i-reload\"></span> Refresh </a>' +\n                '</span>'\n\n            return kendo.template(templateHtml)\n        },\n        excelExport: function (e) {\n            // const pivot = this.$refs.gridTransactionDS.kendoWidget()\n            // pivot.saveAsExcel()\n            window.console.log(e.data);\n        },\n    },\n    mounted: async function () {\n        await this.loadUOM()\n        await this.loadTransactionItems()\n        await this.initToolbar(this)\n    },\n    created: async function () {\n        await this.loadAccount()\n    },\n    computed: {},\n    components: {\n        LoadingMe: () => import(`@/components/Loading`)\n    },\n};\n</script>\n\n<style scoped>\n\n.function_footer {\n    padding: 15px;\n    display: inline-block;\n}\n\np {\n    color: rgba(0, 0, 0, 0.87);\n}\n\n.actionBtn {\n    height: 47.2px !important;\n}\n\n.text_tip {\n    font-size: 9px;\n    line-height: 10px;\n}\n\n@media (max-width: 576px) {\n}\n</style>\n"]}]}