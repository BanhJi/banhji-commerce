{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/suppliers/expense/advance_setlement/AdvanceSettlement.vue?vue&type=style&index=0&id=8c156162&scoped=true&lang=css&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/suppliers/expense/advance_setlement/AdvanceSettlement.vue","mtime":1638499443349},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouay1jaGFydCB7CiAgaGVpZ2h0OiAxODBweDsKfQoKLnRoZW1lLS1saWdodC52LWRhdGEtdGFibGUgewogIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7Cn0KCi52LWRhdGEtdGFibGUgPiAudi1kYXRhLXRhYmxlX193cmFwcGVyID4gdGFibGUgPiB0Ym9keSA+IHRyID4gdGQgewogIGhlaWdodDogMzJweCAhaW1wb3J0YW50OwogIGJvcmRlci1ib3R0b206IHRoaW4gc29saWQgcmdiYSgwLCAwLCAwLCAwLjEyKSAhaW1wb3J0YW50Owp9Cgoudi1kYXRhLXRhYmxlID4gLnYtZGF0YS10YWJsZV9fd3JhcHBlciA+IHRhYmxlID4gdGJvZHkgPiB0cjpmaXJzdC1jaGlsZCA+IHRkIHsKICBib3JkZXItdG9wOiB0aGluIHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xMikgIWltcG9ydGFudDsKfQoKLnRoZW1lLS1saWdodC52LWRhdGEtdGFibGUKICA+IC52LWRhdGEtdGFibGVfX3dyYXBwZXIKICA+IHRhYmxlCiAgPiB0Ym9keQogID4gdHI6aG92ZXI6bm90KC52LWRhdGEtdGFibGVfX2V4cGFuZGVkX19jb250ZW50KTpub3QoLnYtZGF0YS10YWJsZV9fZW1wdHktd3JhcHBlcikgewogIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7Cn0KQG1lZGlhIChtYXgtd2lkdGg6IDU3NnB4KSB7CiAgLnBhZGRpbmdUIHsKICAgIHBhZGRpbmctdG9wOiAwICFpbXBvcnRhbnQ7CiAgfQp9Cg=="},{"version":3,"sources":["AdvanceSettlement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+RA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdvanceSettlement.vue","sourceRoot":"src/views/suppliers/expense/advance_setlement","sourcesContent":["<template>\n  <v-row>\n    <v-col sm=\"12\" cols=\"12\" class=\"grayBg px-6\">\n      <v-card color=\"white\" class=\"pa-3 no_border\" elevation=\"0\">\n        <v-row>\n          <v-col sm=\"8\" cols=\"8\" class=\"py-0\">\n            <h2 class=\"mb-1 font_20\">\n              {{ $t(\"cash_advances_their_settlement\") }}\n            </h2>\n            <p class=\"mb-0\">{{ $t(\"cash_advances_their_settlement_desc\") }}</p>\n          </v-col>\n          <v-col sm=\"4\" cols=\"4\" class=\"py-0\">\n            <v-btn class=\"float-right capitalize white--text\" to=\"advance_settlement\" color=\"primary\">\n              {{ $t(\"add_new\") }}\n            </v-btn>\n          </v-col>\n        </v-row>\n\n        <v-row>\n          <v-col sm=\"3 \" cols=\"12\" class=\"py-0\">\n            <label class=\"label text-uppercase\">{{ $t(\"as_of\") }}</label>\n            <app-datepicker\n              :initialDate=\"asOfDate\"\n              @emitDate=\"asOfDate = $event\"\n            />\n          </v-col>\n          <v-col sm=\"1\" cols=\"12\" class=\"pt-6 mb-0 paddingT\">\n            <v-btn\n              class=\"btn_search\"\n              style=\"background-color: rgb(237, 241, 245)\"\n              @click=\"search\"\n            >\n              <i\n                class=\"b-search\"\n                style=\"font-size: 18px; color:#fff !important;\"\n              />\n            </v-btn>\n          </v-col>\n        </v-row>\n\n        <!-- loading -->\n        <LoadingMe\n          :isLoading=\"showLoading\"\n          :fullPage=\"false\"\n          :myLoading=\"true\"\n        />\n\n        <v-row>\n          <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n            <kendo-datasource\n              ref=\"dataSource\"\n              :data=\"cashAdvanceList\"\n              :group=\"groupDefinition\"\n              :aggregate=\"aggregateDefinition\"\n              :group-paging=\"true\"\n            />\n\n            <kendo-grid\n              id=\"gridGL\"\n              ref=\"gridGL\"\n              class=\"custom_grid\"\n              :data-source-ref=\"'dataSource'\"\n              :sortable=\"true\"\n              :column-menu=\"true\"\n              :reorderable=\"true\"\n              :resizable=\"true\"\n              :noRecords=\"true\"\n              :navigatable=\"true\"\n            >\n              <kendo-grid-column\n                :field=\"'advance_date'\"\n                :title=\"$t('date')\"\n                :template=\"dateTemplate\"\n                :groupFooterTemplate=\"'Total:'\"\n                :width=\"100\"\n              />\n              <kendo-grid-column\n                :field=\"'requested_by.name'\"\n                :title=\"$t('employee')\"\n                :width=\"150\"\n                :hidden=\"true\"\n                groupHeaderTemplate=\"<span class=`text-bold text-black`>#=value#</span>\"\n              />\n              <kendo-grid-column\n                :field=\"'number'\"\n                :title=\"$t('advance_number')\"\n                :template=\"numberTemplate\"\n                :width=\"150\"\n              />\n              <kendo-grid-column\n                :field=\"'amount'\"\n                :title=\"$t('amount')\"\n                :format=\"'{0:n}'\"\n                :width=\"100\"\n                :groupFooterTemplate=\"\n                  '<div style=text-align:right>#= kendo.toString(sum, `n`) #</div>'\n                \"\n                :attributes=\"{\n                  style: 'text-align: right;',\n                }\"\n              />\n              <kendo-grid-column\n                :field=\"'advance_settlement'\"\n                :title=\"$t('advance_settlement')\"\n                :template=\"settlementTemplate\"\n                :width=\"200\"\n              />\n              <kendo-grid-column\n                :field=\"'actual_expense_amount'\"\n                :title=\"$t('actual_expense')\"\n                :format=\"'{0:n}'\"\n                :groupFooterTemplate=\"\n                  '<div style=text-align:right>#= kendo.toString(sum, `n`) #</div>'\n                \"\n                :width=\"100\"\n                :attributes=\"{\n                  style: 'text-align: right',\n                }\"\n              />\n            </kendo-grid>\n\n            <pager \n              :skip=\"responseData.skip\" \n              :take=\"responseData.item_per_page\" \n              :total=\"responseData.total_item_count\" \n              :button-count=\"responseData.buttonCount\" \n              :info=\"responseData.info\" \n              :type=\"responseData.type\" \n              :page-sizes=\"responseData.pageSizes ? responseData.pageSizeDefs : undefined\"\n              :previous-next=\"responseData.previousNext\" \n              @pagechange=\"handlePageChange\" >\n            </pager>\n          </v-col>\n        </v-row>\n      </v-card>\n    </v-col>\n  </v-row>\n</template>\n\n<script>\n// import { i18n } from '@/i18n'\nimport kendo from \"@progress/kendo-ui\";\nimport { Pager } from '@progress/kendo-vue-data-tools';\nimport Helper from \"@/helper.js\";\nimport { CashAdvanceModel } from \"@/scripts/model/AppModels\";\nimport ResponseDataModel from \"@/scripts/model/ResponseData\";\n\nconst { cashAdvanceHandler } = require(\"@/scripts/AppHandlers\");\nconst { EntityType } = require(\"@/scripts/default_setup/Collections\");\n\nexport default {\n  name: \"CashAdvanceAndSettlement\",\n  components: {\n    \"pager\": Pager,\n    LoadingMe: () => import(\"@/components/Loading\"),\n    \"app-datepicker\": () =>\n      import(\"@/components/custom_templates/DatePickerComponent\"),\n  },\n  data: () => ({\n    responseData : new ResponseDataModel(),\n    asOfDate: new Date().toISOString().substr(0, 10),\n    cashAdvance: {\n      advance_date: \"\",\n      requested_by: {}, //Employee\n      number: \"\",\n      amount: 0,\n      is_settled: 0,\n      advance_settlement: {\n        settlement_date: \"\",\n        number: \"\",\n        amount: 0,\n      },\n      actual_expense_amount: 0,\n    },\n    cashAdvances: [],\n    cashAdvanceList: [],\n    cashBalance: 0,\n\n    // Kendo dataSource\n    groupDefinition: {\n      field: \"requested_by.name\",\n      aggregates: [\n        { field: \"amount\", aggregate: \"sum\" },\n        { field: \"actual_expense_amount\", aggregate: \"sum\" },\n      ],\n      compare: function(a, b) {\n        if (a.items[0].requested_by.number === b.items[0].requested_by.number) {\n          return 0;\n        } else if (\n          a.items[0].requested_by.number > b.items[0].requested_by.number\n        ) {\n          return 1;\n        } else {\n          return -1;\n        }\n      },\n    },\n    aggregateDefinition: [\n      { field: \"amount\", aggregate: \"sum\" },\n      { field: \"actual_expense_amount\", aggregate: \"sum\" },\n    ],\n    // LoadingMe\n    showLoading: false,\n  }),\n  methods: {\n    handlePageChange: function(event){\n\t\t\tlet pageNumber = (event.skip + event.take) / event.take;\n\t\t\t\n\t\t\tthis.responseData.page_number = pageNumber;\n\t\t\tthis.responseData.skip = event.skip;\n\t\t\tthis.responseData.take = event.take;\n\t\t\tthis.responseData.item_per_page = event.take;\n\n\t\t\tthis.search();\n\t\t},\n    // Search\n    search() {\n      let asOfDate = new Date(this.asOfDate);\n\n      // Empty dataSource\n      let ds = this.$refs.dataSource.kendoWidget();\n      ds.data([]);\n\n      this.showLoading = true;\n      cashAdvanceHandler\n        .getAll({\n          params: {\n            as_of_date: kendo.toString(asOfDate, \"yyyy-MM-dd\") + \"T23:59:59.999Z\",\n            page_number: this.responseData.page_number,\n\t\t\t\t\t\titem_per_page: this.responseData.item_per_page,\n          },\n        })\n        .then((res) => {\n          this.responseData = new ResponseDataModel(res.data);\n          this.cashAdvanceList = this.responseData.data.filter(i=>i.is_settled === 1);\n          // this.bindData();\n        })\n        .finally(() => {\n          this.showLoading = false;\n        });\n    },\n    // Bind Data\n    bindData() {\n      let entries = [];\n\n      this.cashAdvances.forEach((element) => {\n        let cashAdvance = new CashAdvanceModel(element);\n\n        // Amount\n        cashAdvance.amount = 0;\n        element.details.forEach((value) => {\n          if (value.amount > 0) {\n            cashAdvance.amount += value.amount;\n          }\n        });\n\n        // Add Entry\n        entries.push(cashAdvance);\n      });\n\n      // Add to list\n      this.cashAdvanceList = entries;\n    },\n    // Templates\n    numberTemplate: (dataItem) => {\n      return Helper.linkTemplate(\n        dataItem.number,\n        `${EntityType.CASH_ADVANCE}/view/${dataItem.uuid}`\n      );\n    },\n    dateTemplate: (dataItem) => {\n      return Helper.dateFormat(dataItem.advance_date);\n    },\n    settlementTemplate: (dataItem) => {\n      let advstmnt = Object.assign({},dataItem.advance_settlement);\n\n      if (advstmnt !== null) {\n        return Helper.linkTemplate(`${Helper.dateFormat(advstmnt.settlement_date)} ${advstmnt.number}`, `${EntityType.ADVANCE_SETTLEMENT}/view/${advstmnt.uuid}`);\n      } else {\n        return \"\";\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.k-chart {\n  height: 180px;\n}\n\n.theme--light.v-data-table {\n  background-color: transparent !important;\n}\n\n.v-data-table > .v-data-table__wrapper > table > tbody > tr > td {\n  height: 32px !important;\n  border-bottom: thin solid rgba(0, 0, 0, 0.12) !important;\n}\n\n.v-data-table > .v-data-table__wrapper > table > tbody > tr:first-child > td {\n  border-top: thin solid rgba(0, 0, 0, 0.12) !important;\n}\n\n.theme--light.v-data-table\n  > .v-data-table__wrapper\n  > table\n  > tbody\n  > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {\n  background-color: transparent !important;\n}\n@media (max-width: 576px) {\n  .paddingT {\n    padding-top: 0 !important;\n  }\n}\n</style>\n"]}]}