{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/customers/DelayedInvoice.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/customers/DelayedInvoice.vue","mtime":1638499443185},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEYXRlUGlja2VyQ29tcG9uZW50IGZyb20gJ0AvY29tcG9uZW50cy9jdXN0b21fdGVtcGxhdGVzL0RhdGVQaWNrZXJDb21wb25lbnQnCmltcG9ydCB7RHJvcERvd25MaXN0fSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tdnVlLWRyb3Bkb3ducycKaW1wb3J0IEl0ZW1MaW5lTW9kZWwgZnJvbSAiQC9zY3JpcHRzL2ludm9pY2UvbW9kZWwvSXRlbUxpbmUiCmltcG9ydCB7dXVpZH0gZnJvbSAndnVlLXV1aWQnCmltcG9ydCBJbnZvaWNlTW9kZWwgZnJvbSAiQC9zY3JpcHRzL2ludm9pY2UvbW9kZWwvSW52b2ljZSIKaW1wb3J0IFNhbGVGb3JtQ29udGVudE1vZGVsIGZyb20gIkAvc2NyaXB0cy9tb2RlbC9TYWxlRm9ybUNvbnRlbnQiOwppbXBvcnQga2VuZG8gZnJvbSAiQHByb2dyZXNzL2tlbmRvLXVpIjsKaW1wb3J0IHsgU2hvd1Jlc291cmNlIH0gZnJvbSAnQC9vYnNlcnZhYmxlL3N0b3JlJwoKY29uc3QgJCA9IHJlcXVpcmUoImpxdWVyeSIpCgpjb25zdCBzZXR0aW5nc0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvc2V0dGluZ3NIYW5kbGVyIikKY29uc3QgY3VzdG9tZXJIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2N1c3RvbWVySGFuZGxlciIpCmNvbnN0IGxvY2F0aW9uSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9sb2NhdGlvbkhhbmRsZXIiKQpjb25zdCBwcmVmaXhIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3ByZWZpeEhhbmRsZXIiKQpjb25zdCBiaWxsaW5nSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9pbnZvaWNlL2hhbmRsZXIvYmlsbGluZ0hhbmRsZXIiKQpjb25zdCBjdXJyZW5jeUhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvY3VycmVuY3kvaGFuZGxlci9jdXJyZW5jeUhhbmRsZXIiKQpjb25zdCBzYWxlRm9ybUNvbnRlbnRIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3NhbGVGb3JtQ29udGVudEhhbmRsZXIiKQpjb25zdCBwcm9kdWN0VmFyaWFudEhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvcHJvZHVjdFZhcmlhbnRIYW5kbGVyIikKY29uc3QgdW9tUHJpY2VIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3VvbVByaWNlSGFuZGxlciIpCmNvbnN0IGRpc2NvdW50SXRlbUhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvZGlzY291bnRJdGVtSGFuZGxlciIpCmNvbnN0IGl0ZW1Nb2RpZmllckhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvaXRlbU1vZGlmaWVySGFuZGxlciIpCmNvbnN0IHNhbGVVbml0SXRlbUhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvc2FsZVVuaXRJdGVtSGFuZGxlciIpCmNvbnN0IGVtcGxveWVlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9lbXBsb3llZUhhbmRsZXIiKQpjb25zdCBzZXR0aW5nSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9zZXR0aW5nSGFuZGxlciIpCmNvbnN0IG90aGVyQ2hhcmdlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9vdGhlckNoYXJnZUhhbmRsZXIiKQoKY29uc3QgaW52b2ljZU1vZGVsID0gbmV3IEludm9pY2VNb2RlbCh7fSkKY29uc3QgaXRlbUxpbmVNb2RlbCA9IG5ldyBJdGVtTGluZU1vZGVsKHt9KQpjb25zdCBzYWxlRm9ybUNvbnRlbnRNb2RlbCA9IG5ldyBTYWxlRm9ybUNvbnRlbnRNb2RlbCh7fSkKCmNvbnN0IHRleHRGaWVsZCA9ICdudW1iZXJOYW1lJwpjb25zdCBrZXlGaWVsZCA9ICdpZCcKY29uc3QgZGVmYXVsdEl0ZW0gPSB7W3RleHRGaWVsZF06ICdTZWxlY3QgY3VzdG9tZXIuLi4nLCBba2V5RmllbGRdOiBudWxsfQpjb25zdCBlbXB0eUl0ZW0gPSB7W3RleHRGaWVsZF06ICdsb2FkaW5nIC4uLid9CmNvbnN0IERFTEFZRURfSU5WT0lDRSA9ICdkZWxheWVkIGludm9pY2UnCmNvbnN0IGl0ZW1MaW5lUHJlZml4ID0gJ2xpbi0nCmNvbnN0IERJU0NPVU5UX1RZUEUgPSAnP3R5cGU9U2FsZScKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJEZWxheWVkSW52b2ljZSIsCiAgICBwcm9wczogWydpZCddLAogICAgY29tcG9uZW50czogewogICAgICAgIExvYWRpbmdNZTogKCkgPT4gaW1wb3J0KGBAL2NvbXBvbmVudHMvTG9hZGluZ2ApLAogICAgICAgICdhcHAtZGF0ZXBpY2tlcic6IERhdGVQaWNrZXJDb21wb25lbnQsCiAgICAgICAgJ2Ryb3Bkb3dubGlzdCc6IERyb3BEb3duTGlzdAogICAgfSwKICAgIGRhdGE6ICgpID0+ICh7CiAgICAgICAgc2hvd0xvYWRpbmc6IGZhbHNlLAogICAgICAgIGxvYWRpbmdBbGVydDogZmFsc2UsCiAgICAgICAgbG9hZGluZ0NvbG9yQWxlcnQ6ICcnLAogICAgICAgIGxvYWRpbmdUZXh0QWxlcnQ6ICcnLAogICAgICAgIGFsZXJ0OiBmYWxzZSwKICAgICAgICBkZXBvc2l0ZTogMCwKICAgICAgICBmaWxlczogW10sCiAgICAgICAgLy8gRm9ybSB2YWxpZGF0aW9uCiAgICAgICAgdmFsaWQ6IHRydWUsCiAgICAgICAgdHJhbnNhY3Rpb25EYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKSwKICAgICAgICB0cmFuc2FjdGlvblR5cGU6IFsnRGVsYXllZCBJbnZvaWNlJ10sCiAgICAgICAgdGVtcGxhdGVzOiBbCiAgICAgICAgICAgIHt0aXRsZTogJ0RyYWZ0J30sCiAgICAgICAgICAgIHt0aXRsZTogJ09wZW4nfSwKICAgICAgICAgICAge3RpdGxlOiAnUGFydGlhbGx5IENsb3NlZCd9LAogICAgICAgICAgICB7dGl0bGU6ICdDbG9zZWQnfSwKICAgICAgICBdLAogICAgICAgIGNvbF9leHBhbmQ6IDksCiAgICAgICAgY29sX2hpZGU6IDMsCiAgICAgICAgaXNIaWRlQmFyOiBmYWxzZSwKICAgICAgICBkaWFsb2dUYXg6IGZhbHNlLAogICAgICAgIGN1c3RvbWVyTGlzdDogW10sCiAgICAgICAgY3VycmVuY2llczogW10sCiAgICAgICAgc2VnbWVudHM6IFtdLAogICAgICAgIGxvY2F0aW9uczogW10sCiAgICAgICAgaXRlbUxpbmVzOiBbXSwKICAgICAgICBudW1TZWxlY3Q6IFsxXSwKICAgICAgICBtT3RoZXJDaGFyZ2U6IFtdLAogICAgICAgIG1PdGhlckNoYXJnZUFtb3VudDogW10sCiAgICAgICAgc3BlY2lmaWNEaXNjb3VudEl0ZW06IFtdLAogICAgICAgIG90aGVyQ2hhcmdlTGlzdDogW10sCiAgICAgICAgdGF4TGlzdFRvdGFsOiB7fSwKICAgICAgICBsb2dnZWRVc2VyOiB7CiAgICAgICAgICAgIGlkOiAnY2YzZDEwYWItYmNlNi00N2IzLTg0MDUtYjQ0OGMyM2RhZDg0JywKICAgICAgICAgICAgbmFtZTogJ01yLiBJbnNwZWN0b3InCiAgICAgICAgfSwKICAgICAgICBjdXNCYXNlVXJsOiBjdXN0b21lckhhbmRsZXIuc2VhcmNoKCksCiAgICAgICAgZmlsdGVyOiAnJywKICAgICAgICBkZWZhdWx0SXRlbTogZGVmYXVsdEl0ZW0sCiAgICAgICAgaXRlbUxpbmU6IGl0ZW1MaW5lTW9kZWwsCiAgICAgICAgc2FsZUZvcm1Db250ZW50OiBzYWxlRm9ybUNvbnRlbnRNb2RlbCwKICAgICAgICBjdXN0b21lcjoge30sCiAgICAgICAgaW52b2ljZTogaW52b2ljZU1vZGVsCiAgICB9KSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBIZWxwKGtleV9zZWFyY2gpewogICAgICAgICAgICBTaG93UmVzb3VyY2Uoa2V5X3NlYXJjaCkKICAgICAgICB9LAogICAgICAgIG9uVU9NQ2hhbmdlZChkYXRhSXRlbSkgewogICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coZGF0YUl0ZW0sICd1b20gY2hhbmdlZCcpCiAgICAgICAgfSwKICAgICAgICBjbG9zZShkYXRhKSB7CiAgICAgICAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICJDdXN0b21lcnMiLAogICAgICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5nbygtMSkKICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIC8vICAgICBwYXRoOiAiaW52b2ljZV92aWV3IiwKICAgICAgICAgICAgICAgIC8vICAgICBuYW1lOiAiSW52b2ljZSBWaWV3IiwKICAgICAgICAgICAgICAgIC8vICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgICAgICAvLyB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhLCAnZGF0YScpCiAgICAgICAgfSwKICAgICAgICBzYXZlTmV3KCkgewoKICAgICAgICB9LAogICAgICAgIGFzeW5jIGluaXREYXRhKCkgewogICAgICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLmlkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFZpZXdJbnZvaWNlKCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuYWRkUm93KCkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgb25TYXZlQ2xvc2Uoc2F2ZVNlbmQpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKSkgewogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgIGxldCBpdGVtTGluZURTID0gdGhpcy4kcmVmcy5pdGVtTGluZURTLmtlbmRvV2lkZ2V0KCkKICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgImlkIjogdGhpcy5pbnZvaWNlLmlkID8gdGhpcy5pbnZvaWNlLmlkIDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogJ0RlbGF5ZWQgSW52b2ljZScsCiAgICAgICAgICAgICAgICAgICAgICAgICJudW1iZXIiOiB0aGlzLmludm9pY2UubnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgICAiYWJiciI6IHRoaXMuaW52b2ljZS50cmFuc2FjdGlvblR5cGUuYWJiciwKICAgICAgICAgICAgICAgICAgICAgICAgInRyYW5zYWN0aW9uRGF0ZSI6IHRoaXMudHJhbnNhY3Rpb25EYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAiZHVlRGF0ZSI6IHRoaXMuaW52b2ljZS5kdWVEYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAibW9udGhPZiI6IHRoaXMuaW52b2ljZS5tb250aE9mLAogICAgICAgICAgICAgICAgICAgICAgICAiY3VzdG9tZXIiOiB0aGlzLmludm9pY2UuY3VzdG9tZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0cmFuc2FjdGlvblR5cGUiOiB0aGlzLmludm9pY2UudHJhbnNhY3Rpb25UeXBlLAogICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVudFRlcm0iOiB0aGlzLmludm9pY2UucGF5bWVudFRlcm0sCiAgICAgICAgICAgICAgICAgICAgICAgICJkaXNjb3VudFByb21vdGlvbiI6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAiYWNjUmVjZWl2YWJsZSI6IHRoaXMuaW52b2ljZS5hY2NSZWNlaXZhYmxlLAogICAgICAgICAgICAgICAgICAgICAgICAiY3VycmVuY3kiOiB0aGlzLmludm9pY2UuY3VycmVuY3ksCiAgICAgICAgICAgICAgICAgICAgICAgICJwcmljZUxldmVsIjogdGhpcy5pbnZvaWNlLnByaWNlTGV2ZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICJpdGVtTGluZXMiOiBpdGVtTGluZURTLmRhdGEoKSwKICAgICAgICAgICAgICAgICAgICAgICAgInNlZ21lbnQiOiB0aGlzLmludm9pY2Uuc2VnbWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgImxvY2F0aW9uIjogdGhpcy5pbnZvaWNlLmxvY2F0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAicHJvamVjdCI6IHRoaXMuaW52b2ljZS5wcm9qZWN0LAogICAgICAgICAgICAgICAgICAgICAgICAic2FsZUNoYW5uZWwiOiB0aGlzLmludm9pY2Uuc2FsZUNoYW5uZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICJlbXBsb3llZSI6IHRoaXMuaW52b2ljZS5lbXBsb3llZSwKICAgICAgICAgICAgICAgICAgICAgICAgImJpbGxpbmdBZGRyZXNzIjogdGhpcy5pbnZvaWNlLmJpbGxpbmdBZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVsaXZlcnlBZGRyZXNzIjogdGhpcy5pbnZvaWNlLmRlbGl2ZXJ5QWRkcmVzcywKICAgICAgICAgICAgICAgICAgICAgICAgImRlbGl2ZXJ5RGF0ZVRpbWUiOiB0aGlzLmludm9pY2UuZGVsaXZlcnlEYXRlVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgInRyYW5zYWN0aW9uTm90ZSI6IHRoaXMuaW52b2ljZS50cmFuc2FjdGlvbk5vdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICJqb3VybmFsTm90ZSI6IHRoaXMuaW52b2ljZS5qb3VybmFsTm90ZSwKICAgICAgICAgICAgICAgICAgICAgICAgInN1YlRvdGFsIjogdGhpcy5pbnZvaWNlLnN1YlRvdGFsLAogICAgICAgICAgICAgICAgICAgICAgICAidG90YWwiOiB0aGlzLmludm9pY2UudG90YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICJkaXNjb3VudFRvdGFsIjogdGhpcy5pbnZvaWNlLmRpc2NvdW50VG90YWwsCiAgICAgICAgICAgICAgICAgICAgICAgICJzcGVjaWZpY0Rpc2NvdW50VG90YWwiOiB0aGlzLmludm9pY2Uuc3BlY2lmaWNEaXNjb3VudFRvdGFsLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVsaXZlcnlGZWUiOiB0aGlzLmludm9pY2UuZGVsaXZlcnlGZWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0b3RhbFRheEFtb3VudCI6IHRoaXMuaW52b2ljZS50b3RhbFRheEFtb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgImRlcG9zaXRBbW91bnQiOiB0aGlzLmludm9pY2UuZGVwb3NpdEFtb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgImRlcG9zaXREZWR1Y3Rpb24iOiB0aGlzLmludm9pY2UuZGVwb3NpdERlZHVjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgInJlbWFpbmluZ0Ftb3VudCI6IHRoaXMuaW52b2ljZS5yZW1haW5pbmdBbW91bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICJhbW91bnREdWUiOiB0aGlzLmludm9pY2UuYW1vdW50RHVlLAogICAgICAgICAgICAgICAgICAgICAgICAiY3VycmVudEJhbGFuY2UiOiB0aGlzLmludm9pY2UuY3VycmVudEJhbGFuY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJiYWxhbmNlIjogdGhpcy5pbnZvaWNlLmJhbGFuY2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJjcmVkaXRMaW1pdCI6IHRoaXMuaW52b2ljZS5jcmVkaXRMaW1pdCwKICAgICAgICAgICAgICAgICAgICAgICAgInNhdmVPcHRpb24iOiB0aGlzLmludm9pY2Uuc2F2ZU9wdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgInN0YXR1cyI6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICJhcHByb3ZlZEJ5IjogdGhpcy5pbnZvaWNlLmFwcHJvdmVkQnksCiAgICAgICAgICAgICAgICAgICAgICAgICJmb3JtVGVtcGxhdGUiOiB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgInNwZWNpZmljRGlzY291bnRJdGVtIjogdGhpcy5pbnZvaWNlLnNwZWNpZmljRGlzY291bnRJdGVtLAogICAgICAgICAgICAgICAgICAgICAgICAib3RoZXJDaGFyZ2UiOiB0aGlzLm1PdGhlckNoYXJnZSwKICAgICAgICAgICAgICAgICAgICAgICAgIm90aGVyQ2hhcmdlQW1vdW50IjogdGhpcy5pbnZvaWNlLm90aGVyQ2hhcmdlQW1vdW50LAogICAgICAgICAgICAgICAgICAgICAgICAibGF0ZUZlZSI6IHRoaXMuaW52b2ljZS5sYXRlRmVlLAogICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVudE9wdGlvbldCTW9iaWxlIjoge30sCiAgICAgICAgICAgICAgICAgICAgICAgICJwYXltZW50T3B0aW9uT25saW5lIjoge30sCiAgICAgICAgICAgICAgICAgICAgICAgICJwYXltZW50T3B0aW9uS0hRUiI6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAicHVibGljTGluayI6IHRoaXMuaW52b2ljZS5wdWJsaWNMaW5rLAogICAgICAgICAgICAgICAgICAgICAgICAicGF5bWVudENvZGUiOiB0aGlzLmludm9pY2UucGF5bWVudENvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICJ0YXhMaXN0VG90YWwiOiB0aGlzLnRheExpc3RUb3RhbCwKICAgICAgICAgICAgICAgICAgICAgICAgImN1c3RvbWVyRGlzY291bnRJdGVtIjogdGhpcy5jdXN0b21lckRpc2NvdW50SXRlbSwKICAgICAgICAgICAgICAgICAgICAgICAgImN1c3RvbWVyU2FsZVVuaXQiOiB0aGlzLmN1c3RvbWVyU2FsZVVuaXQsCiAgICAgICAgICAgICAgICAgICAgICAgICJwYXltZW50U2NoZW1lIjogdGhpcy5pbnZvaWNlLnBheW1lbnRTY2hlbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJjcmVhdGVkQXQiOiB0aGlzLmludm9pY2UuY3JlYXRlZEF0LAogICAgICAgICAgICAgICAgICAgICAgICAibG9nZ2VkVXNlciI6IHRoaXMubG9nZ2VkVXNlciwKICAgICAgICAgICAgICAgICAgICAgICAgInNhdmVTZW5kIjogc2F2ZVNlbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICJhY3Rpb25UeXBlIjogdGhpcy4kcm91dGUucGFyYW1zLmlkID8gdGhpcy4kcm91dGUucXVlcnkudHlwZSA6ICduZXcnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJpbGxpbmdIYW5kbGVyLmNyZWF0ZShkYXRhKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmNsb3NlKHJlc3BvbnNlLmRhdGEuZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJlZnMuZm9ybS5yZXNldCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzbm90aWZ5LnN1Y2Nlc3MoJ1N1Y2Nlc3NmdWxseScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKHJlc3BvbnNlLmRhdGEuZGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzbm90aWZ5LmVycm9yKCdTb21ldGhpbmcgd2VudCB3cm9uZycpCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JzLnB1c2goZSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIHJlbW92ZVJvdyhlKSB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgY29uc3QgZ3JpZCA9IGtlbmRvLmpRdWVyeSgiI2dyaWRJdGVtTGluZSIpLmRhdGEoImtlbmRvR3JpZCIpLAogICAgICAgICAgICAgICAgZGF0YVNvdXJjZSA9IGdyaWQuZGF0YVNvdXJjZSwKICAgICAgICAgICAgICAgIGRhdGFJdGVtID0gZ3JpZC5kYXRhSXRlbSgkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdCgidHIiKSk7CgogICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS50b3RhbCgpID4gMSkgewogICAgICAgICAgICAgICAgZGF0YVNvdXJjZS5yZW1vdmUoZGF0YUl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBlcnJvck1lc3NhZ2UoKSB7CgogICAgICAgIH0sCiAgICAgICAgYWRkUm93KCkgewogICAgICAgICAgICBsZXQgZHMgPSB0aGlzLiRyZWZzLml0ZW1MaW5lRFMua2VuZG9XaWRnZXQoKSwKICAgICAgICAgICAgICAgIHRvdGFsID0gZHMudG90YWwoKQogICAgICAgICAgICB0aGlzLml0ZW1MaW5lLmlkID0gaXRlbUxpbmVQcmVmaXggKyB1dWlkLnYxKCkKICAgICAgICAgICAgZHMuaW5zZXJ0KHRvdGFsLCB0aGlzLml0ZW1MaW5lKQogICAgICAgICAgICAvLyB0aGlzLml0ZW1MaW5lcy5wdXNoKHRoaXMuaXRlbUxpbmUpCiAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygnaXRlbSBMaW5lJywgdGhpcy5pdGVtTGluZSkKICAgICAgICB9LAogICAgICAgIGFjY291bnREcm9wRG93bkVkaXRvcigpIHsKICAgICAgICB9LAogICAgICAgIGNhbmNlbCgpIHsKCiAgICAgICAgfSwKICAgICAgICBoaWRlX3NtYWxsc2l0ZWJhcigpIHsKICAgICAgICAgICAgdGhpcy5pc0hpZGVCYXIgPSAhdGhpcy5pc0hpZGVCYXI7CiAgICAgICAgfSwKICAgICAgICB6ZXJvUGFkKG51bSwgcGxhY2VzKSB7CiAgICAgICAgICAgIHJldHVybiBTdHJpbmcobnVtKS5wYWRTdGFydChwbGFjZXMsICcwJykKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRTYWxlRm9ybUNvbnRlbnQoKSB7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICBzYWxlRm9ybUNvbnRlbnRIYW5kbGVyLmxpc3QoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYWxlRm9ybUNvbnRlbnQgPSBkYXRhWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZEN1cnJlbmN5KCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgY3VycmVuY3lIYW5kbGVyLmxpc3QoJ2Z1bi1jJykudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVuY2llcyA9IHJlcy5kYXRhLmRhdGEuZmlsdGVyKG8gPT4gby51c2VkID09PSAxKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkUHJlZml4KCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgcHJlZml4SGFuZGxlci5nZXQoREVMQVlFRF9JTlZPSUNFKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZvaWNlVHlwZXMgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbnZvaWNlVHlwZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52b2ljZS50cmFuc2FjdGlvblR5cGUgPSB0aGlzLmludm9pY2VUeXBlc1swXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlTnVtYmVyKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkU2FsZVVuaXRJdGVtcygpIHsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHNhbGVVbml0SXRlbUhhbmRsZXIubGlzdCgpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2FsZVVuaXRJdGVtTGlzdCA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYWRkU2VsZWN0KCkgewogICAgICAgICAgICBsZXQgYW1vdW50X251bSA9IHRoaXMubnVtU2VsZWN0Lmxlbmd0aAogICAgICAgICAgICBsZXQgbnVtID0gdGhpcy5udW1TZWxlY3RbYW1vdW50X251bSAtIDFdCiAgICAgICAgICAgIGxldCBuZXdfbnVtID0gbnVtICsgMQogICAgICAgICAgICBsZXQgbGVuZ2h0SXRlbSA9IHRoaXMuc3BlY2lmaWNEaXNjb3VudEl0ZW0ubGVuZ3RoCiAgICAgICAgICAgIGlmIChuZXdfbnVtIDw9IGxlbmdodEl0ZW0pIHsKICAgICAgICAgICAgICAgIHRoaXMubnVtU2VsZWN0LnB1c2gobmV3X251bSkKICAgICAgICAgICAgfQoKICAgICAgICB9LAogICAgICAgIHJlbW92ZVNlbGVjdChpbmRleCkgewogICAgICAgICAgICB0aGlzLm51bVNlbGVjdC5zcGxpY2UoaW5kZXgsIDEpCiAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyhpbmRleCwgdGhpcy5udW1TZWxlY3QpCiAgICAgICAgICAgIC8vIHRoaXMuc2VsZWN0RGlzY291bnQuc3BsaWNlKGluZGV4LDEpCiAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygicmVtb3ZlIix0aGlzLnNlbGVjdERpc2NvdW50KQogICAgICAgICAgICAvLyB0aGlzLnNlbGVjdERpc2NvdW50ID0gdGhpcy5zZWxlY3REaXNjb3VudC5maWx0ZXIoaXRlbSA9PiAgaXRlbS5pZCAhPSB2YWwuaWQpOwogICAgICAgIH0sCiAgICAgICAgb25PdGhlckNoYXJnZUNoYW5nZSgpIHsKICAgICAgICAgICAgbGV0IG90aGVyQ2hhcmdlID0gMAogICAgICAgICAgICB0aGlzLm1PdGhlckNoYXJnZS5mb3JFYWNoKG0gPT4gewogICAgICAgICAgICAgICAgb3RoZXJDaGFyZ2UgKz0gdGhpcy5hdXRvQ2FsY3VsYXRlRGlzY291bnQobSwgdGhpcy5pbnZvaWNlLnN1YlRvdGFsKQogICAgICAgICAgICB9KQogICAgICAgICAgICB0aGlzLmludm9pY2Uub3RoZXJDaGFyZ2VBbW91bnQgPSBvdGhlckNoYXJnZQogICAgICAgICAgICB0aGlzLmF1dG9DYWxjdWxhdGUoKQogICAgICAgIH0sCiAgICAgICAgb25PdGhlckFtb3VudCh2YWx1ZSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRvQ2FsY3VsYXRlRGlzY291bnQodmFsdWUsIHRoaXMuaW52b2ljZS5zdWJUb3RhbCkKICAgICAgICB9LAogICAgICAgIG9uU3BlY2lmaWNEaXNjb3VudENoYW5nZWQoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmludm9pY2Uuc3BlY2lmaWNEaXNjb3VudEl0ZW0pIHsKICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygnLWNoYW5nZWQnLCB0aGlzLmludm9pY2Uuc3BlY2lmaWNEaXNjb3VudEl0ZW0pCiAgICAgICAgICAgICAgICBjb25zdCBkaXNjb3VudEludm9pY2UgPSB0aGlzLmF1dG9DYWxjdWxhdGVEaXNjb3VudCh0aGlzLmludm9pY2Uuc3BlY2lmaWNEaXNjb3VudEl0ZW0sIHRoaXMuaW52b2ljZS5zdWJUb3RhbCkKICAgICAgICAgICAgICAgIHRoaXMuaW52b2ljZS5zcGVjaWZpY0Rpc2NvdW50VG90YWwgPSBrZW5kby50b1N0cmluZyhkaXNjb3VudEludm9pY2UgPyBkaXNjb3VudEludm9pY2UgOiAwLCAnbicpCiAgICAgICAgICAgICAgICBsZXQgdG90YWwgPSBrZW5kby5wYXJzZUZsb2F0KHRoaXMuaW52b2ljZS5zdWJUb3RhbCkgLSAoa2VuZG8ucGFyc2VGbG9hdCh0aGlzLmludm9pY2UuZGlzY291bnRUb3RhbCkgKyBrZW5kby5wYXJzZUZsb2F0KHRoaXMuaW52b2ljZS50b3RhbFRheEFtb3VudCkpIC0gZGlzY291bnRJbnZvaWNlCiAgICAgICAgICAgICAgICB0aGlzLmludm9pY2UudG90YWwgPSBrZW5kby50b1N0cmluZygodG90YWwpLCAnbicpCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRPdGhlckNoYXJnZSgpIHsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIG90aGVyQ2hhcmdlSGFuZGxlci5saXN0KCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm90aGVyQ2hhcmdlTGlzdCA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgb25DaGFuZ2UoZXZlbnQpIHsKICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBldmVudC52YWx1ZQogICAgICAgICAgICBpZiAodmFsdWUgJiYgdmFsdWVbdGV4dEZpZWxkXSA9PT0gZW1wdHlJdGVtW3RleHRGaWVsZF0pIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmN1c3RvbWVyID0gdmFsdWUKICAgICAgICAgICAgdGhpcy5pbnZvaWNlLmN1c3RvbWVyID0gdmFsdWUKICAgICAgICAgICAgdGhpcy5pbnZvaWNlLnByaWNlTGV2ZWwgPSB2YWx1ZS5oYXNPd25Qcm9wZXJ0eSgncHJpY2VMZXZlbCcpID8gdmFsdWUucHJpY2VMZXZlbCA6IHt9CgogICAgICAgICAgICBpZiAodmFsdWUuaGFzT3duUHJvcGVydHkoJ3ByaWNlTGV2ZWwnKSkgewogICAgICAgICAgICAgICAgaWYgKHZhbHVlLnByaWNlTGV2ZWwuaGFzT3duUHJvcGVydHkoJ2N1cnJlbmN5JykpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmludm9pY2UuY3VycmVuY3kgPSB2YWx1ZS5wcmljZUxldmVsLmN1cnJlbmN5CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG9uRmlsdGVyQ2hhbmdlKGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9IGV2ZW50LmZpbHRlci52YWx1ZQogICAgICAgICAgICB0aGlzLmN1c3RvbWVyRGF0YShmaWx0ZXIsIHRoaXMuY3VzQmFzZVVybCkKICAgICAgICAgICAgdGhpcy5maWx0ZXIgPSBmaWx0ZXIKICAgICAgICB9LAogICAgICAgIGN1c3RvbWVyRGF0YShmaWx0ZXIsIGJhc2VVcmwpIHsKICAgICAgICAgICAgY29uc3QgdXJsID0gYmFzZVVybCArCiAgICAgICAgICAgICAgICBgP2ZpbHRlcj0ke2ZpbHRlcn1gCiAgICAgICAgICAgIGZldGNoKHVybCkKICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbih0aGlzLmFmdGVyRmV0Y2gpCiAgICAgICAgfSwKICAgICAgICBhZnRlckZldGNoKGpzb24pIHsKICAgICAgICAgICAgdGhpcy5jdXN0b21lckxpc3QgPSBqc29uLmRhdGEKICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRMb2NhdGlvbigpIHsKICAgICAgICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbnMgPSBbXQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uSGFuZGxlci5saXN0KCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb25zID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubG9jYXRpb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludm9pY2UubG9jYXRpb24gPSB0aGlzLmxvY2F0aW9uc1swXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZFNlZ21lbnQoKSB7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VnbWVudHMgPSBbXQogICAgICAgICAgICAgICAgICAgIHNldHRpbmdzSGFuZGxlci5nZXRTZWcoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWdtZW50cyA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlZ21lbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludm9pY2Uuc2VnbWVudCA9IHRoaXMuc2VnbWVudHNbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuc2VnbWVudExpc3QgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCAzMDApCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBnZW5lcmF0ZU51bWJlcigpIHsKICAgICAgICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgICAgICAgICBhYmJyOiB0aGlzLmludm9pY2UudHJhbnNhY3Rpb25UeXBlLmFiYnIsCiAgICAgICAgICAgICAgICBzdHJ1Y3R1cmU6IHRoaXMuaW52b2ljZS50cmFuc2FjdGlvblR5cGUuc3RydWN0dXJlLAogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25EYXRlOiB0aGlzLnRyYW5zYWN0aW9uRGF0ZSwKICAgICAgICAgICAgICAgIHR5cGU6ICdEZWxheWVkIEludm9pY2UnLAogICAgICAgICAgICAgICAgZW50aXR5OiAxCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmlsbGluZ0hhbmRsZXIubGFzdE51bWJlcihkYXRhKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyh0aGlzLmludm9pY2UudHJhbnNhY3Rpb25UeXBlLCdkYXRhJykKICAgICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSByZXNwb25zZS5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXN0TnVtYmVyID0gdGhpcy56ZXJvUGFkKHBhcnNlSW50KHJlcy5sYXN0TnVtYmVyKSwgdGhpcy5pbnZvaWNlLnRyYW5zYWN0aW9uVHlwZS5mb3JtYXQpCiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtYmVyID0gcmVzLnN1ZmZpeCArIHRoaXMuaW52b2ljZS50cmFuc2FjdGlvblR5cGUubnVtYmVyU2VwYXJhdG9yICsgbGFzdE51bWJlcgogICAgICAgICAgICAgICAgICAgIC8vIHRoaXMudHJhbnNhY3Rpb25OdW1iZXIgPSBudW1iZXIKICAgICAgICAgICAgICAgICAgICB0aGlzLmludm9pY2UubnVtYmVyID0gbnVtYmVyCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gewogICAgICAgICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChlKQogICAgICAgICAgICB9KQoKICAgICAgICB9LAogICAgICAgIHJvd051bWJlclRtcGwoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgbGV0IGRzID0gdGhpcy4kcmVmcy5pdGVtTGluZURTLmtlbmRvV2lkZ2V0KCksCiAgICAgICAgICAgICAgICBpbmRleCA9IGRzLmluZGV4T2YoZGF0YUl0ZW0pOwogICAgICAgICAgICByZXR1cm4gaW5kZXggKyAxOwogICAgICAgIH0sCiAgICAgICAgZW1wSW1wbChkYXRhSXRlbSkgewogICAgICAgICAgICBsZXQgZW1wSWRzID0gW10KICAgICAgICAgICAgZGF0YUl0ZW0uZW1wbG95ZWUuZm9yRWFjaChtID0+IHsKICAgICAgICAgICAgICAgIGVtcElkcy5wdXNoKG0uZmlyc3ROYW1lICsgJyAtICcgKyBtLmxhc3ROYW1lKQogICAgICAgICAgICB9KQogICAgICAgICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2coZW1wSWRzLmpvaW4oJywgJykpCiAgICAgICAgICAgIHJldHVybiBgPHNwYW4+JHtlbXBJZHMuam9pbignLCAnKX08L3NwYW4+YAogICAgICAgIH0sCiAgICAgICAgRW1wbG95ZWVEcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAgICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgZGF0YS1iaW5kPSJ2YWx1ZTonICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb011bHRpU2VsZWN0KHsKICAgICAgICAgICAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6ICJjb250YWlucyIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgIGhlYWRlclRlbXBsYXRlOiAnPGRpdiBjbGFzcz0iZHJvcGRvd24taGVhZGVyIGstd2lkZ2V0IGstaGVhZGVyIj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuPkVtcGxveWVlIDwvc3Bhbj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuPjwvc3Bhbj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlckZpbHRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBlbXBsb3llZUhhbmRsZXIuc2VhcmNoVVJMKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB7dHlwZTogInN0cmluZyJ9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0TmFtZToge3R5cGU6ICJzdHJpbmcifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5jb3VudAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGF1dG9DYWxjdWxhdGVUYXhCeVR5cGUodGF4KSB7CiAgICAgICAgICAgIC8vIHJldHVybiBieSBhIGtleQogICAgICAgICAgICBjb25zdCBncm91cEFsbCA9IGxpc3QgPT4gbGlzdC5yZWR1Y2UoKHRheCwgaXRlbSkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgdGF4QW1vdW50ID0gdGF4W2l0ZW0ubmFtZV0gfHwgMAogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRheCwge1tpdGVtLm5hbWVdOiB0YXhBbW91bnQgKyBwYXJzZUZsb2F0KGl0ZW0uYW1vdW50KX0pCiAgICAgICAgICAgIH0sIHt9KQogICAgICAgICAgICB0aGlzLnRheExpc3RUb3RhbCA9IGdyb3VwQWxsKHRheCkKICAgICAgICB9LAogICAgICAgIGF1dG9DYWxjdWxhdGUoKSB7CiAgICAgICAgICAgIGxldCBkcyA9IHRoaXMuJHJlZnMuaXRlbUxpbmVEUy5rZW5kb1dpZGdldCgpLAogICAgICAgICAgICAgICAgc3ViVG90YWwgPSAwLAogICAgICAgICAgICAgICAgdG90YWxUYXggPSAwLCBkaXNjb3VudFRvdGFsID0gMCwKICAgICAgICAgICAgICAgIHNwVGF4ID0gMCwgcGx0YXggPSAwLCBvdGhlclRheCA9IDAsIHZhdFRheCA9IDAsIGRpc2NvdW50SW52b2ljZSA9IDAsIHRheExpc3QgPSBbXSwgZGlzY291bnRJdGVtID0gW10sCiAgICAgICAgICAgICAgICBzYWxlVW5pdCA9IFtdLCBpbmNsdXNpdmVUYXggPSAwCgogICAgICAgICAgICBkcy5kYXRhKCkuZm9yRWFjaCh2YWx1ZSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgbW9kaWZpZXJQcmljZSA9IDAKICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5tb2RpZmllcikgewogICAgICAgICAgICAgICAgICAgIG1vZGlmaWVyUHJpY2UgPSBrZW5kby5wYXJzZUZsb2F0KHZhbHVlLm1vZGlmaWVyLnByaWNlKQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIHN1YlRvdGFsICs9IChrZW5kby5wYXJzZUZsb2F0KHZhbHVlLmFtb3VudCkgKyBtb2RpZmllclByaWNlKQogICAgICAgICAgICAgICAgbGV0IGRpc2NvdW50ID0gMAogICAgICAgICAgICAgICAgaWYgKHZhbHVlLmRpc2NvdW50SXRlbSkgewogICAgICAgICAgICAgICAgICAgIGxldCBzdWJUbyA9IGtlbmRvLnBhcnNlRmxvYXQodmFsdWUucHJpY2UpICoga2VuZG8ucGFyc2VGbG9hdCh2YWx1ZS5xdHkpCiAgICAgICAgICAgICAgICAgICAgZGlzY291bnQgPSB0aGlzLmF1dG9DYWxjdWxhdGVEaXNjb3VudCh2YWx1ZS5kaXNjb3VudEl0ZW0sIHN1YlRvKQogICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5kaXNjb3VudEl0ZW0uaGFzT3duUHJvcGVydHkoJ2lkJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGlzY291bnRJdGVtLnB1c2godmFsdWUuZGlzY291bnRJdGVtKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkaXNjb3VudFRvdGFsICs9IChkaXNjb3VudCA/IGRpc2NvdW50IDogMCkKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coZGlzY291bnRUb3RhbCwgJ2RpcyBUb3RhbCcpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodmFsdWUuc2FsZVVuaXQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuc2FsZVVuaXQuaGFzT3duUHJvcGVydHkoJ2lkJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2FsZVVuaXQucHVzaCh2YWx1ZS5zYWxlVW5pdCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodmFsdWUuc3BlY2lmaWNUYXgpIHsKICAgICAgICAgICAgICAgICAgICBzcFRheCA9IHRoaXMuYXV0b0NhbGN1bGF0ZVRheCh2YWx1ZS5zcGVjaWZpY1RheCwgKGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50KSAtIGtlbmRvLnBhcnNlRmxvYXQoZGlzY291bnQpKSkKICAgICAgICAgICAgICAgICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2coJ3NwICcsIGRpc2NvdW50KQogICAgICAgICAgICAgICAgICAgIHNwVGF4ID0ga2VuZG8ucGFyc2VGbG9hdChzcFRheCkgPyBrZW5kby5wYXJzZUZsb2F0KHNwVGF4KSA6IDAKICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXggPSB2YWx1ZS5zcGVjaWZpY1RheAogICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhc2VBbW91bnQgPSB0YXguYmFzZUFtb3VudAogICAgICAgICAgICAgICAgICAgIGlmIChiYXNlQW1vdW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09ICdpbmNsdXNpdmUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdXNpdmVUYXggKz0gc3BUYXgKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuc3BlY2lmaWNUYXguaGFzT3duUHJvcGVydHkoJ3RheFR5cGUnKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0YXhMaXN0LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdmFsdWUuc3BlY2lmaWNUYXgudGF4VHlwZS5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBzcFRheCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB2YWx1ZS5zcGVjaWZpY1RheC50YXhUeXBlLmlkCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHZhbHVlLnB1YmxpY0xpZ2h0aW5nVGF4KSB7CiAgICAgICAgICAgICAgICAgICAgcGx0YXggPSB0aGlzLmF1dG9DYWxjdWxhdGVUYXgodmFsdWUucHVibGljTGlnaHRpbmdUYXgsIChrZW5kby5wYXJzZUZsb2F0KHZhbHVlLmFtb3VudCkgLSBrZW5kby5wYXJzZUZsb2F0KGRpc2NvdW50KSkpCiAgICAgICAgICAgICAgICAgICAgcGx0YXggPSBrZW5kby5wYXJzZUZsb2F0KHBsdGF4KSA/IGtlbmRvLnBhcnNlRmxvYXQocGx0YXgpIDogMAogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRheCA9IHZhbHVlLnB1YmxpY0xpZ2h0aW5nVGF4CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmFzZUFtb3VudCA9IHRheC5iYXNlQW1vdW50CiAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2VBbW91bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0gJ2luY2x1c2l2ZScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1c2l2ZVRheCArPSBwbHRheAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5wdWJsaWNMaWdodGluZ1RheC5oYXNPd25Qcm9wZXJ0eSgndGF4VHlwZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRheExpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB2YWx1ZS5wdWJsaWNMaWdodGluZ1RheC50YXhUeXBlLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHBsdGF4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHZhbHVlLnB1YmxpY0xpZ2h0aW5nVGF4LnRheFR5cGUuaWQKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodmFsdWUub3RoZXJUYXgpIHsKICAgICAgICAgICAgICAgICAgICBvdGhlclRheCA9IHRoaXMuYXV0b0NhbGN1bGF0ZVRheCh2YWx1ZS5vdGhlclRheCwgKGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50KSAtIGtlbmRvLnBhcnNlRmxvYXQoZGlzY291bnQpKSkKICAgICAgICAgICAgICAgICAgICBvdGhlclRheCA9IGtlbmRvLnBhcnNlRmxvYXQob3RoZXJUYXgpID8ga2VuZG8ucGFyc2VGbG9hdChvdGhlclRheCkgOiAwCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGF4ID0gdmFsdWUub3RoZXJUYXgKICAgICAgICAgICAgICAgICAgICBjb25zdCBiYXNlQW1vdW50ID0gdGF4LmJhc2VBbW91bnQKICAgICAgICAgICAgICAgICAgICBpZiAoYmFzZUFtb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpID09PSAnaW5jbHVzaXZlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVzaXZlVGF4ICs9IG90aGVyVGF4CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLm90aGVyVGF4Lmhhc093blByb3BlcnR5KCd0YXhUeXBlJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGF4TGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHZhbHVlLm90aGVyVGF4LnRheFR5cGUubmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogb3RoZXJUYXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdmFsdWUub3RoZXJUYXgudGF4VHlwZS5pZAogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHZhbHVlLnZhdFRheCkgewogICAgICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygnVmF0IFRheCcsIHZhbHVlLnZhdFRheCkKICAgICAgICAgICAgICAgICAgICBsZXQgYW10ID0ga2VuZG8ucGFyc2VGbG9hdChzcFRheCA/IHNwVGF4IDogMCkgKyBrZW5kby5wYXJzZUZsb2F0KHBsdGF4ID8gcGx0YXggOiAwKSArIGtlbmRvLnBhcnNlRmxvYXQob3RoZXJUYXggPyBvdGhlclRheCA6IDApICsgKGtlbmRvLnBhcnNlRmxvYXQodmFsdWUuYW1vdW50ID8gdmFsdWUuYW1vdW50IDogMCkgLSAoZGlzY291bnQgPyBkaXNjb3VudCA6IDApKQogICAgICAgICAgICAgICAgICAgIHZhdFRheCA9IHRoaXMuYXV0b0NhbGN1bGF0ZVRheCh2YWx1ZS52YXRUYXgsIGFtdCkKICAgICAgICAgICAgICAgICAgICB2YXRUYXggPSBrZW5kby5wYXJzZUZsb2F0KHZhdFRheCkgPyBrZW5kby5wYXJzZUZsb2F0KHZhdFRheCkgOiAwCiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGF4ID0gdmFsdWUudmF0VGF4CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmFzZUFtb3VudCA9IHRheC5iYXNlQW1vdW50CiAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2VBbW91bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0gJ2luY2x1c2l2ZScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1c2l2ZVRheCArPSB2YXRUYXgKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUudmF0VGF4Lmhhc093blByb3BlcnR5KCd0YXhUeXBlJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGF4TGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHZhbHVlLnZhdFRheC50YXhUeXBlLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHZhdFRheCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB2YWx1ZS52YXRUYXgudGF4VHlwZS5pZAogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRvdGFsVGF4ICs9IGtlbmRvLnBhcnNlRmxvYXQoc3BUYXggPyBzcFRheCA6IDApICsga2VuZG8ucGFyc2VGbG9hdChwbHRheCA/IHBsdGF4IDogMCkgKyBrZW5kby5wYXJzZUZsb2F0KG90aGVyVGF4ID8gb3RoZXJUYXggOiAwKSArIGtlbmRvLnBhcnNlRmxvYXQodmF0VGF4ID8gdmF0VGF4IDogMCkKICAgICAgICAgICAgICAgIHN1YlRvdGFsICs9IChrZW5kby5wYXJzZUZsb2F0KHZhbHVlLmFtb3VudCkgKyBtb2RpZmllclByaWNlIC0gaW5jbHVzaXZlVGF4KQogICAgICAgICAgICB9KQoKICAgICAgICAgICAgLy8gZGlzY291bnRUb3RhbCA9IGRpc2NvdW50VG90YWwgPyBkaXNjb3VudFRvdGFsIDogMAoKICAgICAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKHNwVGF4LCBwbHRheCwgb3RoZXJUYXgsIHZhdFRheCkKICAgICAgICAgICAgbGV0IHRvdGFsID0gKGtlbmRvLnBhcnNlRmxvYXQoc3ViVG90YWwpIC0ga2VuZG8ucGFyc2VGbG9hdChkaXNjb3VudFRvdGFsKSkgKyBrZW5kby5wYXJzZUZsb2F0KHRvdGFsVGF4KQogICAgICAgICAgICB0aGlzLmludm9pY2Uuc3ViVG90YWwgPSBzdWJUb3RhbAogICAgICAgICAgICAvLyAkKCIjc3VidG90YWwiKS50ZXh0KGtlbmRvLnBhcnNlRmxvYXQoc3ViVG90YWwpKQogICAgICAgICAgICB0aGlzLmludm9pY2UudG90YWxUYXhBbW91bnQgPSBrZW5kby5wYXJzZUZsb2F0KHRvdGFsVGF4KQogICAgICAgICAgICB0aGlzLmludm9pY2UuZGlzY291bnRUb3RhbCA9IGtlbmRvLnBhcnNlRmxvYXQoZGlzY291bnRUb3RhbCkKICAgICAgICAgICAgaWYgKHRoaXMuaW52b2ljZS5zcGVjaWZpY0Rpc2NvdW50SXRlbSkgewogICAgICAgICAgICAgICAgZGlzY291bnRJbnZvaWNlID0gdGhpcy5hdXRvQ2FsY3VsYXRlRGlzY291bnQodGhpcy5pbnZvaWNlLnNwZWNpZmljRGlzY291bnRJdGVtLCBrZW5kby5wYXJzZUZsb2F0KHN1YlRvdGFsKSkKICAgICAgICAgICAgICAgIGRpc2NvdW50SW52b2ljZSA9IGRpc2NvdW50SW52b2ljZSA/IGRpc2NvdW50SW52b2ljZSA6IDAKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyB0aGlzLm9uT3RoZXJDaGFyZ2VDaGFuZ2UoKQogICAgICAgICAgICB0aGlzLmludm9pY2UudG90YWwgPSBrZW5kby5wYXJzZUZsb2F0KHRvdGFsKSAtIGRpc2NvdW50SW52b2ljZSArIGtlbmRvLnBhcnNlRmxvYXQodGhpcy5pbnZvaWNlLm90aGVyQ2hhcmdlQW1vdW50KQogICAgICAgICAgICB0aGlzLmludm9pY2UucmVtYWluaW5nQW1vdW50ID0ga2VuZG8ucGFyc2VGbG9hdCh0aGlzLmludm9pY2UudG90YWwpIC0ga2VuZG8ucGFyc2VGbG9hdCh0aGlzLmRlcG9zaXRlKQogICAgICAgICAgICB0aGlzLmludm9pY2UuYW1vdW50RHVlID0ga2VuZG8ucGFyc2VGbG9hdCh0aGlzLmludm9pY2UudG90YWwgLSBrZW5kby5wYXJzZUZsb2F0KHRoaXMuZGVwb3NpdGUpKQogICAgICAgICAgICB0aGlzLmludm9pY2UuZXhjaGFuZ2VBbW91bnQgPSAoa2VuZG8ucGFyc2VGbG9hdCh0aGlzLmludm9pY2UuYW1vdW50RHVlKSAqIGtlbmRvLnBhcnNlRmxvYXQodGhpcy5pbnZvaWNlLnR4blJhdGUpKQogICAgICAgICAgICAvLyB0aGlzLmludm9pY2UuZXhjaGFuZ2VBbW91bnQgPSAoa2VuZG8ucGFyc2VGbG9hdCh0aGlzLmludm9pY2UuYW1vdW50RHVlKSAqICBrZW5kby5wYXJzZUZsb2F0KHRoaXMuaW52b2ljZS50eG5SYXRlKSkKICAgICAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCctLScsIHRheExpc3QpCiAgICAgICAgICAgIHRoaXMuYXV0b0NhbGN1bGF0ZVRheEJ5VHlwZSh0YXhMaXN0KQogICAgICAgICAgICB0aGlzLmN1c3RvbWVyRGlzY291bnRJdGVtID0gdGhpcy5yZW1vdmVEdXBsaWNhdGUoZGlzY291bnRJdGVtKQogICAgICAgICAgICB0aGlzLmN1c3RvbWVyU2FsZVVuaXQgPSB0aGlzLnJlbW92ZUR1cGxpY2F0ZShzYWxlVW5pdCkKICAgICAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCdkaXNjb3VudCAnLCB0aGlzLmN1c3RvbWVyRGlzY291bnRJdGVtKQogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlRHVwbGljYXRlKGFycmF5KSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdOwogICAgICAgICAgICBjb25zdCBtYXAgPSBuZXcgTWFwKCk7CiAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBhcnJheSkgewogICAgICAgICAgICAgICAgaWYgKCFtYXAuaGFzKGl0ZW0uaWQpKSB7CiAgICAgICAgICAgICAgICAgICAgbWFwLnNldChpdGVtLmlkLCB0cnVlKTsgICAgLy8gc2V0IGFueSB2YWx1ZSB0byBNYXAKICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICB9LAogICAgICAgIG51bWJlckZvcm1hdCh2YWx1ZSkgewogICAgICAgICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2codGhpcy5zYWxlRm9ybUNvbnRlbnQuZGVjaW1hbCwnbmltb2wnKQogICAgICAgICAgICByZXR1cm4ga2VuZG8udG9TdHJpbmcodmFsdWUsIGBuJHt0aGlzLnNhbGVGb3JtQ29udGVudC5kZWNpbWFsfWApCiAgICAgICAgfSwKICAgICAgICBhdXRvQ2FsY3VsYXRlRGlzY291bnQoZGlzY291bnRJdGVtLCBzdWJUb3RhbCkgewogICAgICAgICAgICBpZiAoZGlzY291bnRJdGVtKSB7CiAgICAgICAgICAgICAgICBjb25zdCBuYXR1cmUgPSBkaXNjb3VudEl0ZW0ubmF0dXJlIHx8ICcnCiAgICAgICAgICAgICAgICBjb25zdCBhbW91bnQgPSBkaXNjb3VudEl0ZW0uYW1vdW50IHx8IDAKICAgICAgICAgICAgICAgIGlmIChuYXR1cmUgPT09ICdBbW91bnQnKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoYW1vdW50KQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuYXR1cmUgPT09ICdQZXJjZW50YWdlJykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoc3ViVG90YWwgKiAocGFyc2VGbG9hdChhbW91bnQpIC8gMTAwKSkKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYXV0b0NhbGN1bGF0ZVRheCh0YXgsIGFtb3VudCkgewogICAgICAgICAgICBpZiAodGF4KSB7CiAgICAgICAgICAgICAgICB2YXIgZm9ybXVsYSA9IHRheC5mb3JtdWxhCiAgICAgICAgICAgICAgICB2YXIgaW5BbXQgPSBrZW5kby5wYXJzZUZsb2F0KGFtb3VudCkKICAgICAgICAgICAgICAgIHZhciBuQW10ID0ga2VuZG8ucGFyc2VGbG9hdChhbW91bnQpCiAgICAgICAgICAgICAgICB2YXIgdGF4QmFzZSA9IGtlbmRvLnBhcnNlRmxvYXQodGF4LnRheEJhc2UpIC8gMTAwCiAgICAgICAgICAgICAgICB2YXIgcmF0ZSA9IGtlbmRvLnBhcnNlRmxvYXQodGF4LnJhdGUpIC8gMTAwCiAgICAgICAgICAgICAgICB2YXIgdG90YWwgPSBldmFsKGZvcm11bGEpCiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coaW5BbXQsIG5BbXQsIHRheEJhc2UsIHJhdGUsIGZvcm11bGEsIHRvdGFsKQogICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gcmV0dXJuIDAKICAgICAgICB9LAogICAgICAgIGRhdGFTb3VyY2VDaGFuZ2VkKGUpIHsKICAgICAgICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICAgICAgICAgIGxldCBkYXRhUm93ID0gZS5pdGVtc1swXQoKICAgICAgICAgICAgICAgIHN3aXRjaCAoZS5maWVsZCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgIml0ZW0iOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmF0dHJpYnV0ZV8gPSB0aGlzLmF0dHJpYnV0ZXMuZmlsdGVyKG0gPT4gbS50eXBlLmlkID09PSBkYXRhUm93LnZhcmlhbnQuaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCdkZXNjcmlwdGlvbicsIGRhdGFSb3cuaXRlbS5kZXNjcmlwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBjYXNlICJwcmljZSI6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhUm93LnNldCgncHJpY2UnLCBwYXJzZUZsb2F0KGRhdGFSb3cucHJpY2UpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoJ2Ftb3VudCcsIHBhcnNlRmxvYXQoZGF0YVJvdy5wcmljZSkgKiBwYXJzZUZsb2F0KGRhdGFSb3cucXR5KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygncHJpY2UnLGRhdGFSb3cucHJpY2UpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoJ3ByaWNlJywgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCdhbW91bnQnLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgY2FzZSAidW9tIjoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCdwcmljZScsIHBhcnNlRmxvYXQoZGF0YVJvdy51b20ucHJpY2UpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoJ2Ftb3VudCcsIHBhcnNlRmxvYXQoZGF0YVJvdy51b20ucHJpY2UpICogcGFyc2VGbG9hdChkYXRhUm93LnF0eSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVJvdy5zZXQoJ3ByaWNlJywgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCdhbW91bnQnLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgY2FzZSAicXR5IjoKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCdwcmljZScsIHBhcnNlRmxvYXQoZGF0YVJvdy5wcmljZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhUm93LnNldCgnYW1vdW50JywgcGFyc2VGbG9hdChkYXRhUm93LnByaWNlKSAqIHBhcnNlRmxvYXQoZGF0YVJvdy5xdHkpKQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCdwcmljZScsIDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhUm93LnNldCgnYW1vdW50JywgMCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGNhc2UgIm90aGVyVGF4IjoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKCItLSIsIGRhdGFSb3cpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChlLmZpZWxkKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdXRvQ2FsY3VsYXRlKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgU2VydmljZURhdGVFZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgICAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IHJlcXVpcmVkIG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAgICAgLmtlbmRvRGF0ZVBpY2tlcigpCgogICAgICAgICAgICAvLyBsZXQgZHMgPSB0aGlzLiRyZWZzLml0ZW1MaW5lRFMua2VuZG9XaWRnZXQoKQogICAgICAgICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2coZHMuZGF0YSgpKQogICAgICAgICAgICAvLyAvLyBjb25zdCBkYXRlU3RyaW5nID0ga2VuZG8udG9TdHJpbmcoKG5ldyBEYXRlKG9wdGlvbnMubW9kZWwuaXRlbXMuc2VydmljZURhdGUpKSwgdGhpcy5pdGVtTGluZS5kYXRlRm9ybWF0KQogICAgICAgICAgICAvLyAvLyBjb25zdCBkYXRlU3RyaW5nID0ga2VuZG8udG9TdHJpbmcob3B0aW9ucy5tb2RlbC5pdGVtcy5zZXJ2aWNlRGF0ZSkKICAgICAgICAgICAgLy8gY29uc3QgJGlucHV0ID0gJCgiPGlucHV0IHZhbHVlPSIgKyBvcHRpb25zLm1vZGVsLnNlcnZpY2VEYXRlICsgIiAvPiIpLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgLy8gJGlucHV0LmtlbmRvRGF0ZVBpY2tlcigpCiAgICAgICAgICAgIC8vIC8vICRpbnB1dC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgICAgIC8vIC8vIG9wdGlvbnMubW9kZWwuaXRlbXMuc2VydmljZURhdGUgPSBkYXRlU3RyaW5nCiAgICAgICAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZygkaW5wdXQpCiAgICAgICAgfSwKICAgICAgICBTZXJ2aWNlRGF0ZVRvRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCByZXF1aXJlZCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb0RhdGVQaWNrZXIoKQogICAgICAgIH0sCiAgICAgICAgSXRlbURyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICAgICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcjogImNvbnRhaW5zIiwKICAgICAgICAgICAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAibmFtZSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyVGVtcGxhdGU6ICc8ZGl2IGNsYXNzPSJkcm9wZG93bi1oZWFkZXIgay13aWRnZXQgay1oZWFkZXIiPicgKwogICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4+SXRlbXMgPC9zcGFuPicgKwogICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4+PC9zcGFuPicgKwogICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JywKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgICAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyRmlsdGVyaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHByb2R1Y3RWYXJpYW50SGFuZGxlci5pdGVtU2VhcmNoVVJMKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDoge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2t1OiB7dHlwZTogInN0cmluZyJ9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEuY291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRhdGE6IHRoaXMudmFyaWFudHMKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuVU9NRHJvcERvd25FZGl0b3IoY29udGFpbmVyLG9wdGlvbnMpCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygnY2hhbmdlZCBldmVudCcsIGUpCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBVT01Ecm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAgICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6ICJzdGFydHN3aXRoIiwKICAgICAgICAgICAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAidW9tLm5hbWUiLAogICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAidW9tLmlkIiwKICAgICAgICAgICAgICAgICAgICBjYXNjYWRlRnJvbTogIml0ZW0iLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz11b20ubmFtZSM8L3NwYW4+IiwKICAgICAgICAgICAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyRmlsdGVyaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1cmw6IHVvbVByaWNlSGFuZGxlci5nZXRVUkwob3B0aW9ucy5tb2RlbC5pdGVtLmlkLCB0aGlzLmludm9pY2UucHJpY2VMZXZlbC5pZCwgb3B0aW9ucy5tb2RlbC5pdGVtLnR5cGUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdW9tUHJpY2VIYW5kbGVyLnVvbVByaWNlQnlQcmljZUxldmVsVVJMKCdpZD0nICsgb3B0aW9ucy5tb2RlbC5pdGVtLmlkICsgJyZwbElkPScgKyB0aGlzLmludm9pY2UucHJpY2VMZXZlbC5pZCArICcmZGF0ZT0nICsgdGhpcy50cmFuc2FjdGlvbkRhdGUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogImlkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5hbWU6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNrdToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEuY291bnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGF0YTogdGhpcy52YXJpYW50cwogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIERpc2NvdW50SXRlbURyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICAgICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJuYW1lIiwKICAgICAgICAgICAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgICAgICAgICAgICBjYXNjYWRlRnJvbTogIml0ZW0iLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1jb2RlIyAtICM9bmFtZSM8L3NwYW4+IiwKICAgICAgICAgICAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyRmlsdGVyaW5nOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGRpc2NvdW50SXRlbUhhbmRsZXIuZ2V0VVJMKERJU0NPVU5UX1RZUEUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogImlkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5hbWU6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNrdToge3R5cGU6ICJzdHJpbmcifSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5jb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBTcGVjaWZpY1RheERyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICAgICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJkZWZhdWx0VGF4IiwKICAgICAgICAgICAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9ZGVmYXVsdFRheCM8L3NwYW4+IiwKICAgICAgICAgICAgICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlOiBuZXcga2VuZG8uZGF0YS5EYXRhU291cmNlKHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogdGhpcy5zcGVjaWZpY1RheC5maWx0ZXIobSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlbC5oYXNPd25Qcm9wZXJ0eSgndmF0VGF4JykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YXQgPSBvcHRpb25zLm1vZGVsLnZhdFRheAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubW9kZWwudmF0VGF4ICE9PSBudWxsIHx8IG9wdGlvbnMubW9kZWwudmF0VGF4ICE9PSAnbnVsbCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm1vZGVsLnZhdFRheC5iYXNlQW1vdW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG0uYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpID09PSBvcHRpb25zLm1vZGVsLnZhdFRheC5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgUHVibGljTGlnaHRpbmdUYXhEcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAgICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6ICJzdGFydHN3aXRoIiwKICAgICAgICAgICAgICAgICAgICBkYXRhVGV4dEZpZWxkOiAiZGVmYXVsdFRheCIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPWRlZmF1bHRUYXgjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMucHVibGljTGlnaHRpbmdUYXguZmlsdGVyKG0gPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubW9kZWwuaGFzT3duUHJvcGVydHkoJ3ZhdFRheCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmF0ID0gb3B0aW9ucy5tb2RlbC52YXRUYXgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmF0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm1vZGVsLnZhdFRheCAhPT0gbnVsbCAmJiBvcHRpb25zLm1vZGVsLnZhdFRheCAhPT0gJ251bGwnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlbC52YXRUYXguYmFzZUFtb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0gb3B0aW9ucy5tb2RlbC52YXRUYXguYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIE90aGVyVGF4RHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgICAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgICAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiAic3RhcnRzd2l0aCIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogImRlZmF1bHRUYXgiLAogICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1kZWZhdWx0VGF4Izwvc3Bhbj4iLAogICAgICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U6IG5ldyBrZW5kby5kYXRhLkRhdGFTb3VyY2UoewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLm90aGVyVGF4LmZpbHRlcihtID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm1vZGVsLmhhc093blByb3BlcnR5KCd2YXRUYXgnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhdCA9IG9wdGlvbnMubW9kZWwudmF0VGF4CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlbC52YXRUYXggIT09IG51bGwgJiYgb3B0aW9ucy5tb2RlbC52YXRUYXggIT09ICdudWxsJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubW9kZWwudmF0VGF4LmJhc2VBbW91bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbS5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09IG9wdGlvbnMubW9kZWwudmF0VGF4LmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgVmF0VGF4RHJvcERvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgICAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kVG8oY29udGFpbmVyKQogICAgICAgICAgICAgICAgLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICAgICAgICAgICAgICBhdXRvQmluZDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA0MDAsCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiAic3RhcnRzd2l0aCIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogImRlZmF1bHRUYXgiLAogICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAiPHNwYW4+Iz1kZWZhdWx0VGF4Izwvc3Bhbj4iLAogICAgICAgICAgICAgICAgICAgIG9wdGlvbkxhYmVsOiAiLS1TZWxlY3QtLSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMudmF0VGF4CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBTYWxlVW5pdERyb3BEb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAgICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKGNvbnRhaW5lcikKICAgICAgICAgICAgICAgIC5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgICAgICAgICAgICAgYXV0b0JpbmQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGhlaWdodDogNDAwLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcjogInN0YXJ0c3dpdGgiLAogICAgICAgICAgICAgICAgICAgIGRhdGFUZXh0RmllbGQ6ICJuYW1lIiwKICAgICAgICAgICAgICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogIjxzcGFuPiM9Y29kZSMgLSAjPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuc2FsZVVuaXRJdGVtTGlzdAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgTW9kaWZpZXJEcm9wRG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAgICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykKICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhjb250YWluZXIpCiAgICAgICAgICAgICAgICAua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgICAgICAgICAgICAgIGF1dG9CaW5kOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDQwMCwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6ICJjb250YWlucyIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVRleHRGaWVsZDogIm5hbWUiLAogICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgICAgICAgICAgICAgIGhlYWRlclRlbXBsYXRlOiAnPGRpdiBjbGFzcz0iZHJvcGRvd24taGVhZGVyIGstd2lkZ2V0IGstaGVhZGVyIj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuPk1vZGlmaWVyIDwvc3Bhbj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuPjwvc3Bhbj4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicsCiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6ICI8c3Bhbj4jPW5hbWUjPC9zcGFuPiIsCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogbmV3IGtlbmRvLmRhdGEuRGF0YVNvdXJjZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlckZpbHRlcmluZzogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBpdGVtTW9kaWZpZXJIYW5kbGVyLnNlYXJjaFVSTChvcHRpb25zLm1vZGVsLml0ZW0uaWQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogImlkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaWNlOiB7dHlwZTogIm51bWJlciJ9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1b206IHt0eXBlOiAic3RyaW5nIn0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmNvdW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgdmF0VGVtcGxhdGUoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgY29uc3QgdmF0ID0gZGF0YUl0ZW0udmF0VGF4CiAgICAgICAgICAgIGlmICh2YXQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBgPHNwYW4+JHt2YXQuZGVmYXVsdFRheCA/IHZhdC5kZWZhdWx0VGF4IDogYGB9PC9zcGFuPmAKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBgYAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBpdGVtVGVtcGxhdGUoZGF0YUl0ZW0pIHsKICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRhdGFJdGVtLml0ZW0KICAgICAgICAgICAgaWYgKGl0ZW0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBgPHNwYW4+JHtpdGVtLm5hbWUgPyBpdGVtLm5hbWUgOiBgYH08L3NwYW4+YAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGBgCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFVPTVRlbXBsYXRlKGRhdGFJdGVtKSB7CiAgICAgICAgICAgIGNvbnN0IHVvbSA9IGRhdGFJdGVtLnVvbQogICAgICAgICAgICBpZiAodW9tKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYDxzcGFuPiR7dW9tLnVvbSA/IHVvbS51b20ubmFtZSA6IGBgfTwvc3Bhbj5gCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYGAKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgc2FsZVVuaXRUZW1wbGF0ZShkYXRhSXRlbSkgewogICAgICAgICAgICBjb25zdCBzYWxlVW5pdCA9IGRhdGFJdGVtLnNhbGVVbml0CiAgICAgICAgICAgIGlmIChzYWxlVW5pdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke3NhbGVVbml0Lm5hbWUgPyBzYWxlVW5pdC5uYW1lIDogYGB9PC9zcGFuPmAKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBgYAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBkaXNjb3VudEl0ZW1UZW1wbGF0ZShkYXRhSXRlbSkgewogICAgICAgICAgICBjb25zdCBkaXNjb3VudEl0ZW0gPSBkYXRhSXRlbS5kaXNjb3VudEl0ZW0KICAgICAgICAgICAgaWYgKGRpc2NvdW50SXRlbSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGA8c3Bhbj4ke2Rpc2NvdW50SXRlbS5jb2RlID8gZGlzY291bnRJdGVtLmNvZGUgOiBgYH0gLSAke2Rpc2NvdW50SXRlbS5uYW1lID8gZGlzY291bnRJdGVtLm5hbWUgOiBgYH08L3NwYW4+YAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGBgCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFzeW5jIGxvYWRUYXgoKSB7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKQogICAgICAgICAgICAgICAgICAgIHNldHRpbmdIYW5kbGVyLmdldCgpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXggPSByZXMKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vdGhlclRheCA9IHRoaXMudGF4LmZpbHRlcihtID0+IChtLnRheFR5cGUudHlwZUlkID09PSA3IHx8IG0udGF4VHlwZS50eXBlSWQgPT09IDEwKSAmJiBtLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ1NhbGUnKSAvLyB2YWx1YWJsZSB0YXgKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGVjaWZpY1RheCA9IHRoaXMudGF4LmZpbHRlcihtID0+IChtLnRheFR5cGUudHlwZUlkID09PSA4IHx8IG0udGF4VHlwZS50eXBlSWQgPT09IDEwKSAmJiBtLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ1NhbGUnKSAvLyB2YWx1YWJsZSB0YXgKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdWJsaWNMaWdodGluZ1RheCA9IHRoaXMudGF4LmZpbHRlcihtID0+IChtLnRheFR5cGUudHlwZUlkID09PSA5IHx8IG0udGF4VHlwZS50eXBlSWQgPT09IDEwKSAmJiBtLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ1NhbGUnKSAvLyB2YWx1YWJsZSB0YXgKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YXRUYXggPSB0aGlzLnRheC5maWx0ZXIobSA9PiAobS50YXhUeXBlLnR5cGVJZCA9PT0gMSB8fCBtLnRheFR5cGUudHlwZUlkID09PSA4IHx8IG0udGF4VHlwZS50eXBlSWQgPT09IDEwKSAmJiBtLnRyYW5zYWN0aW9uVHlwZSA9PT0gJ1NhbGUnKSAvLyB2YWx1YWJsZSB0YXgKCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIHVvbUJ5UHJpY2VMZXZlbChpZCwgcHJpY2VMZXZlbElkLCBkYXRhUm93KSB7CiAgICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICB1b21QcmljZUhhbmRsZXIudW9tQnlQcmljZUxldmVsKGlkLCBwcmljZUxldmVsSWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFSb3cuc2V0KCd1b20nLCByZXMuZGF0YS5kYXRhKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhc3luYyBsb2FkRGlzY291bnRJdGVtKCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgZGlzY291bnRJdGVtSGFuZGxlci5saXN0KERJU0NPVU5UX1RZUEUpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGVjaWZpY0Rpc2NvdW50SXRlbSA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCAzMDApOwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYXN5bmMgbG9hZFZpZXdJbnZvaWNlKCkgewogICAgICAgICAgICBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJykKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGJpbGxpbmdIYW5kbGVyLnZpZXcodGhpcy4kcm91dGUucGFyYW1zLmlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZvaWNlID0gcmVzLmRhdGEuZGF0YVswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXN0b21lciA9IHRoaXMuaW52b2ljZS5jdXN0b21lcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXhMaXN0VG90YWwgPSB0aGlzLmludm9pY2UudGF4TGlzdFRvdGFsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1MaW5lcyA9IHRoaXMuaW52b2ljZS5pdGVtTGluZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubU90aGVyQ2hhcmdlID0gdGhpcy5pbnZvaWNlLm90aGVyQ2hhcmdlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSB0aGlzLm1PdGhlckNoYXJnZS5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFNlbGVjdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCA1MDApCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBjbGVhcigpIHsKICAgICAgICAgICAgdGhpcy5pZCA9IHVuZGVmaW5lZAogICAgICAgICAgICB0aGlzLmludm9pY2UgPSB7fQogICAgICAgICAgICB0aGlzLml0ZW1MaW5lcyA9IFtdCiAgICAgICAgICAgIHRoaXMuaW52b2ljZS50cmFuc2FjdGlvblR5cGUgPSB0aGlzLmludm9pY2VUeXBlc1swXQogICAgICAgICAgICB0aGlzLmdlbmVyYXRlTnVtYmVyKCkKICAgICAgICB9CiAgICB9LAogICAgd2F0Y2g6IHsKICAgICAgICBpZCgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICB0aGlzLmxvYWRWaWV3SW52b2ljZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICAvLyBmZXRjaCB0aGUgZGF0YSB3aGVuIHRoZSB2aWV3IGlzIGNyZWF0ZWQgYW5kIHRoZSBkYXRhIGlzCiAgICAgICAgLy8gYWxyZWFkeSBiZWluZyBvYnNlcnZlZAogICAgICAgIC8vIHRoaXMubG9hZE9iaigpCiAgICB9LAogICAgbW91bnRlZDogYXN5bmMgZnVuY3Rpb24gKCkgewogICAgICAgIGF3YWl0IHRoaXMubG9hZExvY2F0aW9uKCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZWdtZW50KCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRQcmVmaXgoKQogICAgICAgIGF3YWl0IHRoaXMubG9hZEN1cnJlbmN5KCkKICAgICAgICBhd2FpdCB0aGlzLmxvYWRTYWxlRm9ybUNvbnRlbnQoKQogICAgICAgIGF3YWl0IHRoaXMubG9hZFNhbGVVbml0SXRlbXMoKQogICAgICAgIGF3YWl0IHRoaXMubG9hZFRheCgpCiAgICAgICAgYXdhaXQgdGhpcy5sb2FkT3RoZXJDaGFyZ2UoKQogICAgICAgIGF3YWl0IHRoaXMubG9hZERpc2NvdW50SXRlbSgpCiAgICAgICAgdGhpcy5jdXN0b21lckRhdGEodGhpcy5maWx0ZXIsIHRoaXMuY3VzQmFzZVVybCkKICAgICAgICBhd2FpdCB0aGlzLmluaXREYXRhKCkKCiAgICB9LAp9Owo="},{"version":3,"sources":["DelayedInvoice.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6pBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"DelayedInvoice.vue","sourceRoot":"src/views/customers","sourcesContent":["<template>\n    <v-app>\n        <v-container>\n            <v-row>\n                <v-col sm=\"12\" cols=\"12\">\n                    <v-card outlined dense class=\"pa-4 no_border rounded-sm\" color=\"white\">\n                        <v-row>\n                            <v-col class=\"bigSide py-0\" sm=\"8\" cols=\"12\" style=\"transition: .3s ease-in;\"\n                                   :class=\"{'hide_big_bar_class':isHideBar}\">\n                                <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\n                                    <v-card outlined dense class=\"no_border\">\n                                        <h2 class=\"mb-0\">{{ $t('delayed_invoice') }}</h2>\n                                        <v-icon v-if=\"isHideBar\"\n                                                onclick=\"window.history.go(-1); return false;\"\n                                                style=\"cursor: pointer; color: #333; font-size: 40px;\"\n                                                class=\"float-right\"\n                                        >close\n                                        </v-icon>\n                                        <span style=\"transition: .3s ease-in; z-index:10;\"\n                                              :class=\"{'iconArrow': !isHideBar,'iconArrowHide': isHideBar }\">\n                                            <v-icon size=\"22\"\n                                                    class=\"arr_icon\"\n                                                    @click=\"hide_smallsitebar\"\n                                                    v-if=\"isHideBar\"> mdi-chevron-left-circle\n                                            </v-icon>\n                                            <v-icon size=\"22\"\n                                                    class=\"arr_icon\"\n                                                    @click=\"hide_smallsitebar\"\n                                                    v-if=\"!isHideBar\"> mdi-chevron-right-circle\n                                            </v-icon>\n\t\t\t\t\t\t\t\t\t\t</span>\n                                    </v-card>\n                                    <v-card outlined dense class=\"px-3 no_border\" color=\"grayBg\">\n                                        <v-row>\n                                            <v-col sm=\"6\" cols=\"12\" class=\"pb-0 px-4 pt-4\">\n                                                <label class=\"label  mb-0\">{{ $t('customer') }}</label>\n                                                <v-col sm=\"12\" cols=\"12\"\n                                                       class=\"kendo_dropdown_custom pl-0 pb-3 pt-1\">\n                                                    <dropdownlist\n                                                        :data-items=\"customerList\"\n                                                        @change=\"onChange\"\n                                                        :value=\"customer\"\n                                                        :data-item-key=\"'id'\"\n                                                        :text-field=\"'numberName'\"\n                                                        :default-item=\"defaultItem\"\n                                                        :filterable=\"true\"\n                                                        @filterchange=\"onFilterChange\">\n                                                    </dropdownlist>\n                                                </v-col>\n                                                <label class=\"label mb-0 mt-1\">{{ $t('number') }}</label>\n                                                <v-row class=\"mt-1 mr-0\">\n                                                    <v-col sm=\"3\" cols=\"3\" class=\"pt-0 pr-0\">\n                                                        <div class=\"code_text text-bold\">\n                                                            {{ invoice.transactionType.abbr }}\n                                                        </div>\n                                                    </v-col>\n                                                    <v-col sm=\"7\" cols=\"7\" class=\"pt-0 pl-0 pr-1\">\n                                                        <v-text-field class=\"custom-border \"\n                                                                      v-model=\"invoice.number\"\n                                                                      outlined\n                                                                      tage=\"Invoice Number\"\n                                                                      :rules=\"[v => !!v || 'Number is required']\"\n                                                                      required/>\n                                                    </v-col>\n                                                    <v-col sm=\"2\" cols=\"2\" class=\"pt-0 px-0\">\n                                                        <v-icon color=\"black\" size=\"30\" class=\"border_qrcode\"\n                                                                @click=\"generateNumber\">mdi-qrcode\n                                                        </v-icon>\n                                                    </v-col>\n                                                </v-row>\n                                            </v-col>\n                                            <v-col sm=\"6\" cols=\"12\" class=\"pb-0 px-4 pt-4\">\n                                                <label class=\"label  mb-0\">{{ $t('date') }}</label>\n                                                <app-datepicker :initialDate=\"invoice.transactionDate\"\n                                                                @emitDate=\"transactionDate = $event\"/>\n                                                <label class=\"label  mb-0\">{{ $t('invoice_currency') }}</label>\n                                                <v-select class=\"mt-0\"\n                                                          :items=\"currencies\"\n                                                          v-model=\"invoice.currency\"\n                                                          tage=\"Invoice Currency\"\n                                                          placeholder=\"USD\"\n                                                          item-value=\"id\"\n                                                          return-object\n                                                          :item-text=\"item =>`${item.code} - ${item.name}`\"\n                                                          outlined\n                                                />\n                                            </v-col>\n                                        </v-row>\n                                    </v-card>\n                                    <v-row class=\"pt-3\" style=\"background-color: #fff;\">\n                                        <v-col sm=\"12\" cols=\"12\" class=\"pt-0\">\n                                            <kendo-datasource ref=\"itemLineDS\"\n                                                              :data=\"itemLines\"\n                                                              :change=\"dataSourceChanged\"/>\n                                            <kendo-grid id=\"gridItemLine\" class=\"grid-function\"\n                                                        :data-source-ref=\"'itemLineDS'\"\n                                                        :sortable=\"false\"\n                                                        :column-menu=\"true\"\n                                                        :editable=\"true\"\n                                                        :scrollable-virtual=\"true\">\n                                                <kendo-grid-column\n                                                    :title=\"$t('no.')\"\n                                                    :width=\"55\"\n                                                    :column-menu=\"false\"\n                                                    :template=\"rowNumberTmpl\"\n                                                    :headerAttributes=\"{\n                                                                    style: 'background-color: #EDF1F5;',\n                                                                    class: 'text-products'\n                                                                }\"\n                                                    :attributes=\"{\n                                                                    style: 'text-align: products'\n                                                                }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'serviceDate'\"\n                                                    :title=\"$t('date_from')\"\n                                                    :width=\"160\"\n                                                    :hidden=\"!saleFormContent.serviceDate\"\n                                                    :template=\"'<span>#= kendo.toString(new Date(serviceDate), dateFormat)#</span>'\"\n                                                    :editor=\"ServiceDateEditor\"\n                                                    :headerAttributes=\"{\n                                                                    style: 'background-color: #EDF1F5'\n                                                                }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'serviceDateTo'\"\n                                                    :title=\"$t('date_to')\"\n                                                    :width=\"160\"\n                                                    :hidden=\"!saleFormContent.serviceDateTo\"\n                                                    :template=\"'<span>#= kendo.toString(new Date(serviceDateTo), dateFormat)#</span>'\"\n                                                    :editor=\"ServiceDateToEditor\"\n                                                    :headerAttributes=\"{\n                                                                    style: 'background-color: #EDF1F5'\n                                                                }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'item'\"\n                                                    :title=\"$t('item')\"\n                                                    :template=\"itemTemplate\"\n                                                    :editor=\"ItemDropDownEditor\"\n                                                    :width=\"200\"\n                                                    :headerAttributes=\"{\n                                                                    style: 'background-color: #EDF1F5'\n                                                                }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'description'\"\n                                                    :title=\"$t('description')\"\n                                                    :template=\"'<span>#=description#</span>'\"\n                                                    :width=\"160\"\n                                                    :headerAttributes=\"{\n                                                                    style: 'background-color: #EDF1F5'\n                                                                }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'qty'\"\n                                                    :title=\"$t('qty')\"\n                                                    :format=\"'{0:n}'\"\n\n                                                    :template=\"'<span>#=qty#</span>'\"\n                                                    :width=\"80\"\n                                                    :headerAttributes=\"{style: 'text-align: left; background-color: #EDF1F5'}\"\n                                                    :attributes=\"{style: 'text-align: left; '}\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'uom'\"\n                                                    :title=\"$t('uom')\"\n                                                    :width=\"100\"\n                                                    :template=\"UOMTemplate\"\n                                                    @change=\"onUOMChanged\"\n                                                    :editor=\"UOMDropDownEditor\"\n                                                    :headerAttributes=\"{\n                                                                        style: 'text-align: left; background-color: #EDF1F5'\n                                                                    }\"\n                                                    :attributes=\"{\n                                                                        style: 'text-align: left'\n                                                                    }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'price'\"\n                                                    :title=\"$t('price')\"\n                                                    :format=\"'{0:n}'\"\n                                                    :width=\"100\"\n                                                    :template=\"'<span>#=price#</span>'\"\n                                                    :headerAttributes=\"{\n                                                                        style: 'text-align: left; background-color: #EDF1F5'\n                                                                    }\"\n                                                    :attributes=\"{\n                                                                        style: 'text-align: right'\n                                                                    }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'amount'\"\n                                                    :title=\"$t('amount')\"\n                                                    :format=\"'{0:n}'\"\n                                                    :width=\"100\"\n                                                    :editable=\"()=>{ return false}\"\n                                                    :template=\"'<span>#=amount#</span>'\"\n                                                    :headerAttributes=\"{\n                                                                        style: 'text-align: left; background-color: #EDF1F5'\n                                                                    }\"\n                                                    :attributes=\"{\n                                                                        style: 'text-align: right'\n                                                                    }\"/>\n                                                <!--                                                <kendo-grid-column-->\n                                                <!--                                                    :field=\"'discountPercent'\"-->\n                                                <!--                                                    :title=\"$t('discount_%')\"-->\n                                                <!--                                                    :format=\"'{0:n}'\"-->\n                                                <!--                                                    :width=\"100\"-->\n                                                <!--                                                    :template=\"'<span>#=discountPercent#</span>'\"-->\n                                                <!--                                                    :headerAttributes=\"{-->\n                                                <!--                                                                        style: 'text-align: left; background-color: #EDF1F5'-->\n                                                <!--                                                                    }\"-->\n                                                <!--                                                    :attributes=\"{-->\n                                                <!--                                                                        style: 'text-align: left'-->\n                                                <!--                                                                    }\"/>-->\n                                                <!--                                                <kendo-grid-column-->\n                                                <!--                                                    :field=\"'discountAmount'\"-->\n                                                <!--                                                    :title=\"$t('discount_amount')\"-->\n                                                <!--                                                    :format=\"'{0:n}'\"-->\n                                                <!--                                                    :width=\"100\"-->\n                                                <!--                                                    :template=\"'<span>#=discountAmount#</span>'\"-->\n                                                <!--                                                    :headerAttributes=\"{-->\n                                                <!--                                                                        style: 'text-align: left; background-color: #EDF1F5'-->\n                                                <!--                                                                    }\"-->\n                                                <!--                                                    :attributes=\"{-->\n                                                <!--                                                                        style: 'text-align: left'-->\n                                                <!--                                                                    }\"/>-->\n                                                <kendo-grid-column\n                                                    :field=\"'modifier'\"\n                                                    :title=\"$t('modifier')\"\n                                                    :format=\"'{0:n}'\"\n                                                    :width=\"150\"\n                                                    :hidden=\"!saleFormContent.modifier\"\n                                                    :template=\"'<span>#=modifier.name?modifier.name:``#</span>'\"\n                                                    :editor=\"ModifierDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'text-align: left; background-color: #EDF1F5' }\"\n                                                    :attributes=\"{style: 'text-align: left' }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'discountItem'\"\n                                                    :title=\"$t('discount_item')\"\n                                                    :width=\"150\"\n                                                    :hidden=\"!saleFormContent.discountItem\"\n                                                    :template=\"discountItemTemplate\"\n                                                    :editor=\"DiscountItemDropDownEditor\"\n                                                    :headerAttributes=\"{\n                                                                        style: 'text-align: left; background-color: #EDF1F5'\n                                                                    }\"\n                                                    :attributes=\"{\n                                                                        style: 'text-align: left'\n                                                                    }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'vatTax'\"\n                                                    :title=\"$t('vat')\"\n                                                    :width=\"150\"\n                                                    :template=\"vatTemplate\"\n                                                    :editor=\"VatTaxDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'text-align: left; background-color: #EDF1F5' }\"\n                                                    :attributes=\"{style: 'text-align: left' }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'specificTax'\"\n                                                    :title=\"$t('specificTax')\"\n                                                    :width=\"150\"\n                                                    :hidden=\"!saleFormContent.specificTax\"\n                                                    :template=\"'<span>#=specificTax.defaultTax?specificTax.defaultTax:``#</span>'\"\n                                                    :editor=\"SpecificTaxDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'text-align: left; background-color: #EDF1F5' }\"\n                                                    :attributes=\"{style: 'text-align: left' }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'otherTax'\"\n                                                    :title=\"$t('otherTax')\"\n                                                    :width=\"150\"\n                                                    :hidden=\"!saleFormContent.otherTax\"\n                                                    :template=\"'<span>#=otherTax.defaultTax?otherTax.defaultTax:``#</span>'\"\n                                                    :editor=\"OtherTaxDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'text-align: left; background-color: #EDF1F5' }\"\n                                                    :attributes=\"{style: 'text-align: left' }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'publicLightingTax'\"\n                                                    :title=\"$t('pl_tax')\"\n                                                    :format=\"'{0:n}'\"\n                                                    :width=\"150\"\n                                                    :hidden=\"!saleFormContent.publicLightingTax\"\n                                                    :template=\"'<span>#=publicLightingTax.defaultTax?publicLightingTax.defaultTax:``#</span>'\"\n                                                    :editor=\"PublicLightingTaxDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'text-align: left; background-color: #EDF1F5' }\"\n                                                    :attributes=\"{style: 'text-align: left' }\"/>\n                                                <kendo-grid-column\n                                                    :field=\"'saleUnit'\"\n                                                    :title=\"$t('sale_unit')\"\n                                                    :width=\"150\"\n                                                    :hidden=\"!saleFormContent.saleUnit\"\n                                                    :template=\"saleUnitTemplate\"\n                                                    :editor=\"SaleUnitDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'text-align: left; background-color: #EDF1F5' }\"\n                                                    :attributes=\"{style: 'text-align: left' }\"/>\n\n                                                <kendo-grid-column\n                                                    :field=\"'employee'\"\n                                                    :title=\"$t('employee')\"\n                                                    :width=\"150\"\n                                                    :hidden=\"!saleFormContent.employee\"\n                                                    :template=\"empImpl\"\n                                                    :editor=\"EmployeeDropDownEditor\"\n                                                    :headerAttributes=\"{ style: 'text-align: left; background-color: #EDF1F5' }\"\n                                                    :attributes=\"{style: 'text-align: left' }\"/>\n\n                                                <kendo-grid-column\n                                                    :command=\"{ iconClass: 'k-icon k-i-trash', text: 'Delete', click: removeRow, class: 'btn-plus' }\"\n                                                    :title=\"'Action'\"\n                                                    :width=\"100\"\n                                                    :headerAttributes=\"{style: 'text-align: left; background-color: #EDF1F5'}\"/>\n                                            </kendo-grid>\n\n                                        </v-col>\n                                        <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                                            <v-row>\n                                                <v-col sm=\"9\" cols=\"12\" class=\"\">\n                                                    <v-btn class=\"float-left btn_plus rounded-0 mr-2\" @click=\"addRow\">\n                                                        <v-icon size=\"\" class=\"ma-1\">mdi-plus</v-icon>\n                                                    </v-btn>\n                                                    <!--                                                    <v-btn class=\"float-left rounded-0 btn_plus mr-2\" @click=\"addRow\">-->\n                                                    <!--                                                        <v-icon size=\"\" class=\"ma-1\">fa fa-barcode</v-icon>-->\n                                                    <!--                                                    </v-btn>-->\n                                                    <!--                                                    <v-btn class=\"float-left white&#45;&#45;text rounded-0 add_account mr-2\"-->\n                                                    <!--                                                           to=\"add_item\">-->\n                                                    <!--                                                        {{ $t('add_account') }}-->\n                                                    <!--                                                    </v-btn>-->\n                                                    <!--                                                    <v-btn class=\"float-left rounded-0 add_account mr-2 btn_save_draft\">-->\n                                                    <!--                                                        {{ $t('sub_total') }}-->\n                                                    <!--                                                    </v-btn>-->\n                                                    <!--                                                    <template>-->\n                                                    <!--                                                        <v-file-input class=\"mt-0 pt-0 \" sm=\"3\" cols=\"6\"-->\n                                                    <!--                                                                      v-model=\"files\"-->\n                                                    <!--                                                                      :placeholder=\"$t('attachment')\"-->\n                                                    <!--                                                                      multiple-->\n                                                    <!--                                                                      prepend-icon=\"mdi-paperclip\"-->\n                                                    <!--                                                        >-->\n                                                    <!--                                                            <template v-slot:selection=\"{ text }\">-->\n                                                    <!--                                                                <v-chip-->\n                                                    <!--                                                                    small-->\n                                                    <!--                                                                    label-->\n                                                    <!--                                                                    color=\"primary\"-->\n                                                    <!--                                                                >-->\n                                                    <!--                                                                    {{ text }}-->\n                                                    <!--                                                                </v-chip>-->\n                                                    <!--                                                            </template>-->\n                                                    <!--                                                        </v-file-input>-->\n                                                    <!--                                                    </template>-->\n                                                </v-col>\n                                            </v-row>\n                                        </v-col>\n                                        <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                                            <v-row>\n                                                <v-col class=\"pt-0\" sm=\"6\" cols=\"6\">\n                                                    <v-card class=\"no-boxshadow pa-3\" color=\"grayBg\">\n                                                        <label>{{ $t('message_on_invoice') }}</label>\n                                                        <v-textarea class=\"mt-1\"\n                                                                    v-model=\"invoice.transactionNote\"\n                                                                    outlined\n                                                                    no-resize\n                                                                    height=\"80px\"\n                                                                    rows=\"3\"\n                                                                    placeholder=\"This will appear on the invoice\"\n                                                        />\n                                                    </v-card>\n                                                </v-col>\n                                                <v-col class=\"pt-0\" sm=\"6\" cols=\"6\">\n                                                    <v-simple-table>\n                                                        <template v-slot:default>\n                                                            <tbody>\n                                                            <tr>\n                                                                <td class=\"text-left pr-0\">{{ $t('subtotal') }}</td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right\">\n                                                                    {{ numberFormat(invoice.subTotal) }}\n                                                                </td>\n                                                            </tr>\n                                                            <tr>\n                                                                <td class=\"text-left pr-0\">{{\n                                                                        $t('general_discount')\n                                                                    }}\n                                                                </td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right\">({{\n                                                                        numberFormat(invoice.discountTotal)\n                                                                    }})\n                                                                </td>\n                                                            </tr>\n                                                            <tr>\n                                                                <td class=\"text-left pr-0\">{{ $t('total_tax') }}\n                                                                    <v-btn @click=\"dialogTax=true\"\n                                                                            color=\"primary\"\n                                                                           class=\"text-white text-bold rounded-0 float-right text-uppercase\"\n                                                                           style=\"height: 30px !important;\">\n                                                                        {{ $t('tax') }}\n                                                                    </v-btn>\n                                                                </td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right\">\n                                                                    {{ numberFormat(invoice.totalTaxAmount) }}\n                                                                </td>\n                                                            </tr>\n                                                            <tr>\n                                                                <td class=\"text-left pr-0\" width=\"240px\">\n                                                                    <v-select class=\"mt-3\"\n                                                                              v-model=\"invoice.specificDiscountItem\"\n                                                                              :items=\"specificDiscountItem\"\n                                                                              item-text=\"name\"\n                                                                              @change=\"onSpecificDiscountChanged\"\n                                                                              item-value=\"id\"\n                                                                              return-object\n                                                                              clearable\n                                                                              outlined\n                                                                    />\n                                                                </td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right\">({{\n                                                                        numberFormat(invoice.specificDiscountTotal ? invoice.specificDiscountTotal : 0)\n                                                                    }})\n                                                                </td>\n                                                            </tr>\n                                                            <!--                                                            <tr>-->\n                                                            <!--                                                                <td class=\"text-left\">{{ $t('delivery') }}</td>-->\n                                                            <!--                                                                <td class=\"text-center\">:</td>-->\n                                                            <!--                                                                <td class=\"text-right\">{{ invoice.deliveryFee }}</td>-->\n                                                            <!--                                                            </tr>-->\n\n                                                            <tr v-for=\"(num,index) in numSelect\" :key=\"index\"\n                                                                class=\"hide_form_alert\">\n                                                                <td class=\"text-left text-uppercase pr-0\">\n\n                                                                    <v-btn v-if=\"num == 1\" @click=\"addSelect\"\n                                                                           class=\"float-left mt-2 mr-1 pa-1\" small>\n                                                                        <v-icon color=\"primary\" size=\"16\" class=\"ma-1\">\n                                                                            mdi-plus\n                                                                        </v-icon>\n                                                                    </v-btn>\n                                                                    <v-btn v-if=\"num > 1\" @click=\"removeSelect(index)\"\n                                                                           class=\"float-left mt-2 mr-1 pa-1\" small>\n                                                                        <v-icon color=\"primary\" size=\"16\" class=\"ma-1\">\n                                                                            fa-trash\n                                                                        </v-icon>\n                                                                    </v-btn>\n                                                                    <v-select class=\"my-2 capitalize\"\n                                                                              v-model=\"mOtherCharge[index]\"\n                                                                              :items=\"otherChargeList\"\n                                                                              item-text=\"name\"\n                                                                              @change=\"onOtherChargeChange\"\n                                                                              item-value=\"id\"\n                                                                              return-object\n                                                                              clearable\n                                                                              outlined\n                                                                    />\n                                                                </td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right color_green text-bold\">\n                                                                    {{\n                                                                        numberFormat(onOtherAmount(mOtherCharge[index]))\n                                                                    }}\n                                                                </td>\n                                                            </tr>\n                                                            <tr style=\"background: #F8F8F9\">\n                                                                <td class=\"text-left text-uppercase pr-0\">{{\n                                                                        $t('total')\n                                                                    }}\n                                                                </td>\n                                                                <td class=\"text-center\">:</td>\n                                                                <td class=\"text-right color_green text-bold\" id=\"total\">\n                                                                    {{ numberFormat(invoice.total) }}\n                                                                </td>\n                                                            </tr>\n                                                            <!--                                                            <tr>-->\n                                                            <!--                                                                <td class=\"text-left pr-0\">{{ $t('deposit') }} <span-->\n                                                            <!--                                                                    class=\"float-right color_green\">{{-->\n                                                            <!--                                                                        numberFormat(invoice.depositAmount)-->\n                                                            <!--                                                                    }}</span>-->\n                                                            <!--                                                                </td>-->\n                                                            <!--                                                                <td class=\"text-center\">:</td>-->\n                                                            <!--                                                                <td class=\"text-right hide_form_alert\">-->\n                                                            <!--                                                                    <v-text-field-->\n                                                            <!--                                                                        class=\" text-right float-right deposite_input\"-->\n                                                            <!--                                                                        v-model=\"invoice.depositDeduction\"-->\n                                                            <!--                                                                        @change=\"autoCalculate\"-->\n                                                            <!--                                                                        tage=\"Deposit\"-->\n                                                            <!--                                                                        width=\"80\"-->\n                                                            <!--                                                                        outlined-->\n                                                            <!--                                                                    />-->\n                                                            <!--                                                                </td>-->\n                                                            <!--                                                            </tr>-->\n                                                            <!--                                                            <tr>-->\n                                                            <!--                                                                <td class=\"text-left\">{{ $t('amount_due') }}</td>-->\n                                                            <!--                                                                <td class=\"text-center\">:</td>-->\n                                                            <!--                                                                <td class=\"text-right color_green text-bold\">-->\n                                                            <!--                                                                    {{ numberFormat(invoice.remainingAmount) }}-->\n                                                            <!--                                                                </td>-->\n                                                            <!--                                                            </tr>-->\n\n                                                            </tbody>\n                                                        </template>\n                                                    </v-simple-table>\n                                                </v-col>\n                                            </v-row>\n                                        </v-col>\n                                    </v-row>\n\n                                    <v-divider/>\n                                    <v-card outlined dense class=\"no_border function_footer\">\n                                        <v-alert type=\"warning\"\n                                                 v-model=\"alert\"\n                                                 dismissible>\n                                            <span v-html=\"errorMessage\"/>\n                                        </v-alert>\n                                        <v-menu>\n                                            <template v-slot:activator=\"{ on }\">\n                                                <v-btn class=\"mr-2 float-left text-capitalize \" v-on=\"on\">\n                                                    {{ $t('select_template') }}\n                                                    <v-icon size=\"\" class=\"ma-1\">expand_more</v-icon>\n                                                </v-btn>\n                                            </template>\n                                            <v-list>\n                                                <v-list-item v-for=\"(item, index) in templates\" :key=\"index\">\n                                                    <v-list-item-title>{{ item.title }}</v-list-item-title>\n                                                </v-list-item>\n                                            </v-list>\n                                        </v-menu>\n                                        <v-btn color=\"black\" class=\"float-left white--text  text-capitalize \"\n                                               @click=\"cancel\">{{ $t('cancel') }}\n                                        </v-btn>\n                                        <v-menu>\n                                            <template v-slot:activator=\"{ on }\">\n                                                <v-btn color=\"primary\"\n                                                       class=\"ml-2 float-right white--text  text-capitalize\" v-on=\"on\">\n                                                    {{ $t('save_option') }}\n                                                    <v-icon size=\"\" class=\"ma-1\">expand_more</v-icon>\n                                                </v-btn>\n                                            </template>\n                                            <v-list rounded>\n                                                <v-list-item-group>\n                                                    <v-list-item>\n                                                        <v-list-item-content>\n                                                            <v-list-item-title @click=\"saveNew\">\n                                                                {{ $t('save_new') }}\n                                                            </v-list-item-title>\n                                                        </v-list-item-content>\n                                                    </v-list-item>\n                                                    <v-list-item>\n                                                        <v-list-item-content>\n                                                            <v-list-item-title>{{ $t('save_print') }}\n                                                            </v-list-item-title>\n                                                        </v-list-item-content>\n                                                    </v-list-item>\n                                                    <v-list-item>\n                                                        <v-list-item-content>\n                                                            <v-list-item-title @click=\"onSaveClose(false)\">\n                                                                {{ $t('save_close') }}\n                                                            </v-list-item-title>\n                                                        </v-list-item-content>\n                                                    </v-list-item>\n                                                </v-list-item-group>\n                                            </v-list>\n                                        </v-menu>\n                                        <v-btn color=\"secondary\" class=\"float-right  white--text text-capitalize\">\n                                            {{ $t('save_draft') }}\n                                        </v-btn>\n\n                                    </v-card>\n                                </v-form>\n                            </v-col>\n                            <v-col class=\"smallSide\" sm=\"4\" style=\"transition: .3s ease-in;\"\n                                   :class=\"{'hide_small_bar_class':isHideBar}\">\n                                <h3 style=\"color: #b3b5bc; font-size:20px;\" v-if=\"!isHideBar\"\n                                    class=\"text-uppercase float-right mt-n3\">\n                                    <span class=\"pointer\" @click=\"Help('delayed invoice')\">\n                                        {{ $t('help') }}\n                                    </span>\n                                    <v-icon\n                                        onclick=\"window.history.go(-1); return false;\"\n                                        style=\"cursor: pointer; font-size: 40px;\"\n                                        color=\"grey\"\n                                        class=\"float-right mt-n1\"\n                                    >close\n                                    </v-icon>\n                                </h3>\n\n                                <div v-if=\"!isHideBar\" class=\"small_sidebar mt-9 px-4 pt-4 grayBg\">\n                                    <v-card class=\"pa-3 no-boxshadow d-flex justify-space-between align-center\"\n                                            min-height=\"60px\" color=\"primary\">\n                                        <h3 style=\"font-size: 18px\" class=\"text-white text-uppercase\">\n                                            {{ $t('amount_due') }}</h3>\n                                        <h3 class=\"text-bold float-right text-white\" style=\"font-size: 22px\">\n                                            {{ numberFormat(invoice.amountDue) }}</h3>\n                                    </v-card>\n\n                                    <v-row>\n                                        <v-col sm=\"12\" cols=\"12\" class=\"pt-4\">\n                                            <!-- <h4 class=\" text-uppercase line_22\">{{ $t('analysis') }}</h4> -->\n                                            <label class=\"label mb-0\">{{ $t('segment') }}</label>\n                                            <v-select class=\"mt-1\"\n                                                      v-model=\"invoice.segment\"\n                                                      :items=\"segments\"\n                                                      item-value=\"id\"\n                                                      :item-text=\"item =>`${item.code} - ${item.name}`\"\n                                                      return-object\n                                                      tage=\"sub Of\"\n                                                      placeholder=\"Sub Of\"\n                                                      outlined=\"\"/>\n                                            <label class=\"label mb-0\">{{ $t('location') }}</label>\n                                            <v-select class=\"mt-1\"\n                                                      v-model=\"invoice.location\"\n                                                      :items=\"locations\"\n                                                      item-value=\"id\"\n                                                      :item-text=\"item =>`${item.code} - ${item.name}`\"\n                                                      return-object\n                                                      tage=\"Location\"\n                                                      placeholder=\"bu/location\"\n                                                      outlined=\"\"/>\n\n\n                                        </v-col>\n                                    </v-row>\n                                    <p class=\"mb-0 detial_smallside_p font_14\">{{ $t('delayed_funct_desc') }}</p>\n                                </div>\n                            </v-col>\n                        </v-row>\n\n                    </v-card>\n                </v-col>\n            </v-row>\n            <LoadingMe\n                :isLoading=\"showLoading\"\n                :fullPage=\"true\"\n                :myLoading=\"true\"\n                :alertMessage=\"loadingAlert\"\n                :color=\"loadingColorAlert\"\n                :alertText=\"loadingTextAlert\"/>\n            <v-dialog v-model=\"dialogTax\" max-width=\"450px\">\n                <v-card>\n                    <div class=\"modal_header\">\n                        <v-card-title>{{ $t('tax_list') }}</v-card-title>\n                        <v-icon  @click=\"dialogTax = false\">close</v-icon>\n                    </div>\n                    <v-card-text class=\"modal_text_content\">\n                        <v-row>\n                            <v-col sm=\"12\" cols=\"12\" class=\"pb-0\">\n                                <v-simple-table>\n                                    <template v-slot:default>\n                                        <tbody>\n                                        <tr v-for=\"(value, name) in taxListTotal\" v-bind:key=\"name\">\n                                            <td class=\"text-left\" width=\"180px\">{{ name }}</td>\n                                            <td class=\"text-center\">:</td>\n                                            <td class=\"text-right\">\n                                                {{ numberFormat(value) }}\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <td class=\"text-left\" width=\"180px\">{{ $t('total') }}</td>\n                                            <td class=\"text-center\">:</td>\n                                            <td class=\"text-right\">\n                                                {{ numberFormat(invoice.totalTaxAmount) }}\n                                            </td>\n                                        </tr>\n                                        </tbody>\n                                    </template>\n                                </v-simple-table>\n                            </v-col>\n                        </v-row>\n                    </v-card-text>\n                    <v-divider/>\n\n                </v-card>\n            </v-dialog>\n        </v-container>\n    </v-app>\n</template>\n\n<script>\nimport DatePickerComponent from '@/components/custom_templates/DatePickerComponent'\nimport {DropDownList} from '@progress/kendo-vue-dropdowns'\nimport ItemLineModel from \"@/scripts/invoice/model/ItemLine\"\nimport {uuid} from 'vue-uuid'\nimport InvoiceModel from \"@/scripts/invoice/model/Invoice\"\nimport SaleFormContentModel from \"@/scripts/model/SaleFormContent\";\nimport kendo from \"@progress/kendo-ui\";\nimport { ShowResource } from '@/observable/store'\n\nconst $ = require(\"jquery\")\n\nconst settingsHandler = require(\"@/scripts/settingsHandler\")\nconst customerHandler = require(\"@/scripts/customerHandler\")\nconst locationHandler = require(\"@/scripts/locationHandler\")\nconst prefixHandler = require(\"@/scripts/prefixHandler\")\nconst billingHandler = require(\"@/scripts/invoice/handler/billingHandler\")\nconst currencyHandler = require(\"@/scripts/currency/handler/currencyHandler\")\nconst saleFormContentHandler = require(\"@/scripts/saleFormContentHandler\")\nconst productVariantHandler = require(\"@/scripts/productVariantHandler\")\nconst uomPriceHandler = require(\"@/scripts/uomPriceHandler\")\nconst discountItemHandler = require(\"@/scripts/discountItemHandler\")\nconst itemModifierHandler = require(\"@/scripts/itemModifierHandler\")\nconst saleUnitItemHandler = require(\"@/scripts/saleUnitItemHandler\")\nconst employeeHandler = require(\"@/scripts/employeeHandler\")\nconst settingHandler = require(\"@/scripts/settingHandler\")\nconst otherChargeHandler = require(\"@/scripts/otherChargeHandler\")\n\nconst invoiceModel = new InvoiceModel({})\nconst itemLineModel = new ItemLineModel({})\nconst saleFormContentModel = new SaleFormContentModel({})\n\nconst textField = 'numberName'\nconst keyField = 'id'\nconst defaultItem = {[textField]: 'Select customer...', [keyField]: null}\nconst emptyItem = {[textField]: 'loading ...'}\nconst DELAYED_INVOICE = 'delayed invoice'\nconst itemLinePrefix = 'lin-'\nconst DISCOUNT_TYPE = '?type=Sale'\n\nexport default {\n    name: \"DelayedInvoice\",\n    props: ['id'],\n    components: {\n        LoadingMe: () => import(`@/components/Loading`),\n        'app-datepicker': DatePickerComponent,\n        'dropdownlist': DropDownList\n    },\n    data: () => ({\n        showLoading: false,\n        loadingAlert: false,\n        loadingColorAlert: '',\n        loadingTextAlert: '',\n        alert: false,\n        deposite: 0,\n        files: [],\n        // Form validation\n        valid: true,\n        transactionDate: new Date().toISOString().substr(0, 10),\n        transactionType: ['Delayed Invoice'],\n        templates: [\n            {title: 'Draft'},\n            {title: 'Open'},\n            {title: 'Partially Closed'},\n            {title: 'Closed'},\n        ],\n        col_expand: 9,\n        col_hide: 3,\n        isHideBar: false,\n        dialogTax: false,\n        customerList: [],\n        currencies: [],\n        segments: [],\n        locations: [],\n        itemLines: [],\n        numSelect: [1],\n        mOtherCharge: [],\n        mOtherChargeAmount: [],\n        specificDiscountItem: [],\n        otherChargeList: [],\n        taxListTotal: {},\n        loggedUser: {\n            id: 'cf3d10ab-bce6-47b3-8405-b448c23dad84',\n            name: 'Mr. Inspector'\n        },\n        cusBaseUrl: customerHandler.search(),\n        filter: '',\n        defaultItem: defaultItem,\n        itemLine: itemLineModel,\n        saleFormContent: saleFormContentModel,\n        customer: {},\n        invoice: invoiceModel\n    }),\n    methods: {\n        Help(key_search){\n            ShowResource(key_search)\n        },\n        onUOMChanged(dataItem) {\n            window.console.log(dataItem, 'uom changed')\n        },\n        close(data) {\n            if (this.$route.params.id === undefined) {\n                this.$router.push({\n                    name: \"Customers\",\n                    params: {\n                        data: data,\n                    }\n                })\n            } else {\n                window.history.go(-1)\n                // this.$router.push({\n                //     path: \"invoice_view\",\n                //     name: \"Invoice View\",\n                //     params: {\n                //         data: data,\n                //     }\n                // })\n            }\n            // window.console.log(data, 'data')\n        },\n        saveNew() {\n\n        },\n        async initData() {\n            if (this.$route.params.id !== undefined) {\n                await this.loadViewInvoice()\n            } else {\n                this.addRow()\n            }\n        },\n        async onSaveClose(saveSend) {\n            if (!this.$refs.form.validate()) {\n                this.$refs.form.validate()\n                return\n            }\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    let itemLineDS = this.$refs.itemLineDS.kendoWidget()\n                    let data = {\n                        \"id\": this.invoice.id ? this.invoice.id : '',\n                        \"type\": 'Delayed Invoice',\n                        \"number\": this.invoice.number,\n                        \"abbr\": this.invoice.transactionType.abbr,\n                        \"transactionDate\": this.transactionDate,\n                        \"dueDate\": this.invoice.dueDate,\n                        \"monthOf\": this.invoice.monthOf,\n                        \"customer\": this.invoice.customer,\n                        \"transactionType\": this.invoice.transactionType,\n                        \"paymentTerm\": this.invoice.paymentTerm,\n                        \"discountPromotion\": {},\n                        \"accReceivable\": this.invoice.accReceivable,\n                        \"currency\": this.invoice.currency,\n                        \"priceLevel\": this.invoice.priceLevel,\n                        \"itemLines\": itemLineDS.data(),\n                        \"segment\": this.invoice.segment,\n                        \"location\": this.invoice.location,\n                        \"project\": this.invoice.project,\n                        \"saleChannel\": this.invoice.saleChannel,\n                        \"employee\": this.invoice.employee,\n                        \"billingAddress\": this.invoice.billingAddress,\n                        \"deliveryAddress\": this.invoice.deliveryAddress,\n                        \"deliveryDateTime\": this.invoice.deliveryDateTime,\n                        \"transactionNote\": this.invoice.transactionNote,\n                        \"journalNote\": this.invoice.journalNote,\n                        \"subTotal\": this.invoice.subTotal,\n                        \"total\": this.invoice.total,\n                        \"discountTotal\": this.invoice.discountTotal,\n                        \"specificDiscountTotal\": this.invoice.specificDiscountTotal,\n                        \"deliveryFee\": this.invoice.deliveryFee,\n                        \"totalTaxAmount\": this.invoice.totalTaxAmount,\n                        \"depositAmount\": this.invoice.depositAmount,\n                        \"depositDeduction\": this.invoice.depositDeduction,\n                        \"remainingAmount\": this.invoice.remainingAmount,\n                        \"amountDue\": this.invoice.amountDue,\n                        \"currentBalance\": this.invoice.currentBalance,\n                        \"balance\": this.invoice.balance,\n                        \"creditLimit\": this.invoice.creditLimit,\n                        \"saveOption\": this.invoice.saveOption,\n                        \"status\": 1,\n                        \"approvedBy\": this.invoice.approvedBy,\n                        \"formTemplate\": {},\n                        \"specificDiscountItem\": this.invoice.specificDiscountItem,\n                        \"otherCharge\": this.mOtherCharge,\n                        \"otherChargeAmount\": this.invoice.otherChargeAmount,\n                        \"lateFee\": this.invoice.lateFee,\n                        \"paymentOptionWBMobile\": {},\n                        \"paymentOptionOnline\": {},\n                        \"paymentOptionKHQR\": {},\n                        \"publicLink\": this.invoice.publicLink,\n                        \"paymentCode\": this.invoice.paymentCode,\n                        \"taxListTotal\": this.taxListTotal,\n                        \"customerDiscountItem\": this.customerDiscountItem,\n                        \"customerSaleUnit\": this.customerSaleUnit,\n                        \"paymentScheme\": this.invoice.paymentScheme,\n                        \"createdAt\": this.invoice.createdAt,\n                        \"loggedUser\": this.loggedUser,\n                        \"saveSend\": saveSend,\n                        \"actionType\": this.$route.params.id ? this.$route.query.type : 'new'\n                    }\n                    billingHandler.create(data).then(response => {\n                        if (response.data.statusCode === 201) {\n                            // this.close(response.data.data)\n                            // this.$refs.form.reset()\n                            this.$snotify.success('Successfully')\n                            this.close(response.data.data)\n                        }\n                    }).catch(e => {\n                        this.$snotify.error('Something went wrong')\n                        this.errors.push(e)\n                    })\n                }, 300);\n            })\n        },\n        removeRow(e) {\n            e.preventDefault();\n            const grid = kendo.jQuery(\"#gridItemLine\").data(\"kendoGrid\"),\n                dataSource = grid.dataSource,\n                dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n            if (dataSource.total() > 1) {\n                dataSource.remove(dataItem);\n            }\n        },\n        errorMessage() {\n\n        },\n        addRow() {\n            let ds = this.$refs.itemLineDS.kendoWidget(),\n                total = ds.total()\n            this.itemLine.id = itemLinePrefix + uuid.v1()\n            ds.insert(total, this.itemLine)\n            // this.itemLines.push(this.itemLine)\n            // window.console.log('item Line', this.itemLine)\n        },\n        accountDropDownEditor() {\n        },\n        cancel() {\n\n        },\n        hide_smallsitebar() {\n            this.isHideBar = !this.isHideBar;\n        },\n        zeroPad(num, places) {\n            return String(num).padStart(places, '0')\n        },\n        async loadSaleFormContent() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    saleFormContentHandler.list().then(res => {\n                        if (res.data.statusCode === 200) {\n                            const data = res.data.data\n                            if (data.length > 0) {\n                                this.saleFormContent = data[0]\n                            }\n                        }\n                    })\n                }, 300)\n            })\n        },\n        async loadCurrency() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    currencyHandler.list('fun-c').then(res => {\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false\n                            this.currencies = res.data.data.filter(o => o.used === 1)\n                        }\n                    })\n                }, 300);\n            })\n        },\n        async loadPrefix() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    prefixHandler.get(DELAYED_INVOICE).then(res => {\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false\n                            this.invoiceTypes = res.data.data\n                            if (this.invoiceTypes.length > 0) {\n                                this.invoice.transactionType = this.invoiceTypes[0]\n                                if (this.$route.params.id === undefined) {\n                                    this.generateNumber()\n                                }\n                            }\n                        }\n\n                    })\n                }, 300);\n            })\n        },\n        async loadSaleUnitItems() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    saleUnitItemHandler.list().then(res => {\n                        if (res.data.statusCode === 200)\n                            this.saleUnitItemList = res.data.data\n                    })\n                }, 300)\n            })\n        },\n        addSelect() {\n            let amount_num = this.numSelect.length\n            let num = this.numSelect[amount_num - 1]\n            let new_num = num + 1\n            let lenghtItem = this.specificDiscountItem.length\n            if (new_num <= lenghtItem) {\n                this.numSelect.push(new_num)\n            }\n\n        },\n        removeSelect(index) {\n            this.numSelect.splice(index, 1)\n            // window.console.log(index, this.numSelect)\n            // this.selectDiscount.splice(index,1)\n            // window.console.log(\"remove\",this.selectDiscount)\n            // this.selectDiscount = this.selectDiscount.filter(item =>  item.id != val.id);\n        },\n        onOtherChargeChange() {\n            let otherCharge = 0\n            this.mOtherCharge.forEach(m => {\n                otherCharge += this.autoCalculateDiscount(m, this.invoice.subTotal)\n            })\n            this.invoice.otherChargeAmount = otherCharge\n            this.autoCalculate()\n        },\n        onOtherAmount(value) {\n            return this.autoCalculateDiscount(value, this.invoice.subTotal)\n        },\n        onSpecificDiscountChanged() {\n            if (this.invoice.specificDiscountItem) {\n                // window.console.log('-changed', this.invoice.specificDiscountItem)\n                const discountInvoice = this.autoCalculateDiscount(this.invoice.specificDiscountItem, this.invoice.subTotal)\n                this.invoice.specificDiscountTotal = kendo.toString(discountInvoice ? discountInvoice : 0, 'n')\n                let total = kendo.parseFloat(this.invoice.subTotal) - (kendo.parseFloat(this.invoice.discountTotal) + kendo.parseFloat(this.invoice.totalTaxAmount)) - discountInvoice\n                this.invoice.total = kendo.toString((total), 'n')\n            }\n        },\n        async loadOtherCharge() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    otherChargeHandler.list().then(res => {\n                        if (res.data.statusCode === 200) {\n                            this.otherChargeList = res.data.data\n                        }\n                    })\n                }, 300);\n            })\n        },\n        onChange(event) {\n            const value = event.value\n            if (value && value[textField] === emptyItem[textField]) {\n                return;\n            }\n            this.customer = value\n            this.invoice.customer = value\n            this.invoice.priceLevel = value.hasOwnProperty('priceLevel') ? value.priceLevel : {}\n\n            if (value.hasOwnProperty('priceLevel')) {\n                if (value.priceLevel.hasOwnProperty('currency')) {\n                    this.invoice.currency = value.priceLevel.currency\n                }\n            }\n        },\n        onFilterChange(event) {\n            const filter = event.filter.value\n            this.customerData(filter, this.cusBaseUrl)\n            this.filter = filter\n        },\n        customerData(filter, baseUrl) {\n            const url = baseUrl +\n                `?filter=${filter}`\n            fetch(url)\n                .then((response) => {\n                    return response.json()\n                })\n                .then(this.afterFetch)\n        },\n        afterFetch(json) {\n            this.customerList = json.data\n        },\n        async loadLocation() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    this.locations = []\n                    locationHandler.list().then(res => {\n                        this.showLoading = true\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false\n                            this.locations = res.data.data\n                            if (this.locations.length > 0) {\n                                this.invoice.location = this.locations[0]\n                            }\n                        }\n                    }).catch()\n                    {\n                        this.showLoading = false\n                    }\n                }, 300)\n            })\n        },\n        async loadSegment() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    this.segments = []\n                    settingsHandler.getSeg().then(res => {\n                        this.showLoading = true\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false\n                            this.segments = res.data.data\n                            if (this.segments.length > 0) {\n                                this.invoice.segment = this.segments[0]\n                            }\n                            // this.segmentList = res.data.data\n                        }\n                    }).catch()\n                    {\n                        this.showLoading = false\n                    }\n                }, 300)\n            })\n        },\n        generateNumber() {\n            let data = {\n                abbr: this.invoice.transactionType.abbr,\n                structure: this.invoice.transactionType.structure,\n                transactionDate: this.transactionDate,\n                type: 'Delayed Invoice',\n                entity: 1\n            }\n            billingHandler.lastNumber(data).then(response => {\n                if (response.data.statusCode === 200) {\n                    // window.console.log(this.invoice.transactionType,'data')\n                    const res = response.data.data\n                    const lastNumber = this.zeroPad(parseInt(res.lastNumber), this.invoice.transactionType.format)\n                    const number = res.suffix + this.invoice.transactionType.numberSeparator + lastNumber\n                    // this.transactionNumber = number\n                    this.invoice.number = number\n                }\n            }).catch(e => {\n                this.errors.push(e)\n            })\n\n        },\n        rowNumberTmpl(dataItem) {\n            let ds = this.$refs.itemLineDS.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        empImpl(dataItem) {\n            let empIds = []\n            dataItem.employee.forEach(m => {\n                empIds.push(m.firstName + ' - ' + m.lastName)\n            })\n            // window.console.log(empIds.join(', '))\n            return `<span>${empIds.join(', ')}</span>`\n        },\n        EmployeeDropDownEditor(container, options) {\n            kendo.jQuery('<input data-bind=\"value:' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoMultiSelect({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    suggest: true,\n                    filter: \"contains\",\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    headerTemplate: '<div class=\"dropdown-header k-widget k-header\">' +\n                        '<span>Employee </span>' +\n                        '<span></span>' +\n                        '</div>',\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        serverFiltering: true,\n                        transport: {\n                            read: {\n                                url: employeeHandler.searchURL(),\n                            },\n                            dataType: \"json\",\n                        },\n                        schema: {\n                            model: {\n                                id: \"id\",\n                                fields: {\n                                    id: {type: \"string\"},\n                                    name: {type: \"string\"},\n                                    firstName: {type: \"string\"},\n                                    lastName: {type: \"string\"}\n                                }\n                            },\n                            data: function (response) {\n                                return response.data\n                            },\n                            total: function (response) {\n                                return response.data.count\n                            }\n                        },\n                    }),\n                })\n        },\n        autoCalculateTaxByType(tax) {\n            // return by a key\n            const groupAll = list => list.reduce((tax, item) => {\n                const taxAmount = tax[item.name] || 0\n                return Object.assign({}, tax, {[item.name]: taxAmount + parseFloat(item.amount)})\n            }, {})\n            this.taxListTotal = groupAll(tax)\n        },\n        autoCalculate() {\n            let ds = this.$refs.itemLineDS.kendoWidget(),\n                subTotal = 0,\n                totalTax = 0, discountTotal = 0,\n                spTax = 0, pltax = 0, otherTax = 0, vatTax = 0, discountInvoice = 0, taxList = [], discountItem = [],\n                saleUnit = [], inclusiveTax = 0\n\n            ds.data().forEach(value => {\n                let modifierPrice = 0\n                if (value.modifier) {\n                    modifierPrice = kendo.parseFloat(value.modifier.price)\n                }\n\n                // subTotal += (kendo.parseFloat(value.amount) + modifierPrice)\n                let discount = 0\n                if (value.discountItem) {\n                    let subTo = kendo.parseFloat(value.price) * kendo.parseFloat(value.qty)\n                    discount = this.autoCalculateDiscount(value.discountItem, subTo)\n                    if (value.discountItem.hasOwnProperty('id')) {\n                        discountItem.push(value.discountItem)\n                    }\n                    discountTotal += (discount ? discount : 0)\n                    window.console.log(discountTotal, 'dis Total')\n                }\n                if (value.saleUnit) {\n                    if (value.saleUnit.hasOwnProperty('id')) {\n                        saleUnit.push(value.saleUnit)\n                    }\n                }\n                if (value.specificTax) {\n                    spTax = this.autoCalculateTax(value.specificTax, (kendo.parseFloat(value.amount) - kendo.parseFloat(discount)))\n                    // window.console.log('sp ', discount)\n                    spTax = kendo.parseFloat(spTax) ? kendo.parseFloat(spTax) : 0\n                    const tax = value.specificTax\n                    const baseAmount = tax.baseAmount\n                    if (baseAmount) {\n                        if (baseAmount.toLowerCase() === 'inclusive') {\n                            inclusiveTax += spTax\n                        }\n                    }\n                    if (value.specificTax.hasOwnProperty('taxType')) {\n                        taxList.push({\n                            name: value.specificTax.taxType.name,\n                            amount: spTax,\n                            id: value.specificTax.taxType.id\n                        })\n                    }\n                }\n                if (value.publicLightingTax) {\n                    pltax = this.autoCalculateTax(value.publicLightingTax, (kendo.parseFloat(value.amount) - kendo.parseFloat(discount)))\n                    pltax = kendo.parseFloat(pltax) ? kendo.parseFloat(pltax) : 0\n                    const tax = value.publicLightingTax\n                    const baseAmount = tax.baseAmount\n                    if (baseAmount) {\n                        if (baseAmount.toLowerCase() === 'inclusive') {\n                            inclusiveTax += pltax\n                        }\n                    }\n                    if (value.publicLightingTax.hasOwnProperty('taxType')) {\n                        taxList.push({\n                            name: value.publicLightingTax.taxType.name,\n                            amount: pltax,\n                            id: value.publicLightingTax.taxType.id\n                        })\n                    }\n                }\n                if (value.otherTax) {\n                    otherTax = this.autoCalculateTax(value.otherTax, (kendo.parseFloat(value.amount) - kendo.parseFloat(discount)))\n                    otherTax = kendo.parseFloat(otherTax) ? kendo.parseFloat(otherTax) : 0\n                    const tax = value.otherTax\n                    const baseAmount = tax.baseAmount\n                    if (baseAmount) {\n                        if (baseAmount.toLowerCase() === 'inclusive') {\n                            inclusiveTax += otherTax\n                        }\n                    }\n                    if (value.otherTax.hasOwnProperty('taxType')) {\n                        taxList.push({\n                            name: value.otherTax.taxType.name,\n                            amount: otherTax,\n                            id: value.otherTax.taxType.id\n                        })\n                    }\n\n                }\n\n                if (value.vatTax) {\n                    // window.console.log('Vat Tax', value.vatTax)\n                    let amt = kendo.parseFloat(spTax ? spTax : 0) + kendo.parseFloat(pltax ? pltax : 0) + kendo.parseFloat(otherTax ? otherTax : 0) + (kendo.parseFloat(value.amount ? value.amount : 0) - (discount ? discount : 0))\n                    vatTax = this.autoCalculateTax(value.vatTax, amt)\n                    vatTax = kendo.parseFloat(vatTax) ? kendo.parseFloat(vatTax) : 0\n                    const tax = value.vatTax\n                    const baseAmount = tax.baseAmount\n                    if (baseAmount) {\n                        if (baseAmount.toLowerCase() === 'inclusive') {\n                            inclusiveTax += vatTax\n                        }\n                    }\n                    if (value.vatTax.hasOwnProperty('taxType')) {\n                        taxList.push({\n                            name: value.vatTax.taxType.name,\n                            amount: vatTax,\n                            id: value.vatTax.taxType.id\n                        })\n                    }\n                }\n                totalTax += kendo.parseFloat(spTax ? spTax : 0) + kendo.parseFloat(pltax ? pltax : 0) + kendo.parseFloat(otherTax ? otherTax : 0) + kendo.parseFloat(vatTax ? vatTax : 0)\n                subTotal += (kendo.parseFloat(value.amount) + modifierPrice - inclusiveTax)\n            })\n\n            // discountTotal = discountTotal ? discountTotal : 0\n\n            // window.console.log(spTax, pltax, otherTax, vatTax)\n            let total = (kendo.parseFloat(subTotal) - kendo.parseFloat(discountTotal)) + kendo.parseFloat(totalTax)\n            this.invoice.subTotal = subTotal\n            // $(\"#subtotal\").text(kendo.parseFloat(subTotal))\n            this.invoice.totalTaxAmount = kendo.parseFloat(totalTax)\n            this.invoice.discountTotal = kendo.parseFloat(discountTotal)\n            if (this.invoice.specificDiscountItem) {\n                discountInvoice = this.autoCalculateDiscount(this.invoice.specificDiscountItem, kendo.parseFloat(subTotal))\n                discountInvoice = discountInvoice ? discountInvoice : 0\n            }\n            // this.onOtherChargeChange()\n            this.invoice.total = kendo.parseFloat(total) - discountInvoice + kendo.parseFloat(this.invoice.otherChargeAmount)\n            this.invoice.remainingAmount = kendo.parseFloat(this.invoice.total) - kendo.parseFloat(this.deposite)\n            this.invoice.amountDue = kendo.parseFloat(this.invoice.total - kendo.parseFloat(this.deposite))\n            this.invoice.exchangeAmount = (kendo.parseFloat(this.invoice.amountDue) * kendo.parseFloat(this.invoice.txnRate))\n            // this.invoice.exchangeAmount = (kendo.parseFloat(this.invoice.amountDue) *  kendo.parseFloat(this.invoice.txnRate))\n            // window.console.log('--', taxList)\n            this.autoCalculateTaxByType(taxList)\n            this.customerDiscountItem = this.removeDuplicate(discountItem)\n            this.customerSaleUnit = this.removeDuplicate(saleUnit)\n            // window.console.log('discount ', this.customerDiscountItem)\n        },\n        removeDuplicate(array) {\n            const result = [];\n            const map = new Map();\n            for (const item of array) {\n                if (!map.has(item.id)) {\n                    map.set(item.id, true);    // set any value to Map\n                    result.push(item)\n                }\n            }\n            return result\n        },\n        numberFormat(value) {\n            // window.console.log(this.saleFormContent.decimal,'nimol')\n            return kendo.toString(value, `n${this.saleFormContent.decimal}`)\n        },\n        autoCalculateDiscount(discountItem, subTotal) {\n            if (discountItem) {\n                const nature = discountItem.nature || ''\n                const amount = discountItem.amount || 0\n                if (nature === 'Amount') {\n                    return parseFloat(amount)\n                } else if (nature === 'Percentage') {\n                    return (subTotal * (parseFloat(amount) / 100))\n                }else{\n                    return 0\n                }\n            }else{\n                return 0\n            }\n        },\n        autoCalculateTax(tax, amount) {\n            if (tax) {\n                var formula = tax.formula\n                var inAmt = kendo.parseFloat(amount)\n                var nAmt = kendo.parseFloat(amount)\n                var taxBase = kendo.parseFloat(tax.taxBase) / 100\n                var rate = kendo.parseFloat(tax.rate) / 100\n                var total = eval(formula)\n                window.console.log(inAmt, nAmt, taxBase, rate, formula, total)\n                return total\n            }\n            // return 0\n        },\n        dataSourceChanged(e) {\n            if (e.field) {\n                let dataRow = e.items[0]\n\n                switch (e.field) {\n                    case \"item\":\n                        // this.attribute_ = this.attributes.filter(m => m.type.id === dataRow.variant.id)\n                        dataRow.set('description', dataRow.item.description)\n                        break\n                    case \"price\":\n                        try {\n                            dataRow.set('price', parseFloat(dataRow.price))\n                            dataRow.set('amount', parseFloat(dataRow.price) * parseFloat(dataRow.qty))\n                            // window.console.log('price',dataRow.price)\n                        } catch {\n                            dataRow.set('price', 0)\n                            dataRow.set('amount', 0)\n                        }\n                        break\n                    case \"uom\":\n                        try {\n                            dataRow.set('price', parseFloat(dataRow.uom.price))\n                            dataRow.set('amount', parseFloat(dataRow.uom.price) * parseFloat(dataRow.qty))\n                        } catch {\n                            dataRow.set('price', 0)\n                            dataRow.set('amount', 0)\n                        }\n                        break\n                    case \"qty\":\n                        try {\n                            dataRow.set('price', parseFloat(dataRow.price))\n                            dataRow.set('amount', parseFloat(dataRow.price) * parseFloat(dataRow.qty))\n                        } catch {\n                            dataRow.set('price', 0)\n                            dataRow.set('amount', 0)\n                        }\n                        break\n                    case \"otherTax\":\n                        // window.console.log(\"--\", dataRow)\n                        break\n                    default:\n                        break\n                }\n                if (e.field) {\n                    this.autoCalculate()\n                }\n            }\n        },\n        ServiceDateEditor(container, options) {\n            kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDatePicker()\n\n            // let ds = this.$refs.itemLineDS.kendoWidget()\n            // window.console.log(ds.data())\n            // // const dateString = kendo.toString((new Date(options.model.items.serviceDate)), this.itemLine.dateFormat)\n            // // const dateString = kendo.toString(options.model.items.serviceDate)\n            // const $input = $(\"<input value=\" + options.model.serviceDate + \" />\").appendTo(container)\n            // $input.kendoDatePicker()\n            // // $input.appendTo(container)\n            // // options.model.items.serviceDate = dateString\n            // window.console.log($input)\n        },\n        ServiceDateToEditor(container, options) {\n            kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDatePicker()\n        },\n        ItemDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"contains\",\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    headerTemplate: '<div class=\"dropdown-header k-widget k-header\">' +\n                        '<span>Items </span>' +\n                        '<span></span>' +\n                        '</div>',\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        serverFiltering: true,\n                        transport: {\n                            read: {\n                                url: productVariantHandler.itemSearchURL(),\n                            },\n                            dataType: \"json\",\n                        },\n                        schema: {\n                            model: {\n                                id: \"id\",\n                                fields: {\n                                    id: {type: \"string\"},\n                                    name: {type: \"string\"},\n                                    sku: {type: \"string\"},\n                                }\n                            },\n                            data: function (response) {\n                                return response.data;\n                            },\n                            total: function (response) {\n                                return response.data.count;\n                            }\n                        },\n                        // data: this.variants\n                    }),\n                    change: function (e) {\n                        // this.UOMDropDownEditor(container,options)\n                        window.console.log('changed event', e)\n                    }\n\n                })\n        },\n        UOMDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"uom.name\",\n                    dataValueField: \"uom.id\",\n                    cascadeFrom: \"item\",\n                    template: \"<span>#=uom.name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        serverFiltering: true,\n                        transport: {\n                            read: {\n                                // url: uomPriceHandler.getURL(options.model.item.id, this.invoice.priceLevel.id, options.model.item.type),\n                                url: uomPriceHandler.uomPriceByPriceLevelURL('id=' + options.model.item.id + '&plId=' + this.invoice.priceLevel.id + '&date=' + this.transactionDate),\n                            },\n                            dataType: \"json\",\n                        },\n                        schema: {\n                            model: {\n                                id: \"id\",\n                                fields: {\n                                    id: {type: \"string\"},\n                                    // name: {type: \"string\"},\n                                    // sku: {type: \"string\"},\n                                }\n                            },\n                            data: function (response) {\n                                return response.data\n                            },\n                            total: function (response) {\n                                return response.data.count\n                            }\n                        },\n                        // data: this.variants\n                    }),\n                })\n        },\n        DiscountItemDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    cascadeFrom: \"item\",\n                    template: \"<span>#=code# - #=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        serverFiltering: true,\n                        transport: {\n                            read: {\n                                url: discountItemHandler.getURL(DISCOUNT_TYPE),\n                            },\n                            dataType: \"json\",\n                        },\n                        schema: {\n                            model: {\n                                id: \"id\",\n                                fields: {\n                                    id: {type: \"string\"},\n                                    // name: {type: \"string\"},\n                                    // sku: {type: \"string\"},\n                                }\n                            },\n                            data: function (response) {\n\n                                return response.data;\n                            },\n                            total: function (response) {\n                                return response.data.count;\n                            }\n                        },\n                    }),\n                })\n        },\n        SpecificTaxDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=defaultTax#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.specificTax.filter(m => {\n                            if (options.model.hasOwnProperty('vatTax')) {\n                                const vat = options.model.vatTax\n                                if (vat) {\n                                    if (options.model.vatTax !== null || options.model.vatTax !== 'null') {\n                                        if (options.model.vatTax.baseAmount) {\n                                            return m.baseAmount.toLowerCase() === options.model.vatTax.baseAmount.toLowerCase()\n                                        } else {\n                                            return m\n                                        }\n                                    }\n                                } else {\n                                    return m\n                                }\n                            }\n                        })\n                    })\n                })\n        },\n        PublicLightingTaxDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=defaultTax#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.publicLightingTax.filter(m => {\n                            if (options.model.hasOwnProperty('vatTax')) {\n                                const vat = options.model.vatTax\n                                if (vat) {\n                                    if (options.model.vatTax !== null && options.model.vatTax !== 'null') {\n                                        if (options.model.vatTax.baseAmount) {\n                                            return m.baseAmount.toLowerCase() === options.model.vatTax.baseAmount.toLowerCase()\n                                        } else {\n                                            return m\n                                        }\n                                    }\n                                } else {\n                                    return m\n                                }\n                            }\n                        })\n                    })\n                })\n        },\n        OtherTaxDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=defaultTax#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.otherTax.filter(m => {\n                            if (options.model.hasOwnProperty('vatTax')) {\n                                const vat = options.model.vatTax\n                                if (vat) {\n                                    if (options.model.vatTax !== null && options.model.vatTax !== 'null') {\n                                        if (options.model.vatTax.baseAmount) {\n                                            return m.baseAmount.toLowerCase() === options.model.vatTax.baseAmount.toLowerCase()\n                                        } else {\n                                            return m\n                                        }\n                                    }\n                                } else {\n                                    return m\n                                }\n\n                            }\n                        })\n                    })\n                })\n        },\n        VatTaxDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=defaultTax#</span>\",\n                    optionLabel: \"--Select--\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.vatTax\n                    })\n                })\n        },\n        SaleUnitDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"startswith\",\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    template: \"<span>#=code# - #=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        data: this.saleUnitItemList\n                    })\n                })\n        },\n        ModifierDropDownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: true,\n                    autoWidth: true,\n                    height: 400,\n                    filter: \"contains\",\n                    dataTextField: \"name\",\n                    dataValueField: \"id\",\n                    headerTemplate: '<div class=\"dropdown-header k-widget k-header\">' +\n                        '<span>Modifier </span>' +\n                        '<span></span>' +\n                        '</div>',\n                    template: \"<span>#=name#</span>\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: new kendo.data.DataSource({\n                        serverFiltering: true,\n                        transport: {\n                            read: {\n                                url: itemModifierHandler.searchURL(options.model.item.id),\n                            },\n                            dataType: \"json\",\n                        },\n                        schema: {\n                            model: {\n                                id: \"id\",\n                                fields: {\n                                    id: {type: \"string\"},\n                                    name: {type: \"string\"},\n                                    price: {type: \"number\"},\n                                    uom: {type: \"string\"},\n                                }\n                            },\n                            data: function (response) {\n                                return response.data\n                            },\n                            total: function (response) {\n                                return response.data.count\n                            }\n                        },\n                    }),\n                })\n        },\n        vatTemplate(dataItem) {\n            const vat = dataItem.vatTax\n            if (vat) {\n                return `<span>${vat.defaultTax ? vat.defaultTax : ``}</span>`\n            } else {\n                return ``\n            }\n        },\n        itemTemplate(dataItem) {\n            const item = dataItem.item\n            if (item) {\n                return `<span>${item.name ? item.name : ``}</span>`\n            } else {\n                return ``\n            }\n        },\n        UOMTemplate(dataItem) {\n            const uom = dataItem.uom\n            if (uom) {\n                return `<span>${uom.uom ? uom.uom.name : ``}</span>`\n            } else {\n                return ``\n            }\n        },\n        saleUnitTemplate(dataItem) {\n            const saleUnit = dataItem.saleUnit\n            if (saleUnit) {\n                return `<span>${saleUnit.name ? saleUnit.name : ``}</span>`\n            } else {\n                return ``\n            }\n        },\n        discountItemTemplate(dataItem) {\n            const discountItem = dataItem.discountItem\n            if (discountItem) {\n                return `<span>${discountItem.code ? discountItem.code : ``} - ${discountItem.name ? discountItem.name : ``}</span>`\n            } else {\n                return ``\n            }\n        },\n        async loadTax() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    settingHandler.get().then(res => {\n                        this.tax = res\n                        this.otherTax = this.tax.filter(m => (m.taxType.typeId === 7 || m.taxType.typeId === 10) && m.transactionType === 'Sale') // valuable tax\n                        this.specificTax = this.tax.filter(m => (m.taxType.typeId === 8 || m.taxType.typeId === 10) && m.transactionType === 'Sale') // valuable tax\n                        this.publicLightingTax = this.tax.filter(m => (m.taxType.typeId === 9 || m.taxType.typeId === 10) && m.transactionType === 'Sale') // valuable tax\n                        this.vatTax = this.tax.filter(m => (m.taxType.typeId === 1 || m.taxType.typeId === 8 || m.taxType.typeId === 10) && m.transactionType === 'Sale') // valuable tax\n\n                    })\n                }, 300)\n            })\n        },\n        async uomByPriceLevel(id, priceLevelId, dataRow) {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    uomPriceHandler.uomByPriceLevel(id, priceLevelId).then(res => {\n                        if (res.data.statusCode === 200) {\n                            // return res.data.data\n                            dataRow.set('uom', res.data.data)\n                        }\n                    })\n                }, 300);\n            })\n        },\n        async loadDiscountItem() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    discountItemHandler.list(DISCOUNT_TYPE).then(res => {\n                        if (res.data.statusCode === 200) {\n                            this.specificDiscountItem = res.data.data\n                        }\n                    })\n                }, 300);\n            })\n        },\n        async loadViewInvoice() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved')\n                    this.showLoading = true\n                    billingHandler.view(this.$route.params.id).then(res => {\n                        if (res.data.statusCode === 200) {\n                            this.showLoading = false\n                            this.invoice = res.data.data[0]\n                            this.customer = this.invoice.customer\n                            this.taxListTotal = this.invoice.taxListTotal\n                            this.itemLines = this.invoice.itemLines\n                            this.mOtherCharge = this.invoice.otherCharge\n                            for (let i = 0; i <= this.mOtherCharge.length - 1; i++) {\n                                this.addSelect()\n                            }\n                        }\n                    }).catch()\n                    {\n                        this.showLoading = false\n                    }\n                }, 500)\n            })\n        },\n        clear() {\n            this.id = undefined\n            this.invoice = {}\n            this.itemLines = []\n            this.invoice.transactionType = this.invoiceTypes[0]\n            this.generateNumber()\n        }\n    },\n    watch: {\n        id() {\n            if (this.$route.params.id === undefined) {\n                this.clear()\n            } else {\n                this.showLoading = true\n                this.loadViewInvoice()\n            }\n        }\n    },\n    created() {\n        // fetch the data when the view is created and the data is\n        // already being observed\n        // this.loadObj()\n    },\n    mounted: async function () {\n        await this.loadLocation()\n        await this.loadSegment()\n        await this.loadPrefix()\n        await this.loadCurrency()\n        await this.loadSaleFormContent()\n        await this.loadSaleUnitItems()\n        await this.loadTax()\n        await this.loadOtherCharge()\n        await this.loadDiscountItem()\n        this.customerData(this.filter, this.cusBaseUrl)\n        await this.initData()\n\n    },\n};\n</script>\n\n<style scoped>\n.k-dropdown {\n    width: 100%;\n    margin-top: 3px;\n}\n\n.function_wrapper {\n    box-shadow: none !important;\n}\n\n.v-application--is-ltr .v-text-field .v-input__append-inner {\n    margin-top: 0 !important;\n}\n\n.v-input__slot {\n    background-color: #fff !important;\n}\n\n.function_content .label {\n    margin-bottom: 10px;\n    display: inline-block;\n}\n\n.border_radius10 {\n    border-radius: 10px !important;\n    background-color: #F2F2F2;\n}\n\n.pa-3.v-card h4 {\n    font-size: 18px;\n    color: #333;\n}\n\n.pa-3.v-card p {\n    font-size: 12px;\n    color: #B5B5B5;\n}\n\n.attachment_file {\n    background-color: #EFEDED;\n    border-radius: 0 !important;\n}\n\n.attachment_table.v-data-table table {\n    border: thin solid rgba(0, 0, 0, 0.12);\n}\n\n.attachment_table table tr th {\n    border-left: thin solid rgba(0, 0, 0, 0.12);\n    height: 35px;\n    border-right: thin solid rgba(0, 0, 0, 0.12);\n}\n\n.block_debit,\n.block_credit {\n    border-bottom: 1px solid #fff;\n}\n\n.block_debit p.number,\n.block_credit p.number {\n    font-size: 25px;\n    color: #7F7F7F;\n}\n\n.block_debit h5,\n.block_credit h5,\n.block_difference h5 {\n    text-transform: uppercase;\n    color: #7F7F7F;\n    font-size: 15px;\n    font-weight: normal;\n}\n\n.block_difference h5 {\n    font-size: 18px;\n}\n\n.block_difference h5 span {\n    font-size: 15px;\n}\n\n.custom_grid table th:last-child {\n    text-align: right !important;\n}\n\n.color_green {\n    color: #f44336;\n}\n\n@media (min-width: 1264px) {\n    .container {\n        max-width: 1250px;\n    }\n}\n\n@media (max-width: 576px) {\n    .pt-6.col-sm-5.col-12 {\n        padding-top: 0 !important;\n    }\n\n    .code_text {\n        width: 100%;\n    }\n\n    .phone_no_pt {\n        padding-top: 0 !important;\n    }\n\n    .select_template,\n    .save_option {\n        margin-bottom: 10px;\n    }\n}\n\n.hide_small_bar_class {\n    max-width: 0;\n    transition: .5s ease-in;\n    flex: 0 0 0;\n}\n\n.hide_big_bar_class {\n    max-width: 100%;\n    transition: .5s ease-in;\n    flex: 0 0 100%;\n}\n\n.info_add {\n    background-color: #ffffff;\n}\n\n.small_sidebar {\n    height: 98%;\n    position: relative;\n    padding: 12px;\n    background-color: #EDF1F5;\n}\n\n.iconArrow {\n    right: -35px;\n    position: absolute;\n    bottom: -10px;\n}\n\n.iconArrowHide {\n    position: absolute;\n    right: -7px;\n    bottom: -10px;\n}\n\n.color_grey {\n    color: #808080;\n}\n\n.card_green {\n    min-height: 70px;\n    background-color: #00b050 !important;\n    color: #ffffff;\n}\n\n.lb_bold {\n    font-size: 12px;\n}\n\n.detial_smallside_p {\n    position: absolute;\n    bottom: 10px;\n}\n\n.card_background {\n    background-color: #EDF1F5;\n    min-height: 120px;\n}\n\n.deposite_input {\n    width: 100px;\n}\n\n.btn_save_draft {\n    color: #ffffff;\n    background-color: #00b0f0 !important;\n    text-transform: capitalize;\n}\n\n.save_option {\n    background-color: #203864 !important;\n}\n\n.btn_add_small {\n    height: 27px !important;\n    min-width: 25px !important;\n    font-size: 10px;\n    padding: 0 22px !important;\n    background-color: #00b050 !important;\n    color: #ffffff;\n    border-radius: 0 !important;\n}\n\n.list_site_inv {\n    background-color: #92d050;\n    color: #ffffff;\n    font-size: 12px;\n}\n\n.list_site_exp {\n    background-color: #c5e0b4;\n    color: #000000;\n    font-size: 12px;\n    line-height: 16px;\n    min-height: 40px;\n}\n\n.checkbox_inv {\n    padding: 2px;\n    margin-top: 3px;\n    margin-right: 2px;\n}\n\n.exp_select {\n    font-size: 12px !important;\n}\n\n</style>"]}]}