{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/products/warehouses/warehouse_report/Balance.vue?vue&type=style&index=0&id=bbaba32a&scoped=true&lang=css&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/products/warehouses/warehouse_report/Balance.vue","mtime":1638499443298},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZnVuY3Rpb25fZm9vdGVyIHsKICAgIHBhZGRpbmc6IDE1cHg7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Cn0KCnAgewogICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44Nyk7Cn0KCi5hY3Rpb25CdG4gewogICAgaGVpZ2h0OiA0Ny4ycHggIWltcG9ydGFudDsKfQoKLnRleHRfdGlwIHsKICAgIGZvbnQtc2l6ZTogOXB4OwogICAgbGluZS1oZWlnaHQ6IDEwcHg7Cn0KCkBtZWRpYSAobWF4LXdpZHRoOiA1NzZweCkgewp9Cg=="},{"version":3,"sources":["Balance.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+OA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"Balance.vue","sourceRoot":"src/views/products/warehouses/warehouse_report","sourcesContent":["<template>\n    <v-row class=\"\">\n        <v-col sm=\"12\" cols=\"12\" class=\"grayBg px-6\">\n            <v-card color=\"white\" class=\"pa-3 no_border\" elevation=\"0\">\n                <v-row>\n                    <v-col sm=\"4\" cols=\"12\" class=\"pt-1\">\n                        <v-select @change=\"getBalanceWarehouse\" :items=\"warehouses\" item-value=\"id\" item-text=\"name\" v-model=\"warehouse\" return-object clearable outlined placeholder=\"Warehouse\" />\n                    </v-col>\n                    <v-col sm=\"3\" cols=\"12\" class=\"py-0\">\n                        <app-datepicker :initialDate=\"startDate\" @emitDate=\"startDate = $event\"/>\n                    </v-col>\n                    <v-col sm=\"1\" cols=\"1\" class=\"pt-1\">\n                        <v-btn\n                            class=\"btn_search\" @click=\"getBalanceWarehouse\"\n                            style=\"background-color: rgb(237, 241, 245)\"\n                        >\n                            <i class=\"b-search\" style=\"font-size: 18px; color:#fff !important;\"/>\n                        </v-btn>\n                    </v-col>\n                </v-row>\n    \n                <v-row>\n                    <v-col sm=\"12\" cols=\"12\" class=\"py-0\">\n                        <kendo-datasource ref=\"dataSource\" :data=\"balanceWarehouse\"/>\n                        <kendo-grid id=\"gridProductionOrder\"\n                                    class=\"grid-function\"\n                                    :data-source-ref=\"'dataSource'\"\n                                    :sortable=\"false\"\n                                    :noRecords=\"true\"\n                                    :filterable=\"false\"\n                                    :columns=\"columns\"\n                                    :column-menu=\"true\"\n                                    :editable=\"false\"\n                                    :scrollable-virtual=\"true\">\n<!--                            <kendo-grid-column :field=\"'name'\" :template=\"'<span>#=name#</span>'\" :title=\"$t('product')\" :width=\"100\" :column-menu=\"'false'\"-->\n<!--                                               :headerAttributes=\"{-->\n<!--                                        style: 'background-color: #EDF1F5;',-->\n<!--                                        class: 'text-variants'-->\n<!--                                    }\" :attributes=\"{-->\n<!--                                        style: 'text-align: variants'-->\n<!--                                    }\"/>-->\n<!--                            <kendo-grid-column :field=\"'buom'\" :title=\"$t('uom')\" :width=\"130\"-->\n<!--                                               :template=\"UOMTemplate\" :headerAttributes=\"{-->\n<!--                                        style: 'background-color: #EDF1F5'-->\n<!--                                    }\"/>-->\n<!--                            <kendo-grid-column :field=\"'bQty'\" :title=\"$t('qty')\" :width=\"100\" :headerAttributes=\"{-->\n<!--                                        style: 'background-color: #EDF1F5'-->\n<!--                                    }\"/>-->\n                        </kendo-grid>\n                    </v-col>\n                </v-row>\n                <LoadingMe\n                    :isLoading=\"showLoading\"\n                    :fullPage=\"false\"\n                    :myLoading=\"true\"\n                />\n            </v-card>\n        </v-col>\n    </v-row>\n</template>\n\n<script>\nimport DatePickerComponent from '@/components/custom_templates/DatePickerComponent'\nimport {i18n} from \"@/i18n\";\nconst warehouseHandler = require(\"@/scripts/warehouseHandler\")\nexport default {\n    data: () => ({\n        showLoading: false,\n        mDateSorter: 'Today',\n        startDate: new Date().toISOString().substr(0, 10),\n        dateSorters: ['Today', 'This Week', 'This Month', 'This Year'],\n\n        balanceWarehouse: [],\n        productionOrder: {},\n\n        warehouses: [],\n        warehouse: {},\n        columns: [],\n        calQty: 0,\n    }),\n    props: {},\n    methods: {\n        generateColumn() {\n            this.columns = [\n                {\n                    field: 'name',\n                    title: i18n.t('product'),\n                    locked: true,\n                    width:300\n                },\n                {\n                    field: 'buom',\n                    title: i18n.t('uom'),\n                    template :this.UOMTemplate,\n                    width:300\n                },\n                {\n                    field: 'bQty',\n                    title: i18n.t('qty'),\n                    format: \"{0:n}\",\n                    width:300\n                },\n            ]\n        },\n        UOMTemplate(dataItem) {\n            const buom = dataItem.buom\n            if (buom) {\n                return `<span>${buom ? buom.name : ``}</span>`\n            } else {\n                return ``\n            }\n        },\n        async getBalanceWarehouse() {\n            this.showLoading = true\n            const data = {\n                date: this.startDate ? this.startDate : new Date(),\n                whId: this.warehouse ? this.warehouse.id : ''\n            }\n            await warehouseHandler.getAllBalance(data).then(res => {\n                this.balanceWarehouse = res\n                window.console.log(res, 'data')\n                let columns = [\n                    {\n                        field: 'name',\n                        title: i18n.t('product'),\n                        locked: true,\n                        width:300\n                    },\n                    {\n                        field: 'buom',\n                        title: i18n.t('uom'),\n                        template :this.UOMTemplate,\n                        width:120\n                    },\n                    {\n                        field: 'bQty',\n                        title: i18n.t('qty'),\n                        format: \"{0:n}\",\n                        width:120\n                    },\n                ]\n                if (this.warehouse) {\n                    this.columns = columns\n                } else {\n                    const result = [];\n                    const whMap = new Map()\n                    const map = new Map()\n                    for (let i = 0; i < this.balanceWarehouse.length; i++) {\n                        if (!whMap.has(this.balanceWarehouse[i].whId)) {\n                            whMap.set(this.balanceWarehouse[i].whId, true)\n                            if(!map.has(this.balanceWarehouse[i].name)) {\n                                map.set(this.balanceWarehouse[i].name, true);    // set any value to Map\n                                result.push({\n                                    id: this.balanceWarehouse[i].id,\n                                    name: this.balanceWarehouse[i].name,\n                                    bQty: this.balanceWarehouse[i].bQty,\n                                    buom: this.balanceWarehouse[i].buom,\n                                    wName: this.balanceWarehouse[i].whName,\n                                    ['wh'+i]: this.balanceWarehouse[i].bQty\n                                });\n                                columns.push({\n                                    field: 'wh'+i,\n                                    title: this.balanceWarehouse[i].whName,\n                                    width: 300\n                                })\n                            } else {\n                                result.forEach((o, index) => {\n                                    if (o.name === this.balanceWarehouse[i].name) {\n                                        window.console.log(o, 'wh get1')\n                                        result[index]['bQty'] += this.balanceWarehouse[i].bQty\n                                        result[index]['wh'+i] = this.balanceWarehouse[i].bQty\n                                        columns.push({\n                                            field: 'wh'+i,\n                                            title: this.balanceWarehouse[i].whName,\n                                            width: 300\n                                        })\n                                    }\n                                })\n                            }\n                        } else {\n                            window.console.log(result, 'result before')\n                            if(!map.has(this.balanceWarehouse[i].name)) {\n                                map.set(this.balanceWarehouse[i].name, true);    // set any value to Map\n                                result.forEach((o) => {\n                                    if (o.wName === this.balanceWarehouse[i].whName) {\n                                        let dataKey = Object.keys(o)\n                                        dataKey = dataKey.filter(k => k.includes('wh'))\n                                        result.push({\n                                            id: this.balanceWarehouse[i].id,\n                                            name: this.balanceWarehouse[i].name,\n                                            bQty: this.balanceWarehouse[i].bQty,\n                                            buom: this.balanceWarehouse[i].buom,\n                                            wName: this.balanceWarehouse[i].whName,\n                                            [dataKey[0]]: this.balanceWarehouse[i].bQty\n                                        })\n                                        // columns.push({\n                                        //     field: 'wh'+i,\n                                        //     title: this.balanceWarehouse[i].whName,\n                                        //     width: 300\n                                        // })\n                                        window.console.log(dataKey, 'wh get2')\n                                    }\n                                })\n                            }\n                            window.console.log('987')\n                        }\n                    }\n                    this.balanceWarehouse = result\n                    window.console.log(this.columns, 'columns')\n                    // this.balanceWarehouse = [this.balanceWarehouse[0]]\n                    this.columns = columns\n                }\n                this.showLoading = false\n            })\n        },\n        async onloadWarehouse() {\n            await warehouseHandler.getWarehouseSettingAll().then(res => {\n                this.warehouses = res\n                if (res.length > 0) {\n                    this.warehouse = res[0]\n                    this.getBalanceWarehouse()\n                }\n                window.console.log(res, 'warehouse')\n            })\n        }\n    },\n    async mounted() {\n        await this.generateColumn()\n        await this.onloadWarehouse()\n    },\n    computed: {},\n    components: {\n        'app-datepicker': DatePickerComponent,\n        LoadingMe: () => import(\"@/components/Loading\")\n    },\n};\n</script>\n\n<style scoped>\n.function_footer {\n    padding: 15px;\n    display: inline-block;\n}\n\np {\n    color: rgba(0, 0, 0, 0.87);\n}\n\n.actionBtn {\n    height: 47.2px !important;\n}\n\n.text_tip {\n    font-size: 9px;\n    line-height: 10px;\n}\n\n@media (max-width: 576px) {\n}\n</style>\n"]}]}