{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/babel-loader/lib/index.js!/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/eslint-loader/index.js??ref--13-0!/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/compliance/monthly_tax/new_tax_return/input/add_sale/_add_sale.js?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/compliance/monthly_tax/new_tax_return/input/add_sale/_add_sale.js","mtime":1638499443167},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-commerce/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYWNvcy9EZXNrdG9wL2JhbmhqaS0wLjIvYmFuaGppLWNvbW1lcmNlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvVXNlcnMvbWFjb3MvRGVza3RvcC9iYW5oamktMC4yL2JhbmhqaS1jb21tZXJjZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwoKdmFyIF9kZWZhdWx0SXRlbTsKCmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CgovKgogKiBMYXN0IG1vZGlmaWVkIDogMy8yNy8yMSwgMTE6MTIgQU0gaW4gUHJvamVjdCBiYW5oamktYWNjb3VudGluZy13ZWItbW9kdWxlCiAqIENvcHlyaWdodCAoYykgMjAyMS4gQ2hhbmRhcml0aCBDaGVhIHVuZGVyIENvbXBhbnkgQmFuaEppIEZpbnRlY2ggQ28uLCBMdGQKICogRmFjZWJvb2sgUHJvZmlsZSA6IGh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9wcm9maWxlLnBocD9pZD0xMDAwMTExOTQ4MDY5NDcKICogR2l0aHViIFByb2ZpbGUgOiBodHRwczovL2dpdGh1Yi5jb20vRGFyaXRoLU1va3Bvc3QKICogSW5zdGFncmFtIFByb2ZpbGUgOiBodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL2NoYW5kYXJpdGhfY2hlYQogKi8KLy8gQHZ1ZS9jb21wb25lbnQKaW1wb3J0IFNhbGVSZWNvcmQgZnJvbSAiQC9zY3JpcHRzL2NvbXBsaWFuY2UvbW9kZWwvU2FsZVJlY29yZCI7CmltcG9ydCBrZW5kbyBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdWkiOwppbXBvcnQgeyBEcm9wRG93bkxpc3QgfSBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdnVlLWRyb3Bkb3ducyI7CmltcG9ydCBMb2FkaW5nTWUgZnJvbSAiQC9jb21wb25lbnRzL0xvYWRpbmciOwppbXBvcnQgeyB1dWlkIH0gZnJvbSAndnVlLXV1aWQnOwppbXBvcnQgSXRlbUxpbmVTYWxlIGZyb20gIkAvc2NyaXB0cy9jb21wbGlhbmNlL21vZGVsL2l0ZW1MaW5lU2FsZSI7Cgp2YXIgJCA9IHJlcXVpcmUoImpxdWVyeSIpOwoKdmFyIFNhbGVNb2RlbCA9IG5ldyBTYWxlUmVjb3JkKHt9KTsKdmFyIHRleHRGaWVsZCA9ICdudW1iZXJOYW1lJzsKdmFyIGtleUZpZWxkID0gJ2lkJzsKdmFyIGRlZmF1bHRJdGVtID0gKF9kZWZhdWx0SXRlbSA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX2RlZmF1bHRJdGVtLCB0ZXh0RmllbGQsICdTZWxlY3QgY3VzdG9tZXIuLi4nKSwgX2RlZmluZVByb3BlcnR5KF9kZWZhdWx0SXRlbSwga2V5RmllbGQsIG51bGwpLCBfZGVmYXVsdEl0ZW0pOwoKdmFyIGVtcHR5SXRlbSA9IF9kZWZpbmVQcm9wZXJ0eSh7fSwgdGV4dEZpZWxkLCAnbG9hZGluZyAuLi4nKTsKCnZhciBjdXN0b21lckhhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvY3VzdG9tZXJIYW5kbGVyIik7Cgp2YXIgdGF4U2V0dGluZyA9IHJlcXVpcmUoJ0Avc3RvcmUvdGF4U2V0dGluZycpOwoKdmFyIHRheFNldHRpbmdIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3RheFNldHRpbmdIYW5kbGVyIik7Cgp2YXIgYXBpVXJsID0gcmVxdWlyZSgnQC9hcGlVcmwnKTsKCnZhciBtb250aGx5UmV0dXJuSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9jb21wbGlhbmNlL2hhbmRsZXIvbW9udGhseVJldHVybkhhbmRsZXIiKTsKCnZhciBzYWxlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9jb21wbGlhbmNlL2hhbmRsZXIvc2FsZUhhbmRsZXIiKTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQWRkX3NhbGUnLAogIGNvbXBvbmVudHM6IHsKICAgICdkcm9wZG93bmxpc3QnOiBEcm9wRG93bkxpc3QsCiAgICAnTG9hZGluZ01lJzogTG9hZGluZ01lCiAgfSwKICBtaXhpbnM6IFtdLAogIHByb3BzOiB7fSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nVGF4OiBmYWxzZSwKICAgICAgc2hvd0xvYWRpbmc6IGZhbHNlLAogICAgICBzYWxlOiBTYWxlTW9kZWwsCiAgICAgIG1lbnVKRGF0ZUFkZFNhbGU6IGZhbHNlLAogICAgICB0eG5fZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCksCiAgICAgIGl0ZW1MaW5lczogW10sCiAgICAgIGZpbHRlcjogJycsCiAgICAgIHRleHRGaWVsZDogJ251bWJlck5hbWUnLAogICAgICBkYXRhSXRlbUtleTogJ2lkJywKICAgICAgZGVmYXVsdEl0ZW06IGRlZmF1bHRJdGVtLAogICAgICBjdXNCYXNlVXJsOiBjdXN0b21lckhhbmRsZXIuc2VhcmNoKCksCiAgICAgIGN1c3RvbWVyTGlzdDogW10sCiAgICAgIGFtdDogW10sCiAgICAgIHRvdGFsVmF0OiAwLAogICAgICBhbW91bnRTcDogMCwKICAgICAgYW1vdW50UGx0OiAwLAogICAgICBhbW91bnRBdDogMCwKICAgICAgYW1vdW50VmF0OiAwLAogICAgICBhbW91bnRJbmNsdXNpdmVWYXQ6IDAsCiAgICAgIGFtb3VudE5ldFZhdDogMCwKICAgICAgbW9udGhseVJldHVybjoge30KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdHlwZVByb2R1Y3RUYXg6IGZ1bmN0aW9uIHR5cGVQcm9kdWN0VGF4KCkgewogICAgICByZXR1cm4gdGF4U2V0dGluZy5kZWZhdWx0LnN0YXRlLmxpc3RUYXg7CiAgICB9LAogICAgaWQ6IGZ1bmN0aW9uIGlkKCkgewogICAgICBpZiAodGhpcy4kcm91dGUucXVlcnkuc19pZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLnF1ZXJ5LnNfaWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgJ2lkJzogJ2luaXREYXRhJwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHt9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuaW5pdERhdGEoKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9hZExpc3RUYXgoKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9hZERhdGEoMCwgJycsIF90aGlzLmN1c0Jhc2VVcmwpOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0sCiAgbWV0aG9kczogewogICAgaW5pdERhdGE6IGZ1bmN0aW9uIGluaXREYXRhKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBpdGVtTGluZXMsIF9sb29wLCBpOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMyLnNob3dMb2FkaW5nID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczIuJHJvdXRlLnBhcmFtcy5pZCAhPT0gdW5kZWZpbmVkICYmIF90aGlzMi4kcm91dGUucGFyYW1zLm1vbnRobHlSZXR1cm4gPT09IHVuZGVmaW5lZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLm9uTG9hZE9uZVJldHVybigpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coX3RoaXMyLiRyb3V0ZS5wYXJhbXMpOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIuJHJvdXRlLnBhcmFtcy5tb250aGx5UmV0dXJuICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLm1vbnRobHlSZXR1cm4gPSBfdGhpczIuJHJvdXRlLnBhcmFtcy5tb250aGx5UmV0dXJuOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLmNsZWFyKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMi4kcm91dGUucXVlcnkuc19pZCAhPT0gdW5kZWZpbmVkICYmIF90aGlzMi4kcm91dGUucGFyYW1zLnNhbGUgPT09IHVuZGVmaW5lZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIub25sb2FkT25lU2FsZSgpOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgaWYgKCEoX3RoaXMyLiRyb3V0ZS5wYXJhbXMuc2FsZSAhPT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIuc2FsZSA9IF90aGlzMi4kcm91dGUucGFyYW1zLnNhbGU7CiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coX3RoaXMyLnNhbGUsICdsaXN0IHRheCcpOwogICAgICAgICAgICAgICAgaXRlbUxpbmVzID0gW107CgogICAgICAgICAgICAgICAgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChpKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnRheE5hbWUgPSBfdGhpczIudHlwZVByb2R1Y3RUYXguZmlsdGVyKGZ1bmN0aW9uIChwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHAuZGVmYXVsdFRheCA9PT0gX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0udGF4TmFtZS5uYW1lOwogICAgICAgICAgICAgICAgICB9KVswXTsKCiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5zcGVjaWZpY1RheC5uYW1lID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5zcGVjaWZpY1RheCA9IHsKICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUYXg6ICcnCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5zcGVjaWZpY1RheCA9IF90aGlzMi50eXBlUHJvZHVjdFRheC5maWx0ZXIoZnVuY3Rpb24gKHApIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwLmRlZmF1bHRUYXggPT09IF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnNwZWNpZmljVGF4Lm5hbWU7CiAgICAgICAgICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5wdWJUYXgubmFtZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0ucHViVGF4ID0gewogICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFRheDogJycKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnB1YlRheCA9IF90aGlzMi50eXBlUHJvZHVjdFRheC5maWx0ZXIoZnVuY3Rpb24gKHApIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwLmRlZmF1bHRUYXggPT09IF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnB1YlRheC5uYW1lOwogICAgICAgICAgICAgICAgICAgIH0pWzBdOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0uYWNjb21UYXgubmFtZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0uYWNjb21UYXggPSB7CiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VGF4OiAnJwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0uYWNjb21UYXggPSBfdGhpczIudHlwZVByb2R1Y3RUYXguZmlsdGVyKGZ1bmN0aW9uIChwKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcC5kZWZhdWx0VGF4ID09PSBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5hY2NvbVRheC5uYW1lOwogICAgICAgICAgICAgICAgICAgIH0pWzBdOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBpdGVtTGluZXMucHVzaChuZXcgSXRlbUxpbmVTYWxlKF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldKSk7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnRWYXQgKz0gX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0udmF0IHx8IDA7CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBfdGhpczIuc2FsZS5pdGVtTGluZS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICBfbG9vcChpKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coaXRlbUxpbmVzLCAnaXRlbWxpbmVzJyk7CiAgICAgICAgICAgICAgICBfdGhpczIuc2FsZS5pdGVtTGluZSA9IGl0ZW1MaW5lczsKICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnRJbmNsdXNpdmVWYXQgPSBfdGhpczIuc2FsZS50b3RhbEFtb3VudEluY2x1c2l2ZSB8fCAwOwogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudE5ldFZhdCA9IF90aGlzMi5zYWxlLnRvdGFsQW1vdW50TmV0VmF0IHx8IDA7CiAgICAgICAgICAgICAgICBfdGhpczIuYW1vdW50U3AgPSBfdGhpczIuc2FsZS50b3RhbFNwZWNpZmljVGF4IHx8IDA7CiAgICAgICAgICAgICAgICBfdGhpczIuYW1vdW50UGx0ID0gX3RoaXMyLnNhbGUudG90YWxQdWJUYXggfHwgMDsKICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnRBdCA9IF90aGlzMi5zYWxlLnRvdGFsQWNjb21UYXggfHwgMDsKICAgICAgICAgICAgICAgIF90aGlzMi50b3RhbFZhdCA9IF90aGlzMi5zYWxlLnRvdGFsVkFUIHx8IDA7CiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coX3RoaXMyLnR5cGVQcm9kdWN0VGF4LCBfdGhpczIuc2FsZS5pdGVtTGluZSwgJ2xpc3QgdGF4IDEyMycpOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuY2xlYXJTYWxlKCk7CgogICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczIuc2FsZS50b3RhbEFtb3VudEluY2x1c2l2ZSAhPT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudFNwID0gX3RoaXMyLnNhbGUudG90YWxTcGVjaWZpY1RheDsKICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnRQbHQgPSBfdGhpczIuc2FsZS50b3RhbFB1YlRheDsKICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnRBdCA9IF90aGlzMi5zYWxlLnRvdGFsQWNjb21UYXg7CiAgICAgICAgICAgICAgICBfdGhpczIudG90YWxWYXQgPSBfdGhpczIuc2FsZS50b3RhbFZBVDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAzOToKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMi5zYWxlLml0ZW1MaW5lLmxlbmd0aCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0MjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0MjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuYWRkUm93KCk7CgogICAgICAgICAgICAgIGNhc2UgNDI6CiAgICAgICAgICAgICAgICBfdGhpczIuc2hvd0xvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgY2FzZSA0MzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNsZWFyU2FsZTogZnVuY3Rpb24gY2xlYXJTYWxlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczMuc2FsZSA9IG5ldyBTYWxlUmVjb3JkKHt9KTsKICAgICAgICAgICAgICAgIF90aGlzMy5pdGVtTGluZXMgPSBbXTsKICAgICAgICAgICAgICAgIF90aGlzMy50b3RhbFZhdCA9IDA7CiAgICAgICAgICAgICAgICBfdGhpczMuYW1vdW50SW5jbHVzaXZlVmF0ID0gMDsKICAgICAgICAgICAgICAgIF90aGlzMy5hbW91bnROZXRWYXQgPSAwOwogICAgICAgICAgICAgICAgX3RoaXMzLmFtb3VudFBsdCA9IDA7CiAgICAgICAgICAgICAgICBfdGhpczMuYW1vdW50U3AgPSAwOwogICAgICAgICAgICAgICAgX3RoaXMzLmFtb3VudEF0ID0gMDsKICAgICAgICAgICAgICAgIF90aGlzMy5hbW91bnRWYXQgPSAwOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBvbmxvYWRPbmVTYWxlOiBmdW5jdGlvbiBvbmxvYWRPbmVTYWxlKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IF90aGlzNC4kcm91dGUucGFyYW1zLmlkOwogICAgICAgICAgICAgICAgICAgIHNhbGVIYW5kbGVyLmdldE9uZShpZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczQuc2FsZSA9IHJlcy5kYXRhLmRhdGFbMF07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9uTG9hZE9uZVJldHVybjogZnVuY3Rpb24gb25Mb2FkT25lUmV0dXJuKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IF90aGlzNS4kcm91dGUucGFyYW1zLmlkOwogICAgICAgICAgICAgICAgICAgIG1vbnRobHlSZXR1cm5IYW5kbGVyLmdldE9uZShpZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczUubW9udGhseVJldHVybiA9IHJlcy5kYXRhLmRhdGEubGVuZ3RoID4gMCA/IHJlcy5kYXRhLmRhdGFbMF0gOiBbXTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbG9hZExpc3RUYXg6IGZ1bmN0aW9uIGxvYWRMaXN0VGF4KCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHRheFNldHRpbmdIYW5kbGVyLmdldChhcGlVcmwudGF4X3NldHRpbmcudGF4X2xpc3RfZ2V0LCAibGlzdFRheCIsICJzZXRMaXN0VGF4Iik7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKF90aGlzNi5zYWxlLml0ZW1MaW5lLCAnc2FsZScpOwogICAgICAgICAgICAgICAgICAgIF90aGlzNi5pdGVtTGluZSA9IF90aGlzNi5zYWxlLml0ZW1MaW5lOwogICAgICAgICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9uQ3VzdG9tZXJGaWx0ZXJDaGFuZ2VkOiBmdW5jdGlvbiBvbkN1c3RvbWVyRmlsdGVyQ2hhbmdlZChldmVudCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICAgIHZhciBmaWx0ZXI7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGZpbHRlciA9IGV2ZW50LmZpbHRlci52YWx1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczcubG9hZERhdGEoMCwgZmlsdGVyLCBfdGhpczcuY3VzQmFzZVVybCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF90aGlzNy5maWx0ZXIgPSBmaWx0ZXI7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGxvYWREYXRhOiBmdW5jdGlvbiBsb2FkRGF0YShza2lwLCBmaWx0ZXIsIGJhc2VVcmwpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICB2YXIgdXJsOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB1cmwgPSBiYXNlVXJsICsgIj9maWx0ZXI9Ii5jb25jYXQoZmlsdGVyKTsKICAgICAgICAgICAgICAgIF90aGlzOC5yZXF1ZXN0U3RhcnRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBmZXRjaCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgICAgICAgICAgICAgICB9KS50aGVuKF90aGlzOC5hZnRlckZldGNoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgYWZ0ZXJGZXRjaDogZnVuY3Rpb24gYWZ0ZXJGZXRjaChqc29uKSB7CiAgICAgIHRoaXMuY3VzdG9tZXJMaXN0ID0ganNvbi5kYXRhOwogICAgfSwKICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShldmVudCkgewogICAgICB2YXIgdmFsdWUgPSBldmVudC52YWx1ZTsKCiAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZVt0ZXh0RmllbGRdID09PSBlbXB0eUl0ZW1bdGV4dEZpZWxkXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5zYWxlLmN1c3RvbWVyID0gdmFsdWU7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyh2YWx1ZSwgJ2N1c3RvbWVyJyk7CiAgICB9LAogICAgb25DbG9zZTogZnVuY3Rpb24gb25DbG9zZSgpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOS5jbGVhclNhbGUoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgLy8gYXdhaXQgdGhpcy4kcm91dGVyLnJlcGxhY2UoJy9uZXdfdGF4X3JldHVybi8nICsgdGhpcy4kcm91dGUucGFyYW1zLmlkKQogICAgICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuZ28oLTEpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTkpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBudW1iZXJGb3JtYXQ6IGZ1bmN0aW9uIG51bWJlckZvcm1hdCh2YWx1ZSkgewogICAgICAvLyB3aW5kb3cuY29uc29sZS5sb2codGhpcy5zYWxlRm9ybUNvbnRlbnQuZGVjaW1hbCwnbmltb2wnKQogICAgICByZXR1cm4ga2VuZG8udG9TdHJpbmcodmFsdWUsICIiLmNvbmNhdCh0aGlzLnNhbGUuZGVjaW1hbEZvcm1hdCkpOwogICAgfSwKICAgIGRpc2FibGVFZGl0b3I6IGZ1bmN0aW9uIGRpc2FibGVFZGl0b3IoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBvbkRhdGFTb3VyY2VDaGFuZ2VzOiBmdW5jdGlvbiBvbkRhdGFTb3VyY2VDaGFuZ2VzKGUpIHsKICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICB2YXIgZGF0YVJvdyA9IGUuaXRlbXNbMF07CgogICAgICAgIHN3aXRjaCAoZS5maWVsZCkgewogICAgICAgICAgY2FzZSAidGF4TmFtZSI6CiAgICAgICAgICAgIGRhdGFSb3cuc2V0KCJiYXNlQW1vdW50IiwgZGF0YVJvdy50YXhOYW1lLmJhc2VBbW91bnQpOwoKICAgICAgICAgICAgaWYgKGRhdGFSb3cuYW1vdW50ID4gMCkgewogICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgInNwZWNpZmljVGF4IjoKICAgICAgICAgICAgaWYgKGRhdGFSb3cuYW1vdW50ID4gMCkgewogICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgInB1YlRheCI6CiAgICAgICAgICAgIGlmIChkYXRhUm93LmFtb3VudCA+IDApIHsKICAgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZVRheCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJhY2NvbVRheCI6CiAgICAgICAgICAgIGlmIChkYXRhUm93LmFtb3VudCA+IDApIHsKICAgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZVRheCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJhbW91bnQiOgogICAgICAgICAgICBpZiAoZGF0YVJvdy50YXhOYW1lLmhhc093blByb3BlcnR5KCdkZWZhdWx0VGF4JykpIHsKICAgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZVRheCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjYWxjdWxhdGVUYXg6IGZ1bmN0aW9uIGNhbGN1bGF0ZVRheCgpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdmFyIGRzID0gdGhpcy4kcmVmcy5kYXRhU291cmNlLmtlbmRvV2lkZ2V0KCk7CiAgICAgIHZhciBkYXRhUm93ID0gZHMuZGF0YSgpLAogICAgICAgICAgc3BUYXggPSAwLAogICAgICAgICAgcGx0VGF4ID0gMCwKICAgICAgICAgIGF0VGF4ID0gMCwKICAgICAgICAgIHZhdFRheCA9IDAsCiAgICAgICAgICB0b3RhbFRheCA9IDAsCiAgICAgICAgICB0b3RhbFNwID0gMCwKICAgICAgICAgIHRvdGFsUGx0ID0gMCwKICAgICAgICAgIHRvdGFsQXQgPSAwLAogICAgICAgICAgdG90YWxJbmNsdXNpdmUgPSAwLAogICAgICAgICAgdG90YWxOZXQgPSAwLAogICAgICAgICAgYW1vdW50SW5jID0gMCwKICAgICAgICAgIGFtb3VudE5ldCA9IDA7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhkYXRhUm93LCAnZGF0YVJvdzEyMycpOwogICAgICBkYXRhUm93LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coaXRlbSk7CgogICAgICAgIGlmIChpdGVtLnNwZWNpZmljVGF4KSB7CiAgICAgICAgICBzcFRheCA9IF90aGlzMTAuYXV0b0NhbGN1bGF0ZVRheChpdGVtLnNwZWNpZmljVGF4LCBpdGVtLmFtb3VudCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXRlbS5wdWJUYXgpIHsKICAgICAgICAgIHBsdFRheCA9IF90aGlzMTAuYXV0b0NhbGN1bGF0ZVRheChpdGVtLnB1YlRheCwgaXRlbS5hbW91bnQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGl0ZW0uYWNjb21UYXgpIHsKICAgICAgICAgIGF0VGF4ID0gX3RoaXMxMC5hdXRvQ2FsY3VsYXRlVGF4KGl0ZW0uYWNjb21UYXgsIGl0ZW0uYW1vdW50KTsKICAgICAgICB9CgogICAgICAgIGlmIChpdGVtLnRheE5hbWUpIHsKICAgICAgICAgIHZhciBhbXQgPSBrZW5kby5wYXJzZUZsb2F0KHNwVGF4KSArIGtlbmRvLnBhcnNlRmxvYXQocGx0VGF4KSArIGtlbmRvLnBhcnNlRmxvYXQoYXRUYXgpICsgaXRlbS5hbW91bnQ7CiAgICAgICAgICB2YXRUYXggPSBfdGhpczEwLmF1dG9DYWxjdWxhdGVUYXgoaXRlbS50YXhOYW1lLCBhbXQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGl0ZW0uYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpID09PSAiaW5jbHVzaXZlIikgewogICAgICAgICAgYW1vdW50SW5jID0gaXRlbS5hbW91bnQgLyAoMSArIGl0ZW0udGF4TmFtZS5yYXRlIC8gMTAwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYW1vdW50TmV0ID0gaXRlbS5hbW91bnQ7CiAgICAgICAgfQoKICAgICAgICBfdGhpczEwLml0ZW1MaW5lcy5tYXAoZnVuY3Rpb24gKGksIGluZGV4KSB7CiAgICAgICAgICBpZiAoaS51aWQgPT09IGl0ZW0udWlkKSB7CiAgICAgICAgICAgIF90aGlzMTAuaXRlbUxpbmVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzMTAuaXRlbUxpbmVzLnB1c2goewogICAgICAgICAgdWlkOiBpdGVtLnVpZCwKICAgICAgICAgIGFtb3VudDogaXRlbS5hbW91bnQsCiAgICAgICAgICBhbW91bnRJbmNsdXNpdmU6IGFtb3VudEluYywKICAgICAgICAgIGFtb3VudE5ldFZhdDogYW1vdW50TmV0LAogICAgICAgICAgYW1vdW50U3BlY2lmaWNUYXg6IHNwVGF4IHx8IDAsCiAgICAgICAgICBpdGVtOiBpdGVtLml0ZW0sCiAgICAgICAgICBzcGVjaWZpY1RheDogewogICAgICAgICAgICBuYW1lOiBpdGVtLnNwZWNpZmljVGF4ID8gaXRlbS5zcGVjaWZpY1RheC5kZWZhdWx0VGF4IDogJycsCiAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS5zcGVjaWZpY1RheCA/IGl0ZW0uc3BlY2lmaWNUYXguYWNjb3VudCA/IGl0ZW0uc3BlY2lmaWNUYXguYWNjb3VudC5pZCA6ICcnIDogJycKICAgICAgICAgIH0sCiAgICAgICAgICBwdWJUYXg6IHsKICAgICAgICAgICAgbmFtZTogaXRlbS5wdWJUYXggPyBpdGVtLnB1YlRheC5kZWZhdWx0VGF4IDogJycsCiAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS5wdWJUYXggPyBpdGVtLnB1YlRheC5hY2NvdW50ID8gaXRlbS5wdWJUYXguYWNjb3VudC5pZCA6ICcnIDogJycKICAgICAgICAgIH0sCiAgICAgICAgICBhY2NvbVRheDogewogICAgICAgICAgICBuYW1lOiBpdGVtLmFjY29tVGF4ID8gaXRlbS5hY2NvbVRheC5kZWZhdWx0VGF4IDogJycsCiAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS5hY2NvbVRheCA/IGl0ZW0uYWNjb21UYXguYWNjb3VudCA/IGl0ZW0uYWNjb21UYXguYWNjb3VudC5pZCA6ICcnIDogJycKICAgICAgICAgIH0sCiAgICAgICAgICB2YXQ6IHZhdFRheCwKICAgICAgICAgIGFtb3VudFB1YlRheDogcGx0VGF4IHx8IDAsCiAgICAgICAgICBhbW91bnRBY2NvbVRheDogYXRUYXggfHwgMCwKICAgICAgICAgIGRlc2NyaXB0aW9uOiBpdGVtLmRlc2NyaXB0aW9uLAogICAgICAgICAgdGF4TmFtZTogewogICAgICAgICAgICBuYW1lOiBpdGVtLnRheE5hbWUuZGVmYXVsdFRheCwKICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLnRheE5hbWUuYWNjb3VudC5pZAogICAgICAgICAgfSwKICAgICAgICAgIGJhc2VBbW91bnQ6IGl0ZW0uYmFzZUFtb3VudAogICAgICAgIH0pOwoKICAgICAgICB0b3RhbFRheCArPSBrZW5kby5wYXJzZUZsb2F0KHNwVGF4KSArIGtlbmRvLnBhcnNlRmxvYXQocGx0VGF4KSArIGtlbmRvLnBhcnNlRmxvYXQoYXRUYXgpICsga2VuZG8ucGFyc2VGbG9hdCh2YXRUYXgpOwogICAgICAgIHRvdGFsSW5jbHVzaXZlICs9IGtlbmRvLnBhcnNlRmxvYXQoYW1vdW50SW5jKTsKICAgICAgICB0b3RhbE5ldCArPSBrZW5kby5wYXJzZUZsb2F0KGFtb3VudE5ldCk7CiAgICAgICAgdG90YWxTcCArPSBrZW5kby5wYXJzZUZsb2F0KHNwVGF4KTsKICAgICAgICB0b3RhbFBsdCArPSBrZW5kby5wYXJzZUZsb2F0KHBsdFRheCk7CiAgICAgICAgdG90YWxBdCArPSBrZW5kby5wYXJzZUZsb2F0KGF0VGF4KTsKICAgICAgfSk7CiAgICAgIHRoaXMudG90YWxWYXQgPSB0b3RhbFRheDsKICAgICAgdGhpcy5hbW91bnRTcCA9IHRvdGFsU3A7CiAgICAgIHRoaXMuYW1vdW50UGx0ID0gdG90YWxQbHQ7CiAgICAgIHRoaXMuYW1vdW50QXQgPSB0b3RhbEF0OwogICAgICB0aGlzLmFtb3VudEluY2x1c2l2ZVZhdCA9IHRvdGFsSW5jbHVzaXZlOwogICAgICB0aGlzLmFtb3VudE5ldFZhdCA9IHRvdGFsTmV0OwogICAgICB3aW5kb3cuY29uc29sZS5sb2codG90YWxUYXgpOwogICAgICB3aW5kb3cuY29uc29sZS5sb2coJ3Jlc3VsdCcsIHRoaXMuYW10KTsKICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlVGF4OiBmdW5jdGlvbiBhdXRvQ2FsY3VsYXRlVGF4KHRheCwgYW1vdW50KSB7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyh0YXgsICd0YXgnKTsKCiAgICAgIGlmICh0YXgpIHsKICAgICAgICB2YXIgZm9ybXVsYSA9IHRheC5mb3JtdWxhLAogICAgICAgICAgICBpbkFtdCA9IGtlbmRvLnBhcnNlRmxvYXQoYW1vdW50KSwKICAgICAgICAgICAgbkFtdCA9IGtlbmRvLnBhcnNlRmxvYXQoYW1vdW50KSwKICAgICAgICAgICAgdGF4QmFzZSA9IGtlbmRvLnBhcnNlRmxvYXQodGF4LnRheEJhc2UpIC8gMTAwLAogICAgICAgICAgICByYXRlID0ga2VuZG8ucGFyc2VGbG9hdCh0YXgucmF0ZSkgLyAxMDAsCiAgICAgICAgICAgIHRvdGFsID0gZXZhbChmb3JtdWxhKTsKICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coaW5BbXQsIG5BbXQsIHRheEJhc2UsIHJhdGUsIGZvcm11bGEsIHRvdGFsKTsKICAgICAgICByZXR1cm4gdG90YWw7CiAgICAgIH0KICAgIH0sCiAgICAvLyBBdXRvIEluY3JlYXNlIG51bWJlcgogICAgcm93TnVtYmVyVG1wbDogZnVuY3Rpb24gcm93TnVtYmVyVG1wbChkYXRhSXRlbSkgewogICAgICB2YXIgZHMgPSB0aGlzLiRyZWZzLmRhdGFTb3VyY2Uua2VuZG9XaWRnZXQoKSwKICAgICAgICAgIGluZGV4ID0gZHMuaW5kZXhPZihkYXRhSXRlbSk7CiAgICAgIHJldHVybiBpbmRleCArIDE7CiAgICB9LAogICAgLy8gUmVtb3ZlIFJvdwogICAgcmVtb3ZlUm93OiBmdW5jdGlvbiByZW1vdmVSb3coZSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHZhciBncmlkID0ga2VuZG8ualF1ZXJ5KCIjZ3JpZCIpLmRhdGEoImtlbmRvR3JpZCIpLAogICAgICAgICAgZGF0YVNvdXJjZSA9IGdyaWQuZGF0YVNvdXJjZSwKICAgICAgICAgIGRhdGFJdGVtID0gZ3JpZC5kYXRhSXRlbSgkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdCgidHIiKSk7CgogICAgICBpZiAoZGF0YVNvdXJjZS50b3RhbCgpID4gMSkgewogICAgICAgIGlmIChkYXRhSXRlbS5hbW91bnQgIT09IDAgfHwgZGF0YUl0ZW0udGF4TmFtZS5yYXRlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmIChkYXRhSXRlbS5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09ICduZXQnKSB7CiAgICAgICAgICAgIHRoaXMuYW1vdW50TmV0VmF0ID0gdGhpcy5hbW91bnROZXRWYXQgLSBkYXRhSXRlbS5hbW91bnQ7CiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4RGVsZXRlKGRhdGFJdGVtKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBhbW91bnQgPSBkYXRhSXRlbS5hbW91bnQgLyAoMSArIGRhdGFJdGVtLnRheE5hbWUucmF0ZSAvIDEwMCk7CiAgICAgICAgICAgIHRoaXMuYW1vdW50SW5jbHVzaXZlVmF0ID0gdGhpcy5hbW91bnRJbmNsdXNpdmVWYXQgLSBhbW91bnQ7CiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4RGVsZXRlKGRhdGFJdGVtKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGRhdGFTb3VyY2UucmVtb3ZlKGRhdGFJdGVtKTsKICAgICAgfQogICAgfSwKICAgIGNhbGN1bGF0ZVRheERlbGV0ZTogZnVuY3Rpb24gY2FsY3VsYXRlVGF4RGVsZXRlKGRhdGFSb3cpIHsKICAgICAgdmFyIHZhdFRheCA9IDA7CgogICAgICBpZiAoZGF0YVJvdy50YXhOYW1lKSB7CiAgICAgICAgdmFyIGFtdCA9IGRhdGFSb3cuYW1vdW50OwogICAgICAgIHZhdFRheCA9IHRoaXMuYXV0b0NhbGN1bGF0ZVRheChkYXRhUm93LnRheE5hbWUsIGFtdCk7CiAgICAgIH0KCiAgICAgIHRoaXMudG90YWxWYXQgPSB0aGlzLnRvdGFsVmF0IC0gdmF0VGF4OwogICAgfSwKICAgIHNwZWNpZmljVGF4RHJvcGRvd25FZGl0b3I6IGZ1bmN0aW9uIHNwZWNpZmljVGF4RHJvcGRvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpLmFwcGVuZFRvKGNvbnRhaW5lcikua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgIGF1dG9CaW5kOiBmYWxzZSwKICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgaGVpZ2h0OiAzMDAsCiAgICAgICAgZGF0YVRleHRGaWVsZDogImRlZmF1bHRUYXgiLAogICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgIGRhdGFTb3VyY2U6IHsKICAgICAgICAgIGRhdGE6IHRoaXMudHlwZVByb2R1Y3RUYXguZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRyYW5zYWN0aW9uVHlwZS50b0xvd2VyQ2FzZSgpID09PSAic2FsZSIgJiYgaXRlbS50YXhUeXBlLnR5cGVJZCA9PT0gOCAmJiBpdGVtLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0gb3B0aW9ucy5tb2RlbC5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhvcHRpb25zLm1vZGVsLmJhc2VBbW91bnQpOwogICAgfSwKICAgIHB1YmxpY1RheERyb3Bkb3duRWRpdG9yOiBmdW5jdGlvbiBwdWJsaWNUYXhEcm9wZG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykuYXBwZW5kVG8oY29udGFpbmVyKS5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgYXV0b0JpbmQ6IGZhbHNlLAogICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICBoZWlnaHQ6IDMwMCwKICAgICAgICBkYXRhVGV4dEZpZWxkOiAiZGVmYXVsdFRheCIsCiAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgZGF0YVNvdXJjZTogewogICAgICAgICAgZGF0YTogdGhpcy50eXBlUHJvZHVjdFRheC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGl0ZW0udHJhbnNhY3Rpb25UeXBlLnRvTG93ZXJDYXNlKCkgPT09ICJzYWxlIiAmJiBpdGVtLnRheFR5cGUudHlwZUlkID09PSA5ICYmIGl0ZW0uYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpID09PSBvcHRpb25zLm1vZGVsLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKTsKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBhY2NvbVRheERyb3Bkb3duRWRpdG9yOiBmdW5jdGlvbiBhY2NvbVRheERyb3Bkb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKS5hcHBlbmRUbyhjb250YWluZXIpLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICBhdXRvQmluZDogZmFsc2UsCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgIGhlaWdodDogMzAwLAogICAgICAgIGRhdGFUZXh0RmllbGQ6ICJkZWZhdWx0VGF4IiwKICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICBkYXRhU291cmNlOiB7CiAgICAgICAgICBkYXRhOiB0aGlzLnR5cGVQcm9kdWN0VGF4LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS50cmFuc2FjdGlvblR5cGUudG9Mb3dlckNhc2UoKSA9PT0gInNhbGUiICYmIGl0ZW0udGF4VHlwZS50eXBlSWQgPT09IDcgJiYgaXRlbS5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09IG9wdGlvbnMubW9kZWwuYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHR5cGVQcm9kdWN0VGF4RHJvcGRvd25FZGl0b3I6IGZ1bmN0aW9uIHR5cGVQcm9kdWN0VGF4RHJvcGRvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIC8vIGNvbnN0IHRwbCA9IHRoaXMudHlwZVByb2R1Y3RMaXN0CiAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IHJlcXVpcmVkIG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpLmFwcGVuZFRvKGNvbnRhaW5lcikua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgIGF1dG9CaW5kOiBmYWxzZSwKICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgaGVpZ2h0OiAzMDAsCiAgICAgICAgZGF0YVRleHRGaWVsZDogImRlZmF1bHRUYXgiLAogICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgIGRhdGFTb3VyY2U6IHsKICAgICAgICAgIGRhdGE6IHRoaXMudHlwZVByb2R1Y3RUYXguZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRyYW5zYWN0aW9uVHlwZS50b0xvd2VyQ2FzZSgpID09PSAic2FsZSIgJiYgaXRlbS50YXhUeXBlLnR5cGVJZCA9PT0gMTsKICAgICAgICAgIH0pLAogICAgICAgICAgZ3JvdXA6IHsKICAgICAgICAgICAgZmllbGQ6ICJiYXNlQW1vdW50IgogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZWRpdGFibGVTUDogZnVuY3Rpb24gZWRpdGFibGVTUChkYXRhSXRlbSkgewogICAgICByZXR1cm4gZGF0YUl0ZW0uYmFzZUFtb3VudCA9PT0gIk5ldCIgfHwgZGF0YUl0ZW0uYmFzZUFtb3VudCA9PT0gImluY2x1c2l2ZSI7CiAgICB9LAogICAgZWRpdGFibGVBVDogZnVuY3Rpb24gZWRpdGFibGVBVChkYXRhSXRlbSkgewogICAgICByZXR1cm4gZGF0YUl0ZW0uYmFzZUFtb3VudCA9PT0gIk5ldCIgfHwgZGF0YUl0ZW0uYmFzZUFtb3VudCA9PT0gImluY2x1c2l2ZSI7CiAgICB9LAogICAgZWRpdGFibGVQTDogZnVuY3Rpb24gZWRpdGFibGVQTChkYXRhSXRlbSkgewogICAgICByZXR1cm4gZGF0YUl0ZW0uYmFzZUFtb3VudCA9PT0gIk5ldCIgfHwgZGF0YUl0ZW0uYmFzZUFtb3VudCA9PT0gImluY2x1c2l2ZSI7CiAgICB9LAogICAgYWRkUm93OiBmdW5jdGlvbiBhZGRSb3coKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHsKICAgICAgICB2YXIgZHMsIHRvdGFsOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZHMgPSBfdGhpczExLiRyZWZzLmRhdGFTb3VyY2Uua2VuZG9XaWRnZXQoKSwgdG90YWwgPSBkcy50b3RhbCgpOwogICAgICAgICAgICAgICAgZHMuaW5zZXJ0KHRvdGFsLCB7CiAgICAgICAgICAgICAgICAgIHRheE5hbWU6IHsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VGF4OiAiIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBzcGVjaWZpY1RheDogewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUYXg6ICIiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHB1YlRheDogewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUYXg6ICIiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIGFjY29tVGF4OiB7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFRheDogIiIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgYmFzZUFtb3VudDogIiIsCiAgICAgICAgICAgICAgICAgIGFtb3VudDogMCwKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICIiCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBvbkNsb3NlU2FsZTogZnVuY3Rpb24gb25DbG9zZVNhbGUoKSB7fSwKICAgIG9uU2F2ZUNsb3NlOiBmdW5jdGlvbiBvblNhdmVDbG9zZSgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICAgIHZhciBkYXRhLCByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczEyLnNob3dMb2FkaW5nID0gdHJ1ZTsgLy8gYXdhaXQgdGhpcy5nZXREYXRhU291cmNlKCkKICAgICAgICAgICAgICAgIC8vIGxldCBpdGVtTGluZSA9IFtdCgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTIuc2FsZS5jdXN0b21lci50YXhQYXllclR5cGUgPT09ICcnKSB7CiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczEyLnNhbGUuY3VzdG9tZXIudHlwZS50b0xvd2VyQ2FzZSgpID09PSAnaW5kaXZpZHVhbC1mb3JlaWduJykgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTIuc2FsZS5jdXN0b21lci50YXhQYXllclR5cGUgPSAnUGh5c2ljYWwgUGVyc29uJzsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIubmF0dXJlVGF4VHlwZSA9ICdOb24tUmVzaWRlbnQnOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIuc2FsZS5jdXN0b21lci50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICdmb3JlaWduIGVudGl0eScpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIudGF4UGF5ZXJUeXBlID0gJ0xlZ2FsIFBlcnNvbic7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLm5hdHVyZVRheFR5cGUgPSAnTm9uLVJlc2lkZW50JzsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczEyLnNhbGUuY3VzdG9tZXIudHlwZS50b0xvd2VyQ2FzZSgpID09PSAnaW5kaXZpZHVhbC1sb2NhbCcpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIudGF4UGF5ZXJUeXBlID0gJ1BoeXNpY2FsIFBlcnNvbic7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLm5hdHVyZVRheFR5cGUgPSAnUmVzaWRlbnQnOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIuc2FsZS5jdXN0b21lci50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICdub24tdGF4YWJsZSBlbnRpdHknKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLnRheFBheWVyVHlwZSA9ICdMZWdhbCBQZXJzb24nOwogICAgICAgICAgICAgICAgICAgIF90aGlzMTIuc2FsZS5jdXN0b21lci5uYXR1cmVUYXhUeXBlID0gJ1Jlc2lkZW50JzsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczEyLnNhbGUuY3VzdG9tZXIudHlwZS50b0xvd2VyQ2FzZSgpID09PSAndGF4YWJsZSBlbnRpdHknKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLnRheFBheWVyVHlwZSA9ICdMZWdhbCBQZXJzb24nOwogICAgICAgICAgICAgICAgICAgIF90aGlzMTIuc2FsZS5jdXN0b21lci5uYXR1cmVUYXhUeXBlID0gJ1Jlc2lkZW50JzsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLmN1c3RvbWVySWQgPSBfdGhpczEyLnNhbGUuY3VzdG9tZXIuY3JuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczEyLml0ZW1MaW5lcywgX3RoaXMxMi5zYWxlLml0ZW1MaW5lLCAnaXRlbWxpbmUnKTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMi5pdGVtTGluZXMubGVuZ3RoIDwgMCB8fCBfdGhpczEyLnNhbGUuaXRlbUxpbmUubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coX3RoaXMxMi5zYWxlLml0ZW1MaW5lLCAnaXRlbWxpbmUgMTIzNDEyNDEyJyk7CiAgICAgICAgICAgICAgICAgIF90aGlzMTIuc2FsZS5pdGVtTGluZSA9IF90aGlzMTIuc2FsZS5pdGVtTGluZS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgdWlkOiBpdGVtLnVpZCwKICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogaXRlbS5hbW91bnQsCiAgICAgICAgICAgICAgICAgICAgICBhbW91bnRJbmNsdXNpdmU6IGl0ZW0uYW1vdW50SW5jbHVzaXZlLAogICAgICAgICAgICAgICAgICAgICAgYW1vdW50TmV0VmF0OiBpdGVtLmFtb3VudE5ldFZhdCwKICAgICAgICAgICAgICAgICAgICAgIGFtb3VudFNwZWNpZmljVGF4OiBpdGVtLmFtb3VudFNwZWNpZmljVGF4IHx8IDAsCiAgICAgICAgICAgICAgICAgICAgICBpdGVtOiBpdGVtLml0ZW0sCiAgICAgICAgICAgICAgICAgICAgICBzcGVjaWZpY1RheDogewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLnNwZWNpZmljVGF4ID8gaXRlbS5zcGVjaWZpY1RheC5kZWZhdWx0VGF4IDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS5zcGVjaWZpY1RheCA/IGl0ZW0uc3BlY2lmaWNUYXguYWNjb3VudCA/IGl0ZW0uc3BlY2lmaWNUYXguYWNjb3VudC5pZCA6ICcnIDogJycKICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICBwdWJUYXg6IHsKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbS5wdWJUYXggPyBpdGVtLnB1YlRheC5kZWZhdWx0VGF4IDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS5wdWJUYXggPyBpdGVtLnB1YlRheC5hY2NvdW50ID8gaXRlbS5wdWJUYXguYWNjb3VudC5pZCA6ICcnIDogJycKICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICBhY2NvbVRheDogewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLmFjY29tVGF4ID8gaXRlbS5hY2NvbVRheC5kZWZhdWx0VGF4IDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS5hY2NvbVRheCA/IGl0ZW0uYWNjb21UYXguYWNjb3VudCA/IGl0ZW0uYWNjb21UYXguYWNjb3VudC5pZCA6ICcnIDogJycKICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICB2YXQ6IGl0ZW0udmF0LAogICAgICAgICAgICAgICAgICAgICAgYW1vdW50UHViVGF4OiBpdGVtLmFtb3VudFB1YlRheCB8fCAwLAogICAgICAgICAgICAgICAgICAgICAgYW1vdW50QWNjb21UYXg6IGl0ZW0uYW1vdW50QWNjb21UYXggfHwgMCwKICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBpdGVtLmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICAgICAgdGF4TmFtZTogewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLnRheE5hbWUuZGVmYXVsdFRheCwKICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLnRheE5hbWUuYWNjb3VudC5pZAogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIGJhc2VBbW91bnQ6IGl0ZW0uYmFzZUFtb3VudAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgIGlkOiBfdGhpczEyLnNhbGUuaWQgPyBfdGhpczEyLnNhbGUuaWQgOiAibXItIi5jb25jYXQodXVpZC52MSgpKSwKICAgICAgICAgICAgICAgICAgdHlwZTogJ3NhbGUnLAogICAgICAgICAgICAgICAgICBkYXRlOiBfdGhpczEyLnNhbGUuZGF0ZSwKICAgICAgICAgICAgICAgICAgbW9udGhseVJldHVybklkOiBfdGhpczEyLm1vbnRobHlSZXR1cm4uaWQsCiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlOiBfdGhpczEyLnNhbGUucmVmZXJlbmNlLAogICAgICAgICAgICAgICAgICBtb250aE9mOiBfdGhpczEyLm1vbnRobHlSZXR1cm4ubW9udGhPZiwKICAgICAgICAgICAgICAgICAgY3VzdG9tZXI6IF90aGlzMTIuc2FsZS5jdXN0b21lciwKICAgICAgICAgICAgICAgICAgdG90YWxWQVQ6IF90aGlzMTIudG90YWxWYXQsCiAgICAgICAgICAgICAgICAgIHRvdGFsQW1vdW50SW5jbHVzaXZlOiBfdGhpczEyLmFtb3VudEluY2x1c2l2ZVZhdCwKICAgICAgICAgICAgICAgICAgdG90YWxBbW91bnROZXRWYXQ6IF90aGlzMTIuYW1vdW50TmV0VmF0LAogICAgICAgICAgICAgICAgICB0b3RhbFNwZWNpZmljVGF4OiBfdGhpczEyLmFtb3VudFNwLAogICAgICAgICAgICAgICAgICB0b3RhbFB1YlRheDogX3RoaXMxMi5hbW91bnRQbHQsCiAgICAgICAgICAgICAgICAgIHRvdGFsQWNjb21UYXg6IF90aGlzMTIuYW1vdW50QXQsCiAgICAgICAgICAgICAgICAgIGl0ZW1MaW5lOiBfdGhpczEyLml0ZW1MaW5lcy5sZW5ndGggPiAwID8gX3RoaXMxMi5pdGVtTGluZXMgOiBfdGhpczEyLnNhbGUuaXRlbUxpbmUsCiAgICAgICAgICAgICAgICAgIGlzU2F2ZTogX3RoaXMxMi5zYWxlLmlzU2F2ZSB8fCBmYWxzZSwKICAgICAgICAgICAgICAgICAgc3RhdHVzOiBfdGhpczEyLiRyb3V0ZS5xdWVyeS50eXBlID09PSAnRWRpdCcgPyAyIDogMSwKICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZTogX3RoaXMxMi4kcm91dGUucXVlcnkudHlwZSA9PT0gJ0VkaXQnID8gX3RoaXMxMi5zYWxlLmRhdGFTb3VyY2UgOiB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogIk1hbnVhbGx5IiwKICAgICAgICAgICAgICAgICAgICBpZDogMgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFNhbGVSZWNvcmQoZGF0YSk7CiAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cocmVzdWx0LCAnZGF0YTEyMycpOwoKICAgICAgICAgICAgICAgIF90aGlzMTIuJHN0b3JlLmRpc3BhdGNoKCdjb21wbGlhbmNlL3B1c2hTYWxlJywgcmVzdWx0KTsgLy8gbGV0IHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMubW9udGhseVJldHVybi5udW1iZXIgKyAnJlNhbGUnKSkKICAgICAgICAgICAgICAgIC8vIGlmIChzKSB7CiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKHMubGVuZ3RoIDw9IDApIHsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgaWYgKHRoaXMubW9udGhseVJldHVybi5hYmJyICE9PSAnJyAmJiB0aGlzLm1vbnRobHlSZXR1cm4ubnVtYmVyICE9PSAnJykgewogICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5tb250aGx5UmV0dXJuLmFiYnIgKyB0aGlzLm1vbnRobHlSZXR1cm4ubnVtYmVyICsgJyZTYWxlJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgLy8gICAgIGNvbnN0IGV4aXN0ID0gcy5maWx0ZXIocCA9PiBwLmlkID09PSBkYXRhW2ldLmlkKQogICAgICAgICAgICAgICAgLy8gICAgICAgICAvLyB9CiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNvbnN0IGFsbEFycmF5ID0gWy4uLnMsIC4uLmRhdGFdCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHJlc3VsdHMgPSBhbGxBcnJheS5maWx0ZXIoKGUsIGkpID0+IGFsbEFycmF5LmZpbmRJbmRleChvID0+IG8udG90YWxBbW91bnRJbmNsdXNpdmUgPT09IGUudG90YWxBbW91bnRJbmNsdXNpdmUgJiYgby50b3RhbFZBVCA9PT0gZS50b3RhbFZBVCAmJiBvLnRvdGFsQW1vdW50TmV0VmF0ID09PSBlLnRvdGFsQW1vdW50TmV0VmF0ICYmIG8udG90YWxTcGVjaWZpY1RheCA9PT0gZS50b3RhbFNwZWNpZmljVGF4ICYmIG8udG90YWxQdWJUYXggPT09IGUudG90YWxQdWJUYXggJiYgby50b3RhbEFjY29tVGF4ID09PSBlLnRvdGFsQWNjb21UYXgpID09PSBpKQogICAgICAgICAgICAgICAgLy8gICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cocmVzdWx0cywgJzM0NTY3JykKICAgICAgICAgICAgICAgIC8vICAgICAgICAgaWYgKHRoaXMubW9udGhseVJldHVybi5hYmJyICE9PSAnJyAmJiB0aGlzLm1vbnRobHlSZXR1cm4ubnVtYmVyICE9PSAnJykgewogICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5tb250aGx5UmV0dXJuLmFiYnIgKyB0aGlzLm1vbnRobHlSZXR1cm4ubnVtYmVyICsgJyZTYWxlJywgSlNPTi5zdHJpbmdpZnkocmVzdWx0cykpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgICAgICAvLyB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMubW9udGhseVJldHVybi5hYmJyICsgdGhpcy5tb250aGx5UmV0dXJuLm51bWJlciArICcmU2FsZScsIEpTT04uc3RyaW5naWZ5KGRhdGEpKQogICAgICAgICAgICAgICAgLy8gfQoKCiAgICAgICAgICAgICAgICBfdGhpczEyLnNob3dMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczEyLm9uQ2xvc2UoKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/macos/Desktop/banhji-0.2/banhji-commerce/src/views/compliance/monthly_tax/new_tax_return/input/add_sale/_add_sale.js"],"names":["SaleRecord","kendo","DropDownList","LoadingMe","uuid","ItemLineSale","$","require","SaleModel","textField","keyField","defaultItem","emptyItem","customerHandler","taxSetting","taxSettingHandler","apiUrl","monthlyReturnHandler","saleHandler","name","components","mixins","props","data","dialogTax","showLoading","sale","menuJDateAddSale","txn_date","Date","toISOString","substr","itemLines","filter","dataItemKey","cusBaseUrl","search","customerList","amt","totalVat","amountSp","amountPlt","amountAt","amountVat","amountInclusiveVat","amountNetVat","monthlyReturn","computed","typeProductTax","default","state","listTax","id","$route","query","s_id","undefined","watch","created","mounted","initData","loadListTax","loadData","methods","params","onLoadOneReturn","window","console","log","clear","onloadOneSale","i","itemLine","taxName","p","defaultTax","specificTax","pubTax","accomTax","push","vat","length","totalAmountInclusive","totalAmountNetVat","totalSpecificTax","totalPubTax","totalAccomTax","totalVAT","clearSale","addRow","Promise","resolve","setTimeout","getOne","then","res","get","tax_setting","tax_list_get","onCustomerFilterChanged","event","value","skip","baseUrl","url","requestStarted","fetch","response","json","afterFetch","onChange","customer","onClose","history","go","numberFormat","toString","decimalFormat","disableEditor","onDataSourceChanges","e","field","dataRow","items","set","baseAmount","amount","calculateTax","hasOwnProperty","ds","$refs","dataSource","kendoWidget","spTax","pltTax","atTax","vatTax","totalTax","totalSp","totalPlt","totalAt","totalInclusive","totalNet","amountInc","amountNet","forEach","item","autoCalculateTax","parseFloat","toLowerCase","rate","map","index","uid","splice","amountInclusive","amountSpecificTax","accountId","account","amountPubTax","amountAccomTax","description","tax","formula","inAmt","nAmt","taxBase","total","eval","rowNumberTmpl","dataItem","indexOf","removeRow","preventDefault","grid","jQuery","currentTarget","closest","calculateTaxDelete","remove","specificTaxDropdownEditor","container","options","appendTo","kendoDropDownList","autoBind","autoWidth","height","dataTextField","dataValueField","optionLabel","transactionType","taxType","typeId","model","publicTaxDropdownEditor","accomTaxDropdownEditor","typeProductTaxDropdownEditor","group","editableSP","editableAT","editablePL","insert","onCloseSale","onSaveClose","taxPayerType","type","natureTaxType","customerId","crn","v1","date","monthlyReturnId","reference","monthOf","isSave","status","result","$store","dispatch"],"mappings":"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","sourcesContent":["/*\n * Last modified : 3/27/21, 11:12 AM in Project banhji-accounting-web-module\n * Copyright (c) 2021. Chandarith Chea under Company BanhJi Fintech Co., Ltd\n * Facebook Profile : https://www.facebook.com/profile.php?id=100011194806947\n * Github Profile : https://github.com/Darith-Mokpost\n * Instagram Profile : https://www.instagram.com/chandarith_chea\n */\n\n// @vue/component\nimport SaleRecord from \"@/scripts/compliance/model/SaleRecord\";\nimport kendo from \"@progress/kendo-ui\";\nimport {DropDownList} from \"@progress/kendo-vue-dropdowns\";\nimport LoadingMe from \"@/components/Loading\";\nimport {uuid} from 'vue-uuid'\nimport ItemLineSale from \"@/scripts/compliance/model/itemLineSale\";\n\nconst $ = require(\"jquery\")\nconst SaleModel = new SaleRecord({})\nconst textField = 'numberName'\nconst keyField = 'id'\nconst defaultItem = {[textField]: 'Select customer...', [keyField]: null}\nconst emptyItem = {[textField]: 'loading ...'}\nconst customerHandler = require(\"@/scripts/customerHandler\")\nconst taxSetting = require('@/store/taxSetting');\nconst taxSettingHandler = require(\"@/scripts/taxSettingHandler\")\nconst apiUrl = require('@/apiUrl')\nconst monthlyReturnHandler = require(\"@/scripts/compliance/handler/monthlyReturnHandler\")\nconst saleHandler = require(\"@/scripts/compliance/handler/saleHandler\")\n\nexport default {\n    name: 'Add_sale',\n\n    components: {\n        'dropdownlist': DropDownList,\n        'LoadingMe': LoadingMe,\n    },\n\n    mixins: [],\n\n    props: {},\n\n    data() {\n        return {\n            dialogTax: false,\n            showLoading: false,\n            sale: SaleModel,\n            menuJDateAddSale: false,\n            txn_date: new Date().toISOString().substr(0, 10),\n            itemLines: [],\n            filter: '',\n            textField: 'numberName',\n            dataItemKey: 'id',\n            defaultItem: defaultItem,\n            cusBaseUrl: customerHandler.search(),\n            customerList: [],\n\n            amt: [],\n            totalVat: 0,\n            amountSp: 0,\n            amountPlt: 0,\n            amountAt: 0,\n            amountVat: 0,\n            amountInclusiveVat: 0,\n            amountNetVat: 0,\n            monthlyReturn: {},\n        }\n    },\n\n    computed: {\n        typeProductTax() {\n            return taxSetting.default.state.listTax\n        },\n        id() {\n            if (this.$route.query.s_id !== undefined) {\n                return this.$route.query.s_id\n            } else {\n                return ''\n            }\n        }\n    },\n\n    watch: {\n        'id': 'initData'\n    },\n\n    created() {\n    },\n    async mounted() {\n        await this.initData()\n        await this.loadListTax()\n        await this.loadData(0, '', this.cusBaseUrl)\n    },\n\n    methods: {\n        async initData() {\n            this.showLoading = true\n            if (this.$route.params.id !== undefined && this.$route.params.monthlyReturn === undefined) {\n                await this.onLoadOneReturn()\n                window.console.log(this.$route.params)\n            } else if (this.$route.params.monthlyReturn !== undefined) {\n                this.monthlyReturn = this.$route.params.monthlyReturn\n            } else {\n                this.clear()\n            }\n\n            if (this.$route.query.s_id !== undefined && this.$route.params.sale === undefined) {\n                await this.onloadOneSale()\n            } else if (this.$route.params.sale !== undefined) {\n                this.sale = this.$route.params.sale\n                window.console.log(this.sale, 'list tax')\n                const itemLines = []\n                for (let i =0; i < this.sale.itemLine.length; i++) {\n                    this.sale.itemLine[i].taxName = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].taxName.name)[0]\n                    if (this.sale.itemLine[i].specificTax.name === undefined) {\n                        this.sale.itemLine[i].specificTax = {defaultTax: ''}\n                    } else {\n                        this.sale.itemLine[i].specificTax = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].specificTax.name)[0]\n                    }\n                    if (this.sale.itemLine[i].pubTax.name === undefined) {\n                        this.sale.itemLine[i].pubTax = {defaultTax: ''}\n                    } else {\n                        this.sale.itemLine[i].pubTax = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].pubTax.name)[0]\n                    }\n                    if (this.sale.itemLine[i].accomTax.name === undefined) {\n                        this.sale.itemLine[i].accomTax = {defaultTax: ''}\n                    } else {\n                        this.sale.itemLine[i].accomTax = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].accomTax.name)[0]\n                    }\n                    itemLines.push(new ItemLineSale(this.sale.itemLine[i]))\n\n                    this.amountVat += this.sale.itemLine[i].vat || 0\n                }\n                window.console.log(itemLines, 'itemlines')\n                this.sale.itemLine = itemLines\n                this.amountInclusiveVat = this.sale.totalAmountInclusive || 0\n                this.amountNetVat = this.sale.totalAmountNetVat || 0\n                this.amountSp = this.sale.totalSpecificTax || 0\n                this.amountPlt = this.sale.totalPubTax || 0\n                this.amountAt = this.sale.totalAccomTax || 0\n                this.totalVat = this.sale.totalVAT || 0\n                window.console.log(this.typeProductTax, this.sale.itemLine, 'list tax 123')\n            } else {\n                await this.clearSale()\n            }\n\n            if (this.sale.totalAmountInclusive !== 0) {\n                this.amountSp = this.sale.totalSpecificTax\n                this.amountPlt = this.sale.totalPubTax\n                this.amountAt = this.sale.totalAccomTax\n                this.totalVat = this.sale.totalVAT\n            } else {\n                if (this.sale.itemLine.length === 0) {\n                    await this.addRow()\n                }\n            }\n            this.showLoading = false\n        },\n        async clearSale() {\n            this.sale = new SaleRecord({})\n            this.itemLines = []\n            this.totalVat = 0\n            this.amountInclusiveVat = 0\n            this.amountNetVat = 0\n            this.amountPlt = 0\n            this.amountSp = 0\n            this.amountAt = 0\n            this.amountVat = 0\n        },\n        async onloadOneSale() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    const id = this.$route.params.id\n                    saleHandler.getOne(id).then(res => {\n                        this.sale = res.data.data[0]\n                    })\n                })\n            })\n        },\n        async onLoadOneReturn() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    const id = this.$route.params.id\n                    monthlyReturnHandler.getOne(id).then(res => {\n                        this.monthlyReturn = res.data.data.length > 0 ? res.data.data[0] : []\n                    })\n                })\n            })\n        },\n        async loadListTax() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    taxSettingHandler.get(apiUrl.tax_setting.tax_list_get, \"listTax\", \"setListTax\")\n                    window.console.log(this.sale.itemLine, 'sale')\n                    this.itemLine = this.sale.itemLine\n                }, 100)\n            })\n        },\n        async onCustomerFilterChanged(event) {\n            const filter = event.filter.value\n            await this.loadData(0, filter, this.cusBaseUrl)\n            this.filter = filter\n        },\n        async loadData(skip, filter, baseUrl) {\n            const url = baseUrl +\n                `?filter=${filter}`\n            this.requestStarted = true;\n            fetch(url)\n                .then((response) => {\n                    return response.json()\n                })\n                .then(this.afterFetch)\n        },\n        afterFetch(json) {\n            this.customerList = json.data\n        },\n        onChange(event) {\n            const value = event.value\n            if (value && value[textField] === emptyItem[textField]) {\n                return;\n            }\n            this.sale.customer = value\n            window.console.log(value, 'customer')\n        },\n\n        async onClose() {\n            await this.clearSale()\n            // await this.$router.replace('/new_tax_return/' + this.$route.params.id)\n            window.history.go(-1)\n        },\n        numberFormat(value) {\n            // window.console.log(this.saleFormContent.decimal,'nimol')\n            return kendo.toString(value, `${this.sale.decimalFormat}`)\n        },\n        disableEditor() {\n            return false;\n        },\n        onDataSourceChanges(e) {\n            if (e.field) {\n                let dataRow = e.items[0]\n                switch (e.field) {\n                    case \"taxName\":\n                        dataRow.set(\"baseAmount\", dataRow.taxName.baseAmount)\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"specificTax\":\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"pubTax\":\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"accomTax\":\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"amount\":\n                        if (dataRow.taxName.hasOwnProperty('defaultTax')) {\n                            this.calculateTax()\n                        }\n                        break\n                    default:\n                        break\n                }\n            }\n        },\n        calculateTax() {\n            let ds = this.$refs.dataSource.kendoWidget()\n            let dataRow = ds.data(),\n                spTax = 0, pltTax = 0, atTax = 0, vatTax = 0, totalTax = 0,\n                totalSp = 0, totalPlt = 0, totalAt = 0, totalInclusive = 0, totalNet = 0, amountInc = 0, amountNet = 0\n            window.console.log(dataRow, 'dataRow123')\n            dataRow.forEach(item => {\n                window.console.log(item)\n                if (item.specificTax) {\n                    spTax = this.autoCalculateTax(item.specificTax, item.amount)\n                }\n                if (item.pubTax) {\n                    pltTax = this.autoCalculateTax(item.pubTax, (item.amount))\n                }\n                if (item.accomTax) {\n                    atTax = this.autoCalculateTax(item.accomTax, (item.amount))\n                }\n                if (item.taxName) {\n                    let amt = kendo.parseFloat(spTax) + kendo.parseFloat(pltTax) + kendo.parseFloat(atTax) + (item.amount)\n                    vatTax = this.autoCalculateTax(item.taxName, amt)\n                }\n                if (item.baseAmount.toLowerCase() === \"inclusive\") {\n                    amountInc = item.amount / (1 + (item.taxName.rate / 100))\n                } else {\n                    amountNet = item.amount\n                }\n                this.itemLines.map((i, index) => {\n                    if (i.uid === item.uid) {\n                        this.itemLines.splice(index, 1)\n                    }\n                })\n                this.itemLines.push({\n                    uid: item.uid,\n                    amount: item.amount,\n                    amountInclusive: amountInc,\n                    amountNetVat: amountNet,\n                    amountSpecificTax: spTax || 0,\n                    item: item.item,\n                    specificTax: {name: item.specificTax ? item.specificTax.defaultTax : '', accountId: item.specificTax ? item.specificTax.account ? item.specificTax.account.id : '' : ''},\n                    pubTax: {name: item.pubTax ? item.pubTax.defaultTax : '', accountId: item.pubTax ? item.pubTax.account ? item.pubTax.account.id : '' : ''},\n                    accomTax: {name: item.accomTax ? item.accomTax.defaultTax : '', accountId: item.accomTax ? item.accomTax.account ? item.accomTax.account.id : '' : ''},\n                    vat: vatTax,\n                    amountPubTax: pltTax || 0,\n                    amountAccomTax: atTax || 0,\n                    description: item.description,\n                    taxName: {name: item.taxName.defaultTax, accountId: item.taxName.account.id},\n                    baseAmount: item.baseAmount,\n                })\n                totalTax += kendo.parseFloat(spTax) + kendo.parseFloat(pltTax) + kendo.parseFloat(atTax) + kendo.parseFloat(vatTax)\n                totalInclusive += kendo.parseFloat(amountInc)\n                totalNet += kendo.parseFloat(amountNet)\n                totalSp += kendo.parseFloat(spTax)\n                totalPlt += kendo.parseFloat(pltTax)\n                totalAt += kendo.parseFloat(atTax)\n            })\n            this.totalVat = totalTax\n            this.amountSp = totalSp\n            this.amountPlt = totalPlt\n            this.amountAt = totalAt\n            this.amountInclusiveVat = totalInclusive\n            this.amountNetVat = totalNet\n\n            window.console.log(totalTax)\n            window.console.log('result', this.amt)\n        },\n        autoCalculateTax(tax, amount) {\n            window.console.log(tax, 'tax')\n            if (tax) {\n                let formula = tax.formula,\n                    inAmt = kendo.parseFloat(amount),\n                    nAmt = kendo.parseFloat(amount),\n                    taxBase = kendo.parseFloat(tax.taxBase) / 100,\n                    rate = kendo.parseFloat(tax.rate) / 100,\n                    total = eval(formula)\n                window.console.log(inAmt, nAmt, taxBase, rate, formula, total)\n                return total\n            }\n        },\n        // Auto Increase number\n        rowNumberTmpl(dataItem) {\n            let ds = this.$refs.dataSource.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        // Remove Row\n        removeRow(e) {\n            e.preventDefault();\n            let grid = kendo.jQuery(\"#grid\").data(\"kendoGrid\"),\n                dataSource = grid.dataSource,\n                dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n            if (dataSource.total() > 1) {\n                if (dataItem.amount !== 0 || dataItem.taxName.rate !== undefined) {\n                    if (dataItem.baseAmount.toLowerCase() === 'net') {\n                        this.amountNetVat = this.amountNetVat - dataItem.amount\n                        this.calculateTaxDelete(dataItem)\n                    }else {\n                        let amount = dataItem.amount / (1 + (dataItem.taxName.rate / 100))\n                        this.amountInclusiveVat = this.amountInclusiveVat - amount\n                        this.calculateTaxDelete(dataItem)\n                    }\n                }\n                dataSource.remove(dataItem);\n            }\n        },\n        calculateTaxDelete(dataRow) {\n            let vatTax = 0\n            if (dataRow.taxName) {\n                let amt = dataRow.amount\n                vatTax = this.autoCalculateTax(dataRow.taxName, amt)\n            }\n            this.totalVat = this.totalVat - vatTax\n        },\n        specificTaxDropdownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\"\n                            && item.taxType.typeId === 8 && item.baseAmount.toLowerCase() === options.model.baseAmount.toLowerCase())\n                    }\n                });\n            window.console.log(options.model.baseAmount)\n        },\n        publicTaxDropdownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\"\n                            && item.taxType.typeId === 9 && item.baseAmount.toLowerCase() === options.model.baseAmount.toLowerCase())\n                    }\n                });\n        },\n        accomTaxDropdownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\"\n                            && item.taxType.typeId === 7 && item.baseAmount.toLowerCase() === options.model.baseAmount.toLowerCase())\n                    }\n                });\n        },\n        typeProductTaxDropdownEditor(container, options) {\n            // const tpl = this.typeProductList\n            kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\" && item.taxType.typeId === 1),\n                        group: {\n                            field: \"baseAmount\"\n                        }\n                    }\n                });\n        },\n        editableSP(dataItem) {\n            return dataItem.baseAmount === \"Net\" || dataItem.baseAmount === \"inclusive\"\n        },\n        editableAT(dataItem) {\n            return dataItem.baseAmount === \"Net\" || dataItem.baseAmount === \"inclusive\"\n        },\n        editablePL(dataItem) {\n            return dataItem.baseAmount === \"Net\" || dataItem.baseAmount === \"inclusive\"\n        },\n        async addRow() {\n            let ds = this.$refs.dataSource.kendoWidget(),\n                total = ds.total();\n            ds.insert(total, {\n                taxName: {defaultTax: \"\"},\n                specificTax: {defaultTax: \"\"},\n                pubTax: {defaultTax: \"\"},\n                accomTax: {defaultTax: \"\"},\n                baseAmount: \"\",\n                amount: 0,\n                description: \"\",\n            });\n        },\n        onCloseSale() {\n        },\n        async onSaveClose() {\n            this.showLoading = true\n            // await this.getDataSource()\n            // let itemLine = []\n            if (this.sale.customer.taxPayerType === '') {\n                if (this.sale.customer.type.toLowerCase() === 'individual-foreign') {\n                    this.sale.customer.taxPayerType = 'Physical Person'\n                    this.sale.customer.natureTaxType = 'Non-Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'foreign entity') {\n                    this.sale.customer.taxPayerType = 'Legal Person'\n                    this.sale.customer.natureTaxType = 'Non-Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'individual-local') {\n                    this.sale.customer.taxPayerType = 'Physical Person'\n                    this.sale.customer.natureTaxType = 'Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'non-taxable entity') {\n                    this.sale.customer.taxPayerType = 'Legal Person'\n                    this.sale.customer.natureTaxType = 'Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'taxable entity') {\n                    this.sale.customer.taxPayerType = 'Legal Person'\n                    this.sale.customer.natureTaxType = 'Resident'\n                }\n                this.sale.customer.customerId = this.sale.customer.crn\n            }\n            window.console.log(this.itemLines, this.sale.itemLine, 'itemline')\n            if (this.itemLines.length < 0 || this.sale.itemLine.length > 0) {\n                window.console.log(this.sale.itemLine, 'itemline 123412412')\n               this.sale.itemLine = this.sale.itemLine.map(item => {\n                    return {\n                        uid: item.uid,\n                        amount: item.amount,\n                        amountInclusive: item.amountInclusive,\n                        amountNetVat: item.amountNetVat,\n                        amountSpecificTax: item.amountSpecificTax || 0,\n                        item: item.item,\n                        specificTax: {name: item.specificTax ? item.specificTax.defaultTax : '', accountId: item.specificTax ? item.specificTax.account ? item.specificTax.account.id : '' : ''},\n                        pubTax: {name: item.pubTax ? item.pubTax.defaultTax : '', accountId: item.pubTax ? item.pubTax.account ? item.pubTax.account.id : '' : ''},\n                        accomTax: {name: item.accomTax ? item.accomTax.defaultTax : '', accountId: item.accomTax ? item.accomTax.account ? item.accomTax.account.id : '' : ''},\n                        vat: item.vat,\n                        amountPubTax: item.amountPubTax|| 0,\n                        amountAccomTax: item.amountAccomTax || 0,\n                        description: item.description,\n                        taxName: {name: item.taxName.defaultTax, accountId: item.taxName.account.id},\n                        baseAmount: item.baseAmount,\n                    }\n                })\n            }\n            const data = {\n                id: this.sale.id ? this.sale.id : `mr-${uuid.v1()}`,\n                type: 'sale',\n                date: this.sale.date,\n                monthlyReturnId: this.monthlyReturn.id,\n                description: '',\n                reference: this.sale.reference,\n                monthOf: this.monthlyReturn.monthOf,\n                customer: this.sale.customer,\n                totalVAT: this.totalVat,\n                totalAmountInclusive: this.amountInclusiveVat,\n                totalAmountNetVat: this.amountNetVat,\n                totalSpecificTax: this.amountSp,\n                totalPubTax: this.amountPlt,\n                totalAccomTax: this.amountAt,\n                itemLine: this.itemLines.length > 0 ? this.itemLines : this.sale.itemLine,\n                isSave: this.sale.isSave || false,\n                status: this.$route.query.type === 'Edit' ? 2 : 1,\n                dataSource: this.$route.query.type === 'Edit' ? this.sale.dataSource : {name: \"Manually\", id: 2},\n            }\n            const result = new SaleRecord(data)\n            window.console.log(result, 'data123')\n            this.$store.dispatch('compliance/pushSale', result)\n            // let s = JSON.parse(localStorage.getItem(this.monthlyReturn.number + '&Sale'))\n            // if (s) {\n            //     if (s.length <= 0) {\n            //         if (this.monthlyReturn.abbr !== '' && this.monthlyReturn.number !== '') {\n            //             localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Sale', JSON.stringify(data))\n            //         }\n            //     } else {\n            //         // for (let i = 0; i < data.length; i++) {\n            //         //     const exist = s.filter(p => p.id === data[i].id)\n            //         // }\n            //         const allArray = [...s, ...data]\n            //         results = allArray.filter((e, i) => allArray.findIndex(o => o.totalAmountInclusive === e.totalAmountInclusive && o.totalVAT === e.totalVAT && o.totalAmountNetVat === e.totalAmountNetVat && o.totalSpecificTax === e.totalSpecificTax && o.totalPubTax === e.totalPubTax && o.totalAccomTax === e.totalAccomTax) === i)\n            //         window.console.log(results, '34567')\n            //         if (this.monthlyReturn.abbr !== '' && this.monthlyReturn.number !== '') {\n            //             localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Sale', JSON.stringify(results))\n            //         }\n            //     }\n            // } else {\n            //     localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Sale', JSON.stringify(data))\n            // }\n            this.showLoading = false\n            await this.onClose()\n            // await saleHandler.create(data).then(res => {\n            //     this.showLoading = false\n            //     this.onClose()\n            //     window.console.log(res, 'create sale')\n            // }).catch(e => {\n            //     window.console.error(e)\n            // })\n        },\n    }\n}\n"]}]}