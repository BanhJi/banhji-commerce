{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/eslint-loader/index.js??ref--13-0!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/compliance/monthly_tax/new_tax_return/input/add_sale/_add_sale.js?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/compliance/monthly_tax/new_tax_return/input/add_sale/_add_sale.js","mtime":1638499443167},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYWNvcy9EZXNrdG9wL2JhbmhqaS0wLjIvYmFuaGppLWFjY291bnRpbmctd2ViLW1vZHVsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL21hY29zL0Rlc2t0b3AvYmFuaGppLTAuMi9iYW5oamktYWNjb3VudGluZy13ZWItbW9kdWxlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7Cgp2YXIgX2RlZmF1bHRJdGVtOwoKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKCi8qCiAqIExhc3QgbW9kaWZpZWQgOiAzLzI3LzIxLCAxMToxMiBBTSBpbiBQcm9qZWN0IGJhbmhqaS1hY2NvdW50aW5nLXdlYi1tb2R1bGUKICogQ29weXJpZ2h0IChjKSAyMDIxLiBDaGFuZGFyaXRoIENoZWEgdW5kZXIgQ29tcGFueSBCYW5oSmkgRmludGVjaCBDby4sIEx0ZAogKiBGYWNlYm9vayBQcm9maWxlIDogaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDAxMTE5NDgwNjk0NwogKiBHaXRodWIgUHJvZmlsZSA6IGh0dHBzOi8vZ2l0aHViLmNvbS9EYXJpdGgtTW9rcG9zdAogKiBJbnN0YWdyYW0gUHJvZmlsZSA6IGh0dHBzOi8vd3d3Lmluc3RhZ3JhbS5jb20vY2hhbmRhcml0aF9jaGVhCiAqLwovLyBAdnVlL2NvbXBvbmVudAppbXBvcnQgU2FsZVJlY29yZCBmcm9tICJAL3NjcmlwdHMvY29tcGxpYW5jZS9tb2RlbC9TYWxlUmVjb3JkIjsKaW1wb3J0IGtlbmRvIGZyb20gIkBwcm9ncmVzcy9rZW5kby11aSI7CmltcG9ydCB7IERyb3BEb3duTGlzdCB9IGZyb20gIkBwcm9ncmVzcy9rZW5kby12dWUtZHJvcGRvd25zIjsKaW1wb3J0IExvYWRpbmdNZSBmcm9tICJAL2NvbXBvbmVudHMvTG9hZGluZyI7CmltcG9ydCB7IHV1aWQgfSBmcm9tICd2dWUtdXVpZCc7CmltcG9ydCBJdGVtTGluZVNhbGUgZnJvbSAiQC9zY3JpcHRzL2NvbXBsaWFuY2UvbW9kZWwvaXRlbUxpbmVTYWxlIjsKCnZhciAkID0gcmVxdWlyZSgianF1ZXJ5Iik7Cgp2YXIgU2FsZU1vZGVsID0gbmV3IFNhbGVSZWNvcmQoe30pOwp2YXIgdGV4dEZpZWxkID0gJ251bWJlck5hbWUnOwp2YXIga2V5RmllbGQgPSAnaWQnOwp2YXIgZGVmYXVsdEl0ZW0gPSAoX2RlZmF1bHRJdGVtID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfZGVmYXVsdEl0ZW0sIHRleHRGaWVsZCwgJ1NlbGVjdCBjdXN0b21lci4uLicpLCBfZGVmaW5lUHJvcGVydHkoX2RlZmF1bHRJdGVtLCBrZXlGaWVsZCwgbnVsbCksIF9kZWZhdWx0SXRlbSk7Cgp2YXIgZW1wdHlJdGVtID0gX2RlZmluZVByb3BlcnR5KHt9LCB0ZXh0RmllbGQsICdsb2FkaW5nIC4uLicpOwoKdmFyIGN1c3RvbWVySGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9jdXN0b21lckhhbmRsZXIiKTsKCnZhciB0YXhTZXR0aW5nID0gcmVxdWlyZSgnQC9zdG9yZS90YXhTZXR0aW5nJyk7Cgp2YXIgdGF4U2V0dGluZ0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvdGF4U2V0dGluZ0hhbmRsZXIiKTsKCnZhciBhcGlVcmwgPSByZXF1aXJlKCdAL2FwaVVybCcpOwoKdmFyIG1vbnRobHlSZXR1cm5IYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2NvbXBsaWFuY2UvaGFuZGxlci9tb250aGx5UmV0dXJuSGFuZGxlciIpOwoKdmFyIHNhbGVIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2NvbXBsaWFuY2UvaGFuZGxlci9zYWxlSGFuZGxlciIpOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdBZGRfc2FsZScsCiAgY29tcG9uZW50czogewogICAgJ2Ryb3Bkb3dubGlzdCc6IERyb3BEb3duTGlzdCwKICAgICdMb2FkaW5nTWUnOiBMb2FkaW5nTWUKICB9LAogIG1peGluczogW10sCiAgcHJvcHM6IHt9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dUYXg6IGZhbHNlLAogICAgICBzaG93TG9hZGluZzogZmFsc2UsCiAgICAgIHNhbGU6IFNhbGVNb2RlbCwKICAgICAgbWVudUpEYXRlQWRkU2FsZTogZmFsc2UsCiAgICAgIHR4bl9kYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKSwKICAgICAgaXRlbUxpbmVzOiBbXSwKICAgICAgZmlsdGVyOiAnJywKICAgICAgdGV4dEZpZWxkOiAnbnVtYmVyTmFtZScsCiAgICAgIGRhdGFJdGVtS2V5OiAnaWQnLAogICAgICBkZWZhdWx0SXRlbTogZGVmYXVsdEl0ZW0sCiAgICAgIGN1c0Jhc2VVcmw6IGN1c3RvbWVySGFuZGxlci5zZWFyY2goKSwKICAgICAgY3VzdG9tZXJMaXN0OiBbXSwKICAgICAgYW10OiBbXSwKICAgICAgdG90YWxWYXQ6IDAsCiAgICAgIGFtb3VudFNwOiAwLAogICAgICBhbW91bnRQbHQ6IDAsCiAgICAgIGFtb3VudEF0OiAwLAogICAgICBhbW91bnRWYXQ6IDAsCiAgICAgIGFtb3VudEluY2x1c2l2ZVZhdDogMCwKICAgICAgYW1vdW50TmV0VmF0OiAwLAogICAgICBtb250aGx5UmV0dXJuOiB7fQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICB0eXBlUHJvZHVjdFRheDogZnVuY3Rpb24gdHlwZVByb2R1Y3RUYXgoKSB7CiAgICAgIHJldHVybiB0YXhTZXR0aW5nLmRlZmF1bHQuc3RhdGUubGlzdFRheDsKICAgIH0sCiAgICBpZDogZnVuY3Rpb24gaWQoKSB7CiAgICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS5zX2lkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpcy4kcm91dGUucXVlcnkuc19pZDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAnaWQnOiAnaW5pdERhdGEnCiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkge30sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5pbml0RGF0YSgpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2FkTGlzdFRheCgpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2FkRGF0YSgwLCAnJywgX3RoaXMuY3VzQmFzZVVybCk7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0RGF0YTogZnVuY3Rpb24gaW5pdERhdGEoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIGl0ZW1MaW5lcywgX2xvb3AsIGk7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczIuc2hvd0xvYWRpbmcgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMi4kcm91dGUucGFyYW1zLmlkICE9PSB1bmRlZmluZWQgJiYgX3RoaXMyLiRyb3V0ZS5wYXJhbXMubW9udGhseVJldHVybiA9PT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIub25Mb2FkT25lUmV0dXJuKCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczIuJHJvdXRlLnBhcmFtcyk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMi4kcm91dGUucGFyYW1zLm1vbnRobHlSZXR1cm4gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICBfdGhpczIubW9udGhseVJldHVybiA9IF90aGlzMi4kcm91dGUucGFyYW1zLm1vbnRobHlSZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczIuY2xlYXIoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgaWYgKCEoX3RoaXMyLiRyb3V0ZS5xdWVyeS5zX2lkICE9PSB1bmRlZmluZWQgJiYgX3RoaXMyLiRyb3V0ZS5wYXJhbXMuc2FsZSA9PT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5vbmxvYWRPbmVTYWxlKCk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczIuJHJvdXRlLnBhcmFtcy5zYWxlICE9PSB1bmRlZmluZWQpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMi5zYWxlID0gX3RoaXMyLiRyb3V0ZS5wYXJhbXMuc2FsZTsKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczIuc2FsZSwgJ2xpc3QgdGF4Jyk7CiAgICAgICAgICAgICAgICBpdGVtTGluZXMgPSBbXTsKCiAgICAgICAgICAgICAgICBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0udGF4TmFtZSA9IF90aGlzMi50eXBlUHJvZHVjdFRheC5maWx0ZXIoZnVuY3Rpb24gKHApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcC5kZWZhdWx0VGF4ID09PSBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS50YXhOYW1lLm5hbWU7CiAgICAgICAgICAgICAgICAgIH0pWzBdOwoKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnNwZWNpZmljVGF4Lm5hbWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnNwZWNpZmljVGF4ID0gewogICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFRheDogJycKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnNwZWNpZmljVGF4ID0gX3RoaXMyLnR5cGVQcm9kdWN0VGF4LmZpbHRlcihmdW5jdGlvbiAocCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHAuZGVmYXVsdFRheCA9PT0gX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0uc3BlY2lmaWNUYXgubmFtZTsKICAgICAgICAgICAgICAgICAgICB9KVswXTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLnB1YlRheC5uYW1lID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5wdWJUYXggPSB7CiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VGF4OiAnJwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0ucHViVGF4ID0gX3RoaXMyLnR5cGVQcm9kdWN0VGF4LmZpbHRlcihmdW5jdGlvbiAocCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHAuZGVmYXVsdFRheCA9PT0gX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0ucHViVGF4Lm5hbWU7CiAgICAgICAgICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5hY2NvbVRheC5uYW1lID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5hY2NvbVRheCA9IHsKICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUYXg6ICcnCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS5hY2NvbVRheCA9IF90aGlzMi50eXBlUHJvZHVjdFRheC5maWx0ZXIoZnVuY3Rpb24gKHApIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwLmRlZmF1bHRUYXggPT09IF90aGlzMi5zYWxlLml0ZW1MaW5lW2ldLmFjY29tVGF4Lm5hbWU7CiAgICAgICAgICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIGl0ZW1MaW5lcy5wdXNoKG5ldyBJdGVtTGluZVNhbGUoX3RoaXMyLnNhbGUuaXRlbUxpbmVbaV0pKTsKICAgICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudFZhdCArPSBfdGhpczIuc2FsZS5pdGVtTGluZVtpXS52YXQgfHwgMDsKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IF90aGlzMi5zYWxlLml0ZW1MaW5lLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgIF9sb29wKGkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhpdGVtTGluZXMsICdpdGVtbGluZXMnKTsKICAgICAgICAgICAgICAgIF90aGlzMi5zYWxlLml0ZW1MaW5lID0gaXRlbUxpbmVzOwogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudEluY2x1c2l2ZVZhdCA9IF90aGlzMi5zYWxlLnRvdGFsQW1vdW50SW5jbHVzaXZlIHx8IDA7CiAgICAgICAgICAgICAgICBfdGhpczIuYW1vdW50TmV0VmF0ID0gX3RoaXMyLnNhbGUudG90YWxBbW91bnROZXRWYXQgfHwgMDsKICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnRTcCA9IF90aGlzMi5zYWxlLnRvdGFsU3BlY2lmaWNUYXggfHwgMDsKICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnRQbHQgPSBfdGhpczIuc2FsZS50b3RhbFB1YlRheCB8fCAwOwogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudEF0ID0gX3RoaXMyLnNhbGUudG90YWxBY2NvbVRheCB8fCAwOwogICAgICAgICAgICAgICAgX3RoaXMyLnRvdGFsVmF0ID0gX3RoaXMyLnNhbGUudG90YWxWQVQgfHwgMDsKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczIudHlwZVByb2R1Y3RUYXgsIF90aGlzMi5zYWxlLml0ZW1MaW5lLCAnbGlzdCB0YXggMTIzJyk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5jbGVhclNhbGUoKTsKCiAgICAgICAgICAgICAgY2FzZSAzMjoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMi5zYWxlLnRvdGFsQW1vdW50SW5jbHVzaXZlICE9PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIuYW1vdW50U3AgPSBfdGhpczIuc2FsZS50b3RhbFNwZWNpZmljVGF4OwogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudFBsdCA9IF90aGlzMi5zYWxlLnRvdGFsUHViVGF4OwogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudEF0ID0gX3RoaXMyLnNhbGUudG90YWxBY2NvbVRheDsKICAgICAgICAgICAgICAgIF90aGlzMi50b3RhbFZhdCA9IF90aGlzMi5zYWxlLnRvdGFsVkFUOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0MjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDM5OgogICAgICAgICAgICAgICAgaWYgKCEoX3RoaXMyLnNhbGUuaXRlbUxpbmUubGVuZ3RoID09PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5hZGRSb3coKTsKCiAgICAgICAgICAgICAgY2FzZSA0MjoKICAgICAgICAgICAgICAgIF90aGlzMi5zaG93TG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBjYXNlIDQzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY2xlYXJTYWxlOiBmdW5jdGlvbiBjbGVhclNhbGUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMy5zYWxlID0gbmV3IFNhbGVSZWNvcmQoe30pOwogICAgICAgICAgICAgICAgX3RoaXMzLml0ZW1MaW5lcyA9IFtdOwogICAgICAgICAgICAgICAgX3RoaXMzLnRvdGFsVmF0ID0gMDsKICAgICAgICAgICAgICAgIF90aGlzMy5hbW91bnRJbmNsdXNpdmVWYXQgPSAwOwogICAgICAgICAgICAgICAgX3RoaXMzLmFtb3VudE5ldFZhdCA9IDA7CiAgICAgICAgICAgICAgICBfdGhpczMuYW1vdW50UGx0ID0gMDsKICAgICAgICAgICAgICAgIF90aGlzMy5hbW91bnRTcCA9IDA7CiAgICAgICAgICAgICAgICBfdGhpczMuYW1vdW50QXQgPSAwOwogICAgICAgICAgICAgICAgX3RoaXMzLmFtb3VudFZhdCA9IDA7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9ubG9hZE9uZVNhbGU6IGZ1bmN0aW9uIG9ubG9hZE9uZVNhbGUoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX3RoaXM0LiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgICAgICAgICAgICAgICAgc2FsZUhhbmRsZXIuZ2V0T25lKGlkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNC5zYWxlID0gcmVzLmRhdGEuZGF0YVswXTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb25Mb2FkT25lUmV0dXJuOiBmdW5jdGlvbiBvbkxvYWRPbmVSZXR1cm4oKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX3RoaXM1LiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgICAgICAgICAgICAgICAgbW9udGhseVJldHVybkhhbmRsZXIuZ2V0T25lKGlkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzNS5tb250aGx5UmV0dXJuID0gcmVzLmRhdGEuZGF0YS5sZW5ndGggPiAwID8gcmVzLmRhdGEuZGF0YVswXSA6IFtdOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBsb2FkTGlzdFRheDogZnVuY3Rpb24gbG9hZExpc3RUYXgoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgdGF4U2V0dGluZ0hhbmRsZXIuZ2V0KGFwaVVybC50YXhfc2V0dGluZy50YXhfbGlzdF9nZXQsICJsaXN0VGF4IiwgInNldExpc3RUYXgiKTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coX3RoaXM2LnNhbGUuaXRlbUxpbmUsICdzYWxlJyk7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM2Lml0ZW1MaW5lID0gX3RoaXM2LnNhbGUuaXRlbUxpbmU7CiAgICAgICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb25DdXN0b21lckZpbHRlckNoYW5nZWQ6IGZ1bmN0aW9uIG9uQ3VzdG9tZXJGaWx0ZXJDaGFuZ2VkKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIGZpbHRlcjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZmlsdGVyID0gZXZlbnQuZmlsdGVyLnZhbHVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNy5sb2FkRGF0YSgwLCBmaWx0ZXIsIF90aGlzNy5jdXNCYXNlVXJsKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3RoaXM3LmZpbHRlciA9IGZpbHRlcjsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbG9hZERhdGE6IGZ1bmN0aW9uIGxvYWREYXRhKHNraXAsIGZpbHRlciwgYmFzZVVybCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHZhciB1cmw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHVybCA9IGJhc2VVcmwgKyAiP2ZpbHRlcj0iLmNvbmNhdChmaWx0ZXIpOwogICAgICAgICAgICAgICAgX3RoaXM4LnJlcXVlc3RTdGFydGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZldGNoKHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgICAgIH0pLnRoZW4oX3RoaXM4LmFmdGVyRmV0Y2gpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBhZnRlckZldGNoOiBmdW5jdGlvbiBhZnRlckZldGNoKGpzb24pIHsKICAgICAgdGhpcy5jdXN0b21lckxpc3QgPSBqc29uLmRhdGE7CiAgICB9LAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGV2ZW50KSB7CiAgICAgIHZhciB2YWx1ZSA9IGV2ZW50LnZhbHVlOwoKICAgICAgaWYgKHZhbHVlICYmIHZhbHVlW3RleHRGaWVsZF0gPT09IGVtcHR5SXRlbVt0ZXh0RmllbGRdKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLnNhbGUuY3VzdG9tZXIgPSB2YWx1ZTsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKHZhbHVlLCAnY3VzdG9tZXInKTsKICAgIH0sCiAgICBvbkNsb3NlOiBmdW5jdGlvbiBvbkNsb3NlKCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM5LmNsZWFyU2FsZSgpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAvLyBhd2FpdCB0aGlzLiRyb3V0ZXIucmVwbGFjZSgnL25ld190YXhfcmV0dXJuLycgKyB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpCiAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5nbygtMSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG51bWJlckZvcm1hdDogZnVuY3Rpb24gbnVtYmVyRm9ybWF0KHZhbHVlKSB7CiAgICAgIC8vIHdpbmRvdy5jb25zb2xlLmxvZyh0aGlzLnNhbGVGb3JtQ29udGVudC5kZWNpbWFsLCduaW1vbCcpCiAgICAgIHJldHVybiBrZW5kby50b1N0cmluZyh2YWx1ZSwgIiIuY29uY2F0KHRoaXMuc2FsZS5kZWNpbWFsRm9ybWF0KSk7CiAgICB9LAogICAgZGlzYWJsZUVkaXRvcjogZnVuY3Rpb24gZGlzYWJsZUVkaXRvcigpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIG9uRGF0YVNvdXJjZUNoYW5nZXM6IGZ1bmN0aW9uIG9uRGF0YVNvdXJjZUNoYW5nZXMoZSkgewogICAgICBpZiAoZS5maWVsZCkgewogICAgICAgIHZhciBkYXRhUm93ID0gZS5pdGVtc1swXTsKCiAgICAgICAgc3dpdGNoIChlLmZpZWxkKSB7CiAgICAgICAgICBjYXNlICJ0YXhOYW1lIjoKICAgICAgICAgICAgZGF0YVJvdy5zZXQoImJhc2VBbW91bnQiLCBkYXRhUm93LnRheE5hbWUuYmFzZUFtb3VudCk7CgogICAgICAgICAgICBpZiAoZGF0YVJvdy5hbW91bnQgPiAwKSB7CiAgICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVUYXgoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAic3BlY2lmaWNUYXgiOgogICAgICAgICAgICBpZiAoZGF0YVJvdy5hbW91bnQgPiAwKSB7CiAgICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVUYXgoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAicHViVGF4IjoKICAgICAgICAgICAgaWYgKGRhdGFSb3cuYW1vdW50ID4gMCkgewogICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImFjY29tVGF4IjoKICAgICAgICAgICAgaWYgKGRhdGFSb3cuYW1vdW50ID4gMCkgewogICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImFtb3VudCI6CiAgICAgICAgICAgIGlmIChkYXRhUm93LnRheE5hbWUuaGFzT3duUHJvcGVydHkoJ2RlZmF1bHRUYXgnKSkgewogICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNhbGN1bGF0ZVRheDogZnVuY3Rpb24gY2FsY3VsYXRlVGF4KCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICB2YXIgZHMgPSB0aGlzLiRyZWZzLmRhdGFTb3VyY2Uua2VuZG9XaWRnZXQoKTsKICAgICAgdmFyIGRhdGFSb3cgPSBkcy5kYXRhKCksCiAgICAgICAgICBzcFRheCA9IDAsCiAgICAgICAgICBwbHRUYXggPSAwLAogICAgICAgICAgYXRUYXggPSAwLAogICAgICAgICAgdmF0VGF4ID0gMCwKICAgICAgICAgIHRvdGFsVGF4ID0gMCwKICAgICAgICAgIHRvdGFsU3AgPSAwLAogICAgICAgICAgdG90YWxQbHQgPSAwLAogICAgICAgICAgdG90YWxBdCA9IDAsCiAgICAgICAgICB0b3RhbEluY2x1c2l2ZSA9IDAsCiAgICAgICAgICB0b3RhbE5ldCA9IDAsCiAgICAgICAgICBhbW91bnRJbmMgPSAwLAogICAgICAgICAgYW1vdW50TmV0ID0gMDsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKGRhdGFSb3csICdkYXRhUm93MTIzJyk7CiAgICAgIGRhdGFSb3cuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhpdGVtKTsKCiAgICAgICAgaWYgKGl0ZW0uc3BlY2lmaWNUYXgpIHsKICAgICAgICAgIHNwVGF4ID0gX3RoaXMxMC5hdXRvQ2FsY3VsYXRlVGF4KGl0ZW0uc3BlY2lmaWNUYXgsIGl0ZW0uYW1vdW50KTsKICAgICAgICB9CgogICAgICAgIGlmIChpdGVtLnB1YlRheCkgewogICAgICAgICAgcGx0VGF4ID0gX3RoaXMxMC5hdXRvQ2FsY3VsYXRlVGF4KGl0ZW0ucHViVGF4LCBpdGVtLmFtb3VudCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXRlbS5hY2NvbVRheCkgewogICAgICAgICAgYXRUYXggPSBfdGhpczEwLmF1dG9DYWxjdWxhdGVUYXgoaXRlbS5hY2NvbVRheCwgaXRlbS5hbW91bnQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGl0ZW0udGF4TmFtZSkgewogICAgICAgICAgdmFyIGFtdCA9IGtlbmRvLnBhcnNlRmxvYXQoc3BUYXgpICsga2VuZG8ucGFyc2VGbG9hdChwbHRUYXgpICsga2VuZG8ucGFyc2VGbG9hdChhdFRheCkgKyBpdGVtLmFtb3VudDsKICAgICAgICAgIHZhdFRheCA9IF90aGlzMTAuYXV0b0NhbGN1bGF0ZVRheChpdGVtLnRheE5hbWUsIGFtdCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXRlbS5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09ICJpbmNsdXNpdmUiKSB7CiAgICAgICAgICBhbW91bnRJbmMgPSBpdGVtLmFtb3VudCAvICgxICsgaXRlbS50YXhOYW1lLnJhdGUgLyAxMDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhbW91bnROZXQgPSBpdGVtLmFtb3VudDsKICAgICAgICB9CgogICAgICAgIF90aGlzMTAuaXRlbUxpbmVzLm1hcChmdW5jdGlvbiAoaSwgaW5kZXgpIHsKICAgICAgICAgIGlmIChpLnVpZCA9PT0gaXRlbS51aWQpIHsKICAgICAgICAgICAgX3RoaXMxMC5pdGVtTGluZXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMxMC5pdGVtTGluZXMucHVzaCh7CiAgICAgICAgICB1aWQ6IGl0ZW0udWlkLAogICAgICAgICAgYW1vdW50OiBpdGVtLmFtb3VudCwKICAgICAgICAgIGFtb3VudEluY2x1c2l2ZTogYW1vdW50SW5jLAogICAgICAgICAgYW1vdW50TmV0VmF0OiBhbW91bnROZXQsCiAgICAgICAgICBhbW91bnRTcGVjaWZpY1RheDogc3BUYXggfHwgMCwKICAgICAgICAgIGl0ZW06IGl0ZW0uaXRlbSwKICAgICAgICAgIHNwZWNpZmljVGF4OiB7CiAgICAgICAgICAgIG5hbWU6IGl0ZW0uc3BlY2lmaWNUYXggPyBpdGVtLnNwZWNpZmljVGF4LmRlZmF1bHRUYXggOiAnJywKICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLnNwZWNpZmljVGF4ID8gaXRlbS5zcGVjaWZpY1RheC5hY2NvdW50ID8gaXRlbS5zcGVjaWZpY1RheC5hY2NvdW50LmlkIDogJycgOiAnJwogICAgICAgICAgfSwKICAgICAgICAgIHB1YlRheDogewogICAgICAgICAgICBuYW1lOiBpdGVtLnB1YlRheCA/IGl0ZW0ucHViVGF4LmRlZmF1bHRUYXggOiAnJywKICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLnB1YlRheCA/IGl0ZW0ucHViVGF4LmFjY291bnQgPyBpdGVtLnB1YlRheC5hY2NvdW50LmlkIDogJycgOiAnJwogICAgICAgICAgfSwKICAgICAgICAgIGFjY29tVGF4OiB7CiAgICAgICAgICAgIG5hbWU6IGl0ZW0uYWNjb21UYXggPyBpdGVtLmFjY29tVGF4LmRlZmF1bHRUYXggOiAnJywKICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLmFjY29tVGF4ID8gaXRlbS5hY2NvbVRheC5hY2NvdW50ID8gaXRlbS5hY2NvbVRheC5hY2NvdW50LmlkIDogJycgOiAnJwogICAgICAgICAgfSwKICAgICAgICAgIHZhdDogdmF0VGF4LAogICAgICAgICAgYW1vdW50UHViVGF4OiBwbHRUYXggfHwgMCwKICAgICAgICAgIGFtb3VudEFjY29tVGF4OiBhdFRheCB8fCAwLAogICAgICAgICAgZGVzY3JpcHRpb246IGl0ZW0uZGVzY3JpcHRpb24sCiAgICAgICAgICB0YXhOYW1lOiB7CiAgICAgICAgICAgIG5hbWU6IGl0ZW0udGF4TmFtZS5kZWZhdWx0VGF4LAogICAgICAgICAgICBhY2NvdW50SWQ6IGl0ZW0udGF4TmFtZS5hY2NvdW50LmlkCiAgICAgICAgICB9LAogICAgICAgICAgYmFzZUFtb3VudDogaXRlbS5iYXNlQW1vdW50CiAgICAgICAgfSk7CgogICAgICAgIHRvdGFsVGF4ICs9IGtlbmRvLnBhcnNlRmxvYXQoc3BUYXgpICsga2VuZG8ucGFyc2VGbG9hdChwbHRUYXgpICsga2VuZG8ucGFyc2VGbG9hdChhdFRheCkgKyBrZW5kby5wYXJzZUZsb2F0KHZhdFRheCk7CiAgICAgICAgdG90YWxJbmNsdXNpdmUgKz0ga2VuZG8ucGFyc2VGbG9hdChhbW91bnRJbmMpOwogICAgICAgIHRvdGFsTmV0ICs9IGtlbmRvLnBhcnNlRmxvYXQoYW1vdW50TmV0KTsKICAgICAgICB0b3RhbFNwICs9IGtlbmRvLnBhcnNlRmxvYXQoc3BUYXgpOwogICAgICAgIHRvdGFsUGx0ICs9IGtlbmRvLnBhcnNlRmxvYXQocGx0VGF4KTsKICAgICAgICB0b3RhbEF0ICs9IGtlbmRvLnBhcnNlRmxvYXQoYXRUYXgpOwogICAgICB9KTsKICAgICAgdGhpcy50b3RhbFZhdCA9IHRvdGFsVGF4OwogICAgICB0aGlzLmFtb3VudFNwID0gdG90YWxTcDsKICAgICAgdGhpcy5hbW91bnRQbHQgPSB0b3RhbFBsdDsKICAgICAgdGhpcy5hbW91bnRBdCA9IHRvdGFsQXQ7CiAgICAgIHRoaXMuYW1vdW50SW5jbHVzaXZlVmF0ID0gdG90YWxJbmNsdXNpdmU7CiAgICAgIHRoaXMuYW1vdW50TmV0VmF0ID0gdG90YWxOZXQ7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyh0b3RhbFRheCk7CiAgICAgIHdpbmRvdy5jb25zb2xlLmxvZygncmVzdWx0JywgdGhpcy5hbXQpOwogICAgfSwKICAgIGF1dG9DYWxjdWxhdGVUYXg6IGZ1bmN0aW9uIGF1dG9DYWxjdWxhdGVUYXgodGF4LCBhbW91bnQpIHsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKHRheCwgJ3RheCcpOwoKICAgICAgaWYgKHRheCkgewogICAgICAgIHZhciBmb3JtdWxhID0gdGF4LmZvcm11bGEsCiAgICAgICAgICAgIGluQW10ID0ga2VuZG8ucGFyc2VGbG9hdChhbW91bnQpLAogICAgICAgICAgICBuQW10ID0ga2VuZG8ucGFyc2VGbG9hdChhbW91bnQpLAogICAgICAgICAgICB0YXhCYXNlID0ga2VuZG8ucGFyc2VGbG9hdCh0YXgudGF4QmFzZSkgLyAxMDAsCiAgICAgICAgICAgIHJhdGUgPSBrZW5kby5wYXJzZUZsb2F0KHRheC5yYXRlKSAvIDEwMCwKICAgICAgICAgICAgdG90YWwgPSBldmFsKGZvcm11bGEpOwogICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhpbkFtdCwgbkFtdCwgdGF4QmFzZSwgcmF0ZSwgZm9ybXVsYSwgdG90YWwpOwogICAgICAgIHJldHVybiB0b3RhbDsKICAgICAgfQogICAgfSwKICAgIC8vIEF1dG8gSW5jcmVhc2UgbnVtYmVyCiAgICByb3dOdW1iZXJUbXBsOiBmdW5jdGlvbiByb3dOdW1iZXJUbXBsKGRhdGFJdGVtKSB7CiAgICAgIHZhciBkcyA9IHRoaXMuJHJlZnMuZGF0YVNvdXJjZS5rZW5kb1dpZGdldCgpLAogICAgICAgICAgaW5kZXggPSBkcy5pbmRleE9mKGRhdGFJdGVtKTsKICAgICAgcmV0dXJuIGluZGV4ICsgMTsKICAgIH0sCiAgICAvLyBSZW1vdmUgUm93CiAgICByZW1vdmVSb3c6IGZ1bmN0aW9uIHJlbW92ZVJvdyhlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgdmFyIGdyaWQgPSBrZW5kby5qUXVlcnkoIiNncmlkIikuZGF0YSgia2VuZG9HcmlkIiksCiAgICAgICAgICBkYXRhU291cmNlID0gZ3JpZC5kYXRhU291cmNlLAogICAgICAgICAgZGF0YUl0ZW0gPSBncmlkLmRhdGFJdGVtKCQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCJ0ciIpKTsKCiAgICAgIGlmIChkYXRhU291cmNlLnRvdGFsKCkgPiAxKSB7CiAgICAgICAgaWYgKGRhdGFJdGVtLmFtb3VudCAhPT0gMCB8fCBkYXRhSXRlbS50YXhOYW1lLnJhdGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgaWYgKGRhdGFJdGVtLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0gJ25ldCcpIHsKICAgICAgICAgICAgdGhpcy5hbW91bnROZXRWYXQgPSB0aGlzLmFtb3VudE5ldFZhdCAtIGRhdGFJdGVtLmFtb3VudDsKICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVUYXhEZWxldGUoZGF0YUl0ZW0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIGFtb3VudCA9IGRhdGFJdGVtLmFtb3VudCAvICgxICsgZGF0YUl0ZW0udGF4TmFtZS5yYXRlIC8gMTAwKTsKICAgICAgICAgICAgdGhpcy5hbW91bnRJbmNsdXNpdmVWYXQgPSB0aGlzLmFtb3VudEluY2x1c2l2ZVZhdCAtIGFtb3VudDsKICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVUYXhEZWxldGUoZGF0YUl0ZW0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZGF0YVNvdXJjZS5yZW1vdmUoZGF0YUl0ZW0pOwogICAgICB9CiAgICB9LAogICAgY2FsY3VsYXRlVGF4RGVsZXRlOiBmdW5jdGlvbiBjYWxjdWxhdGVUYXhEZWxldGUoZGF0YVJvdykgewogICAgICB2YXIgdmF0VGF4ID0gMDsKCiAgICAgIGlmIChkYXRhUm93LnRheE5hbWUpIHsKICAgICAgICB2YXIgYW10ID0gZGF0YVJvdy5hbW91bnQ7CiAgICAgICAgdmF0VGF4ID0gdGhpcy5hdXRvQ2FsY3VsYXRlVGF4KGRhdGFSb3cudGF4TmFtZSwgYW10KTsKICAgICAgfQoKICAgICAgdGhpcy50b3RhbFZhdCA9IHRoaXMudG90YWxWYXQgLSB2YXRUYXg7CiAgICB9LAogICAgc3BlY2lmaWNUYXhEcm9wZG93bkVkaXRvcjogZnVuY3Rpb24gc3BlY2lmaWNUYXhEcm9wZG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykuYXBwZW5kVG8oY29udGFpbmVyKS5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgYXV0b0JpbmQ6IGZhbHNlLAogICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICBoZWlnaHQ6IDMwMCwKICAgICAgICBkYXRhVGV4dEZpZWxkOiAiZGVmYXVsdFRheCIsCiAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgZGF0YVNvdXJjZTogewogICAgICAgICAgZGF0YTogdGhpcy50eXBlUHJvZHVjdFRheC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGl0ZW0udHJhbnNhY3Rpb25UeXBlLnRvTG93ZXJDYXNlKCkgPT09ICJzYWxlIiAmJiBpdGVtLnRheFR5cGUudHlwZUlkID09PSA4ICYmIGl0ZW0uYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpID09PSBvcHRpb25zLm1vZGVsLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKTsKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KTsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKG9wdGlvbnMubW9kZWwuYmFzZUFtb3VudCk7CiAgICB9LAogICAgcHVibGljVGF4RHJvcGRvd25FZGl0b3I6IGZ1bmN0aW9uIHB1YmxpY1RheERyb3Bkb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKS5hcHBlbmRUbyhjb250YWluZXIpLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICBhdXRvQmluZDogZmFsc2UsCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgIGhlaWdodDogMzAwLAogICAgICAgIGRhdGFUZXh0RmllbGQ6ICJkZWZhdWx0VGF4IiwKICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICBkYXRhU291cmNlOiB7CiAgICAgICAgICBkYXRhOiB0aGlzLnR5cGVQcm9kdWN0VGF4LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS50cmFuc2FjdGlvblR5cGUudG9Mb3dlckNhc2UoKSA9PT0gInNhbGUiICYmIGl0ZW0udGF4VHlwZS50eXBlSWQgPT09IDkgJiYgaXRlbS5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09IG9wdGlvbnMubW9kZWwuYmFzZUFtb3VudC50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGFjY29tVGF4RHJvcGRvd25FZGl0b3I6IGZ1bmN0aW9uIGFjY29tVGF4RHJvcGRvd25FZGl0b3IoY29udGFpbmVyLCBvcHRpb25zKSB7CiAgICAgIGtlbmRvLmpRdWVyeSgnPGlucHV0IG5hbWU9IicgKyBvcHRpb25zLmZpZWxkICsgJyIvPicpLmFwcGVuZFRvKGNvbnRhaW5lcikua2VuZG9Ecm9wRG93bkxpc3QoewogICAgICAgIGF1dG9CaW5kOiBmYWxzZSwKICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgaGVpZ2h0OiAzMDAsCiAgICAgICAgZGF0YVRleHRGaWVsZDogImRlZmF1bHRUYXgiLAogICAgICAgIGRhdGFWYWx1ZUZpZWxkOiAiaWQiLAogICAgICAgIG9wdGlvbkxhYmVsOiAiLS0tIFNlbGVjdCAtLS0iLAogICAgICAgIGRhdGFTb3VyY2U6IHsKICAgICAgICAgIGRhdGE6IHRoaXMudHlwZVByb2R1Y3RUYXguZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRyYW5zYWN0aW9uVHlwZS50b0xvd2VyQ2FzZSgpID09PSAic2FsZSIgJiYgaXRlbS50YXhUeXBlLnR5cGVJZCA9PT0gNyAmJiBpdGVtLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0gb3B0aW9ucy5tb2RlbC5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgdHlwZVByb2R1Y3RUYXhEcm9wZG93bkVkaXRvcjogZnVuY3Rpb24gdHlwZVByb2R1Y3RUYXhEcm9wZG93bkVkaXRvcihjb250YWluZXIsIG9wdGlvbnMpIHsKICAgICAgLy8gY29uc3QgdHBsID0gdGhpcy50eXBlUHJvZHVjdExpc3QKICAgICAga2VuZG8ualF1ZXJ5KCc8aW5wdXQgcmVxdWlyZWQgbmFtZT0iJyArIG9wdGlvbnMuZmllbGQgKyAnIi8+JykuYXBwZW5kVG8oY29udGFpbmVyKS5rZW5kb0Ryb3BEb3duTGlzdCh7CiAgICAgICAgYXV0b0JpbmQ6IGZhbHNlLAogICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICBoZWlnaHQ6IDMwMCwKICAgICAgICBkYXRhVGV4dEZpZWxkOiAiZGVmYXVsdFRheCIsCiAgICAgICAgZGF0YVZhbHVlRmllbGQ6ICJpZCIsCiAgICAgICAgb3B0aW9uTGFiZWw6ICItLS0gU2VsZWN0IC0tLSIsCiAgICAgICAgZGF0YVNvdXJjZTogewogICAgICAgICAgZGF0YTogdGhpcy50eXBlUHJvZHVjdFRheC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGl0ZW0udHJhbnNhY3Rpb25UeXBlLnRvTG93ZXJDYXNlKCkgPT09ICJzYWxlIiAmJiBpdGVtLnRheFR5cGUudHlwZUlkID09PSAxOwogICAgICAgICAgfSksCiAgICAgICAgICBncm91cDogewogICAgICAgICAgICBmaWVsZDogImJhc2VBbW91bnQiCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBlZGl0YWJsZVNQOiBmdW5jdGlvbiBlZGl0YWJsZVNQKGRhdGFJdGVtKSB7CiAgICAgIHJldHVybiBkYXRhSXRlbS5iYXNlQW1vdW50ID09PSAiTmV0IiB8fCBkYXRhSXRlbS5iYXNlQW1vdW50ID09PSAiaW5jbHVzaXZlIjsKICAgIH0sCiAgICBlZGl0YWJsZUFUOiBmdW5jdGlvbiBlZGl0YWJsZUFUKGRhdGFJdGVtKSB7CiAgICAgIHJldHVybiBkYXRhSXRlbS5iYXNlQW1vdW50ID09PSAiTmV0IiB8fCBkYXRhSXRlbS5iYXNlQW1vdW50ID09PSAiaW5jbHVzaXZlIjsKICAgIH0sCiAgICBlZGl0YWJsZVBMOiBmdW5jdGlvbiBlZGl0YWJsZVBMKGRhdGFJdGVtKSB7CiAgICAgIHJldHVybiBkYXRhSXRlbS5iYXNlQW1vdW50ID09PSAiTmV0IiB8fCBkYXRhSXRlbS5iYXNlQW1vdW50ID09PSAiaW5jbHVzaXZlIjsKICAgIH0sCiAgICBhZGRSb3c6IGZ1bmN0aW9uIGFkZFJvdygpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICAgIHZhciBkcywgdG90YWw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkcyA9IF90aGlzMTEuJHJlZnMuZGF0YVNvdXJjZS5rZW5kb1dpZGdldCgpLCB0b3RhbCA9IGRzLnRvdGFsKCk7CiAgICAgICAgICAgICAgICBkcy5pbnNlcnQodG90YWwsIHsKICAgICAgICAgICAgICAgICAgdGF4TmFtZTogewogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUYXg6ICIiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHNwZWNpZmljVGF4OiB7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFRheDogIiIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcHViVGF4OiB7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFRheDogIiIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgYWNjb21UYXg6IHsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VGF4OiAiIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBiYXNlQW1vdW50OiAiIiwKICAgICAgICAgICAgICAgICAgYW1vdW50OiAwLAogICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogIiIKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9uQ2xvc2VTYWxlOiBmdW5jdGlvbiBvbkNsb3NlU2FsZSgpIHt9LAogICAgb25TYXZlQ2xvc2U6IGZ1bmN0aW9uIG9uU2F2ZUNsb3NlKCkgewogICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICAgICAgdmFyIGRhdGEsIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMTIuc2hvd0xvYWRpbmcgPSB0cnVlOyAvLyBhd2FpdCB0aGlzLmdldERhdGFTb3VyY2UoKQogICAgICAgICAgICAgICAgLy8gbGV0IGl0ZW1MaW5lID0gW10KCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMi5zYWxlLmN1c3RvbWVyLnRheFBheWVyVHlwZSA9PT0gJycpIHsKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMTIuc2FsZS5jdXN0b21lci50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICdpbmRpdmlkdWFsLWZvcmVpZ24nKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLnRheFBheWVyVHlwZSA9ICdQaHlzaWNhbCBQZXJzb24nOwogICAgICAgICAgICAgICAgICAgIF90aGlzMTIuc2FsZS5jdXN0b21lci5uYXR1cmVUYXhUeXBlID0gJ05vbi1SZXNpZGVudCc7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxMi5zYWxlLmN1c3RvbWVyLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ2ZvcmVpZ24gZW50aXR5JykgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTIuc2FsZS5jdXN0b21lci50YXhQYXllclR5cGUgPSAnTGVnYWwgUGVyc29uJzsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIubmF0dXJlVGF4VHlwZSA9ICdOb24tUmVzaWRlbnQnOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIuc2FsZS5jdXN0b21lci50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICdpbmRpdmlkdWFsLWxvY2FsJykgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTIuc2FsZS5jdXN0b21lci50YXhQYXllclR5cGUgPSAnUGh5c2ljYWwgUGVyc29uJzsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIubmF0dXJlVGF4VHlwZSA9ICdSZXNpZGVudCc7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMxMi5zYWxlLmN1c3RvbWVyLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ25vbi10YXhhYmxlIGVudGl0eScpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIudGF4UGF5ZXJUeXBlID0gJ0xlZ2FsIFBlcnNvbic7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLm5hdHVyZVRheFR5cGUgPSAnUmVzaWRlbnQnOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIuc2FsZS5jdXN0b21lci50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICd0YXhhYmxlIGVudGl0eScpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIudGF4UGF5ZXJUeXBlID0gJ0xlZ2FsIFBlcnNvbic7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLmN1c3RvbWVyLm5hdHVyZVRheFR5cGUgPSAnUmVzaWRlbnQnOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBfdGhpczEyLnNhbGUuY3VzdG9tZXIuY3VzdG9tZXJJZCA9IF90aGlzMTIuc2FsZS5jdXN0b21lci5jcm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKF90aGlzMTIuaXRlbUxpbmVzLCBfdGhpczEyLnNhbGUuaXRlbUxpbmUsICdpdGVtbGluZScpOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEyLml0ZW1MaW5lcy5sZW5ndGggPCAwIHx8IF90aGlzMTIuc2FsZS5pdGVtTGluZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczEyLnNhbGUuaXRlbUxpbmUsICdpdGVtbGluZSAxMjM0MTI0MTInKTsKICAgICAgICAgICAgICAgICAgX3RoaXMxMi5zYWxlLml0ZW1MaW5lID0gX3RoaXMxMi5zYWxlLml0ZW1MaW5lLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICB1aWQ6IGl0ZW0udWlkLAogICAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBpdGVtLmFtb3VudCwKICAgICAgICAgICAgICAgICAgICAgIGFtb3VudEluY2x1c2l2ZTogaXRlbS5hbW91bnRJbmNsdXNpdmUsCiAgICAgICAgICAgICAgICAgICAgICBhbW91bnROZXRWYXQ6IGl0ZW0uYW1vdW50TmV0VmF0LAogICAgICAgICAgICAgICAgICAgICAgYW1vdW50U3BlY2lmaWNUYXg6IGl0ZW0uYW1vdW50U3BlY2lmaWNUYXggfHwgMCwKICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0uaXRlbSwKICAgICAgICAgICAgICAgICAgICAgIHNwZWNpZmljVGF4OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0uc3BlY2lmaWNUYXggPyBpdGVtLnNwZWNpZmljVGF4LmRlZmF1bHRUYXggOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLnNwZWNpZmljVGF4ID8gaXRlbS5zcGVjaWZpY1RheC5hY2NvdW50ID8gaXRlbS5zcGVjaWZpY1RheC5hY2NvdW50LmlkIDogJycgOiAnJwogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIHB1YlRheDogewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLnB1YlRheCA/IGl0ZW0ucHViVGF4LmRlZmF1bHRUYXggOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLnB1YlRheCA/IGl0ZW0ucHViVGF4LmFjY291bnQgPyBpdGVtLnB1YlRheC5hY2NvdW50LmlkIDogJycgOiAnJwogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIGFjY29tVGF4OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0uYWNjb21UYXggPyBpdGVtLmFjY29tVGF4LmRlZmF1bHRUYXggOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiBpdGVtLmFjY29tVGF4ID8gaXRlbS5hY2NvbVRheC5hY2NvdW50ID8gaXRlbS5hY2NvbVRheC5hY2NvdW50LmlkIDogJycgOiAnJwogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIHZhdDogaXRlbS52YXQsCiAgICAgICAgICAgICAgICAgICAgICBhbW91bnRQdWJUYXg6IGl0ZW0uYW1vdW50UHViVGF4IHx8IDAsCiAgICAgICAgICAgICAgICAgICAgICBhbW91bnRBY2NvbVRheDogaXRlbS5hbW91bnRBY2NvbVRheCB8fCAwLAogICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGl0ZW0uZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgICB0YXhOYW1lOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0udGF4TmFtZS5kZWZhdWx0VGF4LAogICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IGl0ZW0udGF4TmFtZS5hY2NvdW50LmlkCiAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgYmFzZUFtb3VudDogaXRlbS5iYXNlQW1vdW50CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgaWQ6IF90aGlzMTIuc2FsZS5pZCA/IF90aGlzMTIuc2FsZS5pZCA6ICJtci0iLmNvbmNhdCh1dWlkLnYxKCkpLAogICAgICAgICAgICAgICAgICB0eXBlOiAnc2FsZScsCiAgICAgICAgICAgICAgICAgIGRhdGU6IF90aGlzMTIuc2FsZS5kYXRlLAogICAgICAgICAgICAgICAgICBtb250aGx5UmV0dXJuSWQ6IF90aGlzMTIubW9udGhseVJldHVybi5pZCwKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgICAgICAgICAgICByZWZlcmVuY2U6IF90aGlzMTIuc2FsZS5yZWZlcmVuY2UsCiAgICAgICAgICAgICAgICAgIG1vbnRoT2Y6IF90aGlzMTIubW9udGhseVJldHVybi5tb250aE9mLAogICAgICAgICAgICAgICAgICBjdXN0b21lcjogX3RoaXMxMi5zYWxlLmN1c3RvbWVyLAogICAgICAgICAgICAgICAgICB0b3RhbFZBVDogX3RoaXMxMi50b3RhbFZhdCwKICAgICAgICAgICAgICAgICAgdG90YWxBbW91bnRJbmNsdXNpdmU6IF90aGlzMTIuYW1vdW50SW5jbHVzaXZlVmF0LAogICAgICAgICAgICAgICAgICB0b3RhbEFtb3VudE5ldFZhdDogX3RoaXMxMi5hbW91bnROZXRWYXQsCiAgICAgICAgICAgICAgICAgIHRvdGFsU3BlY2lmaWNUYXg6IF90aGlzMTIuYW1vdW50U3AsCiAgICAgICAgICAgICAgICAgIHRvdGFsUHViVGF4OiBfdGhpczEyLmFtb3VudFBsdCwKICAgICAgICAgICAgICAgICAgdG90YWxBY2NvbVRheDogX3RoaXMxMi5hbW91bnRBdCwKICAgICAgICAgICAgICAgICAgaXRlbUxpbmU6IF90aGlzMTIuaXRlbUxpbmVzLmxlbmd0aCA+IDAgPyBfdGhpczEyLml0ZW1MaW5lcyA6IF90aGlzMTIuc2FsZS5pdGVtTGluZSwKICAgICAgICAgICAgICAgICAgaXNTYXZlOiBfdGhpczEyLnNhbGUuaXNTYXZlIHx8IGZhbHNlLAogICAgICAgICAgICAgICAgICBzdGF0dXM6IF90aGlzMTIuJHJvdXRlLnF1ZXJ5LnR5cGUgPT09ICdFZGl0JyA/IDIgOiAxLAogICAgICAgICAgICAgICAgICBkYXRhU291cmNlOiBfdGhpczEyLiRyb3V0ZS5xdWVyeS50eXBlID09PSAnRWRpdCcgPyBfdGhpczEyLnNhbGUuZGF0YVNvdXJjZSA6IHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiAiTWFudWFsbHkiLAogICAgICAgICAgICAgICAgICAgIGlkOiAyCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU2FsZVJlY29yZChkYXRhKTsKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhyZXN1bHQsICdkYXRhMTIzJyk7CgogICAgICAgICAgICAgICAgX3RoaXMxMi4kc3RvcmUuZGlzcGF0Y2goJ2NvbXBsaWFuY2UvcHVzaFNhbGUnLCByZXN1bHQpOyAvLyBsZXQgcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5tb250aGx5UmV0dXJuLm51bWJlciArICcmU2FsZScpKQogICAgICAgICAgICAgICAgLy8gaWYgKHMpIHsKICAgICAgICAgICAgICAgIC8vICAgICBpZiAocy5sZW5ndGggPD0gMCkgewogICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAodGhpcy5tb250aGx5UmV0dXJuLmFiYnIgIT09ICcnICYmIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm1vbnRobHlSZXR1cm4uYWJiciArIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgKyAnJlNhbGUnLCBKU09OLnN0cmluZ2lmeShkYXRhKSkKICAgICAgICAgICAgICAgIC8vICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgIC8vIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgLy8gICAgICAgICAvLyAgICAgY29uc3QgZXhpc3QgPSBzLmZpbHRlcihwID0+IHAuaWQgPT09IGRhdGFbaV0uaWQpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIC8vIH0KICAgICAgICAgICAgICAgIC8vICAgICAgICAgY29uc3QgYWxsQXJyYXkgPSBbLi4ucywgLi4uZGF0YV0KICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmVzdWx0cyA9IGFsbEFycmF5LmZpbHRlcigoZSwgaSkgPT4gYWxsQXJyYXkuZmluZEluZGV4KG8gPT4gby50b3RhbEFtb3VudEluY2x1c2l2ZSA9PT0gZS50b3RhbEFtb3VudEluY2x1c2l2ZSAmJiBvLnRvdGFsVkFUID09PSBlLnRvdGFsVkFUICYmIG8udG90YWxBbW91bnROZXRWYXQgPT09IGUudG90YWxBbW91bnROZXRWYXQgJiYgby50b3RhbFNwZWNpZmljVGF4ID09PSBlLnRvdGFsU3BlY2lmaWNUYXggJiYgby50b3RhbFB1YlRheCA9PT0gZS50b3RhbFB1YlRheCAmJiBvLnRvdGFsQWNjb21UYXggPT09IGUudG90YWxBY2NvbVRheCkgPT09IGkpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhyZXN1bHRzLCAnMzQ1NjcnKQogICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAodGhpcy5tb250aGx5UmV0dXJuLmFiYnIgIT09ICcnICYmIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm1vbnRobHlSZXR1cm4uYWJiciArIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgKyAnJlNhbGUnLCBKU09OLnN0cmluZ2lmeShyZXN1bHRzKSkKICAgICAgICAgICAgICAgIC8vICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gICAgIH0KICAgICAgICAgICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5tb250aGx5UmV0dXJuLmFiYnIgKyB0aGlzLm1vbnRobHlSZXR1cm4ubnVtYmVyICsgJyZTYWxlJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpCiAgICAgICAgICAgICAgICAvLyB9CgoKICAgICAgICAgICAgICAgIF90aGlzMTIuc2hvd0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTIub25DbG9zZSgpOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTEpOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/compliance/monthly_tax/new_tax_return/input/add_sale/_add_sale.js"],"names":["SaleRecord","kendo","DropDownList","LoadingMe","uuid","ItemLineSale","$","require","SaleModel","textField","keyField","defaultItem","emptyItem","customerHandler","taxSetting","taxSettingHandler","apiUrl","monthlyReturnHandler","saleHandler","name","components","mixins","props","data","dialogTax","showLoading","sale","menuJDateAddSale","txn_date","Date","toISOString","substr","itemLines","filter","dataItemKey","cusBaseUrl","search","customerList","amt","totalVat","amountSp","amountPlt","amountAt","amountVat","amountInclusiveVat","amountNetVat","monthlyReturn","computed","typeProductTax","default","state","listTax","id","$route","query","s_id","undefined","watch","created","mounted","initData","loadListTax","loadData","methods","params","onLoadOneReturn","window","console","log","clear","onloadOneSale","i","itemLine","taxName","p","defaultTax","specificTax","pubTax","accomTax","push","vat","length","totalAmountInclusive","totalAmountNetVat","totalSpecificTax","totalPubTax","totalAccomTax","totalVAT","clearSale","addRow","Promise","resolve","setTimeout","getOne","then","res","get","tax_setting","tax_list_get","onCustomerFilterChanged","event","value","skip","baseUrl","url","requestStarted","fetch","response","json","afterFetch","onChange","customer","onClose","history","go","numberFormat","toString","decimalFormat","disableEditor","onDataSourceChanges","e","field","dataRow","items","set","baseAmount","amount","calculateTax","hasOwnProperty","ds","$refs","dataSource","kendoWidget","spTax","pltTax","atTax","vatTax","totalTax","totalSp","totalPlt","totalAt","totalInclusive","totalNet","amountInc","amountNet","forEach","item","autoCalculateTax","parseFloat","toLowerCase","rate","map","index","uid","splice","amountInclusive","amountSpecificTax","accountId","account","amountPubTax","amountAccomTax","description","tax","formula","inAmt","nAmt","taxBase","total","eval","rowNumberTmpl","dataItem","indexOf","removeRow","preventDefault","grid","jQuery","currentTarget","closest","calculateTaxDelete","remove","specificTaxDropdownEditor","container","options","appendTo","kendoDropDownList","autoBind","autoWidth","height","dataTextField","dataValueField","optionLabel","transactionType","taxType","typeId","model","publicTaxDropdownEditor","accomTaxDropdownEditor","typeProductTaxDropdownEditor","group","editableSP","editableAT","editablePL","insert","onCloseSale","onSaveClose","taxPayerType","type","natureTaxType","customerId","crn","v1","date","monthlyReturnId","reference","monthOf","isSave","status","result","$store","dispatch"],"mappings":"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","sourcesContent":["/*\n * Last modified : 3/27/21, 11:12 AM in Project banhji-accounting-web-module\n * Copyright (c) 2021. Chandarith Chea under Company BanhJi Fintech Co., Ltd\n * Facebook Profile : https://www.facebook.com/profile.php?id=100011194806947\n * Github Profile : https://github.com/Darith-Mokpost\n * Instagram Profile : https://www.instagram.com/chandarith_chea\n */\n\n// @vue/component\nimport SaleRecord from \"@/scripts/compliance/model/SaleRecord\";\nimport kendo from \"@progress/kendo-ui\";\nimport {DropDownList} from \"@progress/kendo-vue-dropdowns\";\nimport LoadingMe from \"@/components/Loading\";\nimport {uuid} from 'vue-uuid'\nimport ItemLineSale from \"@/scripts/compliance/model/itemLineSale\";\n\nconst $ = require(\"jquery\")\nconst SaleModel = new SaleRecord({})\nconst textField = 'numberName'\nconst keyField = 'id'\nconst defaultItem = {[textField]: 'Select customer...', [keyField]: null}\nconst emptyItem = {[textField]: 'loading ...'}\nconst customerHandler = require(\"@/scripts/customerHandler\")\nconst taxSetting = require('@/store/taxSetting');\nconst taxSettingHandler = require(\"@/scripts/taxSettingHandler\")\nconst apiUrl = require('@/apiUrl')\nconst monthlyReturnHandler = require(\"@/scripts/compliance/handler/monthlyReturnHandler\")\nconst saleHandler = require(\"@/scripts/compliance/handler/saleHandler\")\n\nexport default {\n    name: 'Add_sale',\n\n    components: {\n        'dropdownlist': DropDownList,\n        'LoadingMe': LoadingMe,\n    },\n\n    mixins: [],\n\n    props: {},\n\n    data() {\n        return {\n            dialogTax: false,\n            showLoading: false,\n            sale: SaleModel,\n            menuJDateAddSale: false,\n            txn_date: new Date().toISOString().substr(0, 10),\n            itemLines: [],\n            filter: '',\n            textField: 'numberName',\n            dataItemKey: 'id',\n            defaultItem: defaultItem,\n            cusBaseUrl: customerHandler.search(),\n            customerList: [],\n\n            amt: [],\n            totalVat: 0,\n            amountSp: 0,\n            amountPlt: 0,\n            amountAt: 0,\n            amountVat: 0,\n            amountInclusiveVat: 0,\n            amountNetVat: 0,\n            monthlyReturn: {},\n        }\n    },\n\n    computed: {\n        typeProductTax() {\n            return taxSetting.default.state.listTax\n        },\n        id() {\n            if (this.$route.query.s_id !== undefined) {\n                return this.$route.query.s_id\n            } else {\n                return ''\n            }\n        }\n    },\n\n    watch: {\n        'id': 'initData'\n    },\n\n    created() {\n    },\n    async mounted() {\n        await this.initData()\n        await this.loadListTax()\n        await this.loadData(0, '', this.cusBaseUrl)\n    },\n\n    methods: {\n        async initData() {\n            this.showLoading = true\n            if (this.$route.params.id !== undefined && this.$route.params.monthlyReturn === undefined) {\n                await this.onLoadOneReturn()\n                window.console.log(this.$route.params)\n            } else if (this.$route.params.monthlyReturn !== undefined) {\n                this.monthlyReturn = this.$route.params.monthlyReturn\n            } else {\n                this.clear()\n            }\n\n            if (this.$route.query.s_id !== undefined && this.$route.params.sale === undefined) {\n                await this.onloadOneSale()\n            } else if (this.$route.params.sale !== undefined) {\n                this.sale = this.$route.params.sale\n                window.console.log(this.sale, 'list tax')\n                const itemLines = []\n                for (let i =0; i < this.sale.itemLine.length; i++) {\n                    this.sale.itemLine[i].taxName = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].taxName.name)[0]\n                    if (this.sale.itemLine[i].specificTax.name === undefined) {\n                        this.sale.itemLine[i].specificTax = {defaultTax: ''}\n                    } else {\n                        this.sale.itemLine[i].specificTax = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].specificTax.name)[0]\n                    }\n                    if (this.sale.itemLine[i].pubTax.name === undefined) {\n                        this.sale.itemLine[i].pubTax = {defaultTax: ''}\n                    } else {\n                        this.sale.itemLine[i].pubTax = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].pubTax.name)[0]\n                    }\n                    if (this.sale.itemLine[i].accomTax.name === undefined) {\n                        this.sale.itemLine[i].accomTax = {defaultTax: ''}\n                    } else {\n                        this.sale.itemLine[i].accomTax = this.typeProductTax.filter(p => p.defaultTax === this.sale.itemLine[i].accomTax.name)[0]\n                    }\n                    itemLines.push(new ItemLineSale(this.sale.itemLine[i]))\n\n                    this.amountVat += this.sale.itemLine[i].vat || 0\n                }\n                window.console.log(itemLines, 'itemlines')\n                this.sale.itemLine = itemLines\n                this.amountInclusiveVat = this.sale.totalAmountInclusive || 0\n                this.amountNetVat = this.sale.totalAmountNetVat || 0\n                this.amountSp = this.sale.totalSpecificTax || 0\n                this.amountPlt = this.sale.totalPubTax || 0\n                this.amountAt = this.sale.totalAccomTax || 0\n                this.totalVat = this.sale.totalVAT || 0\n                window.console.log(this.typeProductTax, this.sale.itemLine, 'list tax 123')\n            } else {\n                await this.clearSale()\n            }\n\n            if (this.sale.totalAmountInclusive !== 0) {\n                this.amountSp = this.sale.totalSpecificTax\n                this.amountPlt = this.sale.totalPubTax\n                this.amountAt = this.sale.totalAccomTax\n                this.totalVat = this.sale.totalVAT\n            } else {\n                if (this.sale.itemLine.length === 0) {\n                    await this.addRow()\n                }\n            }\n            this.showLoading = false\n        },\n        async clearSale() {\n            this.sale = new SaleRecord({})\n            this.itemLines = []\n            this.totalVat = 0\n            this.amountInclusiveVat = 0\n            this.amountNetVat = 0\n            this.amountPlt = 0\n            this.amountSp = 0\n            this.amountAt = 0\n            this.amountVat = 0\n        },\n        async onloadOneSale() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    const id = this.$route.params.id\n                    saleHandler.getOne(id).then(res => {\n                        this.sale = res.data.data[0]\n                    })\n                })\n            })\n        },\n        async onLoadOneReturn() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    const id = this.$route.params.id\n                    monthlyReturnHandler.getOne(id).then(res => {\n                        this.monthlyReturn = res.data.data.length > 0 ? res.data.data[0] : []\n                    })\n                })\n            })\n        },\n        async loadListTax() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    taxSettingHandler.get(apiUrl.tax_setting.tax_list_get, \"listTax\", \"setListTax\")\n                    window.console.log(this.sale.itemLine, 'sale')\n                    this.itemLine = this.sale.itemLine\n                }, 100)\n            })\n        },\n        async onCustomerFilterChanged(event) {\n            const filter = event.filter.value\n            await this.loadData(0, filter, this.cusBaseUrl)\n            this.filter = filter\n        },\n        async loadData(skip, filter, baseUrl) {\n            const url = baseUrl +\n                `?filter=${filter}`\n            this.requestStarted = true;\n            fetch(url)\n                .then((response) => {\n                    return response.json()\n                })\n                .then(this.afterFetch)\n        },\n        afterFetch(json) {\n            this.customerList = json.data\n        },\n        onChange(event) {\n            const value = event.value\n            if (value && value[textField] === emptyItem[textField]) {\n                return;\n            }\n            this.sale.customer = value\n            window.console.log(value, 'customer')\n        },\n\n        async onClose() {\n            await this.clearSale()\n            // await this.$router.replace('/new_tax_return/' + this.$route.params.id)\n            window.history.go(-1)\n        },\n        numberFormat(value) {\n            // window.console.log(this.saleFormContent.decimal,'nimol')\n            return kendo.toString(value, `${this.sale.decimalFormat}`)\n        },\n        disableEditor() {\n            return false;\n        },\n        onDataSourceChanges(e) {\n            if (e.field) {\n                let dataRow = e.items[0]\n                switch (e.field) {\n                    case \"taxName\":\n                        dataRow.set(\"baseAmount\", dataRow.taxName.baseAmount)\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"specificTax\":\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"pubTax\":\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"accomTax\":\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"amount\":\n                        if (dataRow.taxName.hasOwnProperty('defaultTax')) {\n                            this.calculateTax()\n                        }\n                        break\n                    default:\n                        break\n                }\n            }\n        },\n        calculateTax() {\n            let ds = this.$refs.dataSource.kendoWidget()\n            let dataRow = ds.data(),\n                spTax = 0, pltTax = 0, atTax = 0, vatTax = 0, totalTax = 0,\n                totalSp = 0, totalPlt = 0, totalAt = 0, totalInclusive = 0, totalNet = 0, amountInc = 0, amountNet = 0\n            window.console.log(dataRow, 'dataRow123')\n            dataRow.forEach(item => {\n                window.console.log(item)\n                if (item.specificTax) {\n                    spTax = this.autoCalculateTax(item.specificTax, item.amount)\n                }\n                if (item.pubTax) {\n                    pltTax = this.autoCalculateTax(item.pubTax, (item.amount))\n                }\n                if (item.accomTax) {\n                    atTax = this.autoCalculateTax(item.accomTax, (item.amount))\n                }\n                if (item.taxName) {\n                    let amt = kendo.parseFloat(spTax) + kendo.parseFloat(pltTax) + kendo.parseFloat(atTax) + (item.amount)\n                    vatTax = this.autoCalculateTax(item.taxName, amt)\n                }\n                if (item.baseAmount.toLowerCase() === \"inclusive\") {\n                    amountInc = item.amount / (1 + (item.taxName.rate / 100))\n                } else {\n                    amountNet = item.amount\n                }\n                this.itemLines.map((i, index) => {\n                    if (i.uid === item.uid) {\n                        this.itemLines.splice(index, 1)\n                    }\n                })\n                this.itemLines.push({\n                    uid: item.uid,\n                    amount: item.amount,\n                    amountInclusive: amountInc,\n                    amountNetVat: amountNet,\n                    amountSpecificTax: spTax || 0,\n                    item: item.item,\n                    specificTax: {name: item.specificTax ? item.specificTax.defaultTax : '', accountId: item.specificTax ? item.specificTax.account ? item.specificTax.account.id : '' : ''},\n                    pubTax: {name: item.pubTax ? item.pubTax.defaultTax : '', accountId: item.pubTax ? item.pubTax.account ? item.pubTax.account.id : '' : ''},\n                    accomTax: {name: item.accomTax ? item.accomTax.defaultTax : '', accountId: item.accomTax ? item.accomTax.account ? item.accomTax.account.id : '' : ''},\n                    vat: vatTax,\n                    amountPubTax: pltTax || 0,\n                    amountAccomTax: atTax || 0,\n                    description: item.description,\n                    taxName: {name: item.taxName.defaultTax, accountId: item.taxName.account.id},\n                    baseAmount: item.baseAmount,\n                })\n                totalTax += kendo.parseFloat(spTax) + kendo.parseFloat(pltTax) + kendo.parseFloat(atTax) + kendo.parseFloat(vatTax)\n                totalInclusive += kendo.parseFloat(amountInc)\n                totalNet += kendo.parseFloat(amountNet)\n                totalSp += kendo.parseFloat(spTax)\n                totalPlt += kendo.parseFloat(pltTax)\n                totalAt += kendo.parseFloat(atTax)\n            })\n            this.totalVat = totalTax\n            this.amountSp = totalSp\n            this.amountPlt = totalPlt\n            this.amountAt = totalAt\n            this.amountInclusiveVat = totalInclusive\n            this.amountNetVat = totalNet\n\n            window.console.log(totalTax)\n            window.console.log('result', this.amt)\n        },\n        autoCalculateTax(tax, amount) {\n            window.console.log(tax, 'tax')\n            if (tax) {\n                let formula = tax.formula,\n                    inAmt = kendo.parseFloat(amount),\n                    nAmt = kendo.parseFloat(amount),\n                    taxBase = kendo.parseFloat(tax.taxBase) / 100,\n                    rate = kendo.parseFloat(tax.rate) / 100,\n                    total = eval(formula)\n                window.console.log(inAmt, nAmt, taxBase, rate, formula, total)\n                return total\n            }\n        },\n        // Auto Increase number\n        rowNumberTmpl(dataItem) {\n            let ds = this.$refs.dataSource.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        // Remove Row\n        removeRow(e) {\n            e.preventDefault();\n            let grid = kendo.jQuery(\"#grid\").data(\"kendoGrid\"),\n                dataSource = grid.dataSource,\n                dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n            if (dataSource.total() > 1) {\n                if (dataItem.amount !== 0 || dataItem.taxName.rate !== undefined) {\n                    if (dataItem.baseAmount.toLowerCase() === 'net') {\n                        this.amountNetVat = this.amountNetVat - dataItem.amount\n                        this.calculateTaxDelete(dataItem)\n                    }else {\n                        let amount = dataItem.amount / (1 + (dataItem.taxName.rate / 100))\n                        this.amountInclusiveVat = this.amountInclusiveVat - amount\n                        this.calculateTaxDelete(dataItem)\n                    }\n                }\n                dataSource.remove(dataItem);\n            }\n        },\n        calculateTaxDelete(dataRow) {\n            let vatTax = 0\n            if (dataRow.taxName) {\n                let amt = dataRow.amount\n                vatTax = this.autoCalculateTax(dataRow.taxName, amt)\n            }\n            this.totalVat = this.totalVat - vatTax\n        },\n        specificTaxDropdownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\"\n                            && item.taxType.typeId === 8 && item.baseAmount.toLowerCase() === options.model.baseAmount.toLowerCase())\n                    }\n                });\n            window.console.log(options.model.baseAmount)\n        },\n        publicTaxDropdownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\"\n                            && item.taxType.typeId === 9 && item.baseAmount.toLowerCase() === options.model.baseAmount.toLowerCase())\n                    }\n                });\n        },\n        accomTaxDropdownEditor(container, options) {\n            kendo.jQuery('<input name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\"\n                            && item.taxType.typeId === 7 && item.baseAmount.toLowerCase() === options.model.baseAmount.toLowerCase())\n                    }\n                });\n        },\n        typeProductTaxDropdownEditor(container, options) {\n            // const tpl = this.typeProductList\n            kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"sale\" && item.taxType.typeId === 1),\n                        group: {\n                            field: \"baseAmount\"\n                        }\n                    }\n                });\n        },\n        editableSP(dataItem) {\n            return dataItem.baseAmount === \"Net\" || dataItem.baseAmount === \"inclusive\"\n        },\n        editableAT(dataItem) {\n            return dataItem.baseAmount === \"Net\" || dataItem.baseAmount === \"inclusive\"\n        },\n        editablePL(dataItem) {\n            return dataItem.baseAmount === \"Net\" || dataItem.baseAmount === \"inclusive\"\n        },\n        async addRow() {\n            let ds = this.$refs.dataSource.kendoWidget(),\n                total = ds.total();\n            ds.insert(total, {\n                taxName: {defaultTax: \"\"},\n                specificTax: {defaultTax: \"\"},\n                pubTax: {defaultTax: \"\"},\n                accomTax: {defaultTax: \"\"},\n                baseAmount: \"\",\n                amount: 0,\n                description: \"\",\n            });\n        },\n        onCloseSale() {\n        },\n        async onSaveClose() {\n            this.showLoading = true\n            // await this.getDataSource()\n            // let itemLine = []\n            if (this.sale.customer.taxPayerType === '') {\n                if (this.sale.customer.type.toLowerCase() === 'individual-foreign') {\n                    this.sale.customer.taxPayerType = 'Physical Person'\n                    this.sale.customer.natureTaxType = 'Non-Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'foreign entity') {\n                    this.sale.customer.taxPayerType = 'Legal Person'\n                    this.sale.customer.natureTaxType = 'Non-Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'individual-local') {\n                    this.sale.customer.taxPayerType = 'Physical Person'\n                    this.sale.customer.natureTaxType = 'Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'non-taxable entity') {\n                    this.sale.customer.taxPayerType = 'Legal Person'\n                    this.sale.customer.natureTaxType = 'Resident'\n                } else if (this.sale.customer.type.toLowerCase() === 'taxable entity') {\n                    this.sale.customer.taxPayerType = 'Legal Person'\n                    this.sale.customer.natureTaxType = 'Resident'\n                }\n                this.sale.customer.customerId = this.sale.customer.crn\n            }\n            window.console.log(this.itemLines, this.sale.itemLine, 'itemline')\n            if (this.itemLines.length < 0 || this.sale.itemLine.length > 0) {\n                window.console.log(this.sale.itemLine, 'itemline 123412412')\n               this.sale.itemLine = this.sale.itemLine.map(item => {\n                    return {\n                        uid: item.uid,\n                        amount: item.amount,\n                        amountInclusive: item.amountInclusive,\n                        amountNetVat: item.amountNetVat,\n                        amountSpecificTax: item.amountSpecificTax || 0,\n                        item: item.item,\n                        specificTax: {name: item.specificTax ? item.specificTax.defaultTax : '', accountId: item.specificTax ? item.specificTax.account ? item.specificTax.account.id : '' : ''},\n                        pubTax: {name: item.pubTax ? item.pubTax.defaultTax : '', accountId: item.pubTax ? item.pubTax.account ? item.pubTax.account.id : '' : ''},\n                        accomTax: {name: item.accomTax ? item.accomTax.defaultTax : '', accountId: item.accomTax ? item.accomTax.account ? item.accomTax.account.id : '' : ''},\n                        vat: item.vat,\n                        amountPubTax: item.amountPubTax|| 0,\n                        amountAccomTax: item.amountAccomTax || 0,\n                        description: item.description,\n                        taxName: {name: item.taxName.defaultTax, accountId: item.taxName.account.id},\n                        baseAmount: item.baseAmount,\n                    }\n                })\n            }\n            const data = {\n                id: this.sale.id ? this.sale.id : `mr-${uuid.v1()}`,\n                type: 'sale',\n                date: this.sale.date,\n                monthlyReturnId: this.monthlyReturn.id,\n                description: '',\n                reference: this.sale.reference,\n                monthOf: this.monthlyReturn.monthOf,\n                customer: this.sale.customer,\n                totalVAT: this.totalVat,\n                totalAmountInclusive: this.amountInclusiveVat,\n                totalAmountNetVat: this.amountNetVat,\n                totalSpecificTax: this.amountSp,\n                totalPubTax: this.amountPlt,\n                totalAccomTax: this.amountAt,\n                itemLine: this.itemLines.length > 0 ? this.itemLines : this.sale.itemLine,\n                isSave: this.sale.isSave || false,\n                status: this.$route.query.type === 'Edit' ? 2 : 1,\n                dataSource: this.$route.query.type === 'Edit' ? this.sale.dataSource : {name: \"Manually\", id: 2},\n            }\n            const result = new SaleRecord(data)\n            window.console.log(result, 'data123')\n            this.$store.dispatch('compliance/pushSale', result)\n            // let s = JSON.parse(localStorage.getItem(this.monthlyReturn.number + '&Sale'))\n            // if (s) {\n            //     if (s.length <= 0) {\n            //         if (this.monthlyReturn.abbr !== '' && this.monthlyReturn.number !== '') {\n            //             localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Sale', JSON.stringify(data))\n            //         }\n            //     } else {\n            //         // for (let i = 0; i < data.length; i++) {\n            //         //     const exist = s.filter(p => p.id === data[i].id)\n            //         // }\n            //         const allArray = [...s, ...data]\n            //         results = allArray.filter((e, i) => allArray.findIndex(o => o.totalAmountInclusive === e.totalAmountInclusive && o.totalVAT === e.totalVAT && o.totalAmountNetVat === e.totalAmountNetVat && o.totalSpecificTax === e.totalSpecificTax && o.totalPubTax === e.totalPubTax && o.totalAccomTax === e.totalAccomTax) === i)\n            //         window.console.log(results, '34567')\n            //         if (this.monthlyReturn.abbr !== '' && this.monthlyReturn.number !== '') {\n            //             localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Sale', JSON.stringify(results))\n            //         }\n            //     }\n            // } else {\n            //     localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Sale', JSON.stringify(data))\n            // }\n            this.showLoading = false\n            await this.onClose()\n            // await saleHandler.create(data).then(res => {\n            //     this.showLoading = false\n            //     this.onClose()\n            //     window.console.log(res, 'create sale')\n            // }).catch(e => {\n            //     window.console.error(e)\n            // })\n        },\n    }\n}\n"]}]}