{"remainingRequest":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/eslint-loader/index.js??ref--13-0!/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/compliance/monthly_tax/new_tax_return/input/add_purchase/_add_purchase.js?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/compliance/monthly_tax/new_tax_return/input/add_purchase/_add_purchase.js","mtime":1638499443165},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYWNvcy9EZXNrdG9wL2JhbmhqaS0wLjIvYmFuaGppLWFjY291bnRpbmctd2ViLW1vZHVsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL21hY29zL0Rlc2t0b3AvYmFuaGppLTAuMi9iYW5oamktYWNjb3VudGluZy13ZWItbW9kdWxlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7Cgp2YXIgX2RlZmF1bHRJdGVtOwoKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKCi8qCiAqIExhc3QgbW9kaWZpZWQgOiAzLzMwLzIxLCA5OjUyIEFNIGluIFByb2plY3QgYmFuaGppLWFjY291bnRpbmctd2ViLW1vZHVsZQogKiBDb3B5cmlnaHQgKGMpIDIwMjEuIENoYW5kYXJpdGggQ2hlYSB1bmRlciBDb21wYW55IEJhbmhKaSBGaW50ZWNoIENvLiwgTHRkCiAqIEZhY2Vib29rIFByb2ZpbGUgOiBodHRwczovL3d3dy5mYWNlYm9vay5jb20vcHJvZmlsZS5waHA/aWQ9MTAwMDExMTk0ODA2OTQ3CiAqIEdpdGh1YiBQcm9maWxlIDogaHR0cHM6Ly9naXRodWIuY29tL0Rhcml0aC1Nb2twb3N0CiAqIEluc3RhZ3JhbSBQcm9maWxlIDogaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9jaGFuZGFyaXRoX2NoZWEKICovCmltcG9ydCBQdXJjaGFzZVJlY29yZCBmcm9tICJAL3NjcmlwdHMvY29tcGxpYW5jZS9tb2RlbC9QdXJjaGFzZVJlY29yZCI7CmltcG9ydCBrZW5kbyBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdWkiOwppbXBvcnQgeyBEcm9wRG93bkxpc3QgfSBmcm9tICJAcHJvZ3Jlc3Mva2VuZG8tdnVlLWRyb3Bkb3ducyI7CmltcG9ydCBNb250aGx5UmV0dXJuIGZyb20gIkAvc2NyaXB0cy9jb21wbGlhbmNlL21vZGVsL01vbnRobHlSZXR1cm4iOwppbXBvcnQgTG9hZGluZ01lIGZyb20gIkAvY29tcG9uZW50cy9Mb2FkaW5nIjsKaW1wb3J0IHsgdXVpZCB9IGZyb20gJ3Z1ZS11dWlkJzsKaW1wb3J0IEl0ZW1MaW5lUHVyY2hhc2UgZnJvbSAiQC9zY3JpcHRzL2NvbXBsaWFuY2UvbW9kZWwvaXRlbUxpbmVQdXJjaGFzZSI7Cgp2YXIgJCA9IHJlcXVpcmUoImpxdWVyeSIpOwoKdmFyIHRleHRGaWVsZCA9ICdudW1iZXJOYW1lJzsKdmFyIGtleUZpZWxkID0gJ2lkJzsKdmFyIGRlZmF1bHRJdGVtID0gKF9kZWZhdWx0SXRlbSA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX2RlZmF1bHRJdGVtLCB0ZXh0RmllbGQsICdTZWxlY3Qgc3VwcGxpZXIuLi4nKSwgX2RlZmluZVByb3BlcnR5KF9kZWZhdWx0SXRlbSwga2V5RmllbGQsIG51bGwpLCBfZGVmYXVsdEl0ZW0pOwoKdmFyIGVtcHR5SXRlbSA9IF9kZWZpbmVQcm9wZXJ0eSh7fSwgdGV4dEZpZWxkLCAnbG9hZGluZyAuLi4nKTsKCnZhciB0YXhTZXR0aW5nID0gcmVxdWlyZSgnQC9zdG9yZS90YXhTZXR0aW5nJyk7Cgp2YXIgdGF4U2V0dGluZ0hhbmRsZXIgPSByZXF1aXJlKCJAL3NjcmlwdHMvdGF4U2V0dGluZ0hhbmRsZXIiKTsKCnZhciBhcGlVcmwgPSByZXF1aXJlKCdAL2FwaVVybCcpOwoKdmFyIG1vbnRobHlSZXR1cm5IYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL2NvbXBsaWFuY2UvaGFuZGxlci9tb250aGx5UmV0dXJuSGFuZGxlciIpOwoKdmFyIHB1cmNoYXNlSGFuZGxlciA9IHJlcXVpcmUoIkAvc2NyaXB0cy9jb21wbGlhbmNlL2hhbmRsZXIvcHVyY2hhc2VIYW5kbGVyIik7Cgp2YXIgc3VwcGxpZXJIYW5kbGVyID0gcmVxdWlyZSgiQC9zY3JpcHRzL3N1cHBsaWVySGFuZGxlciIpOwoKdmFyIHB1cmNoYXNlID0gbmV3IFB1cmNoYXNlUmVjb3JkKHt9KTsKdmFyIG1vbnRobHlSZXR1cm4gPSBuZXcgTW9udGhseVJldHVybih7fSk7IC8vIEB2dWUvY29tcG9uZW50CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0FkZF9wdXJjaGFzZScsCiAgY29tcG9uZW50czogewogICAgJ2Ryb3Bkb3dubGlzdCc6IERyb3BEb3duTGlzdCwKICAgICdMb2FkaW5nTWUnOiBMb2FkaW5nTWUKICB9LAogIG1peGluczogW10sCiAgcHJvcHM6IHt9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dUYXg6IGZhbHNlLAogICAgICBzaG93TG9hZGluZzogZmFsc2UsCiAgICAgIG1lbnVKRGF0ZUFkZFNhbGU6IGZhbHNlLAogICAgICBwdXJjaGFzZTogcHVyY2hhc2UsCiAgICAgIHR4bl9kYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKSwKICAgICAgaXRlbUxpbmVzOiBbXSwKICAgICAgZmlsdGVyOiAnJywKICAgICAgdGV4dEZpZWxkOiAnbnVtYmVyTmFtZScsCiAgICAgIGRhdGFJdGVtS2V5OiAnaWQnLAogICAgICBkZWZhdWx0SXRlbTogZGVmYXVsdEl0ZW0sCiAgICAgIHN1cHBCYXNlVXJsOiBzdXBwbGllckhhbmRsZXIuc2VhcmNoKCksCiAgICAgIHN1cHBsaWVyTGlzdDogW10sCiAgICAgIHRvdGFsVmF0OiAwLAogICAgICBhbW91bnRWYXQ6IDAsCiAgICAgIGFtb3VudEluY2x1c2l2ZVZhdDogMCwKICAgICAgYW1vdW50TmV0VmF0OiAwLAogICAgICBtb250aGx5UmV0dXJuOiBtb250aGx5UmV0dXJuCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHR5cGVQcm9kdWN0VGF4OiBmdW5jdGlvbiB0eXBlUHJvZHVjdFRheCgpIHsKICAgICAgcmV0dXJuIHRheFNldHRpbmcuZGVmYXVsdC5zdGF0ZS5saXN0VGF4OwogICAgfSwKICAgIGlzRGlzYWJsZTogZnVuY3Rpb24gaXNEaXNhYmxlKCkgewogICAgICBpZiAodGhpcy5tb250aGx5UmV0dXJuLmhhc093blByb3BlcnR5KCdzdGF0dXMnKSkgewogICAgICAgIGlmICh0aGlzLm1vbnRobHlSZXR1cm4uc3RhdHVzLmNvZGUgPT09IDEpIHsKICAgICAgICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS50eXBlID09PSAnZWRpdCcpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS50eXBlID09PSAndmlldycpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9LAogICAgaWQ6IGZ1bmN0aW9uIGlkKCkgewogICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLnB1cmNoYXNlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdGhpcy4kcm91dGUucGFyYW1zLnB1cmNoYXNlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICdpZCc6ICdpbml0RGF0YScKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuaW5pdERhdGEoKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9hZExpc3RUYXgoKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9hZERhdGEoMCwgJycsIF90aGlzLnN1cHBCYXNlVXJsKTsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7fSwKICBtZXRob2RzOiB7CiAgICBpbml0RGF0YTogZnVuY3Rpb24gaW5pdERhdGEoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIGl0ZW1MaW5lcywgX2xvb3AsIGk7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczIuc2hvd0xvYWRpbmcgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMi4kcm91dGUucGFyYW1zLmlkICE9PSB1bmRlZmluZWQgJiYgX3RoaXMyLiRyb3V0ZS5wYXJhbXMubW9udGhseVJldHVybiA9PT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIub25Mb2FkT25lUmV0dXJuKCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczIuJHJvdXRlLnBhcmFtcyk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMi4kcm91dGUucGFyYW1zLm1vbnRobHlSZXR1cm4gIT09IHVuZGVmaW5lZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyLm1vbnRobHlSZXR1cm4gPSBfdGhpczIuJHJvdXRlLnBhcmFtcy5tb250aGx5UmV0dXJuOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuY2xlYXIoKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMi4kcm91dGUucXVlcnkucF9pZCAhPT0gdW5kZWZpbmVkICYmIF90aGlzMi4kcm91dGUucGFyYW1zLnB1cmNoYXNlID09PSB1bmRlZmluZWQpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLm9ubG9hZE9uZVB1cmNoYXNlKCk7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczIuJHJvdXRlLnBhcmFtcy5wdXJjaGFzZSAhPT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIucHVyY2hhc2UgPSBfdGhpczIuJHJvdXRlLnBhcmFtcy5wdXJjaGFzZTsKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczIucHVyY2hhc2UsICdsaXN0IHRheCcpOwogICAgICAgICAgICAgICAgaXRlbUxpbmVzID0gW107CgogICAgICAgICAgICAgICAgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChpKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5wdXJjaGFzZS5pdGVtTGluZVtpXS50YXhOYW1lID0gX3RoaXMyLnR5cGVQcm9kdWN0VGF4LmZpbHRlcihmdW5jdGlvbiAocCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBwLmRlZmF1bHRUYXggPT09IF90aGlzMi5wdXJjaGFzZS5pdGVtTGluZVtpXS50YXhOYW1lLm5hbWU7CiAgICAgICAgICAgICAgICAgIH0pWzBdOwogICAgICAgICAgICAgICAgICBpdGVtTGluZXMucHVzaChuZXcgSXRlbUxpbmVQdXJjaGFzZShfdGhpczIucHVyY2hhc2UuaXRlbUxpbmVbaV0pKTsKICAgICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudFZhdCArPSBfdGhpczIucHVyY2hhc2UuaXRlbUxpbmVbaV0udmF0IHx8IDA7CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBfdGhpczIucHVyY2hhc2UuaXRlbUxpbmUubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgX2xvb3AoaSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyLnB1cmNoYXNlLml0ZW1MaW5lID0gaXRlbUxpbmVzOwogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudEluY2x1c2l2ZVZhdCA9IF90aGlzMi5wdXJjaGFzZS50b3RhbEFtb3VudEluY2x1c2l2ZSB8fCAwOwogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudE5ldFZhdCA9IF90aGlzMi5wdXJjaGFzZS50b3RhbEFtb3VudE5ldFZhdCB8fCAwOwogICAgICAgICAgICAgICAgX3RoaXMyLnRvdGFsVmF0ID0gX3RoaXMyLnB1cmNoYXNlLnRvdGFsVkFUIHx8IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5jbGVhclB1cmNoYXNlKCk7CgogICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczIucHVyY2hhc2UudG90YWxBbW91bnROZXRWYXQgIT09IDAgfHwgX3RoaXMyLnB1cmNoYXNlLnRvdGFsQW1vdW50SW5jbHVzaXZlICE9PSAwIHx8IF90aGlzMi5wdXJjaGFzZS50b3RhbFZBVCAhPT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyLmFtb3VudEluY2x1c2l2ZVZhdCA9IF90aGlzMi5wdXJjaGFzZS50b3RhbEFtb3VudEluY2x1c2l2ZTsKICAgICAgICAgICAgICAgIF90aGlzMi5hbW91bnROZXRWYXQgPSBfdGhpczIucHVyY2hhc2UudG90YWxBbW91bnROZXRWYXQ7CiAgICAgICAgICAgICAgICBfdGhpczIudG90YWxWYXQgPSBfdGhpczIucHVyY2hhc2UudG90YWxWQVQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQxOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzg6CiAgICAgICAgICAgICAgICBpZiAoIShwdXJjaGFzZS5pdGVtTGluZS5sZW5ndGggPT09IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDE7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLmFkZFJvdygpOwoKICAgICAgICAgICAgICBjYXNlIDQxOgogICAgICAgICAgICAgICAgX3RoaXMyLnNob3dMb2FkaW5nID0gZmFsc2U7IC8vIGlmICh0aGlzLnNhbGUuaXRlbUxpbmUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICAvLyAgICAgYXdhaXQgdGhpcy5hZGRSb3coKQogICAgICAgICAgICAgICAgLy8gfQoKICAgICAgICAgICAgICBjYXNlIDQyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLmNsZWFyUHVyY2hhc2UoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5jbGVhck1vbnRobHlSZXR1cm4oKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY2xlYXJNb250aGx5UmV0dXJuOiBmdW5jdGlvbiBjbGVhck1vbnRobHlSZXR1cm4oKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzNC5tb250aGx5UmV0dXJuID0gbmV3IE1vbnRobHlSZXR1cm4oe30pOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBkaXNhYmxlRWRpdG9yOiBmdW5jdGlvbiBkaXNhYmxlRWRpdG9yKCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgY2xlYXJQdXJjaGFzZTogZnVuY3Rpb24gY2xlYXJQdXJjaGFzZSgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXM1LnB1cmNoYXNlID0gbmV3IFB1cmNoYXNlUmVjb3JkKHt9KTsKICAgICAgICAgICAgICAgIF90aGlzNS5pdGVtTGluZXMgPSBbXTsKICAgICAgICAgICAgICAgIF90aGlzNS5hbW91bnROZXRWYXQgPSAwOwogICAgICAgICAgICAgICAgX3RoaXM1LmFtb3VudEluY2x1c2l2ZVZhdCA9IDA7CiAgICAgICAgICAgICAgICBfdGhpczUudG90YWxWYXQgPSAwOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBvbmxvYWRPbmVQdXJjaGFzZTogZnVuY3Rpb24gb25sb2FkT25lUHVyY2hhc2UoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3Jlc29sdmVkJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX3RoaXM2LiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgICAgICAgICAgICAgICAgcHVyY2hhc2VIYW5kbGVyLmdldE9uZShpZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczYucHVyY2hhc2UgPSByZXMuZGF0YS5kYXRhWzBdOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBvbkxvYWRPbmVSZXR1cm46IGZ1bmN0aW9uIG9uTG9hZE9uZVJldHVybigpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncmVzb2x2ZWQnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBfdGhpczcuJHJvdXRlLnBhcmFtcy5pZDsKICAgICAgICAgICAgICAgICAgICBtb250aGx5UmV0dXJuSGFuZGxlci5nZXRPbmUoaWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM3Lm1vbnRobHlSZXR1cm4gPSByZXMuZGF0YS5kYXRhWzBdOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBsb2FkTGlzdFRheDogZnVuY3Rpb24gbG9hZExpc3RUYXgoKSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyZXNvbHZlZCcpOwogICAgICAgICAgICAgICAgICAgIHRheFNldHRpbmdIYW5kbGVyLmdldChhcGlVcmwudGF4X3NldHRpbmcudGF4X2xpc3RfZ2V0LCAibGlzdFRheCIsICJzZXRMaXN0VGF4Iik7CiAgICAgICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb25TdXBwbGllckZpbHRlckNoYW5nZWQ6IGZ1bmN0aW9uIG9uU3VwcGxpZXJGaWx0ZXJDaGFuZ2VkKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgICAgdmFyIGZpbHRlcjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZmlsdGVyID0gZXZlbnQuZmlsdGVyLnZhbHVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOC5sb2FkRGF0YSgwLCBmaWx0ZXIsIF90aGlzOC5zdXBwQmFzZVVybCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF90aGlzOC5maWx0ZXIgPSBmaWx0ZXI7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGxvYWREYXRhOiBmdW5jdGlvbiBsb2FkRGF0YShza2lwLCBmaWx0ZXIsIGJhc2VVcmwpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgdmFyIHVybDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHVybCA9IGJhc2VVcmwgKyAiP2ZpbHRlcj0iLmNvbmNhdChmaWx0ZXIpOwogICAgICAgICAgICAgICAgX3RoaXM5LnJlcXVlc3RTdGFydGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZldGNoKHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgICAgIH0pLnRoZW4oX3RoaXM5LmFmdGVyRmV0Y2gpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGFmdGVyRmV0Y2g6IGZ1bmN0aW9uIGFmdGVyRmV0Y2goanNvbikgewogICAgICB0aGlzLnN1cHBsaWVyTGlzdCA9IGpzb24uZGF0YTsKICAgIH0sCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UoZXZlbnQpIHsKICAgICAgdmFyIHZhbHVlID0gZXZlbnQudmFsdWU7CgogICAgICBpZiAodmFsdWUgJiYgdmFsdWVbdGV4dEZpZWxkXSA9PT0gZW1wdHlJdGVtW3RleHRGaWVsZF0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMucHVyY2hhc2Uuc3VwcGxpZXIgPSB2YWx1ZTsKICAgIH0sCiAgICBjYWxjdWxhdGVUYXg6IGZ1bmN0aW9uIGNhbGN1bGF0ZVRheCgpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdmFyIGRzID0gdGhpcy4kcmVmcy5kYXRhU291cmNlLmtlbmRvV2lkZ2V0KCk7CiAgICAgIHZhciBkYXRhUm93ID0gZHMuZGF0YSgpLAogICAgICAgICAgdmF0VGF4ID0gMCwKICAgICAgICAgIHRvdGFsVGF4ID0gMCwKICAgICAgICAgIHRvdGFsVmF0ID0gMCwKICAgICAgICAgIGFtb3VudE5ldCA9IDAsCiAgICAgICAgICB0b3RhbE5ldCA9IDAsCiAgICAgICAgICBhbW91bnRJbmMgPSAwOwogICAgICB0aGlzLml0ZW1MaW5lcyA9IFtdOwogICAgICBkYXRhUm93LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBhbW91bnROZXQgPSAwOwogICAgICAgIGFtb3VudEluYyA9IDA7CgogICAgICAgIGlmIChpdGVtLnRheE5hbWUpIHsKICAgICAgICAgIHZhciBhbXQgPSBpdGVtLmFtb3VudDsKICAgICAgICAgIHZhdFRheCA9IF90aGlzMTAuYXV0b0NhbGN1bGF0ZVRheChpdGVtLnRheE5hbWUsIGFtdCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXRlbS50YXhOYW1lLmJhc2VBbW91bnQudG9Mb3dlckNhc2UoKSA9PT0gImluY2x1c2l2ZSIpIHsKICAgICAgICAgIGFtb3VudEluYyA9IGl0ZW0uYW1vdW50IC8gKDEgKyBpdGVtLnRheE5hbWUucmF0ZSAvIDEwMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFtb3VudE5ldCA9IGl0ZW0uYW1vdW50OwogICAgICAgIH0KCiAgICAgICAgX3RoaXMxMC5pdGVtTGluZXMubWFwKGZ1bmN0aW9uIChpLCBpbmRleCkgewogICAgICAgICAgaWYgKGkudWlkID09PSBpdGVtLnVpZCkgewogICAgICAgICAgICBfdGhpczEwLml0ZW1MaW5lcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBfdGhpczEwLml0ZW1MaW5lcy5wdXNoKHsKICAgICAgICAgIHVpZDogaXRlbS51aWQsCiAgICAgICAgICBhbW91bnQ6IGl0ZW0uYW1vdW50LAogICAgICAgICAgYW1vdW50SW5jbHVzaXZlOiBhbW91bnRJbmMsCiAgICAgICAgICBhbW91bnROZXRWYXQ6IGFtb3VudE5ldCB8fCAwLAogICAgICAgICAgdmF0OiB2YXRUYXgsCiAgICAgICAgICBkZXNjcmlwdGlvbjogaXRlbS5kZXNjcmlwdGlvbiwKICAgICAgICAgIHRheE5hbWU6IHsKICAgICAgICAgICAgbmFtZTogaXRlbS50YXhOYW1lLmRlZmF1bHRUYXgsCiAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS50YXhOYW1lLmFjY291bnQuaWQKICAgICAgICAgIH0sCiAgICAgICAgICBiYXNlQW1vdW50OiBpdGVtLmJhc2VBbW91bnQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRvdGFsVGF4ICs9IGtlbmRvLnBhcnNlRmxvYXQodmF0VGF4KTsKICAgICAgdG90YWxWYXQgKz0ga2VuZG8ucGFyc2VGbG9hdChhbW91bnRJbmMpOwogICAgICB0b3RhbE5ldCArPSBrZW5kby5wYXJzZUZsb2F0KGFtb3VudE5ldCk7CiAgICAgIHRoaXMudG90YWxWYXQgKz0gdG90YWxUYXg7CiAgICAgIHRoaXMuYW1vdW50TmV0VmF0ICs9IHRvdGFsTmV0OwogICAgICB0aGlzLmFtb3VudEluY2x1c2l2ZVZhdCArPSB0b3RhbFZhdDsKICAgICAgd2luZG93LmNvbnNvbGUubG9nKHRoaXMuaXRlbUxpbmVzKTsKICAgIH0sCiAgICBhdXRvQ2FsY3VsYXRlVGF4OiBmdW5jdGlvbiBhdXRvQ2FsY3VsYXRlVGF4KHRheCwgYW1vdW50KSB7CiAgICAgIGlmICh0YXgpIHsKICAgICAgICB2YXIgZm9ybXVsYSA9IHRheC5mb3JtdWxhLAogICAgICAgICAgICBpbkFtdCA9IGtlbmRvLnBhcnNlRmxvYXQoYW1vdW50KSwKICAgICAgICAgICAgbkFtdCA9IGtlbmRvLnBhcnNlRmxvYXQoYW1vdW50KSwKICAgICAgICAgICAgdGF4QmFzZSA9IGtlbmRvLnBhcnNlRmxvYXQodGF4LnRheEJhc2UpIC8gMTAwLAogICAgICAgICAgICByYXRlID0ga2VuZG8ucGFyc2VGbG9hdCh0YXgucmF0ZSkgLyAxMDAsCiAgICAgICAgICAgIHRvdGFsID0gZXZhbChmb3JtdWxhKTsKICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coaW5BbXQsIG5BbXQsIHRheEJhc2UsIHJhdGUsIGZvcm11bGEsIHRvdGFsKTsKICAgICAgICByZXR1cm4gdG90YWw7CiAgICAgIH0KICAgIH0sCiAgICBjYWxjdWxhdGVUYXhEZWxldGU6IGZ1bmN0aW9uIGNhbGN1bGF0ZVRheERlbGV0ZShkYXRhUm93KSB7CiAgICAgIHZhciB2YXRUYXggPSAwOwoKICAgICAgaWYgKGRhdGFSb3cudGF4TmFtZSkgewogICAgICAgIHZhciBhbXQgPSBkYXRhUm93LmFtb3VudDsKICAgICAgICB2YXRUYXggPSB0aGlzLmF1dG9DYWxjdWxhdGVUYXgoZGF0YVJvdy50YXhOYW1lLCBhbXQpOwogICAgICB9CgogICAgICB0aGlzLnRvdGFsVmF0ID0gdGhpcy50b3RhbFZhdCAtIHZhdFRheDsKICAgIH0sCiAgICBvbkRhdGFTb3VyY2VDaGFuZ2VzOiBmdW5jdGlvbiBvbkRhdGFTb3VyY2VDaGFuZ2VzKGUpIHsKICAgICAgaWYgKGUuZmllbGQpIHsKICAgICAgICB2YXIgZGF0YVJvdyA9IGUuaXRlbXNbMF07CgogICAgICAgIHN3aXRjaCAoZS5maWVsZCkgewogICAgICAgICAgY2FzZSAidGF4TmFtZSI6CiAgICAgICAgICAgIGRhdGFSb3cuc2V0KCJiYXNlQW1vdW50IiwgZGF0YVJvdy50YXhOYW1lLmJhc2VBbW91bnQpOwoKICAgICAgICAgICAgaWYgKGRhdGFSb3cuYW1vdW50ID4gMCkgewogICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgImFtb3VudCI6CiAgICAgICAgICAgIGlmIChkYXRhUm93LnRheE5hbWUuaGFzT3duUHJvcGVydHkoJ2RlZmF1bHRUYXgnKSkgewogICAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG9uQ2xvc2U6IGZ1bmN0aW9uIG9uQ2xvc2UoKSB7CiAgICAgIHRoaXMucHVyY2hhc2UgPSBuZXcgUHVyY2hhc2VSZWNvcmQoe30pOwogICAgICB0aGlzLnRvdGFsVmF0ID0gMDsKICAgICAgdGhpcy5hbW91bnRJbmNsdXNpdmVWYXQgPSAwOwogICAgICB0aGlzLmFtb3VudE5ldFZhdCA9IDA7CiAgICAgIHdpbmRvdy5oaXN0b3J5LmdvKC0xKTsgLy8gdGhpcy4kcm91dGVyLnB1c2goewogICAgICAvLyAgICAgbmFtZTogJ1B1cmNoYXNlIFJlY29yZCcsCiAgICAgIC8vICAgICBwYXRoOiAncHVyY2hhc2VfcmVjb3JkJywKICAgICAgLy8gICAgIHF1ZXJ5OiB7dHlwZTogdGhpcy4kcm91dGUucXVlcnkudHlwZX0sCiAgICAgIC8vICAgICBwYXJhbXM6IHtpZDogdGhpcy5tb250aGx5UmV0dXJuLmlkLCBtb250aGx5UmV0dXJuOiB0aGlzLm1vbnRobHlSZXR1cm59CiAgICAgIC8vIH0pCiAgICB9LAogICAgbnVtYmVyRm9ybWF0OiBmdW5jdGlvbiBudW1iZXJGb3JtYXQodmFsdWUpIHsKICAgICAgLy8gd2luZG93LmNvbnNvbGUubG9nKHRoaXMuc2FsZUZvcm1Db250ZW50LmRlY2ltYWwsJ25pbW9sJykKICAgICAgcmV0dXJuIGtlbmRvLnRvU3RyaW5nKHZhbHVlLCAibiIuY29uY2F0KHRoaXMucHVyY2hhc2UuZGVjaW1hbCkpOwogICAgfSwKICAgIC8vIEF1dG8gSW5jcmVhc2UgbnVtYmVyCiAgICByb3dOdW1iZXJUbXBsOiBmdW5jdGlvbiByb3dOdW1iZXJUbXBsKGRhdGFJdGVtKSB7CiAgICAgIHZhciBkcyA9IHRoaXMuJHJlZnMuZGF0YVNvdXJjZS5rZW5kb1dpZGdldCgpLAogICAgICAgICAgaW5kZXggPSBkcy5pbmRleE9mKGRhdGFJdGVtKTsKICAgICAgcmV0dXJuIGluZGV4ICsgMTsKICAgIH0sCiAgICAvLyBSZW1vdmUgUm93CiAgICByZW1vdmVSb3c6IGZ1bmN0aW9uIHJlbW92ZVJvdyhlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgdmFyIGdyaWQgPSBrZW5kby5qUXVlcnkoIiNncmlkIikuZGF0YSgia2VuZG9HcmlkIiksCiAgICAgICAgICBkYXRhU291cmNlID0gZ3JpZC5kYXRhU291cmNlLAogICAgICAgICAgZGF0YUl0ZW0gPSBncmlkLmRhdGFJdGVtKCQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCJ0ciIpKTsKCiAgICAgIGlmIChkYXRhU291cmNlLnRvdGFsKCkgPiAxKSB7CiAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKGRhdGFJdGVtLCAnZGVsZXRlJyk7CgogICAgICAgIGlmIChkYXRhSXRlbS5hbW91bnQgIT09IDAgfHwgZGF0YUl0ZW0udGF4TmFtZS5yYXRlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmIChkYXRhSXRlbS5iYXNlQW1vdW50LnRvTG93ZXJDYXNlKCkgPT09ICduZXQnKSB7CiAgICAgICAgICAgIHRoaXMuYW1vdW50TmV0VmF0ID0gdGhpcy5hbW91bnROZXRWYXQgLSBkYXRhSXRlbS5hbW91bnQ7CiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVGF4RGVsZXRlKGRhdGFJdGVtKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBhbW91bnQgPSBkYXRhSXRlbS5hbW91bnQgLyAoMSArIGRhdGFJdGVtLnR5cGVQcm9kdWN0VGF4LnJhdGUgLyAxMDApOwogICAgICAgICAgICB0aGlzLmFtb3VudEluY2x1c2l2ZVZhdCA9IHRoaXMuYW1vdW50SW5jbHVzaXZlVmF0IC0gYW1vdW50OwogICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZVRheERlbGV0ZShkYXRhSXRlbSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBkYXRhU291cmNlLnJlbW92ZShkYXRhSXRlbSk7CiAgICAgIH0KICAgIH0sCiAgICB0eXBlUHJvZHVjdFRheERyb3Bkb3duRWRpdG9yOiBmdW5jdGlvbiB0eXBlUHJvZHVjdFRheERyb3Bkb3duRWRpdG9yKGNvbnRhaW5lciwgb3B0aW9ucykgewogICAgICAvLyBjb25zdCB0cGwgPSB0aGlzLnR5cGVQcm9kdWN0TGlzdAogICAgICBrZW5kby5qUXVlcnkoJzxpbnB1dCByZXF1aXJlZCBuYW1lPSInICsgb3B0aW9ucy5maWVsZCArICciLz4nKS5hcHBlbmRUbyhjb250YWluZXIpLmtlbmRvRHJvcERvd25MaXN0KHsKICAgICAgICBhdXRvQmluZDogZmFsc2UsCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgIGhlaWdodDogMzAwLAogICAgICAgIGRhdGFUZXh0RmllbGQ6ICJkZWZhdWx0VGF4IiwKICAgICAgICBkYXRhVmFsdWVGaWVsZDogImlkIiwKICAgICAgICBvcHRpb25MYWJlbDogIi0tLSBTZWxlY3QgLS0tIiwKICAgICAgICBkYXRhU291cmNlOiB7CiAgICAgICAgICBkYXRhOiB0aGlzLnR5cGVQcm9kdWN0VGF4LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS50cmFuc2FjdGlvblR5cGUudG9Mb3dlckNhc2UoKSA9PT0gInB1cmNoYXNlIiAmJiBpdGVtLnRheFR5cGUudHlwZUlkID09PSAxOwogICAgICAgICAgfSksCiAgICAgICAgICBncm91cDogewogICAgICAgICAgICBmaWVsZDogImJhc2VBbW91bnQiCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBhZGRSb3c6IGZ1bmN0aW9uIGFkZFJvdygpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICAgIHZhciBkcywgdG90YWw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkcyA9IF90aGlzMTEuJHJlZnMuZGF0YVNvdXJjZS5rZW5kb1dpZGdldCgpLCB0b3RhbCA9IGRzLnRvdGFsKCk7CiAgICAgICAgICAgICAgICBkcy5pbnNlcnQodG90YWwsIHsKICAgICAgICAgICAgICAgICAgdHlwZVByb2R1Y3RUYXg6IHsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VGF4OiAiIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBiYXNlQW1vdW50OiAiIiwKICAgICAgICAgICAgICAgICAgYW1vdW50OiAwLAogICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogIiIKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG9uU2F2ZUNsb3NlOiBmdW5jdGlvbiBvblNhdmVDbG9zZSgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICAgIHZhciBkYXRhLCByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczEyLnNob3dMb2FkaW5nID0gdHJ1ZTsgLy8gYXdhaXQgdGhpcy5nZXREYXRhU291cmNlKCkKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMi5wdXJjaGFzZS5zdXBwbGllci50YXhQYXllclR5cGUgPT09ICcnKSB7CiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczEyLnB1cmNoYXNlLnN1cHBsaWVyLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ2luZGl2aWR1YWwtZm9yZWlnbicpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnB1cmNoYXNlLnN1cHBsaWVyLnRheFBheWVyVHlwZSA9ICdQaHlzaWNhbCBQZXJzb24nOwogICAgICAgICAgICAgICAgICAgIF90aGlzMTIucHVyY2hhc2Uuc3VwcGxpZXIubmF0dXJlVGF4VHlwZSA9ICdOb24tUmVzaWRlbnQnOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIucHVyY2hhc2Uuc3VwcGxpZXIudHlwZS50b0xvd2VyQ2FzZSgpID09PSAnZm9yZWlnbiBlbnRpdHknKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5wdXJjaGFzZS5zdXBwbGllci50YXhQYXllclR5cGUgPSAnTGVnYWwgUGVyc29uJzsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnB1cmNoYXNlLnN1cHBsaWVyLm5hdHVyZVRheFR5cGUgPSAnTm9uLVJlc2lkZW50JzsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczEyLnB1cmNoYXNlLnN1cHBsaWVyLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ2luZGl2aWR1YWwtbG9jYWwnKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5wdXJjaGFzZS5zdXBwbGllci50YXhQYXllclR5cGUgPSAnUGh5c2ljYWwgUGVyc29uJzsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLnB1cmNoYXNlLnN1cHBsaWVyLm5hdHVyZVRheFR5cGUgPSAnUmVzaWRlbnQnOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIucHVyY2hhc2Uuc3VwcGxpZXIudHlwZS50b0xvd2VyQ2FzZSgpID09PSAnbm9uLXRheGFibGUgZW50aXR5JykgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTIucHVyY2hhc2Uuc3VwcGxpZXIudGF4UGF5ZXJUeXBlID0gJ0xlZ2FsIFBlcnNvbic7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5wdXJjaGFzZS5zdXBwbGllci5uYXR1cmVUYXhUeXBlID0gJ1Jlc2lkZW50JzsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczEyLnB1cmNoYXNlLnN1cHBsaWVyLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ3RheGFibGUgZW50aXR5JykgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTIucHVyY2hhc2Uuc3VwcGxpZXIudGF4UGF5ZXJUeXBlID0gJ0xlZ2FsIFBlcnNvbic7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5wdXJjaGFzZS5zdXBwbGllci5uYXR1cmVUYXhUeXBlID0gJ1Jlc2lkZW50JzsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEyLml0ZW1MaW5lcy5sZW5ndGggPCAwIHx8IF90aGlzMTIucHVyY2hhc2UuaXRlbUxpbmUubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coX3RoaXMxMi5wdXJjaGFzZS5pdGVtTGluZSwgJ2l0ZW1saW5lIDEyMzQxMjQxMicpOwogICAgICAgICAgICAgICAgICBfdGhpczEyLnB1cmNoYXNlLml0ZW1MaW5lID0gX3RoaXMxMi5wdXJjaGFzZS5pdGVtTGluZS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgdWlkOiBpdGVtLnVpZCwKICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogaXRlbS5hbW91bnQsCiAgICAgICAgICAgICAgICAgICAgICBhbW91bnRJbmNsdXNpdmU6IGl0ZW0uYW1vdW50SW5jbHVzaXZlLAogICAgICAgICAgICAgICAgICAgICAgYW1vdW50TmV0VmF0OiBpdGVtLmFtb3VudE5ldFZhdCwKICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0uaXRlbSwKICAgICAgICAgICAgICAgICAgICAgIHZhdDogaXRlbS52YXQsCiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogaXRlbS5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgICAgICAgIHRheE5hbWU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbS50YXhOYW1lLmRlZmF1bHRUYXgsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogaXRlbS50YXhOYW1lLmFjY291bnQuaWQKICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICBiYXNlQW1vdW50OiBpdGVtLmJhc2VBbW91bnQKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBkYXRhID0gewogICAgICAgICAgICAgICAgICBpZDogX3RoaXMxMi5wdXJjaGFzZS5pZCA/IF90aGlzMTIucHVyY2hhc2UuaWQgOiAibXItIi5jb25jYXQodXVpZC52MSgpKSwKICAgICAgICAgICAgICAgICAgdHlwZTogJ3B1cmNoYXNlJywKICAgICAgICAgICAgICAgICAgZGF0ZTogX3RoaXMxMi5wdXJjaGFzZS5kYXRlLAogICAgICAgICAgICAgICAgICBtb250aGx5UmV0dXJuSWQ6IF90aGlzMTIubW9udGhseVJldHVybi5pZCwKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICcnLAogICAgICAgICAgICAgICAgICByZWZlcmVuY2U6IF90aGlzMTIucHVyY2hhc2UucmVmZXJlbmNlLAogICAgICAgICAgICAgICAgICBtb250aE9mOiBfdGhpczEyLm1vbnRobHlSZXR1cm4ubW9udGhPZiwKICAgICAgICAgICAgICAgICAgc3VwcGxpZXI6IF90aGlzMTIucHVyY2hhc2Uuc3VwcGxpZXIsCiAgICAgICAgICAgICAgICAgIHRvdGFsVkFUOiBfdGhpczEyLnRvdGFsVmF0LAogICAgICAgICAgICAgICAgICB0b3RhbEFtb3VudEluY2x1c2l2ZTogX3RoaXMxMi5hbW91bnRJbmNsdXNpdmVWYXQsCiAgICAgICAgICAgICAgICAgIHRvdGFsQW1vdW50TmV0VmF0OiBfdGhpczEyLmFtb3VudE5ldFZhdCwKICAgICAgICAgICAgICAgICAgaXRlbUxpbmU6IF90aGlzMTIuaXRlbUxpbmVzLmxlbmd0aCA+IDAgPyBfdGhpczEyLml0ZW1MaW5lcyA6IF90aGlzMTIucHVyY2hhc2UuaXRlbUxpbmUsCiAgICAgICAgICAgICAgICAgIGlzU2F2ZTogX3RoaXMxMi5wdXJjaGFzZS5pc1NhdmUgfHwgZmFsc2UsCiAgICAgICAgICAgICAgICAgIHN0YXR1czogX3RoaXMxMi4kcm91dGUucXVlcnkudHlwZSA9PT0gJ0VkaXQnID8gMiA6IDEsCiAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U6IF90aGlzMTIuJHJvdXRlLnF1ZXJ5LnR5cGUgPT09ICdFZGl0JyA/IF90aGlzMTIucHVyY2hhc2UuZGF0YVNvdXJjZSA6IHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiAiTWFudWFsbHkiLAogICAgICAgICAgICAgICAgICAgIGlkOiAyCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpczEyLnB1cmNoYXNlLnN1cHBsaWVyLnN1cHBsaWVySWQgPSAnJzsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBQdXJjaGFzZVJlY29yZChkYXRhKTsKCiAgICAgICAgICAgICAgICBfdGhpczEyLiRzdG9yZS5kaXNwYXRjaCgnY29tcGxpYW5jZS9wdXNoUHVyY2hhc2UnLCByZXN1bHQpOyAvLyBsZXQgcCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5tb250aGx5UmV0dXJuLm51bWJlcisgJyZQdXJjaGFzZScpKQogICAgICAgICAgICAgICAgLy8gaWYgKHApIHsKICAgICAgICAgICAgICAgIC8vICAgICBpZiAocC5sZW5ndGggPD0gMCkgewogICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAodGhpcy5tb250aGx5UmV0dXJuLmFiYnIgIT09ICcnICYmIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm1vbnRobHlSZXR1cm4uYWJiciArIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgKyAnJlB1cmNoYXNlJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gICAgICAgICAvLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm1vbnRobHlSZXR1cm4ubnVtYmVyKyAnJlB1cmNoYXNlJywgSlNPTi5zdHJpbmdpZnkoW10pKQogICAgICAgICAgICAgICAgLy8gICAgICAgICBjb25zdCBhbGxBcnJheSA9IFsuLi5wLCAuLi5kYXRhXQogICAgICAgICAgICAgICAgLy8gICAgICAgICByZXN1bHRzID0gYWxsQXJyYXkuZmlsdGVyKChlLCBpKSA9PiBhbGxBcnJheS5maW5kSW5kZXgobyA9PiBvLnRvdGFsQW1vdW50SW5jbHVzaXZlID09PSBlLnRvdGFsQW1vdW50SW5jbHVzaXZlICYmIG8udG90YWxWQVQgPT09IGUudG90YWxWQVQgJiYgby50b3RhbEFtb3VudE5ldFZhdCA9PT0gZS50b3RhbEFtb3VudE5ldFZhdCkgPT09IGkpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhyZXN1bHRzLCAnMzQ1NjcnKQogICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAodGhpcy5tb250aGx5UmV0dXJuLmFiYnIgIT09ICcnICYmIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm1vbnRobHlSZXR1cm4uYWJiciArIHRoaXMubW9udGhseVJldHVybi5udW1iZXIgKyAnJlB1cmNoYXNlJywgSlNPTi5zdHJpbmdpZnkocmVzdWx0cykpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgICAgICAvLyB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMubW9udGhseVJldHVybi5hYmJyICsgdGhpcy5tb250aGx5UmV0dXJuLm51bWJlciArICcmUHVyY2hhc2UnLCBKU09OLnN0cmluZ2lmeShkYXRhKSkKICAgICAgICAgICAgICAgIC8vIH0KCgogICAgICAgICAgICAgICAgX3RoaXMxMi5zaG93TG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIF90aGlzMTIub25DbG9zZSgpOwoKICAgICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmxvZyhfdGhpczEyLml0ZW1MaW5lcywgZGF0YSwgJ2RhdGEnKTsgLy8gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHsKICAgICAgICAgICAgICAgIC8vICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmVzb2x2ZSgicmVzb2x2ZWQiKTsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgcHVyY2hhc2VIYW5kbGVyLmNyZWF0ZShkYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB3aW5kb3cuY29uc29sZS5sb2cocmVzKQogICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLm9uQ2xvc2UoKQogICAgICAgICAgICAgICAgLy8gICAgICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHdpbmRvdy5jb25zb2xlLmVycm9yKGUpCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAvLyAgICAgfSwgMzAwKTsKICAgICAgICAgICAgICAgIC8vIH0pCgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMik7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/Users/macos/Desktop/banhji-0.2/banhji-accounting-web-module/src/views/compliance/monthly_tax/new_tax_return/input/add_purchase/_add_purchase.js"],"names":["PurchaseRecord","kendo","DropDownList","MonthlyReturn","LoadingMe","uuid","ItemLinePurchase","$","require","textField","keyField","defaultItem","emptyItem","taxSetting","taxSettingHandler","apiUrl","monthlyReturnHandler","purchaseHandler","supplierHandler","purchase","monthlyReturn","name","components","mixins","props","data","dialogTax","showLoading","menuJDateAddSale","txn_date","Date","toISOString","substr","itemLines","filter","dataItemKey","suppBaseUrl","search","supplierList","totalVat","amountVat","amountInclusiveVat","amountNetVat","computed","typeProductTax","default","state","listTax","isDisable","hasOwnProperty","status","code","$route","query","type","id","params","undefined","watch","mounted","initData","loadListTax","loadData","created","methods","onLoadOneReturn","window","console","log","clear","p_id","onloadOnePurchase","i","itemLine","taxName","p","defaultTax","push","vat","length","totalAmountInclusive","totalAmountNetVat","totalVAT","clearPurchase","addRow","clearMonthlyReturn","disableEditor","Promise","resolve","setTimeout","getOne","then","res","get","tax_setting","tax_list_get","onSupplierFilterChanged","event","value","skip","baseUrl","url","requestStarted","fetch","response","json","afterFetch","onChange","supplier","calculateTax","ds","$refs","dataSource","kendoWidget","dataRow","vatTax","totalTax","amountNet","totalNet","amountInc","forEach","item","amt","amount","autoCalculateTax","baseAmount","toLowerCase","rate","map","index","uid","splice","amountInclusive","description","accountId","account","parseFloat","tax","formula","inAmt","nAmt","taxBase","total","eval","calculateTaxDelete","onDataSourceChanges","e","field","items","set","onClose","history","go","numberFormat","toString","decimal","rowNumberTmpl","dataItem","indexOf","removeRow","preventDefault","grid","jQuery","currentTarget","closest","remove","typeProductTaxDropdownEditor","container","options","appendTo","kendoDropDownList","autoBind","autoWidth","height","dataTextField","dataValueField","optionLabel","transactionType","taxType","typeId","group","insert","onSaveClose","taxPayerType","natureTaxType","v1","date","monthlyReturnId","reference","monthOf","isSave","supplierId","result","$store","dispatch"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,cAAP,MAA2B,2CAA3B;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,SAAQC,YAAR,QAA2B,+BAA3B;AACA,OAAOC,aAAP,MAA0B,0CAA1B;AACA,OAAOC,SAAP,MAAsB,sBAAtB;AACA,SAAQC,IAAR,QAAmB,UAAnB;AACA,OAAOC,gBAAP,MAA6B,6CAA7B;;AAEA,IAAMC,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAjB;;AACA,IAAMC,SAAS,GAAG,YAAlB;AACA,IAAMC,QAAQ,GAAG,IAAjB;AACA,IAAMC,WAAW,qDAAKF,SAAL,EAAiB,oBAAjB,iCAAwCC,QAAxC,EAAmD,IAAnD,gBAAjB;;AACA,IAAME,SAAS,uBAAKH,SAAL,EAAiB,aAAjB,CAAf;;AACA,IAAMI,UAAU,GAAGL,OAAO,CAAC,oBAAD,CAA1B;;AACA,IAAMM,iBAAiB,GAAGN,OAAO,CAAC,6BAAD,CAAjC;;AACA,IAAMO,MAAM,GAAGP,OAAO,CAAC,UAAD,CAAtB;;AACA,IAAMQ,oBAAoB,GAAGR,OAAO,CAAC,mDAAD,CAApC;;AACA,IAAMS,eAAe,GAAGT,OAAO,CAAC,8CAAD,CAA/B;;AACA,IAAMU,eAAe,GAAGV,OAAO,CAAC,2BAAD,CAA/B;;AACA,IAAMW,QAAQ,GAAG,IAAInB,cAAJ,CAAmB,EAAnB,CAAjB;AACA,IAAMoB,aAAa,GAAG,IAAIjB,aAAJ,CAAkB,EAAlB,CAAtB,C,CACA;;AACA,eAAe;AACXkB,EAAAA,IAAI,EAAE,cADK;AAGXC,EAAAA,UAAU,EAAE;AACR,oBAAgBpB,YADR;AAER,iBAAaE;AAFL,GAHD;AAQXmB,EAAAA,MAAM,EAAE,EARG;AAUXC,EAAAA,KAAK,EAAE,EAVI;AAYXC,EAAAA,IAZW,kBAYJ;AACH,WAAO;AACHC,MAAAA,SAAS,EAAE,KADR;AAEHC,MAAAA,WAAW,EAAE,KAFV;AAGHC,MAAAA,gBAAgB,EAAE,KAHf;AAIHT,MAAAA,QAAQ,EAAEA,QAJP;AAKHU,MAAAA,QAAQ,EAAE,IAAIC,IAAJ,GAAWC,WAAX,GAAyBC,MAAzB,CAAgC,CAAhC,EAAmC,EAAnC,CALP;AAMHC,MAAAA,SAAS,EAAE,EANR;AAOHC,MAAAA,MAAM,EAAE,EAPL;AAQHzB,MAAAA,SAAS,EAAE,YARR;AASH0B,MAAAA,WAAW,EAAE,IATV;AAUHxB,MAAAA,WAAW,EAAEA,WAVV;AAWHyB,MAAAA,WAAW,EAAElB,eAAe,CAACmB,MAAhB,EAXV;AAYHC,MAAAA,YAAY,EAAE,EAZX;AAcHC,MAAAA,QAAQ,EAAE,CAdP;AAeHC,MAAAA,SAAS,EAAE,CAfR;AAgBHC,MAAAA,kBAAkB,EAAE,CAhBjB;AAiBHC,MAAAA,YAAY,EAAE,CAjBX;AAkBHtB,MAAAA,aAAa,EAAEA;AAlBZ,KAAP;AAoBH,GAjCU;AAmCXuB,EAAAA,QAAQ,EAAE;AACNC,IAAAA,cADM,4BACW;AACb,aAAO/B,UAAU,CAACgC,OAAX,CAAmBC,KAAnB,CAAyBC,OAAhC;AACH,KAHK;AAINC,IAAAA,SAJM,uBAIM;AACR,UAAI,KAAK5B,aAAL,CAAmB6B,cAAnB,CAAkC,QAAlC,CAAJ,EAAiD;AAC7C,YAAI,KAAK7B,aAAL,CAAmB8B,MAAnB,CAA0BC,IAA1B,KAAmC,CAAvC,EAA0C;AACtC,cAAI,KAAKC,MAAL,CAAYC,KAAZ,CAAkBC,IAAlB,KAA2B,MAA/B,EAAuC;AACnC,mBAAO,KAAP;AACH,WAFD,MAEO,IAAI,KAAKF,MAAL,CAAYC,KAAZ,CAAkBC,IAAlB,KAA2B,MAA/B,EAAuC;AAC1C,mBAAO,IAAP;AACH,WAFM,MAEA;AACH,mBAAO,IAAP;AACH;AACJ,SARD,MAQO;AACH,iBAAO,IAAP;AACH;AACJ,OAZD,MAYO;AACH,eAAO,IAAP;AACH;AACJ,KApBK;AAqBNC,IAAAA,EArBM,gBAqBD;AACD,UAAI,KAAKH,MAAL,CAAYI,MAAZ,CAAmBrC,QAAnB,KAAgCsC,SAApC,EAA+C;AAC3C,eAAO,KAAKL,MAAL,CAAYI,MAAZ,CAAmBrC,QAA1B;AACH,OAFD,MAEM;AACF,eAAO,EAAP;AACH;AACJ;AA3BK,GAnCC;AAiEXuC,EAAAA,KAAK,EAAE;AACH,UAAM;AADH,GAjEI;AAqELC,EAAAA,OArEK,qBAqEK;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACN,KAAI,CAACC,QAAL,EADM;;AAAA;AAAA;AAAA,qBAEN,KAAI,CAACC,WAAL,EAFM;;AAAA;AAAA;AAAA,qBAGN,KAAI,CAACC,QAAL,CAAc,CAAd,EAAiB,EAAjB,EAAqB,KAAI,CAAC1B,WAA1B,CAHM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIf,GAzEU;AA2EX2B,EAAAA,OA3EW,qBA2ED,CACT,CA5EU;AA8EXC,EAAAA,OAAO,EAAE;AACCJ,IAAAA,QADD,sBACY;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACb,gBAAA,MAAI,CAACjC,WAAL,GAAmB,IAAnB;;AADa,sBAET,MAAI,CAACyB,MAAL,CAAYI,MAAZ,CAAmBD,EAAnB,KAA0BE,SAA1B,IAAuC,MAAI,CAACL,MAAL,CAAYI,MAAZ,CAAmBpC,aAAnB,KAAqCqC,SAFnE;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAGH,MAAI,CAACQ,eAAL,EAHG;;AAAA;AAITC,gBAAAA,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,MAAI,CAAChB,MAAL,CAAYI,MAA/B;AAJS;AAAA;;AAAA;AAAA,sBAKF,MAAI,CAACJ,MAAL,CAAYI,MAAZ,CAAmBpC,aAAnB,KAAqCqC,SALnC;AAAA;AAAA;AAAA;;AAMT,gBAAA,MAAI,CAACrC,aAAL,GAAqB,MAAI,CAACgC,MAAL,CAAYI,MAAZ,CAAmBpC,aAAxC;AANS;AAAA;;AAAA;AAAA;AAAA,uBAQH,MAAI,CAACiD,KAAL,EARG;;AAAA;AAAA,sBAUT,MAAI,CAACjB,MAAL,CAAYC,KAAZ,CAAkBiB,IAAlB,KAA2Bb,SAA3B,IAAwC,MAAI,CAACL,MAAL,CAAYI,MAAZ,CAAmBrC,QAAnB,KAAgCsC,SAV/D;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAWH,MAAI,CAACc,iBAAL,EAXG;;AAAA;AAAA;AAAA;;AAAA;AAAA,sBAYF,MAAI,CAACnB,MAAL,CAAYI,MAAZ,CAAmBrC,QAAnB,KAAgCsC,SAZ9B;AAAA;AAAA;AAAA;;AAaT,gBAAA,MAAI,CAACtC,QAAL,GAAgB,MAAI,CAACiC,MAAL,CAAYI,MAAZ,CAAmBrC,QAAnC;AACA+C,gBAAAA,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,MAAI,CAACjD,QAAxB,EAAkC,UAAlC;AACMc,gBAAAA,SAfG,GAeS,EAfT;;AAAA,uCAgBAuC,CAhBA;AAiBL,kBAAA,MAAI,CAACrD,QAAL,CAAcsD,QAAd,CAAuBD,CAAvB,EAA0BE,OAA1B,GAAoC,MAAI,CAAC9B,cAAL,CAAoBV,MAApB,CAA2B,UAAAyC,CAAC;AAAA,2BAAIA,CAAC,CAACC,UAAF,KAAiB,MAAI,CAACzD,QAAL,CAAcsD,QAAd,CAAuBD,CAAvB,EAA0BE,OAA1B,CAAkCrD,IAAvD;AAAA,mBAA5B,EAAyF,CAAzF,CAApC;AACAY,kBAAAA,SAAS,CAAC4C,IAAV,CAAe,IAAIvE,gBAAJ,CAAqB,MAAI,CAACa,QAAL,CAAcsD,QAAd,CAAuBD,CAAvB,CAArB,CAAf;AACA,kBAAA,MAAI,CAAChC,SAAL,IAAkB,MAAI,CAACrB,QAAL,CAAcsD,QAAd,CAAuBD,CAAvB,EAA0BM,GAA1B,IAAiC,CAAnD;AAnBK;;AAgBT,qBAASN,CAAT,GAAY,CAAZ,EAAeA,CAAC,GAAG,MAAI,CAACrD,QAAL,CAAcsD,QAAd,CAAuBM,MAA1C,EAAkDP,CAAC,EAAnD,EAAuD;AAAA,wBAA9CA,CAA8C;AAItD;;AACD,gBAAA,MAAI,CAACrD,QAAL,CAAcsD,QAAd,GAAyBxC,SAAzB;AACA,gBAAA,MAAI,CAACQ,kBAAL,GAA0B,MAAI,CAACtB,QAAL,CAAc6D,oBAAd,IAAsC,CAAhE;AACA,gBAAA,MAAI,CAACtC,YAAL,GAAoB,MAAI,CAACvB,QAAL,CAAc8D,iBAAd,IAAmC,CAAvD;AACA,gBAAA,MAAI,CAAC1C,QAAL,GAAgB,MAAI,CAACpB,QAAL,CAAc+D,QAAd,IAA0B,CAA1C;AAxBS;AAAA;;AAAA;AAAA;AAAA,uBA0BH,MAAI,CAACC,aAAL,EA1BG;;AAAA;AAAA,sBA4BT,MAAI,CAAChE,QAAL,CAAc8D,iBAAd,KAAoC,CAApC,IAAyC,MAAI,CAAC9D,QAAL,CAAc6D,oBAAd,KAAuC,CAAhF,IAAqF,MAAI,CAAC7D,QAAL,CAAc+D,QAAd,KAA2B,CA5BvG;AAAA;AAAA;AAAA;;AA6BT,gBAAA,MAAI,CAACzC,kBAAL,GAA0B,MAAI,CAACtB,QAAL,CAAc6D,oBAAxC;AACA,gBAAA,MAAI,CAACtC,YAAL,GAAoB,MAAI,CAACvB,QAAL,CAAc8D,iBAAlC;AACA,gBAAA,MAAI,CAAC1C,QAAL,GAAgB,MAAI,CAACpB,QAAL,CAAc+D,QAA9B;AA/BS;AAAA;;AAAA;AAAA,sBAiCL/D,QAAQ,CAACsD,QAAT,CAAkBM,MAAlB,KAA6B,CAjCxB;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAkCC,MAAI,CAACK,MAAL,EAlCD;;AAAA;AAqCb,gBAAA,MAAI,CAACzD,WAAL,GAAmB,KAAnB,CArCa,CAsCb;AACA;AACA;;AAxCa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyChB,KA1CI;AA2CC0C,IAAAA,KA3CD,mBA2CS;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACJ,MAAI,CAACc,aAAL,EADI;;AAAA;AAAA;AAAA,uBAEJ,MAAI,CAACE,kBAAL,EAFI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGb,KA9CI;AA+CCA,IAAAA,kBA/CD,gCA+CsB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACvB,gBAAA,MAAI,CAACjE,aAAL,GAAqB,IAAIjB,aAAJ,CAAkB,EAAlB,CAArB;;AADuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAE1B,KAjDI;AAkDLmF,IAAAA,aAlDK,2BAkDW;AACZ,aAAO,KAAP;AACH,KApDI;AAqDCH,IAAAA,aArDD,2BAqDiB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAClB,gBAAA,MAAI,CAAChE,QAAL,GAAgB,IAAInB,cAAJ,CAAmB,EAAnB,CAAhB;AACA,gBAAA,MAAI,CAACiC,SAAL,GAAiB,EAAjB;AACA,gBAAA,MAAI,CAACS,YAAL,GAAoB,CAApB;AACA,gBAAA,MAAI,CAACD,kBAAL,GAA0B,CAA1B;AACA,gBAAA,MAAI,CAACF,QAAL,GAAgB,CAAhB;;AALkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMrB,KA3DI;AA4DCgC,IAAAA,iBA5DD,+BA4DqB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACtB,oBAAIgB,OAAJ,CAAY,UAAAC,OAAO,EAAI;AACnBC,kBAAAA,UAAU,CAAC,YAAM;AACbD,oBAAAA,OAAO,CAAC,UAAD,CAAP;AACA,wBAAMjC,EAAE,GAAG,MAAI,CAACH,MAAL,CAAYI,MAAZ,CAAmBD,EAA9B;AACAtC,oBAAAA,eAAe,CAACyE,MAAhB,CAAuBnC,EAAvB,EAA2BoC,IAA3B,CAAgC,UAAAC,GAAG,EAAI;AACnC,sBAAA,MAAI,CAACzE,QAAL,GAAgByE,GAAG,CAACnE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAAhB;AACH,qBAFD;AAGH,mBANS,CAAV;AAOH,iBARD;;AADsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUzB,KAtEI;AAuECwC,IAAAA,eAvED,6BAuEmB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACpB,oBAAIsB,OAAJ,CAAY,UAAAC,OAAO,EAAI;AACnBC,kBAAAA,UAAU,CAAC,YAAM;AACbD,oBAAAA,OAAO,CAAC,UAAD,CAAP;AACA,wBAAMjC,EAAE,GAAG,MAAI,CAACH,MAAL,CAAYI,MAAZ,CAAmBD,EAA9B;AACAvC,oBAAAA,oBAAoB,CAAC0E,MAArB,CAA4BnC,EAA5B,EAAgCoC,IAAhC,CAAqC,UAAAC,GAAG,EAAI;AACxC,sBAAA,MAAI,CAACxE,aAAL,GAAqBwE,GAAG,CAACnE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAArB;AACH,qBAFD;AAGH,mBANS,CAAV;AAOH,iBARD;;AADoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUvB,KAjFI;AAkFCoC,IAAAA,WAlFD,yBAkFe;AAAA;AAAA;AAAA;AAAA;AAAA;AAChB,oBAAI0B,OAAJ,CAAY,UAAAC,OAAO,EAAI;AACnBC,kBAAAA,UAAU,CAAC,YAAM;AACbD,oBAAAA,OAAO,CAAC,UAAD,CAAP;AACA1E,oBAAAA,iBAAiB,CAAC+E,GAAlB,CAAsB9E,MAAM,CAAC+E,WAAP,CAAmBC,YAAzC,EAAuD,SAAvD,EAAkE,YAAlE;AACH,mBAHS,EAGP,GAHO,CAAV;AAIH,iBALD;;AADgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOnB,KAzFI;AA0FCC,IAAAA,uBA1FD,mCA0FyBC,KA1FzB,EA0FgC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAC3B/D,gBAAAA,MAD2B,GAClB+D,KAAK,CAAC/D,MAAN,CAAagE,KADK;AAAA;AAAA,uBAE3B,MAAI,CAACpC,QAAL,CAAc,CAAd,EAAiB5B,MAAjB,EAAyB,MAAI,CAACE,WAA9B,CAF2B;;AAAA;AAGjC,gBAAA,MAAI,CAACF,MAAL,GAAcA,MAAd;;AAHiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIpC,KA9FI;AA+FC4B,IAAAA,QA/FD,oBA+FUqC,IA/FV,EA+FgBjE,MA/FhB,EA+FwBkE,OA/FxB,EA+FiC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAC5BC,gBAAAA,GAD4B,GACtBD,OAAO,qBACJlE,MADI,CADe;AAGlC,gBAAA,MAAI,CAACoE,cAAL,GAAsB,IAAtB;AACAC,gBAAAA,KAAK,CAACF,GAAD,CAAL,CACKV,IADL,CACU,UAACa,QAAD,EAAc;AAChB,yBAAOA,QAAQ,CAACC,IAAT,EAAP;AACH,iBAHL,EAIKd,IAJL,CAIU,MAAI,CAACe,UAJf;;AAJkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASrC,KAxGI;AAyGLA,IAAAA,UAzGK,sBAyGMD,IAzGN,EAyGY;AACb,WAAKnE,YAAL,GAAoBmE,IAAI,CAAChF,IAAzB;AACH,KA3GI;AA4GLkF,IAAAA,QA5GK,oBA4GIV,KA5GJ,EA4GW;AACZ,UAAMC,KAAK,GAAGD,KAAK,CAACC,KAApB;;AACA,UAAIA,KAAK,IAAIA,KAAK,CAACzF,SAAD,CAAL,KAAqBG,SAAS,CAACH,SAAD,CAA3C,EAAwD;AACpD;AACH;;AACD,WAAKU,QAAL,CAAcyF,QAAd,GAAyBV,KAAzB;AACH,KAlHI;AAmHLW,IAAAA,YAnHK,0BAmHU;AAAA;;AACX,UAAIC,EAAE,GAAG,KAAKC,KAAL,CAAWC,UAAX,CAAsBC,WAAtB,EAAT;AACA,UAAIC,OAAO,GAAGJ,EAAE,CAACrF,IAAH,EAAd;AAAA,UACI0F,MAAM,GAAG,CADb;AAAA,UACgBC,QAAQ,GAAG,CAD3B;AAAA,UAC8B7E,QAAQ,GAAG,CADzC;AAAA,UAC4C8E,SAAS,GAAG,CADxD;AAAA,UAC2DC,QAAQ,GAAG,CADtE;AAAA,UACyEC,SAAS,GAAG,CADrF;AAEA,WAAKtF,SAAL,GAAiB,EAAjB;AACAiF,MAAAA,OAAO,CAACM,OAAR,CAAgB,UAAAC,IAAI,EAAI;AACpBJ,QAAAA,SAAS,GAAG,CAAZ;AACAE,QAAAA,SAAS,GAAG,CAAZ;;AACA,YAAIE,IAAI,CAAC/C,OAAT,EAAkB;AACd,cAAIgD,GAAG,GAAID,IAAI,CAACE,MAAhB;AACAR,UAAAA,MAAM,GAAG,OAAI,CAACS,gBAAL,CAAsBH,IAAI,CAAC/C,OAA3B,EAAoCgD,GAApC,CAAT;AACH;;AACD,YAAID,IAAI,CAAC/C,OAAL,CAAamD,UAAb,CAAwBC,WAAxB,OAA0C,WAA9C,EAA2D;AACvDP,UAAAA,SAAS,GAAGE,IAAI,CAACE,MAAL,IAAe,IAAKF,IAAI,CAAC/C,OAAL,CAAaqD,IAAb,GAAoB,GAAxC,CAAZ;AACH,SAFD,MAEO;AACHV,UAAAA,SAAS,GAAGI,IAAI,CAACE,MAAjB;AACH;;AACD,QAAA,OAAI,CAAC1F,SAAL,CAAe+F,GAAf,CAAmB,UAACxD,CAAD,EAAIyD,KAAJ,EAAc;AAC7B,cAAIzD,CAAC,CAAC0D,GAAF,KAAUT,IAAI,CAACS,GAAnB,EAAwB;AACpB,YAAA,OAAI,CAACjG,SAAL,CAAekG,MAAf,CAAsBF,KAAtB,EAA6B,CAA7B;AACH;AACJ,SAJD;;AAKA,QAAA,OAAI,CAAChG,SAAL,CAAe4C,IAAf,CAAoB;AAChBqD,UAAAA,GAAG,EAAET,IAAI,CAACS,GADM;AAEhBP,UAAAA,MAAM,EAAEF,IAAI,CAACE,MAFG;AAGhBS,UAAAA,eAAe,EAAEb,SAHD;AAIhB7E,UAAAA,YAAY,EAAE2E,SAAS,IAAI,CAJX;AAKhBvC,UAAAA,GAAG,EAAEqC,MALW;AAMhBkB,UAAAA,WAAW,EAAEZ,IAAI,CAACY,WANF;AAOhB3D,UAAAA,OAAO,EAAE;AAACrD,YAAAA,IAAI,EAAEoG,IAAI,CAAC/C,OAAL,CAAaE,UAApB;AAAgC0D,YAAAA,SAAS,EAAEb,IAAI,CAAC/C,OAAL,CAAa6D,OAAb,CAAqBhF;AAAhE,WAPO;AAQhBsE,UAAAA,UAAU,EAAEJ,IAAI,CAACI;AARD,SAApB;AAUH,OA3BD;AA4BAT,MAAAA,QAAQ,IAAInH,KAAK,CAACuI,UAAN,CAAiBrB,MAAjB,CAAZ;AACA5E,MAAAA,QAAQ,IAAItC,KAAK,CAACuI,UAAN,CAAiBjB,SAAjB,CAAZ;AACAD,MAAAA,QAAQ,IAAIrH,KAAK,CAACuI,UAAN,CAAiBnB,SAAjB,CAAZ;AAEA,WAAK9E,QAAL,IAAiB6E,QAAjB;AACA,WAAK1E,YAAL,IAAqB4E,QAArB;AACA,WAAK7E,kBAAL,IAA2BF,QAA3B;AAEA2B,MAAAA,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,KAAKnC,SAAxB;AACH,KA7JI;AA8JL2F,IAAAA,gBA9JK,4BA8JYa,GA9JZ,EA8JiBd,MA9JjB,EA8JyB;AAC1B,UAAIc,GAAJ,EAAS;AACL,YAAIC,OAAO,GAAGD,GAAG,CAACC,OAAlB;AAAA,YACIC,KAAK,GAAG1I,KAAK,CAACuI,UAAN,CAAiBb,MAAjB,CADZ;AAAA,YAEIiB,IAAI,GAAG3I,KAAK,CAACuI,UAAN,CAAiBb,MAAjB,CAFX;AAAA,YAGIkB,OAAO,GAAG5I,KAAK,CAACuI,UAAN,CAAiBC,GAAG,CAACI,OAArB,IAAgC,GAH9C;AAAA,YAIId,IAAI,GAAG9H,KAAK,CAACuI,UAAN,CAAiBC,GAAG,CAACV,IAArB,IAA6B,GAJxC;AAAA,YAKIe,KAAK,GAAGC,IAAI,CAACL,OAAD,CALhB;AAMAxE,QAAAA,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmBuE,KAAnB,EAA0BC,IAA1B,EAAgCC,OAAhC,EAAyCd,IAAzC,EAA+CW,OAA/C,EAAwDI,KAAxD;AACA,eAAOA,KAAP;AACH;AACJ,KAzKI;AA0KLE,IAAAA,kBA1KK,8BA0Kc9B,OA1Kd,EA0KuB;AACxB,UAAIC,MAAM,GAAG,CAAb;;AACA,UAAID,OAAO,CAACxC,OAAZ,EAAqB;AACjB,YAAIgD,GAAG,GAAGR,OAAO,CAACS,MAAlB;AACAR,QAAAA,MAAM,GAAG,KAAKS,gBAAL,CAAsBV,OAAO,CAACxC,OAA9B,EAAuCgD,GAAvC,CAAT;AACH;;AACD,WAAKnF,QAAL,GAAgB,KAAKA,QAAL,GAAgB4E,MAAhC;AACH,KAjLI;AAkLL8B,IAAAA,mBAlLK,+BAkLeC,CAlLf,EAkLkB;AACnB,UAAIA,CAAC,CAACC,KAAN,EAAa;AACT,YAAIjC,OAAO,GAAGgC,CAAC,CAACE,KAAF,CAAQ,CAAR,CAAd;;AACA,gBAAQF,CAAC,CAACC,KAAV;AACI,eAAK,SAAL;AACIjC,YAAAA,OAAO,CAACmC,GAAR,CAAY,YAAZ,EAA0BnC,OAAO,CAACxC,OAAR,CAAgBmD,UAA1C;;AACA,gBAAIX,OAAO,CAACS,MAAR,GAAiB,CAArB,EAAwB;AACpB,mBAAKd,YAAL;AACH;;AACD;;AACJ,eAAK,QAAL;AACI,gBAAIK,OAAO,CAACxC,OAAR,CAAgBzB,cAAhB,CAA+B,YAA/B,CAAJ,EAAkD;AAC9C,mBAAK4D,YAAL;AACH;;AACD;AAXR;AAaH;AACJ,KAnMI;AAoMLyC,IAAAA,OApMK,qBAoMK;AACN,WAAKnI,QAAL,GAAgB,IAAInB,cAAJ,CAAmB,EAAnB,CAAhB;AACA,WAAKuC,QAAL,GAAgB,CAAhB;AACA,WAAKE,kBAAL,GAA0B,CAA1B;AACA,WAAKC,YAAL,GAAoB,CAApB;AACAwB,MAAAA,MAAM,CAACqF,OAAP,CAAeC,EAAf,CAAkB,CAAC,CAAnB,EALM,CAMN;AACA;AACA;AACA;AACA;AACA;AACH,KAhNI;AAiNLC,IAAAA,YAjNK,wBAiNQvD,KAjNR,EAiNe;AAChB;AACA,aAAOjG,KAAK,CAACyJ,QAAN,CAAexD,KAAf,aAA0B,KAAK/E,QAAL,CAAcwI,OAAxC,EAAP;AACH,KApNI;AAqNL;AACAC,IAAAA,aAtNK,yBAsNSC,QAtNT,EAsNmB;AACpB,UAAI/C,EAAE,GAAG,KAAKC,KAAL,CAAWC,UAAX,CAAsBC,WAAtB,EAAT;AAAA,UACIgB,KAAK,GAAGnB,EAAE,CAACgD,OAAH,CAAWD,QAAX,CADZ;AAEA,aAAO5B,KAAK,GAAG,CAAf;AACH,KA1NI;AA2NL;AACA8B,IAAAA,SA5NK,qBA4NKb,CA5NL,EA4NQ;AACTA,MAAAA,CAAC,CAACc,cAAF;AACA,UAAIC,IAAI,GAAGhK,KAAK,CAACiK,MAAN,CAAa,OAAb,EAAsBzI,IAAtB,CAA2B,WAA3B,CAAX;AAAA,UACIuF,UAAU,GAAGiD,IAAI,CAACjD,UADtB;AAAA,UAEI6C,QAAQ,GAAGI,IAAI,CAACJ,QAAL,CAActJ,CAAC,CAAC2I,CAAC,CAACiB,aAAH,CAAD,CAAmBC,OAAnB,CAA2B,IAA3B,CAAd,CAFf;;AAIA,UAAIpD,UAAU,CAAC8B,KAAX,KAAqB,CAAzB,EAA4B;AACxB5E,QAAAA,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmByF,QAAnB,EAA6B,QAA7B;;AACA,YAAIA,QAAQ,CAAClC,MAAT,KAAoB,CAApB,IAAyBkC,QAAQ,CAACnF,OAAT,CAAiBqD,IAAjB,KAA0BtE,SAAvD,EAAkE;AAC9D,cAAIoG,QAAQ,CAAChC,UAAT,CAAoBC,WAApB,OAAsC,KAA1C,EAAiD;AAC7C,iBAAKpF,YAAL,GAAoB,KAAKA,YAAL,GAAoBmH,QAAQ,CAAClC,MAAjD;AACA,iBAAKqB,kBAAL,CAAwBa,QAAxB;AACH,WAHD,MAGM;AACF,gBAAIlC,MAAM,GAAGkC,QAAQ,CAAClC,MAAT,IAAmB,IAAKkC,QAAQ,CAACjH,cAAT,CAAwBmF,IAAxB,GAA+B,GAAvD,CAAb;AACA,iBAAKtF,kBAAL,GAA0B,KAAKA,kBAAL,GAA0BkF,MAApD;AACA,iBAAKqB,kBAAL,CAAwBa,QAAxB;AACH;AACJ;;AAED7C,QAAAA,UAAU,CAACqD,MAAX,CAAkBR,QAAlB;AACH;AACJ,KAjPI;AAkPLS,IAAAA,4BAlPK,wCAkPwBC,SAlPxB,EAkPmCC,OAlPnC,EAkP4C;AAC7C;AACAvK,MAAAA,KAAK,CAACiK,MAAN,CAAa,2BAA2BM,OAAO,CAACrB,KAAnC,GAA2C,KAAxD,EACKsB,QADL,CACcF,SADd,EAEKG,iBAFL,CAEuB;AACfC,QAAAA,QAAQ,EAAE,KADK;AAEfC,QAAAA,SAAS,EAAE,IAFI;AAGfC,QAAAA,MAAM,EAAE,GAHO;AAIfC,QAAAA,aAAa,EAAE,YAJA;AAKfC,QAAAA,cAAc,EAAE,IALD;AAMfC,QAAAA,WAAW,EAAE,gBANE;AAOfhE,QAAAA,UAAU,EAAE;AACRvF,UAAAA,IAAI,EAAE,KAAKmB,cAAL,CAAoBV,MAApB,CAA2B,UAACuF,IAAD;AAAA,mBAAUA,IAAI,CAACwD,eAAL,CAAqBnD,WAArB,OAAuC,UAAvC,IAAqDL,IAAI,CAACyD,OAAL,CAAaC,MAAb,KAAwB,CAAvF;AAAA,WAA3B,CADE;AAERC,UAAAA,KAAK,EAAE;AACHjC,YAAAA,KAAK,EAAE;AADJ;AAFC;AAPG,OAFvB;AAgBH,KApQI;AAqQC/D,IAAAA,MArQD,oBAqQU;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACP0B,gBAAAA,EADO,GACF,OAAI,CAACC,KAAL,CAAWC,UAAX,CAAsBC,WAAtB,EADE,EAEP6B,KAFO,GAEChC,EAAE,CAACgC,KAAH,EAFD;AAGXhC,gBAAAA,EAAE,CAACuE,MAAH,CAAUvC,KAAV,EAAiB;AACblG,kBAAAA,cAAc,EAAE;AAACgC,oBAAAA,UAAU,EAAE;AAAb,mBADH;AAEbiD,kBAAAA,UAAU,EAAE,EAFC;AAGbF,kBAAAA,MAAM,EAAE,CAHK;AAIbU,kBAAAA,WAAW,EAAE;AAJA,iBAAjB;;AAHW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASd,KA9QI;AA+QCiD,IAAAA,WA/QD,yBA+Qe;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAChB,gBAAA,OAAI,CAAC3J,WAAL,GAAmB,IAAnB,CADgB,CAEhB;;AACA,oBAAI,OAAI,CAACR,QAAL,CAAcyF,QAAd,CAAuB2E,YAAvB,KAAwC,EAA5C,EAAgD;AAC5C,sBAAI,OAAI,CAACpK,QAAL,CAAcyF,QAAd,CAAuBtD,IAAvB,CAA4BwE,WAA5B,OAA8C,oBAAlD,EAAwE;AACpE,oBAAA,OAAI,CAAC3G,QAAL,CAAcyF,QAAd,CAAuB2E,YAAvB,GAAsC,iBAAtC;AACA,oBAAA,OAAI,CAACpK,QAAL,CAAcyF,QAAd,CAAuB4E,aAAvB,GAAuC,cAAvC;AACH,mBAHD,MAGO,IAAI,OAAI,CAACrK,QAAL,CAAcyF,QAAd,CAAuBtD,IAAvB,CAA4BwE,WAA5B,OAA8C,gBAAlD,EAAoE;AACvE,oBAAA,OAAI,CAAC3G,QAAL,CAAcyF,QAAd,CAAuB2E,YAAvB,GAAsC,cAAtC;AACA,oBAAA,OAAI,CAACpK,QAAL,CAAcyF,QAAd,CAAuB4E,aAAvB,GAAuC,cAAvC;AACH,mBAHM,MAGA,IAAI,OAAI,CAACrK,QAAL,CAAcyF,QAAd,CAAuBtD,IAAvB,CAA4BwE,WAA5B,OAA8C,kBAAlD,EAAsE;AACzE,oBAAA,OAAI,CAAC3G,QAAL,CAAcyF,QAAd,CAAuB2E,YAAvB,GAAsC,iBAAtC;AACA,oBAAA,OAAI,CAACpK,QAAL,CAAcyF,QAAd,CAAuB4E,aAAvB,GAAuC,UAAvC;AACH,mBAHM,MAGA,IAAI,OAAI,CAACrK,QAAL,CAAcyF,QAAd,CAAuBtD,IAAvB,CAA4BwE,WAA5B,OAA8C,oBAAlD,EAAwE;AAC3E,oBAAA,OAAI,CAAC3G,QAAL,CAAcyF,QAAd,CAAuB2E,YAAvB,GAAsC,cAAtC;AACA,oBAAA,OAAI,CAACpK,QAAL,CAAcyF,QAAd,CAAuB4E,aAAvB,GAAuC,UAAvC;AACH,mBAHM,MAGA,IAAI,OAAI,CAACrK,QAAL,CAAcyF,QAAd,CAAuBtD,IAAvB,CAA4BwE,WAA5B,OAA8C,gBAAlD,EAAoE;AACvE,oBAAA,OAAI,CAAC3G,QAAL,CAAcyF,QAAd,CAAuB2E,YAAvB,GAAsC,cAAtC;AACA,oBAAA,OAAI,CAACpK,QAAL,CAAcyF,QAAd,CAAuB4E,aAAvB,GAAuC,UAAvC;AACH;AACJ;;AACD,oBAAI,OAAI,CAACvJ,SAAL,CAAe8C,MAAf,GAAwB,CAAxB,IAA6B,OAAI,CAAC5D,QAAL,CAAcsD,QAAd,CAAuBM,MAAvB,GAAgC,CAAjE,EAAoE;AAChEb,kBAAAA,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,OAAI,CAACjD,QAAL,CAAcsD,QAAjC,EAA2C,oBAA3C;AACA,kBAAA,OAAI,CAACtD,QAAL,CAAcsD,QAAd,GAAyB,OAAI,CAACtD,QAAL,CAAcsD,QAAd,CAAuBuD,GAAvB,CAA2B,UAAAP,IAAI,EAAI;AACxD,2BAAO;AACHS,sBAAAA,GAAG,EAAET,IAAI,CAACS,GADP;AAEHP,sBAAAA,MAAM,EAAEF,IAAI,CAACE,MAFV;AAGHS,sBAAAA,eAAe,EAAEX,IAAI,CAACW,eAHnB;AAIH1F,sBAAAA,YAAY,EAAE+E,IAAI,CAAC/E,YAJhB;AAKH+E,sBAAAA,IAAI,EAAEA,IAAI,CAACA,IALR;AAMH3C,sBAAAA,GAAG,EAAE2C,IAAI,CAAC3C,GANP;AAOHuD,sBAAAA,WAAW,EAAEZ,IAAI,CAACY,WAPf;AAQH3D,sBAAAA,OAAO,EAAE;AAACrD,wBAAAA,IAAI,EAAEoG,IAAI,CAAC/C,OAAL,CAAaE,UAApB;AAAgC0D,wBAAAA,SAAS,EAAEb,IAAI,CAAC/C,OAAL,CAAa6D,OAAb,CAAqBhF;AAAhE,uBARN;AASHsE,sBAAAA,UAAU,EAAEJ,IAAI,CAACI;AATd,qBAAP;AAWH,mBAZwB,CAAzB;AAaH;;AACKpG,gBAAAA,IArCU,GAqCH;AACT8B,kBAAAA,EAAE,EAAE,OAAI,CAACpC,QAAL,CAAcoC,EAAd,GAAmB,OAAI,CAACpC,QAAL,CAAcoC,EAAjC,gBAA4ClD,IAAI,CAACoL,EAAL,EAA5C,CADK;AAETnI,kBAAAA,IAAI,EAAE,UAFG;AAGToI,kBAAAA,IAAI,EAAE,OAAI,CAACvK,QAAL,CAAcuK,IAHX;AAITC,kBAAAA,eAAe,EAAE,OAAI,CAACvK,aAAL,CAAmBmC,EAJ3B;AAKT8E,kBAAAA,WAAW,EAAE,EALJ;AAMTuD,kBAAAA,SAAS,EAAE,OAAI,CAACzK,QAAL,CAAcyK,SANhB;AAOTC,kBAAAA,OAAO,EAAE,OAAI,CAACzK,aAAL,CAAmByK,OAPnB;AAQTjF,kBAAAA,QAAQ,EAAE,OAAI,CAACzF,QAAL,CAAcyF,QARf;AAST1B,kBAAAA,QAAQ,EAAE,OAAI,CAAC3C,QATN;AAUTyC,kBAAAA,oBAAoB,EAAE,OAAI,CAACvC,kBAVlB;AAWTwC,kBAAAA,iBAAiB,EAAE,OAAI,CAACvC,YAXf;AAYT+B,kBAAAA,QAAQ,EAAE,OAAI,CAACxC,SAAL,CAAe8C,MAAf,GAAwB,CAAxB,GAA4B,OAAI,CAAC9C,SAAjC,GAA6C,OAAI,CAACd,QAAL,CAAcsD,QAZ5D;AAaTqH,kBAAAA,MAAM,EAAE,OAAI,CAAC3K,QAAL,CAAc2K,MAAd,IAAwB,KAbvB;AAcT5I,kBAAAA,MAAM,EAAE,OAAI,CAACE,MAAL,CAAYC,KAAZ,CAAkBC,IAAlB,KAA2B,MAA3B,GAAoC,CAApC,GAAwC,CAdvC;AAeT0D,kBAAAA,UAAU,EAAE,OAAI,CAAC5D,MAAL,CAAYC,KAAZ,CAAkBC,IAAlB,KAA2B,MAA3B,GAAoC,OAAI,CAACnC,QAAL,CAAc6F,UAAlD,GAA+D;AAAC3F,oBAAAA,IAAI,EAAE,UAAP;AAAmBkC,oBAAAA,EAAE,EAAE;AAAvB;AAflE,iBArCG;AAsDhB,gBAAA,OAAI,CAACpC,QAAL,CAAcyF,QAAd,CAAuBmF,UAAvB,GAAoC,EAApC;AACMC,gBAAAA,MAvDU,GAuDD,IAAIhM,cAAJ,CAAmByB,IAAnB,CAvDC;;AAwDhB,gBAAA,OAAI,CAACwK,MAAL,CAAYC,QAAZ,CAAqB,yBAArB,EAAgDF,MAAhD,EAxDgB,CAyDhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,gBAAA,OAAI,CAACrK,WAAL,GAAmB,KAAnB;;AACA,gBAAA,OAAI,CAAC2H,OAAL;;AACApF,gBAAAA,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,OAAI,CAACnC,SAAxB,EAAmCR,IAAnC,EAAyC,MAAzC,EA7EgB,CA8EhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAzFgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0FnB;AAzWI;AA9EE,CAAf","sourcesContent":["/*\n * Last modified : 3/30/21, 9:52 AM in Project banhji-accounting-web-module\n * Copyright (c) 2021. Chandarith Chea under Company BanhJi Fintech Co., Ltd\n * Facebook Profile : https://www.facebook.com/profile.php?id=100011194806947\n * Github Profile : https://github.com/Darith-Mokpost\n * Instagram Profile : https://www.instagram.com/chandarith_chea\n */\nimport PurchaseRecord from \"@/scripts/compliance/model/PurchaseRecord\";\nimport kendo from \"@progress/kendo-ui\";\nimport {DropDownList} from \"@progress/kendo-vue-dropdowns\";\nimport MonthlyReturn from \"@/scripts/compliance/model/MonthlyReturn\";\nimport LoadingMe from \"@/components/Loading\";\nimport {uuid} from 'vue-uuid'\nimport ItemLinePurchase from \"@/scripts/compliance/model/itemLinePurchase\";\n\nconst $ = require(\"jquery\")\nconst textField = 'numberName'\nconst keyField = 'id'\nconst defaultItem = {[textField]: 'Select supplier...', [keyField]: null}\nconst emptyItem = {[textField]: 'loading ...'}\nconst taxSetting = require('@/store/taxSetting');\nconst taxSettingHandler = require(\"@/scripts/taxSettingHandler\")\nconst apiUrl = require('@/apiUrl')\nconst monthlyReturnHandler = require(\"@/scripts/compliance/handler/monthlyReturnHandler\")\nconst purchaseHandler = require(\"@/scripts/compliance/handler/purchaseHandler\")\nconst supplierHandler = require(\"@/scripts/supplierHandler\")\nconst purchase = new PurchaseRecord({})\nconst monthlyReturn = new MonthlyReturn({})\n// @vue/component\nexport default {\n    name: 'Add_purchase',\n\n    components: {\n        'dropdownlist': DropDownList,\n        'LoadingMe': LoadingMe,\n    },\n\n    mixins: [],\n\n    props: {},\n\n    data() {\n        return {\n            dialogTax: false,\n            showLoading: false,\n            menuJDateAddSale: false,\n            purchase: purchase,\n            txn_date: new Date().toISOString().substr(0, 10),\n            itemLines: [],\n            filter: '',\n            textField: 'numberName',\n            dataItemKey: 'id',\n            defaultItem: defaultItem,\n            suppBaseUrl: supplierHandler.search(),\n            supplierList: [],\n\n            totalVat: 0,\n            amountVat: 0,\n            amountInclusiveVat: 0,\n            amountNetVat: 0,\n            monthlyReturn: monthlyReturn,\n        }\n    },\n\n    computed: {\n        typeProductTax() {\n            return taxSetting.default.state.listTax\n        },\n        isDisable() {\n            if (this.monthlyReturn.hasOwnProperty('status')) {\n                if (this.monthlyReturn.status.code === 1) {\n                    if (this.$route.query.type === 'edit') {\n                        return false\n                    } else if (this.$route.query.type === 'view') {\n                        return true\n                    } else {\n                        return true\n                    }\n                } else {\n                    return true\n                }\n            } else {\n                return true\n            }\n        },\n        id() {\n            if (this.$route.params.purchase !== undefined) {\n                return this.$route.params.purchase\n            }else {\n                return ''\n            }\n        }\n    },\n\n    watch: {\n        'id': 'initData'\n    },\n\n    async mounted() {\n        await this.initData()\n        await this.loadListTax()\n        await this.loadData(0, '', this.suppBaseUrl)\n    },\n\n    created() {\n    },\n\n    methods: {\n        async initData() {\n            this.showLoading = true\n            if (this.$route.params.id !== undefined && this.$route.params.monthlyReturn === undefined) {\n                await this.onLoadOneReturn()\n                window.console.log(this.$route.params)\n            } else if (this.$route.params.monthlyReturn !== undefined) {\n                this.monthlyReturn = this.$route.params.monthlyReturn\n            } else {\n                await this.clear()\n            }\n            if (this.$route.query.p_id !== undefined && this.$route.params.purchase === undefined) {\n                await this.onloadOnePurchase()\n            } else if (this.$route.params.purchase !== undefined) {\n                this.purchase = this.$route.params.purchase\n                window.console.log(this.purchase, 'list tax')\n                const itemLines = []\n                for (let i =0; i < this.purchase.itemLine.length; i++) {\n                    this.purchase.itemLine[i].taxName = this.typeProductTax.filter(p => p.defaultTax === this.purchase.itemLine[i].taxName.name)[0]\n                    itemLines.push(new ItemLinePurchase(this.purchase.itemLine[i]))\n                    this.amountVat += this.purchase.itemLine[i].vat || 0\n                }\n                this.purchase.itemLine = itemLines\n                this.amountInclusiveVat = this.purchase.totalAmountInclusive || 0\n                this.amountNetVat = this.purchase.totalAmountNetVat || 0\n                this.totalVat = this.purchase.totalVAT || 0\n            } else {\n                await this.clearPurchase()\n            }\n            if (this.purchase.totalAmountNetVat !== 0 || this.purchase.totalAmountInclusive !== 0 || this.purchase.totalVAT !== 0) {\n                this.amountInclusiveVat = this.purchase.totalAmountInclusive\n                this.amountNetVat = this.purchase.totalAmountNetVat\n                this.totalVat = this.purchase.totalVAT\n            }else {\n                if (purchase.itemLine.length === 0) {\n                    await this.addRow()\n                }\n            }\n            this.showLoading = false\n            // if (this.sale.itemLine.length === 0) {\n            //     await this.addRow()\n            // }\n        },\n        async clear() {\n            await this.clearPurchase()\n            await this.clearMonthlyReturn()\n        },\n        async clearMonthlyReturn() {\n            this.monthlyReturn = new MonthlyReturn({})\n        },\n        disableEditor() {\n            return false;\n        },\n        async clearPurchase() {\n            this.purchase = new PurchaseRecord({})\n            this.itemLines = []\n            this.amountNetVat = 0\n            this.amountInclusiveVat = 0\n            this.totalVat = 0\n        },\n        async onloadOnePurchase() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    const id = this.$route.params.id\n                    purchaseHandler.getOne(id).then(res => {\n                        this.purchase = res.data.data[0]\n                    })\n                })\n            })\n        },\n        async onLoadOneReturn() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    const id = this.$route.params.id\n                    monthlyReturnHandler.getOne(id).then(res => {\n                        this.monthlyReturn = res.data.data[0]\n                    })\n                })\n            })\n        },\n        async loadListTax() {\n            new Promise(resolve => {\n                setTimeout(() => {\n                    resolve('resolved');\n                    taxSettingHandler.get(apiUrl.tax_setting.tax_list_get, \"listTax\", \"setListTax\")\n                }, 100)\n            })\n        },\n        async onSupplierFilterChanged(event) {\n            const filter = event.filter.value\n            await this.loadData(0, filter, this.suppBaseUrl)\n            this.filter = filter\n        },\n        async loadData(skip, filter, baseUrl) {\n            const url = baseUrl +\n                `?filter=${filter}`\n            this.requestStarted = true;\n            fetch(url)\n                .then((response) => {\n                    return response.json()\n                })\n                .then(this.afterFetch)\n        },\n        afterFetch(json) {\n            this.supplierList = json.data\n        },\n        onChange(event) {\n            const value = event.value\n            if (value && value[textField] === emptyItem[textField]) {\n                return;\n            }\n            this.purchase.supplier = value\n        },\n        calculateTax() {\n            let ds = this.$refs.dataSource.kendoWidget()\n            let dataRow = ds.data(),\n                vatTax = 0, totalTax = 0, totalVat = 0, amountNet = 0, totalNet = 0, amountInc = 0\n            this.itemLines = []\n            dataRow.forEach(item => {\n                amountNet = 0\n                amountInc = 0\n                if (item.taxName) {\n                    let amt = (item.amount)\n                    vatTax = this.autoCalculateTax(item.taxName, amt)\n                }\n                if (item.taxName.baseAmount.toLowerCase() === \"inclusive\") {\n                    amountInc = item.amount / (1 + (item.taxName.rate / 100))\n                } else {\n                    amountNet = item.amount\n                }\n                this.itemLines.map((i, index) => {\n                    if (i.uid === item.uid) {\n                        this.itemLines.splice(index, 1)\n                    }\n                })\n                this.itemLines.push({\n                    uid: item.uid,\n                    amount: item.amount,\n                    amountInclusive: amountInc,\n                    amountNetVat: amountNet || 0,\n                    vat: vatTax,\n                    description: item.description,\n                    taxName: {name: item.taxName.defaultTax, accountId: item.taxName.account.id},\n                    baseAmount: item.baseAmount\n                })\n            })\n            totalTax += kendo.parseFloat(vatTax)\n            totalVat += kendo.parseFloat(amountInc)\n            totalNet += kendo.parseFloat(amountNet)\n\n            this.totalVat += totalTax\n            this.amountNetVat += totalNet\n            this.amountInclusiveVat += totalVat\n\n            window.console.log(this.itemLines)\n        },\n        autoCalculateTax(tax, amount) {\n            if (tax) {\n                let formula = tax.formula,\n                    inAmt = kendo.parseFloat(amount),\n                    nAmt = kendo.parseFloat(amount),\n                    taxBase = kendo.parseFloat(tax.taxBase) / 100,\n                    rate = kendo.parseFloat(tax.rate) / 100,\n                    total = eval(formula)\n                window.console.log(inAmt, nAmt, taxBase, rate, formula, total)\n                return total\n            }\n        },\n        calculateTaxDelete(dataRow) {\n            let vatTax = 0\n            if (dataRow.taxName) {\n                let amt = dataRow.amount\n                vatTax = this.autoCalculateTax(dataRow.taxName, amt)\n            }\n            this.totalVat = this.totalVat - vatTax\n        },\n        onDataSourceChanges(e) {\n            if (e.field) {\n                let dataRow = e.items[0]\n                switch (e.field) {\n                    case \"taxName\":\n                        dataRow.set(\"baseAmount\", dataRow.taxName.baseAmount)\n                        if (dataRow.amount > 0) {\n                            this.calculateTax()\n                        }\n                        break\n                    case \"amount\":\n                        if (dataRow.taxName.hasOwnProperty('defaultTax')) {\n                            this.calculateTax()\n                        }\n                        break\n                }\n            }\n        },\n        onClose() {\n            this.purchase = new PurchaseRecord({})\n            this.totalVat = 0\n            this.amountInclusiveVat = 0\n            this.amountNetVat = 0\n            window.history.go(-1)\n            // this.$router.push({\n            //     name: 'Purchase Record',\n            //     path: 'purchase_record',\n            //     query: {type: this.$route.query.type},\n            //     params: {id: this.monthlyReturn.id, monthlyReturn: this.monthlyReturn}\n            // })\n        },\n        numberFormat(value) {\n            // window.console.log(this.saleFormContent.decimal,'nimol')\n            return kendo.toString(value, `n${this.purchase.decimal}`)\n        },\n        // Auto Increase number\n        rowNumberTmpl(dataItem) {\n            let ds = this.$refs.dataSource.kendoWidget(),\n                index = ds.indexOf(dataItem);\n            return index + 1;\n        },\n        // Remove Row\n        removeRow(e) {\n            e.preventDefault();\n            let grid = kendo.jQuery(\"#grid\").data(\"kendoGrid\"),\n                dataSource = grid.dataSource,\n                dataItem = grid.dataItem($(e.currentTarget).closest(\"tr\"));\n\n            if (dataSource.total() > 1) {\n                window.console.log(dataItem, 'delete')\n                if (dataItem.amount !== 0 || dataItem.taxName.rate !== undefined) {\n                    if (dataItem.baseAmount.toLowerCase() === 'net') {\n                        this.amountNetVat = this.amountNetVat - dataItem.amount\n                        this.calculateTaxDelete(dataItem)\n                    }else {\n                        let amount = dataItem.amount / (1 + (dataItem.typeProductTax.rate / 100))\n                        this.amountInclusiveVat = this.amountInclusiveVat - amount\n                        this.calculateTaxDelete(dataItem)\n                    }\n                }\n\n                dataSource.remove(dataItem);\n            }\n        },\n        typeProductTaxDropdownEditor(container, options) {\n            // const tpl = this.typeProductList\n            kendo.jQuery('<input required name=\"' + options.field + '\"/>')\n                .appendTo(container)\n                .kendoDropDownList({\n                    autoBind: false,\n                    autoWidth: true,\n                    height: 300,\n                    dataTextField: \"defaultTax\",\n                    dataValueField: \"id\",\n                    optionLabel: \"--- Select ---\",\n                    dataSource: {\n                        data: this.typeProductTax.filter((item) => item.transactionType.toLowerCase() === \"purchase\" && item.taxType.typeId === 1),\n                        group: {\n                            field: \"baseAmount\"\n                        }\n                    }\n                });\n        },\n        async addRow() {\n            let ds = this.$refs.dataSource.kendoWidget(),\n                total = ds.total();\n            ds.insert(total, {\n                typeProductTax: {defaultTax: \"\"},\n                baseAmount: \"\",\n                amount: 0,\n                description: \"\",\n            });\n        },\n        async onSaveClose() {\n            this.showLoading = true\n            // await this.getDataSource()\n            if (this.purchase.supplier.taxPayerType === '') {\n                if (this.purchase.supplier.type.toLowerCase() === 'individual-foreign') {\n                    this.purchase.supplier.taxPayerType = 'Physical Person'\n                    this.purchase.supplier.natureTaxType = 'Non-Resident'\n                } else if (this.purchase.supplier.type.toLowerCase() === 'foreign entity') {\n                    this.purchase.supplier.taxPayerType = 'Legal Person'\n                    this.purchase.supplier.natureTaxType = 'Non-Resident'\n                } else if (this.purchase.supplier.type.toLowerCase() === 'individual-local') {\n                    this.purchase.supplier.taxPayerType = 'Physical Person'\n                    this.purchase.supplier.natureTaxType = 'Resident'\n                } else if (this.purchase.supplier.type.toLowerCase() === 'non-taxable entity') {\n                    this.purchase.supplier.taxPayerType = 'Legal Person'\n                    this.purchase.supplier.natureTaxType = 'Resident'\n                } else if (this.purchase.supplier.type.toLowerCase() === 'taxable entity') {\n                    this.purchase.supplier.taxPayerType = 'Legal Person'\n                    this.purchase.supplier.natureTaxType = 'Resident'\n                }\n            }\n            if (this.itemLines.length < 0 || this.purchase.itemLine.length > 0) {\n                window.console.log(this.purchase.itemLine, 'itemline 123412412')\n                this.purchase.itemLine = this.purchase.itemLine.map(item => {\n                    return {\n                        uid: item.uid,\n                        amount: item.amount,\n                        amountInclusive: item.amountInclusive,\n                        amountNetVat: item.amountNetVat,\n                        item: item.item,\n                        vat: item.vat,\n                        description: item.description,\n                        taxName: {name: item.taxName.defaultTax, accountId: item.taxName.account.id},\n                        baseAmount: item.baseAmount,\n                    }\n                })\n            }\n            const data = {\n                id: this.purchase.id ? this.purchase.id : `mr-${uuid.v1()}`,\n                type: 'purchase',\n                date: this.purchase.date,\n                monthlyReturnId: this.monthlyReturn.id,\n                description: '',\n                reference: this.purchase.reference,\n                monthOf: this.monthlyReturn.monthOf,\n                supplier: this.purchase.supplier,\n                totalVAT: this.totalVat,\n                totalAmountInclusive: this.amountInclusiveVat,\n                totalAmountNetVat: this.amountNetVat,\n                itemLine: this.itemLines.length > 0 ? this.itemLines : this.purchase.itemLine,\n                isSave: this.purchase.isSave || false,\n                status: this.$route.query.type === 'Edit' ? 2 : 1,\n                dataSource: this.$route.query.type === 'Edit' ? this.purchase.dataSource : {name: \"Manually\", id: 2},\n            }\n            this.purchase.supplier.supplierId = ''\n            const result = new PurchaseRecord(data)\n            this.$store.dispatch('compliance/pushPurchase', result)\n            // let p = JSON.parse(localStorage.getItem(this.monthlyReturn.number+ '&Purchase'))\n            // if (p) {\n            //     if (p.length <= 0) {\n            //         if (this.monthlyReturn.abbr !== '' && this.monthlyReturn.number !== '') {\n            //             localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Purchase', JSON.stringify(data))\n            //         }\n            //     } else {\n            //         // localStorage.setItem(this.monthlyReturn.number+ '&Purchase', JSON.stringify([]))\n            //         const allArray = [...p, ...data]\n            //         results = allArray.filter((e, i) => allArray.findIndex(o => o.totalAmountInclusive === e.totalAmountInclusive && o.totalVAT === e.totalVAT && o.totalAmountNetVat === e.totalAmountNetVat) === i)\n            //         window.console.log(results, '34567')\n            //         if (this.monthlyReturn.abbr !== '' && this.monthlyReturn.number !== '') {\n            //             localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Purchase', JSON.stringify(results))\n            //         }\n            //     }\n            // } else {\n            //     localStorage.setItem(this.monthlyReturn.abbr + this.monthlyReturn.number + '&Purchase', JSON.stringify(data))\n            // }\n            this.showLoading = false\n            this.onClose()\n            window.console.log(this.itemLines, data, 'data')\n            // new Promise((resolve) => {\n            //     setTimeout(() => {\n            //         resolve(\"resolved\");\n            //         purchaseHandler.create(data).then(res => {\n            //             window.console.log(res)\n            //             this.showLoading = false\n            //             this.onClose()\n            //         }).catch(e => {\n            //             window.console.error(e)\n            //         })\n            //     }, 300);\n            // })\n        },\n    }\n}\n"]}]}